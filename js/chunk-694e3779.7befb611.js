(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-694e3779"],{"005c":function(e,t,r){"use strict";const s=Object.freeze({NEW_STREAM:0,MESSAGE_RECEIVER:1,MESSAGE_INITIATOR:2,CLOSE_RECEIVER:3,CLOSE_INITIATOR:4,RESET_RECEIVER:5,RESET_INITIATOR:6});t.MessageTypes=s,t.InitiatorMessageTypes=Object.freeze({NEW_STREAM:s.NEW_STREAM,MESSAGE:s.MESSAGE_INITIATOR,CLOSE:s.CLOSE_INITIATOR,RESET:s.RESET_INITIATOR}),t.ReceiverMessageTypes=Object.freeze({MESSAGE:s.MESSAGE_RECEIVER,CLOSE:s.CLOSE_RECEIVER,RESET:s.RESET_RECEIVER}),t.MessageTypeNames=Object.freeze(Object.entries(s).reduce((e,t)=>(e[t[1]]=t[0],e),{}))},"0111":function(e,t,r){"use strict";t.Diagnose=r("8e99"),t.Decoder=r("8431"),t.Encoder=r("2dc7"),t.Simple=r("5076"),t.Tagged=r("22b4"),t.decodeAll=t.Decoder.decodeAll,t.decodeFirst=t.Decoder.decodeFirst,t.diagnose=t.Diagnose.diagnose,t.encode=t.Encoder.encode,t.decode=t.Decoder.decode,t.leveldb={decode:t.Decoder.decodeAll,encode:t.Encoder.encode,buffer:!0,name:"cbor"}},"01de":function(e,t,r){"use strict";const s=r("34eb"),n=s("ipfs:repo:migrator:repo_mem_lock"),i="repo.lock",o={};t.lock=async function(e,t){const r=t+"/"+i;if(n("locking %s",r),!0===o[r])throw Error("There is already present lock for: "+r);return o[r]=!0,{close(){o[r]&&(n("releasing lock %s",r),delete o[r])}}}},"01f1":function(e,t,r){"use strict";const{getPubsubRouting:s}=r("a866"),n=r("a29d");e.exports=({ipns:e,options:t})=>{const r=t.EXPERIMENTAL;async function i(t={}){const n=s(e,r);return n.getSubscriptions(t)}return n(i)}},"01f9":function(e,t,r){"use strict";const{pipe:s}=r("66f2"),n=r("bbbe"),i=r("73fb"),o=r("474f"),a=r("a9f4");e.exports=e=>{const t=a.logger(e.peerId,"rpc"),r=o(e);async function c(s,n){const i=r(n.type);try{await e._add(s)}catch(o){t.error("Failed to update the kbucket store",o)}if(i)return i(s,n);t.error("no handler found for message type: "+n.type)}async function u({stream:r,connection:o}){const a=o.remotePeer;try{await e._add(a)}catch(l){t.error(l)}const u=a.toB58String();t("from: %s",u),await s(r.source,n.decode(),e=>async function*(){for await(const t of e){const e=i.deserialize(t.slice()),r=await c(a,e);r&&(yield r.serialize())}}(),n.encode(),r.sink)}return u}},"0280":function(e,t,r){"use strict";const s=r("6ef9"),n=r("ff5f"),i=r("eddf"),o=r("b6aa"),a=r("34eb"),c=Object.assign(a("ipfs:ipns:republisher"),{error:a("ipfs:ipns:republisher:error")}),u=6e4,l=60*u,d=4*l,h=24*l;class p{constructor(e,t,r,s,n={pass:""}){this._publisher=e,this._datastore=t,this._peerId=r,this._keychain=s,this._options=n,this._republishHandle=null}async start(){if(this._republishHandle)throw o(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");const e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:t=>{e._timeoutId=setTimeout(async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(t)}catch(r){c.error(r)}},t())},cancel:async()=>{null!=e._timeoutId&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{privKey:t}=this._peerId,{pass:r}=this._options;let s=!0;e._task=()=>this._republishEntries(t,r),e.runPeriodically(()=>s?(s=!1,this._options.initialBroadcastInterval||u):this._options.broadcastInterval||d),this._republishHandle=e}async stop(){const e=this._republishHandle;if(!e)throw o(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,t){try{await this._republishEntry(e)}catch(r){const e="cannot republish entry for the node's private key";return void c.error(e)}if(t)try{const e=await this._keychain.listKeys();for(const r of e){if("self"===r.name)continue;const e=await this._keychain.exportKey(r.name,t),s=await n.keys.import(e,t);await this._republishEntry(s)}}catch(r){c.error(r)}}async _republishEntry(e){if(!e||!e.bytes)throw o(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");try{const t=await i.createFromPrivKey(e.bytes),r=await this._getPreviousValue(t);await this._publisher.publishWithEOL(e,r,h)}catch(t){if("ERR_NO_ENTRY_FOUND"===t.code)return;throw t}}async _getPreviousValue(e){if(!i.isPeerId(e))throw o(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{const r=await this._datastore.get(s.getLocalKey(e.id));if(!(r instanceof Uint8Array))throw o(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{const e=s.unmarshal(r);return e.value}catch(t){throw c.error(t),o(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(t){if(t&&t.notFound)throw o(new Error("no previous entry for record with id: "+e.id),"ERR_NO_ENTRY_FOUND");throw t}}}e.exports=p},"0300":function(e,t,r){"use strict";const s=7;function n(e,t){return e+i(t)}function i(e){let t=e;return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}function o(e,t){return e[0]-t[0]}function a(e){return e[1]}e.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let r=this._internalPositionFor(e,!1);if(void 0===t)-1!==r&&(this._unsetInternalPos(r),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let s=!1;-1===r?(r=this._data.length,this._setBit(e),this._changedData=!0):s=!0,this._setInternalPos(r,e,t,s),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();const t=this._internalPositionFor(e,!0);if(-1!==t)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){const e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;while(t<this.length)e(this.get(t),t,this),t++}map(e){let t=0,r=new Array(this.length);while(t<this.length)r[t]=e(this.get(t),t,this),t++;return r}reduce(e,t){let r=0,s=t;while(r<this.length){const t=this.get(r);s=e(s,t,r),r++}return s}find(e){let t,r,s=0;while(s<this.length&&!t)r=this.get(s),t=e(r),s++;return t?r:void 0}_internalPositionFor(e,t){const r=this._bytePosFor(e,t);if(r>=this._bitArrays.length)return-1;const o=this._bitArrays[r],a=e-r*s,c=(o&1<<a)>0;if(!c)return-1;const u=this._bitArrays.slice(0,r).reduce(n,0),l=~(4294967295<<a+1),d=i(o&l),h=u+d-1;return h}_bytePosFor(e,t){const r=Math.floor(e/s),n=r+1;while(!t&&this._bitArrays.length<n)this._bitArrays.push(0);return r}_setBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-t*s}_unsetBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-t*s)}_setInternalPos(e,t,r,s){const n=this._data,i=[t,r];if(s)this._sortData(),n[e]=i;else{if(n.length)if(n[n.length-1][0]>=t)n.push(i);else if(n[0][0]<=t)n.unshift(i);else{const e=Math.round(n.length/2);this._data=n.slice(0,e).concat(i).concat(n.slice(e))}else this._data.push(i);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(o),this._changedData=!1}bitField(){const e=[];let t,r=8,s=0,n=0;const i=this._bitArrays.slice();while(i.length||s){0===s&&(t=i.shift(),s=7);const o=Math.min(s,r),a=~(255<<o),c=t&a;n|=c<<8-r,t>>>=o,s-=o,r-=o,r&&(s||i.length)||(e.push(n),n=0,r=8)}for(var o=e.length-1;o>0;o--){const t=e[o];if(0!==t)break;e.pop()}return e}compactArray(){return this._sortData(),this._data.map(a)}}},"0321":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promisify=n;var s="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function n(e){if("function"!==typeof e)throw new TypeError("Argument to promisify must be a function");var t=e[s],r=n.Promise||Promise;if("function"!==typeof r)throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var s=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return new r((function(r,n){i.push((function(e){if(e)return n(e);for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];if(1===i.length||!t)return r(i[0]);var a={};i.forEach((function(e,r){var s=t[r];s&&(a[s]=e)})),r(a)})),e.apply(s,i)}))}}n.argumentNames=s,n.Promise=void 0},"043f":function(e,t,r){"use strict";const s=r("1304").Key,n=r("bb8f"),i=r("9b62"),o=r("d46b"),a=new s("datastore_spec");e.exports=e=>({exists(){return e.has(a)},async get(){const t=await e.get(a);return JSON.parse(i(t))},async set(t){return e.put(a,o(JSON.stringify(n(t,{deep:!0}))))}})},"04ce":function(e,t,r){"use strict";e.exports=function(){return Date.now()}},"0592":function(e,t,r){"use strict";const s=r("3842"),n=r("d32a"),i=r("4fcb").bind({ignoreUndefined:!0}),o=r("a29d"),a={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};e.exports=e=>{async function t(t,r,o={}){const c=i(a,o);await s(e)(t,r,c),await n(e)(t,{...c,recursive:!0})}return o(t)}},"05d0":function(e,t,r){e.exports=r("5349")},"05e5":function(e,t){function r(e,t){this.value=e,this.next=t}e.exports=r,r.prototype.contains=function(e){var t=this;while(t){if(t.value===e)return!0;t=t.next}return!1}},"063c":function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:peer-routing"),{error:s("libp2p:peer-routing:err")}),i=r("b6aa"),{storeAddresses:o,uniquePeers:a,requirePeers:c}=r("aa14"),u=r("500d"),{pipe:l}=r("66f2"),d=r("9410"),h=r("5268"),p=r("335d"),{setDelayedInterval:f,clearDelayedInterval:y}=r("63ee");class g{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(e._dht),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){this._routers.length&&!this._timeoutId&&this._refreshManagerOptions.enabled&&(this._timeoutId=f(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await h(this.getClosestPeers(this._peerId.id))}catch(e){n.error(e)}}stop(){y(this._timeoutId)}async findPeer(e,t){if(!this._routers.length)throw i(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");if(e.toB58String()===this._peerId.toB58String())throw i(new Error("Should not try to find self"),"ERR_FIND_SELF");const r=await l(u(...this._routers.map(r=>[r.findPeer(e,t)])),e=>p(e,Boolean),e=>o(e,this._peerStore),e=>d(e));if(r)return r;throw i(new Error("not found"),"NOT_FOUND")}async*getClosestPeers(e,t={timeout:3e4}){if(!this._routers.length)throw i(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");yield*l(u(...this._routers.map(r=>r.getClosestPeers(e,t))),e=>o(e,this._peerStore),e=>a(e),e=>c(e))}}e.exports=g},"0662":function(e,t,r){"use strict";const s=r("fd46"),n=r("f3bf");function i(e){function t(t){return t instanceof o?t:new o(t,e)}return t}class o{constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;while(this._availableBits<t)await this._produceMoreBits();let r=0;while(t>0){const e=this._buffers[this._currentBufferIndex],s=Math.min(e.availableBits(),t),n=e.take(s);r=(r<<s)+n,t-=s,this._availableBits-=s,0===e.availableBits()&&this._currentBufferIndex++}return r}untake(e){let t=e;while(t>0){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.totalBits()-e.availableBits(),t);e.untake(r),t-=r,this._availableBits+=r,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth?n([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),r=new s(t);this._buffers.push(r),this._availableBits+=r.availableBits()}}e.exports=i,e.exports.InfiniteHash=o},"070a":function(e,t,r){"use strict";const s=r("c449"),{UnixFS:n}=r("9fd0"),{DAGNode:i}=r("8141"),o=r("34eb")("ipfs:mfs:utils:with-mfs-root"),a=r("5d98"),c=r("0e80").multihash,u=r("b6aa"),{MFS_ROOT_KEY:l}=r("4d04"),d=async(e,t)=>{if(t&&t.signal&&t.signal.aborted)throw u(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});let r;await e.repo.datastore.open();try{const t=await e.repo.datastore.get(l);r=new s(t)}catch(d){if("ERR_NOT_FOUND"!==d.code)throw d;o("Creating new MFS root");const s=new i(new n({type:"directory"}).marshal());if(r=await e.ipld.put(s,a.DAG_PB,{cidVersion:0,hashAlg:c.names["sha2-256"]}),t&&t.signal&&t.signal.aborted)throw u(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await e.repo.datastore.put(l,r.bytes)}return o("Loaded MFS root /ipfs/"+r),r};e.exports=d},"076b":function(e,t,r){"use strict";const s=6e4;e.exports={ADVERTISE_BOOT_DELAY:15*s,ADVERTISE_TTL:30*s,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}},"07be":function(e,t,r){"use strict";const{Key:s}=r("1304"),n=r("7a13"),i="/repo/flatfs/shard/",o="SHARDING",a="_README";class c{constructor(e){this.param=e,this.name="base",this._padding=""}fun(e){return"implement me"}toString(){return`${i}v1/${this.name}/${this.param}`}}class u extends c{constructor(e){super(e),this._padding="".padStart(e,"_"),this.name="prefix"}fun(e){return(e+this._padding).slice(0,this.param)}}class l extends c{constructor(e){super(e),this._padding="".padStart(e,"_"),this.name="suffix"}fun(e){const t=this._padding+e;return t.slice(t.length-this.param)}}class d extends c{constructor(e){super(e),this._padding="".padStart(e+1,"_"),this.name="next-to-last"}fun(e){const t=this._padding+e,r=t.length-this.param-1;return t.slice(r,r+this.param)}}function h(e){if(e=e.trim(),0===e.length)throw new Error("empty shard string");if(!e.startsWith(i))throw new Error("invalid or no path prefix: "+e);const t=e.slice(i.length).split("/"),r=t[0];if("v1"!==r)throw new Error(`expect 'v1' version, got '${r}'`);const s=t[1];if(!t[2])throw new Error("missing param");const n=parseInt(t[2],10);switch(s){case"prefix":return new u(n);case"suffix":return new l(n);case"next-to-last":return new d(n);default:throw new Error("unkown sharding function: "+s)}}const p=async(e,t)=>{const r=new s(e).child(new s(o)),n="function"===typeof t.getRaw?t.getRaw.bind(t):t.get.bind(t),i=await n(r);return h((new TextDecoder).decode(i||"").trim())};e.exports={readme:n,parseShardFun:h,readShardFun:p,Prefix:u,Suffix:l,NextToLast:d,README_FN:a,SHARDING_FN:o,PREFIX:i}},"07d5":function(e,t,r){"use strict";e.exports=function(...e){const t=e.reduce((e,t)=>Object.assign(e,t),{});return Object.assign(t,{bufferKeys:t.bufferKeys||!1,snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,openCallback:t.openCallback||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:t.encodings||!1,additionalMethods:Object.assign({},t.additionalMethods)})}},"07fc":function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["libp2p-envelope"]||(s.roots["libp2p-envelope"]={});a.Envelope=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.publicKey=o.newBuffer([]),e.prototype.payloadType=o.newBuffer([]),e.prototype.payload=o.newBuffer([]),e.prototype.signature=o.newBuffer([]),e.encode=function(e,t){return t||(t=i.create()),null!=e.publicKey&&Object.hasOwnProperty.call(e,"publicKey")&&t.uint32(10).bytes(e.publicKey),null!=e.payloadType&&Object.hasOwnProperty.call(e,"payloadType")&&t.uint32(18).bytes(e.payloadType),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(26).bytes(e.payload),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Envelope;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.publicKey=e.bytes();break;case 2:s.payloadType=e.bytes();break;case 3:s.payload=e.bytes();break;case 5:s.signature=e.bytes();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Envelope)return e;var t=new a.Envelope;return null!=e.publicKey&&("string"===typeof e.publicKey?o.base64.decode(e.publicKey,t.publicKey=o.newBuffer(o.base64.length(e.publicKey)),0):e.publicKey.length&&(t.publicKey=e.publicKey)),null!=e.payloadType&&("string"===typeof e.payloadType?o.base64.decode(e.payloadType,t.payloadType=o.newBuffer(o.base64.length(e.payloadType)),0):e.payloadType.length&&(t.payloadType=e.payloadType)),null!=e.payload&&("string"===typeof e.payload?o.base64.decode(e.payload,t.payload=o.newBuffer(o.base64.length(e.payload)),0):e.payload.length&&(t.payload=e.payload)),null!=e.signature&&("string"===typeof e.signature?o.base64.decode(e.signature,t.signature=o.newBuffer(o.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.publicKey="":(r.publicKey=[],t.bytes!==Array&&(r.publicKey=o.newBuffer(r.publicKey))),t.bytes===String?r.payloadType="":(r.payloadType=[],t.bytes!==Array&&(r.payloadType=o.newBuffer(r.payloadType))),t.bytes===String?r.payload="":(r.payload=[],t.bytes!==Array&&(r.payload=o.newBuffer(r.payload))),t.bytes===String?r.signature="":(r.signature=[],t.bytes!==Array&&(r.signature=o.newBuffer(r.signature)))),null!=e.publicKey&&e.hasOwnProperty("publicKey")&&(r.publicKey=t.bytes===String?o.base64.encode(e.publicKey,0,e.publicKey.length):t.bytes===Array?Array.prototype.slice.call(e.publicKey):e.publicKey),null!=e.payloadType&&e.hasOwnProperty("payloadType")&&(r.payloadType=t.bytes===String?o.base64.encode(e.payloadType,0,e.payloadType.length):t.bytes===Array?Array.prototype.slice.call(e.payloadType):e.payloadType),null!=e.payload&&e.hasOwnProperty("payload")&&(r.payload=t.bytes===String?o.base64.encode(e.payload,0,e.payload.length):t.bytes===Array?Array.prototype.slice.call(e.payload):e.payload),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?o.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.exports=a},"08c7":function(e,t,r){"use strict";const s=r("eddf"),{Multiaddr:n}=r("2054"),i=r("b6aa"),{codes:o}=r("b73a");function a(e){let t;if("string"===typeof e&&(e=new n(e)),n.isMultiaddr(e)){t=e;const n=e.getPeerId();if(!n)throw i(new Error(e+" does not have a valid peer type"),o.ERR_INVALID_MULTIADDR);try{e=s.createFromB58String(n)}catch(r){throw i(new Error(e+" is not a valid peer type"),o.ERR_INVALID_MULTIADDR)}}return{id:e,multiaddrs:t?[t]:void 0}}e.exports=a},"0910":function(e,t,r){"use strict";const s=r("6ca9");function n(e){const{address:t}=e.nodeAddress();return s(t)}e.exports=n},"09b5":function(e,t,r){"use strict";var s=r("4d4f");function n(e,t,r){var n=this;function i(){n._rescheduled>0?(n._scheduled=n._rescheduled-(s()-n._started),n._timer=setTimeout(i,n._scheduled),n._rescheduled=0):e.apply(null,n._args)}this._started=s(),this._rescheduled=0,this._scheduled=t,this._args=r,this._timer=setTimeout(i,t)}function i(){if("function"!==typeof arguments[0])throw new Error("callback needed");if("number"!==typeof arguments[1])throw new Error("timeout needed");var e;if(arguments.length>0){e=new Array(arguments.length-2);for(var t=0;t<e.length;t++)e[t]=arguments[t+2]}return new n(arguments[0],arguments[1],e)}n.prototype.reschedule=function(e){var t=s();return!(t+e-(this._started+this._scheduled)<0)&&(this._started=t,this._rescheduled=e,!0)},n.prototype.clear=function(){clearTimeout(this._timer)},e.exports=i},"0acf":function(e,t,r){"use strict";const s=r("b6aa"),n=r("e66e"),i=r("5aab"),o=r("9b62"),a=r("92b9"),c=r("7704"),u=r("b664"),l=r("a9f4"),d=a.Record;e.exports=e=>{const t=async(t,r)=>e.datastore.put(l.bufferToKey(t),r),r=async t=>{e._log("getLocal "+o(t,"base32"));const r=await e.datastore.get(l.bufferToKey(t));e._log(`found ${o(t,"base32")} in local datastore`);const s=d.deserialize(r);return await e._verifyRecordLocally(s),s},h=async(t,r,s)=>{const n=await l.createPutRecord(t,s);return Promise.all(r.map(async r=>{if(!i(r.val,s))if(e._isSelf(r.from))try{await e._putLocal(t,n)}catch(o){e._log.error("Failed error correcting self",o)}else try{await e._putValueToPeer(t,n,r.from)}catch(o){e._log.error("Failed error correcting entry",o)}}))};return{async _putLocal(e,r){return t(e,r)},async put(r,n,i={}){e._log("PutValue %b",r);const o=await l.createPutRecord(r,n);await t(r,o);let a=0,c=0;await l.mapParallel(e.getClosestPeers(r,{shallow:!0}),async t=>{try{a+=1,await e._putValueToPeer(r,o,t),c+=1}catch(s){e._log.error("Failed to put to peer (%b): %s",t.id,s)}});const u=i.minPeers||a;if(u>c){const t=s(new Error(`Failed to put value to enough peers: ${c}/${u}`),"ERR_NOT_ENOUGH_PUT_PEERS");throw e._log.error(t),t}},async get(t,r={}){r.timeout=r.timeout||c.minute,e._log("_get %b",t);const n=await e.getMany(t,c.GET_MANY_RECORD_COUNT,r),i=n.map(e=>e.val);let o=0;try{o=a.selection.bestRecord(e.selectors,t,i)}catch(l){if("ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"!==l.code)throw l}const u=i[o];if(e._log("GetValue %b %s",t,u),!u)throw s(new Error("best value was not found"),"ERR_NOT_FOUND");return await h(t,n,u),u},async getMany(t,i,o={}){o.timeout=o.timeout||c.minute,e._log("getMany %b (%s)",t,i);const a=[];let d;try{d=await r(t)}catch(b){if(0===i)throw b}if(d&&a.push({val:d.value,from:e.peerId}),a.length>=i)return a;const h=await l.convertBuffer(t),p=e.routingTable.closestPeers(h,e.kBucketSize);if(e._log("peers in rt: %d",p.length),0===p.length){const t="Failed to lookup key! No peers from routing table!";if(e._log.error(t),0===a.length)throw s(new Error(t),"ERR_NO_PEERS_IN_ROUTING_TABLE");return a}const f=a.length;function y(r,s){const n=l.pathSize(i-f,s);let o=0;async function c(r){let s,i,c;try{const n=await e._getValueOrPeers(r,t);s=n.record,i=n.peers}catch(b){if("ERR_INVALID_RECORD"!==b.code)throw b;c=b}const u={closerPeers:i};return s&&s.value?(a.push({val:s.value,from:r}),o++):c&&(a.push({err:c,from:r}),o++),o>=n&&(u.pathComplete=!0),u}return c}const g=new u(e,t,y);try{await n(g.run(p),o.timeout)}catch(b){if(0===a.length)throw b}finally{g.stop()}return a}}}},"0ad3":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("1755"),n=r("b92d"),i=r("7cf7"),o=r("a4cc"),a=r("83ec"),c=r("e80e"),u=r("d6fc"),l=r("68c3"),d=r("237f"),h=r("ac23"),p=r("3ef0");function f(e,t,r){throw new Error(`${h.decodeErrPrefix} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function y(e){return()=>{throw new Error(`${h.decodeErrPrefix} ${e}`)}}const g=[];for(let w=0;w<=23;w++)g[w]=f;g[24]=n.decodeUint8,g[25]=n.decodeUint16,g[26]=n.decodeUint32,g[27]=n.decodeUint64,g[28]=f,g[29]=f,g[30]=f,g[31]=f;for(let w=32;w<=55;w++)g[w]=f;g[56]=i.decodeNegint8,g[57]=i.decodeNegint16,g[58]=i.decodeNegint32,g[59]=i.decodeNegint64,g[60]=f,g[61]=f,g[62]=f,g[63]=f;for(let w=64;w<=87;w++)g[w]=o.decodeBytesCompact;g[88]=o.decodeBytes8,g[89]=o.decodeBytes16,g[90]=o.decodeBytes32,g[91]=o.decodeBytes64,g[92]=f,g[93]=f,g[94]=f,g[95]=y("indefinite length bytes/strings are not supported");for(let w=96;w<=119;w++)g[w]=a.decodeStringCompact;g[120]=a.decodeString8,g[121]=a.decodeString16,g[122]=a.decodeString32,g[123]=a.decodeString64,g[124]=f,g[125]=f,g[126]=f,g[127]=y("indefinite length bytes/strings are not supported");for(let w=128;w<=151;w++)g[w]=c.decodeArrayCompact;g[152]=c.decodeArray8,g[153]=c.decodeArray16,g[154]=c.decodeArray32,g[155]=c.decodeArray64,g[156]=f,g[157]=f,g[158]=f,g[159]=c.decodeArrayIndefinite;for(let w=160;w<=183;w++)g[w]=u.decodeMapCompact;g[184]=u.decodeMap8,g[185]=u.decodeMap16,g[186]=u.decodeMap32,g[187]=u.decodeMap64,g[188]=f,g[189]=f,g[190]=f,g[191]=u.decodeMapIndefinite;for(let w=192;w<=215;w++)g[w]=l.decodeTagCompact;g[216]=l.decodeTag8,g[217]=l.decodeTag16,g[218]=l.decodeTag32,g[219]=l.decodeTag64,g[220]=f,g[221]=f,g[222]=f,g[223]=f;for(let w=224;w<=243;w++)g[w]=y("simple values are not supported");g[244]=f,g[245]=f,g[246]=f,g[247]=d.decodeUndefined,g[248]=y("simple values are not supported"),g[249]=d.decodeFloat16,g[250]=d.decodeFloat32,g[251]=d.decodeFloat64,g[252]=f,g[253]=f,g[254]=f,g[255]=d.decodeBreak;const b=[];for(let w=0;w<24;w++)b[w]=new s.Token(s.Type.uint,w,1);for(let w=-1;w>=-24;w--)b[31-w]=new s.Token(s.Type.negint,w,1);function m(e){switch(e.type){case s.Type.false:return p.fromArray([244]);case s.Type.true:return p.fromArray([245]);case s.Type.null:return p.fromArray([246]);case s.Type.bytes:return e.value.length?void 0:p.fromArray([64]);case s.Type.string:return""===e.value?p.fromArray([96]):void 0;case s.Type.array:return 0===e.value?p.fromArray([128]):void 0;case s.Type.map:return 0===e.value?p.fromArray([160]):void 0;case s.Type.uint:return e.value<24?p.fromArray([Number(e.value)]):void 0;case s.Type.negint:if(e.value>=-24)return p.fromArray([31-Number(e.value)])}}b[64]=new s.Token(s.Type.bytes,new Uint8Array(0),1),b[96]=new s.Token(s.Type.string,"",1),b[128]=new s.Token(s.Type.array,0,1),b[160]=new s.Token(s.Type.map,0,1),b[244]=new s.Token(s.Type.false,!1,1),b[245]=new s.Token(s.Type.true,!0,1),b[246]=new s.Token(s.Type.null,null,1),t.jump=g,t.quick=b,t.quickEncodeToken=m},"0ae1":function(e,t,r){"use strict";const s=r("c449"),n=r("34eb")("ipfs:repo:gc"),{MFS_ROOT_KEY:i}=r("4d04"),o=r("a29d"),{Errors:a}=r("1304"),c=a.notFoundError().code,{parallelMerge:u,transform:l,map:d}=r("8b55"),h=r("675c"),p=256;async function f({pin:e,refs:t,repo:r}){const o=d(({cid:e})=>e,e.ls()),a=async function*(){let e;try{e=await r.root.get(i)}catch(a){if(a.code===c)return void n("No blocks in MFS");throw a}const o=new s(e);yield o;for await(const{ref:r}of t(o,{recursive:!0}))yield new s(r)}(),l=new Set;for await(const s of u(o,a))l.add(h.encode("base32",s.multihash).toString());return l}async function*y({repo:e},t,r){let s=0,i=0;const o=async r=>{s++;try{const s=h.encode("base32",r.multihash).toString();if(t.has(s))return null;try{await e.blocks.delete(r),i++}catch(o){return{err:new Error(`Could not delete block with CID ${r}: ${o.message}`)}}return{cid:r}}catch(o){const e="Could delete block with CID "+r;return n(e,o),{err:new Error(e+": "+o.message)}}};for await(const n of l(p,o,r))n&&(yield n);n(`Marked set has ${t.size} unique blocks. Blockstore has ${s} blocks. Deleted ${i} blocks.`)}e.exports=({gcLock:e,pin:t,refs:r,repo:s})=>{async function*i(i={}){const o=Date.now();n("Creating set of marked blocks");const a=await e.writeLock();try{const e=await f({pin:t,refs:r,repo:s}),i=s.blocks.queryKeys({});yield*y({repo:s},e,i),n(`Complete (${Date.now()-o}ms)`)}finally{a()}}return o(i)}},"0bac":function(e,t,r){"use strict";class s{constructor(e,t,r){if(this.tag=e,this.value=t,this.err=r,"number"!==typeof this.tag)throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(0|this.tag)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){var t,r;if(r=null!=e?e[this.tag]:void 0,"function"!==typeof r&&(r=s["_tag"+this.tag],"function"!==typeof r))return this;try{return r.call(s,this.value)}catch(n){return t=n,this.err=t,this}}}e.exports=s},"0bb1":function(e,t,r){"use strict";class s{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}}e.exports=s},"0c1e":function(e,t,r){"use strict";const{exporter:s}=r("d6d7"),n=r("aaf7"),i=r("a29d"),o=r("5d6d"),a=e=>{const t={cid:e.cid,name:e.name,type:"directory"===e.type?"directory":"file",size:e.size};return"file"!==e.type&&"directory"!==e.type||(t.mode=e.unixfs.mode,t.mtime=e.unixfs.mtime),t};e.exports=e=>{async function*t(t,r={}){const i=await n(e,t,r),c=await s(i.mfsPath,e.ipld);"directory"!==c.type?yield a(c):yield*o(c.content(r),a)}return i(t)}},"0c24":function(e,t,r){"use strict";const s=r("b6aa"),n={"dag-pb":r("be58"),raw:r("ea55"),"dag-cbor":r("173c"),identity:r("c0f4")};function i(e,t,r,o,a,c,u){const l=n[e.codec];if(!l)throw s(new Error("No resolver for codec "+e.codec),"ERR_NO_RESOLVER");return l(e,t,r,o,i,a,c,u)}e.exports=i},"0c5c":function(e,t,r){"use strict";const{EventEmitter:s}=r("faa1"),n=r("ce0f"),i={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[6e4,3e5,9e5]};class o extends s{constructor(e=[],t=i){super();const r=Object.assign({},i,t);if("number"!==typeof r.computeThrottleTimeout)throw new Error("need computeThrottleTimeout");if("number"!==typeof r.computeThrottleMaxQueueSize)throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=e,this._options=r,this._enabled=this._options.enabled,this._global=new n(e,r),this._global.on("update",e=>this.emit("update",e)),this._peers=new Map}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(const e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){const t="string"!==typeof e&&e.toB58String?e.toB58String():""+e;return this._peers.get(t)}push(e,t,r){if(this._enabled&&(this._global.push(t,r),e)){let s=this._peers.get(e);s||(s=new n(this._initialCounters,this._options),this._peers.set(e,s)),s.push(t,r)}}disconnected(e){const t=e.toB58String(),r=this._peers.get(t);r&&(r.stop(),this._peers.delete(t))}}e.exports=o},"0c5f":function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["libp2p-identify"]||(s.roots["libp2p-identify"]={});a.Identify=function(){function e(e){if(this.listenAddrs=[],this.protocols=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.protocolVersion="",e.prototype.agentVersion="",e.prototype.publicKey=o.newBuffer([]),e.prototype.listenAddrs=o.emptyArray,e.prototype.observedAddr=o.newBuffer([]),e.prototype.protocols=o.emptyArray,e.prototype.signedPeerRecord=o.newBuffer([]),e.encode=function(e,t){if(t||(t=i.create()),null!=e.publicKey&&Object.hasOwnProperty.call(e,"publicKey")&&t.uint32(10).bytes(e.publicKey),null!=e.listenAddrs&&e.listenAddrs.length)for(var r=0;r<e.listenAddrs.length;++r)t.uint32(18).bytes(e.listenAddrs[r]);if(null!=e.protocols&&e.protocols.length)for(r=0;r<e.protocols.length;++r)t.uint32(26).string(e.protocols[r]);return null!=e.observedAddr&&Object.hasOwnProperty.call(e,"observedAddr")&&t.uint32(34).bytes(e.observedAddr),null!=e.protocolVersion&&Object.hasOwnProperty.call(e,"protocolVersion")&&t.uint32(42).string(e.protocolVersion),null!=e.agentVersion&&Object.hasOwnProperty.call(e,"agentVersion")&&t.uint32(50).string(e.agentVersion),null!=e.signedPeerRecord&&Object.hasOwnProperty.call(e,"signedPeerRecord")&&t.uint32(66).bytes(e.signedPeerRecord),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Identify;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 5:s.protocolVersion=e.string();break;case 6:s.agentVersion=e.string();break;case 1:s.publicKey=e.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(e.bytes());break;case 4:s.observedAddr=e.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(e.string());break;case 8:s.signedPeerRecord=e.bytes();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Identify)return e;var t=new a.Identify;if(null!=e.protocolVersion&&(t.protocolVersion=String(e.protocolVersion)),null!=e.agentVersion&&(t.agentVersion=String(e.agentVersion)),null!=e.publicKey&&("string"===typeof e.publicKey?o.base64.decode(e.publicKey,t.publicKey=o.newBuffer(o.base64.length(e.publicKey)),0):e.publicKey.length&&(t.publicKey=e.publicKey)),e.listenAddrs){if(!Array.isArray(e.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");t.listenAddrs=[];for(var r=0;r<e.listenAddrs.length;++r)"string"===typeof e.listenAddrs[r]?o.base64.decode(e.listenAddrs[r],t.listenAddrs[r]=o.newBuffer(o.base64.length(e.listenAddrs[r])),0):e.listenAddrs[r].length&&(t.listenAddrs[r]=e.listenAddrs[r])}if(null!=e.observedAddr&&("string"===typeof e.observedAddr?o.base64.decode(e.observedAddr,t.observedAddr=o.newBuffer(o.base64.length(e.observedAddr)),0):e.observedAddr.length&&(t.observedAddr=e.observedAddr)),e.protocols){if(!Array.isArray(e.protocols))throw TypeError(".Identify.protocols: array expected");t.protocols=[];for(r=0;r<e.protocols.length;++r)t.protocols[r]=String(e.protocols[r])}return null!=e.signedPeerRecord&&("string"===typeof e.signedPeerRecord?o.base64.decode(e.signedPeerRecord,t.signedPeerRecord=o.newBuffer(o.base64.length(e.signedPeerRecord)),0):e.signedPeerRecord.length&&(t.signedPeerRecord=e.signedPeerRecord)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.listenAddrs=[],r.protocols=[]),t.defaults&&(t.bytes===String?r.publicKey="":(r.publicKey=[],t.bytes!==Array&&(r.publicKey=o.newBuffer(r.publicKey))),t.bytes===String?r.observedAddr="":(r.observedAddr=[],t.bytes!==Array&&(r.observedAddr=o.newBuffer(r.observedAddr))),r.protocolVersion="",r.agentVersion="",t.bytes===String?r.signedPeerRecord="":(r.signedPeerRecord=[],t.bytes!==Array&&(r.signedPeerRecord=o.newBuffer(r.signedPeerRecord)))),null!=e.publicKey&&e.hasOwnProperty("publicKey")&&(r.publicKey=t.bytes===String?o.base64.encode(e.publicKey,0,e.publicKey.length):t.bytes===Array?Array.prototype.slice.call(e.publicKey):e.publicKey),e.listenAddrs&&e.listenAddrs.length){r.listenAddrs=[];for(var s=0;s<e.listenAddrs.length;++s)r.listenAddrs[s]=t.bytes===String?o.base64.encode(e.listenAddrs[s],0,e.listenAddrs[s].length):t.bytes===Array?Array.prototype.slice.call(e.listenAddrs[s]):e.listenAddrs[s]}if(e.protocols&&e.protocols.length){r.protocols=[];for(s=0;s<e.protocols.length;++s)r.protocols[s]=e.protocols[s]}return null!=e.observedAddr&&e.hasOwnProperty("observedAddr")&&(r.observedAddr=t.bytes===String?o.base64.encode(e.observedAddr,0,e.observedAddr.length):t.bytes===Array?Array.prototype.slice.call(e.observedAddr):e.observedAddr),null!=e.protocolVersion&&e.hasOwnProperty("protocolVersion")&&(r.protocolVersion=e.protocolVersion),null!=e.agentVersion&&e.hasOwnProperty("agentVersion")&&(r.agentVersion=e.agentVersion),null!=e.signedPeerRecord&&e.hasOwnProperty("signedPeerRecord")&&(r.signedPeerRecord=t.bytes===String?o.base64.encode(e.signedPeerRecord,0,e.signedPeerRecord.length):t.bytes===Array?Array.prototype.slice.call(e.signedPeerRecord):e.signedPeerRecord),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.exports=a},"0ca7":function(e,t,r){"use strict";const{DAGLink:s,DAGNode:n}=r("8141"),{UnixFS:i}=r("9fd0"),o=r("0bb1"),a=r("3ba3");class c extends o{constructor(e,t){super(e,t),this._children={}}async put(e,t){this.cid=void 0,this.size=void 0,this._children[e]=t}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){const e=Object.keys(this._children);for(let t=0;t<e.length;t++){const r=e[t];yield{key:r,child:this._children[r]}}}async*flush(e){const t=Object.keys(this._children),r=[];for(let n=0;n<t.length;n++){let i=this._children[t[n]];if(i instanceof o)for await(const t of i.flush(e))i=t,yield i;null!=i.size&&i.cid&&r.push(new s(t[n],i.size,i.cid))}const c=new i({type:"directory",mtime:this.mtime,mode:this.mode}),u=new n(c.marshal(),r),l=u.serialize(),d=await a(l,e,this.options),h=l.length+u.Links.reduce((e,t)=>e+t.Tsize,0);this.cid=d,this.size=h,yield{cid:d,unixfs:c,path:this.path,size:h}}}e.exports=c},"0d05":function(e,t,r){"use strict";class s extends Error{constructor(e){super(e),this.name="LockExistsError",this.code=s.code}}s.code="ERR_LOCK_EXISTS",t.LockExistsError=s;class n extends Error{constructor(e){super(e),this.name="NotFoundError",this.code=n.code}}n.code="ERR_NOT_FOUND",t.NotFoundError=n;class i extends Error{constructor(e){super(e),this.name="InvalidRepoVersionError",this.code=i.code}}i.code="ERR_INVALID_REPO_VERSION",t.InvalidRepoVersionError=i,t.ERR_REPO_NOT_INITIALIZED="ERR_REPO_NOT_INITIALIZED",t.ERR_REPO_ALREADY_OPEN="ERR_REPO_ALREADY_OPEN",t.ERR_REPO_ALREADY_CLOSED="ERR_REPO_ALREADY_CLOSED"},"0e65":function(e,t,r){"use strict";const s=r("9888"),n=r("a29d"),i=r("4fcb").bind({ignoreUndefined:!0}),o={};e.exports=e=>{async function t(t,r={}){r=i(o,r);const{cid:n}=await s(e)(t,r);return n}return n(t)}},"0e8e":function(e,t,r){"use strict";const s=r("5425").AbstractLevelDOWN,n=r("5425").AbstractChainedBatch,i=r("5425").AbstractIterator,o=r("3fb5"),a=r("777e"),c=r("df7a").EncodingError,u=["approximateSize","compactRange"];function l(e,t){if(!(this instanceof l))return new l(e,t);const r=e.supports||{},n=r.additionalMethods||{};s.call(this,r),this.supports.encodings=!0,this.supports.additionalMethods={},u.forEach((function(t){const r="function"===typeof e[t];(n[t]||r)&&(this.supports.additionalMethods[t]=!0,this[t]=function(e,r,s,n){return e=this.codec.encodeKey(e,s),r=this.codec.encodeKey(r,s),this.db[t](e,r,s,n)})}),this),t=t||{},"undefined"===typeof t.keyEncoding&&(t.keyEncoding="utf8"),"undefined"===typeof t.valueEncoding&&(t.valueEncoding="utf8"),this.db=e,this.codec=new a(t)}function d(e,t){i.call(this,e),this.codec=e.codec,this.keys=t.keys,this.values=t.values,this.opts=this.codec.encodeLtgt(t),this.it=e.db.iterator(this.opts)}function h(e,t){n.call(this,e),this.codec=e.codec,this.batch=e.db.batch()}e.exports=l,o(l,s),l.prototype.type="encoding-down",l.prototype._serializeKey=l.prototype._serializeValue=function(e){return e},l.prototype._open=function(e,t){this.db.open(e,t)},l.prototype._close=function(e){this.db.close(e)},l.prototype._put=function(e,t,r,s){e=this.codec.encodeKey(e,r),t=this.codec.encodeValue(t,r),this.db.put(e,t,r,s)},l.prototype._get=function(e,t,r){e=this.codec.encodeKey(e,t),t.asBuffer=this.codec.valueAsBuffer(t),this.db.get(e,t,(e,s)=>{if(e)return r(e);try{s=this.codec.decodeValue(s,t)}catch(e){return r(new c(e))}r(null,s)})},l.prototype._del=function(e,t,r){e=this.codec.encodeKey(e,t),this.db.del(e,t,r)},l.prototype._chainedBatch=function(){return new h(this)},l.prototype._batch=function(e,t,r){e=this.codec.encodeBatch(e,t),this.db.batch(e,t,r)},l.prototype._iterator=function(e){return e.keyAsBuffer=this.codec.keyAsBuffer(e),e.valueAsBuffer=this.codec.valueAsBuffer(e),new d(this,e)},l.prototype._clear=function(e,t){e=this.codec.encodeLtgt(e),this.db.clear(e,t)},o(d,i),d.prototype._next=function(e){this.it.next((t,r,s)=>{if(t)return e(t);try{r=this.keys&&"undefined"!==typeof r?this.codec.decodeKey(r,this.opts):void 0,s=this.values&&"undefined"!==typeof s?this.codec.decodeValue(s,this.opts):void 0}catch(t){return e(new c(t))}e(null,r,s)})},d.prototype._seek=function(e){e=this.codec.encodeKey(e,this.opts),this.it.seek(e)},d.prototype._end=function(e){this.it.end(e)},o(h,n),h.prototype._put=function(e,t,r){e=this.codec.encodeKey(e,r),t=this.codec.encodeValue(t,r),this.batch.put(e,t)},h.prototype._del=function(e,t){e=this.codec.encodeKey(e,t),this.batch.del(e)},h.prototype._clear=function(){this.batch.clear()},h.prototype._write=function(e,t){this.batch.write(e,t)}},"0ea3":function(e,t,r){"use strict";const{getPubsubRouting:s}=r("a866"),n=r("a29d");e.exports=({ipns:e,options:t})=>{const r=t.EXPERIMENTAL;async function i(t,n={}){const i=s(e,r);return i.cancel(t,n)}return n(i)}},"0eff":function(e,t,r){"use strict";const s=r("c449"),n=r("d46b");class i{constructor(e,t,r){if(!r)throw new Error("A link requires a cid to point to");this.Name=e||"",this.Tsize=t,this.Hash=new s(r),Object.defineProperties(this,{_nameBuf:{value:null,writable:!0,enumerable:!1}})}toString(){return`DAGLink <${this.Hash.toBaseEncodedString()} - name: "${this.Name}", size: ${this.Tsize}>`}toJSON(){return this._json||(this._json=Object.freeze({name:this.Name,size:this.Tsize,cid:this.Hash.toBaseEncodedString()})),Object.assign({},this._json)}get nameAsBuffer(){return null!=this._nameBuf||(this._nameBuf=n(this.Name)),this._nameBuf}}e.exports=i},"0f57":function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:circuit:hop"),{error:s("libp2p:circuit:hop:err")}),i=r("b6aa"),o=r("eddf"),{validateAddrs:a}=r("5d03"),c=r("56fc"),{CircuitRelay:u}=r("46f6"),{pipe:l}=r("66f2"),{codes:d}=r("b73a"),{stop:h}=r("54383"),p=r("5e54");async function f({connection:e,request:t,streamHandler:r,circuit:s}){if(!s._options.hop.enabled)return n("HOP request received but we are not acting as a relay"),r.end({type:u.Type.STATUS,code:u.Status.HOP_CANT_SPEAK_RELAY});try{a(t,r)}catch(y){return n.error("invalid hop request via peer %s",e.remotePeer.toB58String(),y)}if(!t.dstPeer)return void n("HOP request received but we do not receive a dstPeer");const i=new o(t.dstPeer.id),c=s._connectionManager.get(i);if(!c&&!s._options.hop.active)return n("HOP request received but we are not connected to the destination peer"),r.end({type:u.Type.STATUS,code:u.Status.HOP_NO_CONN_TO_DST});if(!c)return;const d={type:u.Type.STOP,dstPeer:t.dstPeer,srcPeer:t.srcPeer};let p;try{p=await h({connection:c,request:d})}catch(y){return n.error(y)}n("hop request from %s is valid",e.remotePeer.toB58String()),r.write({type:u.Type.STATUS,code:u.Status.SUCCESS});const f=r.rest();return l(f,p,f)}async function y({connection:e,request:t}){const{stream:r}=await e.newStream([p.relay]),s=new c({stream:r});s.write(t);const o=await s.read();if(!o)throw i(new Error("HOP request had no response"),d.ERR_HOP_REQUEST_FAILED);if(o.code===u.Status.SUCCESS)return n("hop request was successful"),s.rest();throw n("hop request failed with code %d, closing stream",o.code),s.close(),i(new Error("HOP request failed with code "+o.code),d.ERR_HOP_REQUEST_FAILED)}async function g({connection:e}){const{stream:t}=await e.newStream([p.relay]),r=new c({stream:t});r.write({type:u.Type.CAN_HOP});const s=await r.read();return await r.close(),!(!s||s.code!==u.Status.SUCCESS)}function b({connection:e,streamHandler:t,circuit:r}){const s=r._options.hop.enabled;n("can hop (%s) request from %s",s,e.remotePeer.toB58String()),t.end({type:u.Type.STATUS,code:s?u.Status.SUCCESS:u.Status.HOP_CANT_SPEAK_RELAY})}e.exports={handleHop:f,hop:y,canHop:g,handleCanHop:b}},"0f68":function(e,t,r){"use strict";e.exports=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:200,HighWater:500},DisableNatPortMap:!0},Routing:{Type:"none"}})},"0f6c":function(e,t,r){"use strict";const s=r("0ca7"),n=r("da12"),i=r("0bb1"),o=r("7dcc");async function a(e,t,r){const a=o(e.path||""),c=a.length-1;let u=t,l="";for(let o=0;o<a.length;o++){const d=a[o];l+=`${l?"/":""}${d}`;const h=o===c;if(u.dirty=!0,u.cid=void 0,u.size=void 0,h)await u.put(d,e),t=await n(null,u,r.shardSplitThreshold,r);else{let e=await u.get(d);e&&e instanceof i||(e=new s({root:!1,dir:!0,parent:u,parentKey:d,path:l,dirty:!0,flat:!0,mtime:e&&e.unixfs&&e.unixfs.mtime,mode:e&&e.unixfs&&e.unixfs.mode},r)),await u.put(d,e),u=e}}return t}async function*c(e,t){e instanceof i?yield*e.flush(t):e&&e.unixfs&&e.unixfs.isDirectory()&&(yield e)}async function*u(e,t,r){let n=new s({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r);for await(const s of e)s&&(n=await a(s,n,r),s.unixfs&&s.unixfs.isDirectory()||(yield s));if(r.wrapWithDirectory)yield*c(n,t);else for await(const s of n.eachChildSeries())s&&(yield*c(s.child,t))}e.exports=u},"0fc0":function(e,t,r){"use strict";const s=r("23bc"),n=r("0eff"),{createDagLinkFromB58EncodedHash:i}=r("bf15"),{serializeDAGNode:o}=r("f140"),a=r("adf6"),c=r("4706"),u=r("3e7a"),l=r("d46b"),d=r("9b62");class h{constructor(e,t=[],r=null){if(e||(e=new Uint8Array(0)),"string"===typeof e&&(e=l(e)),!(e instanceof Uint8Array))throw new Error("Passed 'data' is not a Uint8Array or a String!");if(null!==r&&"number"!==typeof r)throw new Error("Passed 'serializedSize' must be a number!");const o=t.map(e=>e instanceof n?e:i(e));s(o),this.Data=e,this.Links=o,Object.defineProperties(this,{_serializedSize:{value:r,writable:!0,enumerable:!1},_size:{value:null,writable:!0,enumerable:!1}})}toJSON(){return this._json||(this._json=Object.freeze({data:this.Data,links:this.Links.map(e=>e.toJSON()),size:this.size})),Object.assign({},this._json)}toString(){return`DAGNode <data: "${d(this.Data,"base64urlpad")}", links: ${this.Links.length}, size: ${this.size}>`}_invalidateCached(){this._serializedSize=null,this._size=null}addLink(e){return this._invalidateCached(),c(this,e)}rmLink(e){return this._invalidateCached(),u(this,e)}toDAGLink(e){return a(this,e)}serialize(){const e=o(this);return this._serializedSize=e.length,e}get size(){if(null==this._size){let e;null==e&&(this._serializedSize=this.serialize().length,e=this._serializedSize),this._size=this.Links.reduce((e,t)=>e+t.Tsize,e)}return this._size}set size(e){throw new Error("Can't set property: 'size' is immutable")}}e.exports=h},1060:function(e,t,r){"use strict";const s=r("a29d");e.exports=({network:e})=>{async function t(t={}){const{libp2p:r}=await e.use(t);return r.multiaddrs}return s(t)}},"109b":function(e,t,r){"use strict";const{Key:s}=r("1304"),n=r("c449"),i=r("675c"),o=r("b6aa"),a=r("9b62");t.cidToKey=e=>{if(!n.isCID(e))throw o(new Error("Not a valid cid"),"ERR_INVALID_CID");return new s("/"+a(i.encode("base32",e.multihash)).slice(1).toUpperCase(),!1)},t.keyToCid=e=>new n(1,"raw",i.decode("b"+e.toString().slice(1).toLowerCase()))},"112d":function(e,t,r){"use strict";const s=r("95ed8"),n=r("d64a"),i=r("3f55"),o=r("d292"),a=r("6762"),c=r("e4e3"),u=r("4f9c");class l{constructor({keychain:e}){this.gen=n({keychain:e}),this.list=a({keychain:e}),this.rm=u({keychain:e}),this.rename=c({keychain:e}),this.export=s({keychain:e}),this.import=i({keychain:e}),this.info=o({keychain:e})}}e.exports=l},"11ae":function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["libp2p-address-book"]||(s.roots["libp2p-address-book"]={});a.Addresses=function(){function e(e){if(this.addrs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.addrs=o.emptyArray,e.prototype.certifiedRecord=null,e.encode=function(e,t){if(t||(t=i.create()),null!=e.addrs&&e.addrs.length)for(var r=0;r<e.addrs.length;++r)a.Addresses.Address.encode(e.addrs[r],t.uint32(10).fork()).ldelim();return null!=e.certifiedRecord&&Object.hasOwnProperty.call(e,"certifiedRecord")&&a.Addresses.CertifiedRecord.encode(e.certifiedRecord,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Addresses;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(a.Addresses.Address.decode(e,e.uint32()));break;case 2:s.certifiedRecord=a.Addresses.CertifiedRecord.decode(e,e.uint32());break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Addresses)return e;var t=new a.Addresses;if(e.addrs){if(!Array.isArray(e.addrs))throw TypeError(".Addresses.addrs: array expected");t.addrs=[];for(var r=0;r<e.addrs.length;++r){if("object"!==typeof e.addrs[r])throw TypeError(".Addresses.addrs: object expected");t.addrs[r]=a.Addresses.Address.fromObject(e.addrs[r])}}if(null!=e.certifiedRecord){if("object"!==typeof e.certifiedRecord)throw TypeError(".Addresses.certifiedRecord: object expected");t.certifiedRecord=a.Addresses.CertifiedRecord.fromObject(e.certifiedRecord)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addrs=[]),t.defaults&&(r.certifiedRecord=null),e.addrs&&e.addrs.length){r.addrs=[];for(var s=0;s<e.addrs.length;++s)r.addrs[s]=a.Addresses.Address.toObject(e.addrs[s],t)}return null!=e.certifiedRecord&&e.hasOwnProperty("certifiedRecord")&&(r.certifiedRecord=a.Addresses.CertifiedRecord.toObject(e.certifiedRecord,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.Address=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.multiaddr=o.newBuffer([]),e.prototype.isCertified=!1,e.encode=function(e,t){return t||(t=i.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),null!=e.isCertified&&Object.hasOwnProperty.call(e,"isCertified")&&t.uint32(16).bool(e.isCertified),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Addresses.Address;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.multiaddr=e.bytes();break;case 2:s.isCertified=e.bool();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Addresses.Address)return e;var t=new a.Addresses.Address;return null!=e.multiaddr&&("string"===typeof e.multiaddr?o.base64.decode(e.multiaddr,t.multiaddr=o.newBuffer(o.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),null!=e.isCertified&&(t.isCertified=Boolean(e.isCertified)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.multiaddr="":(r.multiaddr=[],t.bytes!==Array&&(r.multiaddr=o.newBuffer(r.multiaddr))),r.isCertified=!1),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(r.multiaddr=t.bytes===String?o.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),null!=e.isCertified&&e.hasOwnProperty("isCertified")&&(r.isCertified=e.isCertified),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.CertifiedRecord=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.seq=o.Long?o.Long.fromBits(0,0,!0):0,e.prototype.raw=o.newBuffer([]),e.encode=function(e,t){return t||(t=i.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.raw&&Object.hasOwnProperty.call(e,"raw")&&t.uint32(18).bytes(e.raw),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Addresses.CertifiedRecord;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.seq=e.uint64();break;case 2:s.raw=e.bytes();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Addresses.CertifiedRecord)return e;var t=new a.Addresses.CertifiedRecord;return null!=e.seq&&(o.Long?(t.seq=o.Long.fromValue(e.seq)).unsigned=!0:"string"===typeof e.seq?t.seq=parseInt(e.seq,10):"number"===typeof e.seq?t.seq=e.seq:"object"===typeof e.seq&&(t.seq=new o.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.raw&&("string"===typeof e.raw?o.base64.decode(e.raw,t.raw=o.newBuffer(o.base64.length(e.raw)),0):e.raw.length&&(t.raw=e.raw)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(o.Long){var s=new o.Long(0,0,!0);r.seq=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else r.seq=t.longs===String?"0":0;t.bytes===String?r.raw="":(r.raw=[],t.bytes!==Array&&(r.raw=o.newBuffer(r.raw)))}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"===typeof e.seq?r.seq=t.longs===String?String(e.seq):e.seq:r.seq=t.longs===String?o.Long.prototype.toString.call(e.seq):t.longs===Number?new o.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.raw&&e.hasOwnProperty("raw")&&(r.raw=t.bytes===String?o.base64.encode(e.raw,0,e.raw.length):t.bytes===Array?Array.prototype.slice.call(e.raw):e.raw),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e}(),e.exports=a},"121c":function(e,t,r){"use strict";function s(e={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},e),{topics:e.topics?Object.entries(e.topics).reduce((e,[t,r])=>(e[t]=n(r),e),{}):{}})}function n(e={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e)}function i(e,t,r){let s=t.topics[e];return s||(r.topics[e]?(t.topics[e]=s=n(),s):void 0)}Object.defineProperty(t,"__esModule",{value:!0}),t.ensureTopicStats=t.createTopicStats=t.createPeerStats=void 0,t.createPeerStats=s,t.createTopicStats=n,t.ensureTopicStats=i},1248:function(e,t,r){var s,n,i;(function(){var r,o,a,c,u,l,d,h,p,f,y,g,b,m,w;a=Math.floor,f=Math.min,o=function(e,t){return e<t?-1:e>t?1:0},p=function(e,t,r,s,n){var i;if(null==r&&(r=0),null==n&&(n=o),r<0)throw new Error("lo must be non-negative");null==s&&(s=e.length);while(r<s)i=a((r+s)/2),n(t,e[i])<0?s=i:r=i+1;return[].splice.apply(e,[r,r-r].concat(t)),t},l=function(e,t,r){return null==r&&(r=o),e.push(t),m(e,0,e.length-1,r)},u=function(e,t){var r,s;return null==t&&(t=o),r=e.pop(),e.length?(s=e[0],e[0]=r,w(e,0,t)):s=r,s},h=function(e,t,r){var s;return null==r&&(r=o),s=e[0],e[0]=t,w(e,0,r),s},d=function(e,t,r){var s;return null==r&&(r=o),e.length&&r(e[0],t)<0&&(s=[e[0],t],t=s[0],e[0]=s[1],w(e,0,r)),t},c=function(e,t){var r,s,n,i,c,u;for(null==t&&(t=o),i=function(){u=[];for(var t=0,r=a(e.length/2);0<=r?t<r:t>r;0<=r?t++:t--)u.push(t);return u}.apply(this).reverse(),c=[],s=0,n=i.length;s<n;s++)r=i[s],c.push(w(e,r,t));return c},b=function(e,t,r){var s;if(null==r&&(r=o),s=e.indexOf(t),-1!==s)return m(e,0,s,r),w(e,s,r)},y=function(e,t,r){var s,n,i,a,u;if(null==r&&(r=o),n=e.slice(0,t),!n.length)return n;for(c(n,r),u=e.slice(t),i=0,a=u.length;i<a;i++)s=u[i],d(n,s,r);return n.sort(r).reverse()},g=function(e,t,r){var s,n,i,a,l,d,h,y,g;if(null==r&&(r=o),10*t<=e.length){if(i=e.slice(0,t).sort(r),!i.length)return i;for(n=i[i.length-1],h=e.slice(t),a=0,d=h.length;a<d;a++)s=h[a],r(s,n)<0&&(p(i,s,0,null,r),i.pop(),n=i[i.length-1]);return i}for(c(e,r),g=[],l=0,y=f(t,e.length);0<=y?l<y:l>y;0<=y?++l:--l)g.push(u(e,r));return g},m=function(e,t,r,s){var n,i,a;null==s&&(s=o),n=e[r];while(r>t){if(a=r-1>>1,i=e[a],!(s(n,i)<0))break;e[r]=i,r=a}return e[r]=n},w=function(e,t,r){var s,n,i,a,c;null==r&&(r=o),n=e.length,c=t,i=e[t],s=2*t+1;while(s<n)a=s+1,a<n&&!(r(e[s],e[a])<0)&&(s=a),e[t]=e[s],t=s,s=2*t+1;return e[t]=i,m(e,c,t,r)},r=function(){function e(e){this.cmp=null!=e?e:o,this.nodes=[]}return e.push=l,e.pop=u,e.replace=h,e.pushpop=d,e.heapify=c,e.updateItem=b,e.nlargest=y,e.nsmallest=g,e.prototype.push=function(e){return l(this.nodes,e,this.cmp)},e.prototype.pop=function(){return u(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return h(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return d(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return c(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return b(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return t=new e,t.nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),function(r,o){n=[],s=o,i="function"===typeof s?s.apply(t,n):s,void 0!==i&&(e.exports=i)}(0,(function(){return r}))}).call(this)},"12ca":function(e,t,r){"use strict";const{DAGLink:s}=r("8141"),n=r("c449"),i=r("34eb")("ipfs:mfs:core:utils:remove-link"),{UnixFS:o}=r("9fd0"),{generatePath:a,updateHamtDirectory:c}=r("5496"),u=r("b6aa"),l=r("5d98"),d=r("0e80").multihash,h=async(e,t)=>{let r=t.parent;if(t.parentCid){if(!n.isCID(t.parentCid))throw u(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");i("Loading parent node "+t.parentCid),r=await e.ipld.get(t.parentCid)}if(!r)throw u(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!t.name)throw u(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");const s=o.unmarshal(r.Data);return"hamt-sharded-directory"===s.type?(i(`Removing ${t.name} from sharded directory`),f(e,{...t,parent:r})):(i(`Removing link ${t.name} regular directory`),p(e,{...t,parent:r}))},p=async(e,t)=>{const r=d.names[t.hashAlg];t.parent.rmLink(t.name);const s=await e.ipld.put(t.parent,l.DAG_PB,{cidVersion:t.cidVersion,hashAlg:r});return i("Updated regular directory "+s),{node:t.parent,cid:s}},f=async(e,t)=>{const{rootBucket:r,path:s}=await a(e,t.name,t.parent);await r.del(t.name);const{node:n}=await y(e,s,t.name,t);return c(e,n.Links,r,t)},y=async(e,t,r,s)=>{const n=t.pop();if(!n)throw u(new Error("Could not find parent"),"EINVALIDPARENT");const{bucket:o,prefix:a,node:l}=n;if(!l)throw u(new Error("Could not find parent"),"EINVALIDPARENT");const d=l.Links.find(e=>e.Name.substring(0,2)===a);if(!d)throw u(new Error(`No link found with prefix ${a} for file ${r}`),"ERR_NOT_FOUND");if(d.Name===`${a}${r}`)return i("Removing existing link "+d.Name),l.rmLink(d.Name),await o.del(r),c(e,l.Links,o,s);i(`Descending into sub-shard ${d.Name} for ${a}${r}`);const h=await y(e,t,r,s);let p=h.cid,f=h.size,b=a;if(1===h.node.Links.length){i("Removing subshard for "+a);const e=h.node.Links[0];b=`${a}${e.Name.substring(2)}`,p=e.Hash,f=e.Tsize}return i(`Updating shard ${a} with name ${b}`),g(e,o,l,a,b,f,p,s)},g=(e,t,r,n,i,o,a,u)=>(r.rmLink(n),r.addLink(new s(i,o,a)),c(e,r.Links,t,u));e.exports=h},1304:function(e,t,r){"use strict";const s=r("8724"),n=r("609c"),i=r("59c5"),o=r("e730"),a=r("b605");e.exports={Key:s,MemoryDatastore:n,utils:i,Errors:o,Adapter:a}},"131d":function(e,t,r){"use strict";const{Adapter:s,Errors:n}=r("1304"),i=r("34eb")("datastore:core:tiered");class o extends s{constructor(e){super(),this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map(e=>e.open()))}catch(e){throw n.dbOpenFailedError()}}async put(e,t){try{await Promise.all(this.stores.map(r=>r.put(e,t)))}catch(r){throw n.dbWriteFailedError()}}async get(e,t){for(const s of this.stores)try{const r=await s.get(e,t);if(r)return r}catch(r){i(r)}throw n.notFoundError()}async has(e,t){for(const r of this.stores)if(await r.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map(r=>r.delete(e,t)))}catch(r){throw n.dbDeleteFailedError()}}async close(){await Promise.all(this.stores.map(e=>e.close()))}batch(){const e=this.stores.map(e=>e.batch());return{put:(t,r)=>{e.forEach(e=>e.put(t,r))},delete:t=>{e.forEach(e=>e.delete(t))},commit:async t=>{for(const r of e)await r.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}}e.exports=o},1468:function(e,t){var r=1e3,s=60*r,n=60*s,i=24*n,o=7*i,a=365.25*i;function c(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var c=parseFloat(t[1]),u=(t[2]||"ms").toLowerCase();switch(u){case"years":case"year":case"yrs":case"yr":case"y":return c*a;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*s;case"seconds":case"second":case"secs":case"sec":case"s":return c*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}function u(e){var t=Math.abs(e);return t>=i?Math.round(e/i)+"d":t>=n?Math.round(e/n)+"h":t>=s?Math.round(e/s)+"m":t>=r?Math.round(e/r)+"s":e+"ms"}function l(e){var t=Math.abs(e);return t>=i?d(e,t,i,"day"):t>=n?d(e,t,n,"hour"):t>=s?d(e,t,s,"minute"):t>=r?d(e,t,r,"second"):e+" ms"}function d(e,t,r,s){var n=t>=1.5*r;return Math.round(e/r)+" "+s+(n?"s":"")}e.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return c(e);if("number"===r&&isFinite(e))return t.long?l(e):u(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},1534:function(e,t,r){"use strict";const s=()=>{},n=Symbol.for("@libp2p/js-interfaces/topology");class i{constructor({min:e=0,max:t=1/0,handlers:r={}}){this.min=e,this.max=t,this._onConnect=r.onConnect||s,this._onDisconnect=r.onDisconnect||s,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[n](){return!0}static isTopology(e){return Boolean(e&&e[n])}set registrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}}e.exports=i},1583:function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["libp2p-dht-message"]||(s.roots["libp2p-dht-message"]={});a.Record=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key=o.newBuffer([]),e.prototype.value=o.newBuffer([]),e.prototype.author=o.newBuffer([]),e.prototype.signature=o.newBuffer([]),e.prototype.timeReceived="",e.encode=function(e,t){return t||(t=i.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).bytes(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).bytes(e.value),null!=e.author&&Object.hasOwnProperty.call(e,"author")&&t.uint32(26).bytes(e.author),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(34).bytes(e.signature),null!=e.timeReceived&&Object.hasOwnProperty.call(e,"timeReceived")&&t.uint32(42).string(e.timeReceived),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Record;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.key=e.bytes();break;case 2:s.value=e.bytes();break;case 3:s.author=e.bytes();break;case 4:s.signature=e.bytes();break;case 5:s.timeReceived=e.string();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Record)return e;var t=new a.Record;return null!=e.key&&("string"===typeof e.key?o.base64.decode(e.key,t.key=o.newBuffer(o.base64.length(e.key)),0):e.key.length&&(t.key=e.key)),null!=e.value&&("string"===typeof e.value?o.base64.decode(e.value,t.value=o.newBuffer(o.base64.length(e.value)),0):e.value.length&&(t.value=e.value)),null!=e.author&&("string"===typeof e.author?o.base64.decode(e.author,t.author=o.newBuffer(o.base64.length(e.author)),0):e.author.length&&(t.author=e.author)),null!=e.signature&&("string"===typeof e.signature?o.base64.decode(e.signature,t.signature=o.newBuffer(o.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),null!=e.timeReceived&&(t.timeReceived=String(e.timeReceived)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.key="":(r.key=[],t.bytes!==Array&&(r.key=o.newBuffer(r.key))),t.bytes===String?r.value="":(r.value=[],t.bytes!==Array&&(r.value=o.newBuffer(r.value))),t.bytes===String?r.author="":(r.author=[],t.bytes!==Array&&(r.author=o.newBuffer(r.author))),t.bytes===String?r.signature="":(r.signature=[],t.bytes!==Array&&(r.signature=o.newBuffer(r.signature))),r.timeReceived=""),null!=e.key&&e.hasOwnProperty("key")&&(r.key=t.bytes===String?o.base64.encode(e.key,0,e.key.length):t.bytes===Array?Array.prototype.slice.call(e.key):e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=t.bytes===String?o.base64.encode(e.value,0,e.value.length):t.bytes===Array?Array.prototype.slice.call(e.value):e.value),null!=e.author&&e.hasOwnProperty("author")&&(r.author=t.bytes===String?o.base64.encode(e.author,0,e.author.length):t.bytes===Array?Array.prototype.slice.call(e.author):e.author),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?o.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature),null!=e.timeReceived&&e.hasOwnProperty("timeReceived")&&(r.timeReceived=e.timeReceived),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),a.Message=function(){function e(e){if(this.closerPeers=[],this.providerPeers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.type=0,e.prototype.clusterLevelRaw=0,e.prototype.key=o.newBuffer([]),e.prototype.record=o.newBuffer([]),e.prototype.closerPeers=o.emptyArray,e.prototype.providerPeers=o.emptyArray,e.encode=function(e,t){if(t||(t=i.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).int32(e.type),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(18).bytes(e.key),null!=e.record&&Object.hasOwnProperty.call(e,"record")&&t.uint32(26).bytes(e.record),null!=e.closerPeers&&e.closerPeers.length)for(var r=0;r<e.closerPeers.length;++r)a.Message.Peer.encode(e.closerPeers[r],t.uint32(66).fork()).ldelim();if(null!=e.providerPeers&&e.providerPeers.length)for(r=0;r<e.providerPeers.length;++r)a.Message.Peer.encode(e.providerPeers[r],t.uint32(74).fork()).ldelim();return null!=e.clusterLevelRaw&&Object.hasOwnProperty.call(e,"clusterLevelRaw")&&t.uint32(80).int32(e.clusterLevelRaw),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Message;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.type=e.int32();break;case 10:s.clusterLevelRaw=e.int32();break;case 2:s.key=e.bytes();break;case 3:s.record=e.bytes();break;case 8:s.closerPeers&&s.closerPeers.length||(s.closerPeers=[]),s.closerPeers.push(a.Message.Peer.decode(e,e.uint32()));break;case 9:s.providerPeers&&s.providerPeers.length||(s.providerPeers=[]),s.providerPeers.push(a.Message.Peer.decode(e,e.uint32()));break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Message)return e;var t=new a.Message;switch(e.type){case"PUT_VALUE":case 0:t.type=0;break;case"GET_VALUE":case 1:t.type=1;break;case"ADD_PROVIDER":case 2:t.type=2;break;case"GET_PROVIDERS":case 3:t.type=3;break;case"FIND_NODE":case 4:t.type=4;break;case"PING":case 5:t.type=5;break}if(null!=e.clusterLevelRaw&&(t.clusterLevelRaw=0|e.clusterLevelRaw),null!=e.key&&("string"===typeof e.key?o.base64.decode(e.key,t.key=o.newBuffer(o.base64.length(e.key)),0):e.key.length&&(t.key=e.key)),null!=e.record&&("string"===typeof e.record?o.base64.decode(e.record,t.record=o.newBuffer(o.base64.length(e.record)),0):e.record.length&&(t.record=e.record)),e.closerPeers){if(!Array.isArray(e.closerPeers))throw TypeError(".Message.closerPeers: array expected");t.closerPeers=[];for(var r=0;r<e.closerPeers.length;++r){if("object"!==typeof e.closerPeers[r])throw TypeError(".Message.closerPeers: object expected");t.closerPeers[r]=a.Message.Peer.fromObject(e.closerPeers[r])}}if(e.providerPeers){if(!Array.isArray(e.providerPeers))throw TypeError(".Message.providerPeers: array expected");t.providerPeers=[];for(r=0;r<e.providerPeers.length;++r){if("object"!==typeof e.providerPeers[r])throw TypeError(".Message.providerPeers: object expected");t.providerPeers[r]=a.Message.Peer.fromObject(e.providerPeers[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.closerPeers=[],r.providerPeers=[]),t.defaults&&(r.type=t.enums===String?"PUT_VALUE":0,t.bytes===String?r.key="":(r.key=[],t.bytes!==Array&&(r.key=o.newBuffer(r.key))),t.bytes===String?r.record="":(r.record=[],t.bytes!==Array&&(r.record=o.newBuffer(r.record))),r.clusterLevelRaw=0),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?a.Message.MessageType[e.type]:e.type),null!=e.key&&e.hasOwnProperty("key")&&(r.key=t.bytes===String?o.base64.encode(e.key,0,e.key.length):t.bytes===Array?Array.prototype.slice.call(e.key):e.key),null!=e.record&&e.hasOwnProperty("record")&&(r.record=t.bytes===String?o.base64.encode(e.record,0,e.record.length):t.bytes===Array?Array.prototype.slice.call(e.record):e.record),e.closerPeers&&e.closerPeers.length){r.closerPeers=[];for(var s=0;s<e.closerPeers.length;++s)r.closerPeers[s]=a.Message.Peer.toObject(e.closerPeers[s],t)}if(e.providerPeers&&e.providerPeers.length){r.providerPeers=[];for(s=0;s<e.providerPeers.length;++s)r.providerPeers[s]=a.Message.Peer.toObject(e.providerPeers[s],t)}return null!=e.clusterLevelRaw&&e.hasOwnProperty("clusterLevelRaw")&&(r.clusterLevelRaw=e.clusterLevelRaw),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.MessageType=function(){var e={},t=Object.create(e);return t[e[0]="PUT_VALUE"]=0,t[e[1]="GET_VALUE"]=1,t[e[2]="ADD_PROVIDER"]=2,t[e[3]="GET_PROVIDERS"]=3,t[e[4]="FIND_NODE"]=4,t[e[5]="PING"]=5,t}(),e.ConnectionType=function(){var e={},t=Object.create(e);return t[e[0]="NOT_CONNECTED"]=0,t[e[1]="CONNECTED"]=1,t[e[2]="CAN_CONNECT"]=2,t[e[3]="CANNOT_CONNECT"]=3,t}(),e.Peer=function(){function e(e){if(this.addrs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.id=o.newBuffer([]),e.prototype.addrs=o.emptyArray,e.prototype.connection=0,e.encode=function(e,t){if(t||(t=i.create()),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(10).bytes(e.id),null!=e.addrs&&e.addrs.length)for(var r=0;r<e.addrs.length;++r)t.uint32(18).bytes(e.addrs[r]);return null!=e.connection&&Object.hasOwnProperty.call(e,"connection")&&t.uint32(24).int32(e.connection),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Message.Peer;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.id=e.bytes();break;case 2:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(e.bytes());break;case 3:s.connection=e.int32();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Message.Peer)return e;var t=new a.Message.Peer;if(null!=e.id&&("string"===typeof e.id?o.base64.decode(e.id,t.id=o.newBuffer(o.base64.length(e.id)),0):e.id.length&&(t.id=e.id)),e.addrs){if(!Array.isArray(e.addrs))throw TypeError(".Message.Peer.addrs: array expected");t.addrs=[];for(var r=0;r<e.addrs.length;++r)"string"===typeof e.addrs[r]?o.base64.decode(e.addrs[r],t.addrs[r]=o.newBuffer(o.base64.length(e.addrs[r])),0):e.addrs[r].length&&(t.addrs[r]=e.addrs[r])}switch(e.connection){case"NOT_CONNECTED":case 0:t.connection=0;break;case"CONNECTED":case 1:t.connection=1;break;case"CAN_CONNECT":case 2:t.connection=2;break;case"CANNOT_CONNECT":case 3:t.connection=3;break}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addrs=[]),t.defaults&&(t.bytes===String?r.id="":(r.id=[],t.bytes!==Array&&(r.id=o.newBuffer(r.id))),r.connection=t.enums===String?"NOT_CONNECTED":0),null!=e.id&&e.hasOwnProperty("id")&&(r.id=t.bytes===String?o.base64.encode(e.id,0,e.id.length):t.bytes===Array?Array.prototype.slice.call(e.id):e.id),e.addrs&&e.addrs.length){r.addrs=[];for(var s=0;s<e.addrs.length;++s)r.addrs[s]=t.bytes===String?o.base64.encode(e.addrs[s],0,e.addrs[s].length):t.bytes===Array?Array.prototype.slice.call(e.addrs[s]):e.addrs[s]}return null!=e.connection&&e.hasOwnProperty("connection")&&(r.connection=t.enums===String?a.Message.ConnectionType[e.connection]:e.connection),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e}(),e.exports=a},"15d0":function(e,t,r){"use strict";const s=r("34eb")("ipfs:mfs:write"),{importer:n}=r("9495"),i=r("9888"),o=r("52ea"),a=r("5688"),c=r("4fcb").bind({ignoreUndefined:!0}),u=r("b405"),l=r("b74e"),d=r("aaf7"),h=r("57be"),p=r("1eaa"),f=r("e53b"),y=r("57e0"),g=r("b6aa"),{MFS_MAX_CHUNK_SIZE:b}=r("4d04"),m=r("9975"),w=r("a29d"),{parseMode:_,parseMtime:E}=r("9fd0"),v={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(e,t)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};e.exports=e=>{async function t(t,r,n={}){const i=c(v,n);let o,a,h;if(s("Reading source, destination and parent"),await u().readLock(async()=>{o=await l(r),a=await d(e,t,i),h=await d(e,a.mfsDirectory,i)})(),s("Read source, destination and parent"),!i.parents&&!h.exists)throw g(new Error("directory does not exist"),"ERR_NO_EXIST");if(null==o)throw g(new Error("could not create source"),"ERR_NO_SOURCE");if(null==a)throw g(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!i.create&&!a.exists)throw g(new Error("file does not exist"),"ERR_NO_EXIST");if("file"!==a.entryType)throw g(new Error("not a file"),"ERR_NOT_A_FILE");return S(e,t,o,a,i)}return w(t)};const S=async(e,t,r,s,n)=>{const c=await I(e,r,s,n);await u().writeLock(async()=>{const r=h(t),s=r.pop();if(null==s)throw g(new Error("source does not exist"),"ERR_NO_EXIST");let u=!1;try{await i(e)("/"+r.join("/"),n),u=!0}catch(v){if("ERR_NOT_FOUND"!==v.code)throw v}u||await o(e)("/"+r.join("/"),n);const l=await d(e,t,n),b=await p(e,l.mfsDirectory),m=b[b.length-1];if(!m)throw g(new Error("directory does not exist"),"ERR_NO_EXIST");if(!m.type||!m.type.includes("directory"))throw g(new Error(`cannot write to ${m.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");const w=await e.ipld.get(m.cid),_=await a(e,{parent:w,name:s,cid:c.cid,size:c.size,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:n.cidVersion});m.cid=_.cid;const E=await f(e,b,n);await y(e,E,n)})()},I=async(e,t,r,i)=>{r.exists?s(`Overwriting file ${r.cid} offset ${i.offset} length ${i.length}`):s(`Writing file offset ${i.offset} length ${i.length}`);const o=[];if(i.offset>0)if(r.unixfs){if(s(`Writing first ${i.offset} bytes of original file`),o.push(()=>r.content({offset:0,length:i.offset})),r.unixfs.fileSize()<i.offset){const e=i.offset-r.unixfs.fileSize();s(`Writing zeros for extra ${e} bytes`),o.push(R(e))}}else s(`Writing zeros for first ${i.offset} bytes`),o.push(R(i.offset));o.push(A(t,i.length));const a=k(T(o),e=>{if(r.unixfs&&!i.truncate){const t=r.unixfs.fileSize();if(t>e)return s(`Writing last ${t-e} of ${t} bytes from original file starting at offset ${e}`),r.content({offset:e});s("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}});let c,u;void 0!==i.mode&&null!==i.mode?c=_(i.mode):r&&r.unixfs&&(c=r.unixfs.mode),null!=i.mtime?u=E(i.mtime):r&&r.unixfs&&(u=r.unixfs.mtime);const l=await m(n([{content:a,mode:c,mtime:u}],e.block,{progress:i.progress,hashAlg:i.hashAlg,cidVersion:i.cidVersion,strategy:i.strategy,rawLeaves:i.rawLeaves,reduceSingleLeafToSelf:i.reduceSingleLeafToSelf,leafType:i.leafType,pin:!1}));if(!l)throw g(new Error("cannot write to "+parent.name),"ERR_COULD_NOT_WRITE");return s("Wrote "+l.cid),{cid:l.cid,size:l.size}},A=(e,t)=>async function*(){let r=0;for await(const s of e){if(r+=s.length,r>t)return void(yield s.slice(0,t-r));yield s}},R=(e,t=b)=>{const r=new Uint8Array(t);async function*s(){while(1)yield r.slice()}return A(s(),e)},T=async function*(e){for(let t=0;t<e.length;t++)yield*e[t]()},k=async function*(e,t){let r=0;for await(const s of e)r+=s.length,yield s;for await(const s of t(r))r+=s.length,yield s}},"16e2":function(e,t,r){"use strict";const s=r("0ad6"),n=async function*(...e){const t=s();setTimeout(async()=>{try{await Promise.all(e.map(async e=>{for await(const r of e)t.push(r)})),t.end()}catch(r){t.end(r)}},0),yield*t};e.exports=n},"173c":function(e,t,r){"use strict";const s=r("c449"),n=r("b6aa"),i=async(e,t,r,i,o,a,c,u)=>{const l=await c.get(e,u),d=await c.get(new s(1,"raw",e.multihash));let h=l,p=r;while(i.length){const o=i[0];if(!(o in h))throw n(new Error(`No property named ${o} found in cbor node ${e}`),"ERR_NO_PROP");if(i.shift(),p=`${p}/${o}`,s.isCID(h[o]))return{entry:{type:"object",name:t,path:r,cid:e,node:d,depth:a,size:d.length,content:async function*(){yield l}},next:{cid:h[o],name:o,path:p,toResolve:i}};h=h[o]}return{entry:{type:"object",name:t,path:r,cid:e,node:d,depth:a,size:d.length,content:async function*(){yield l}}}};e.exports=i},1755:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}s.uint=new s(0,"uint",!0),s.negint=new s(1,"negint",!0),s.bytes=new s(2,"bytes",!0),s.string=new s(3,"string",!0),s.array=new s(4,"array",!1),s.map=new s(5,"map",!1),s.tag=new s(6,"tag",!1),s.float=new s(7,"float",!0),s.false=new s(7,"false",!0),s.true=new s(7,"true",!0),s.null=new s(7,"null",!0),s.undefined=new s(7,"undefined",!0),s.break=new s(7,"break",!0);class n{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0}toString(){return`Token[${this.type}].${this.value}`}}t.Token=n,t.Type=s},"175a":function(e,t,r){e.exports=r("1248")},1771:function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:connection-manager"),{error:s("libp2p:connection-manager:err")}),i=r("b6aa"),o=r("4fcb"),a=r("eeca"),c=r("4c0c"),{EventEmitter:u}=r("faa1"),l=r("eddf"),{codes:{ERR_INVALID_PARAMETERS:d}}=r("b73a"),h={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1};class p extends u{constructor(e,t={}){if(super(),this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=o.call({ignoreUndefined:!0},h,t),this._options.maxConnections<this._options.minConnections)throw i(new Error("Connection Manager maxConnections must be greater than minConnections"),d);n("options: %j",this._options),this._peerValues=new Map,this.connections=new Map,this._started=!1,this._timer=null,this._autoDialTimeout=null,this._checkMetrics=this._checkMetrics.bind(this),this._autoDial=this._autoDial.bind(this),this._latencyMonitor=new a({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval})}get size(){return Array.from(this.connections.values()).reduce((e,t)=>e+t.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||c(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,n("started"),this._options.autoDial&&this._autoDial()}async stop(){this._autoDialTimeout&&this._autoDialTimeout.clear(),this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),n("stopped")}async _close(){const e=[];for(const t of this.connections.values())for(const r of t)e.push(r.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,t){if(t<0||t>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),t)}_checkMetrics(){if(this._libp2p.metrics){const e=this._libp2p.metrics.global.movingAverages,t=e.dataReceived[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxReceivedData",t);const r=e.dataSent[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxSentData",r);const s=t+r;this._checkMaxLimit("maxData",s),n("metrics update",s),this._timer=c(this._checkMetrics,this._options.pollInterval)}}onConnect(e){const t=e.remotePeer,r=t.toB58String(),s=this.connections.get(r);this.emit("peer:connect",e),s?s.push(e):this.connections.set(r,[e]),this._libp2p.peerStore.keyBook.set(t,t.pubKey),this._peerValues.has(r)||this._peerValues.set(r,this._options.defaultPeerValue),this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){const t=e.remotePeer.toB58String();let r=this.connections.get(t);r&&r.length>1?(r=r.filter(t=>t.id!==e.id),this.connections.set(t,r)):r&&(this.connections.delete(t),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e))}get(e){const t=this.getAll(e);return t.length?t[0]:null}getAll(e){if(!l.isPeerId(e))throw i(new Error("peerId must be an instance of peer-id"),d);const t=e.toB58String(),r=this.connections.get(t);return r?r.filter(e=>"open"===e.stat.status):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs)}_checkMaxLimit(e,t){const r=this._options[e];n("checking limit of %s. current value: %d of %d",e,t,r),t>r&&(n("%s: limit exceeded: %s, %d",this._peerId,e,t),this._maybeDisconnectOne())}async _autoDial(){const e=this._options.minConnections;if(this.size>=e)return void(this._autoDialTimeout=c(this._autoDial,this._options.autoDialInterval));const t=Array.from(this._libp2p.peerStore.peers.values()).sort((e,t)=>!t.protocols||!t.protocols.length||e.protocols&&e.protocols.length?t.id.pubKey&&!e.id.pubKey?1:-1:1);for(let s=0;s<t.length&&this.size<e;s++)if(!this.get(t[s].id)){n("connecting to a peerStore stored peer %s",t[s].id.toB58String());try{if(await this._libp2p.dialer.connectToPeer(t[s].id),!this._started)return}catch(r){n.error("could not connect to peerStore stored peer",r)}}this._autoDialTimeout=c(this._autoDial,this._options.autoDialInterval)}_maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){const e=Array.from(new Map([...this._peerValues.entries()].sort((e,t)=>e[1]-t[1])));n("%s: sorted peer values: %j",this._peerId,e);const t=e[0];if(t){const e=t[0];n("%s: lowest value peer is %s",this._peerId,e),n("%s: closing a connection to %j",this._peerId,e);for(const t of this.connections.values())if(t[0].remotePeer.toB58String()===e){t[0].close();break}}}}}e.exports=p},"179e":function(e,t,r){"use strict";const{importer:s}=r("9495"),n=r("e68e"),{parseChunkerString:i}=r("549a"),{pipe:o}=r("66f2"),a=r("a29d"),c=r("4fcb").bind({ignoreUndefined:!0});function u(e){async function*t(t){for await(const r of t){let t=r.cid;1===e.cidVersion&&(t=t.toV1());let s=r.path?r.path:t.toString();e.wrapWithDirectory&&!r.path&&(s=""),yield{path:s,cid:t,size:r.size,mode:r.unixfs&&r.unixfs.mode,mtime:r.unixfs&&r.unixfs.mtime}}}return t}function l(e,t){async function*r(r){for await(const s of r){const r=!s.path||t.wrapWithDirectory?""===s.path:!s.path.includes("/"),n=r&&!t.onlyHash&&!1!==t.preload;n&&e(s.cid),yield s}}return r}function d(e,t){async function*r(r){for await(const s of r){const r=!(s.path&&s.path.includes("/")),n=(null==t.pin||t.pin)&&r&&!t.onlyHash;n&&await e.add(s.cid,{preload:!1,lock:!1}),yield s}}return r}e.exports=({block:e,gcLock:t,preload:r,pin:h,options:p})=>{const f=p&&p.sharding;async function*y(a,p={}){const y=c({shardSplitThreshold:f?1e3:1/0,strategy:"balanced"},p,{...i(p.chunker)});y.hashAlg&&"sha2-256"!==y.hashAlg&&1!==y.cidVersion&&(y.cidVersion=1),y.trickle&&(y.strategy="trickle"),"trickle"===y.strategy&&(y.leafType="raw",y.reduceSingleLeafToSelf=!1),y.cidVersion>0&&void 0===y.rawLeaves&&(y.rawLeaves=!0),void 0!==y.hashAlg&&void 0===y.rawLeaves&&(y.rawLeaves=!0),delete y.trickle;const g={};if(y.progress){const e=y.progress;y.progress=(t,r)=>{g[r]||(g[r]=0),g[r]+=t,e(g[r],r)}}const b=o(n(a),t=>s(t,e,{...y,pin:!1}),u(y),l(r,y),d(h,y)),m=await t.readLock();try{for await(const e of b)delete g[e.path],yield e}finally{m()}}return a(y)}},"181b":function(e,t,r){"use strict";class s extends Map{constructor(e,t){super(),this._cmp=t||this._defaultSort,this._keys=[];for(const[r,s]of e||[])this.set(r,s)}update(e){if(e<0||e>=this._keys.length)return;const t=this._keys[e];this._keys.splice(e,1);const r=this._find(t);this._keys.splice(r,0,t)}set(e,t){if(this.has(e)){const t=this.indexOf(e);this._keys.splice(t,1)}super.set(e,t);const r=this._find(e);return this._keys.splice(r,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;const t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;const t=this._find(e);if(this._keys[t]===e)return t;for(let r=1;r<this._keys.length;r++){if(this._keys[t+r]===e)return t+r;if(this._keys[t-r]===e)return t-r}return-1}_find(e){let t=0,r=this._keys.length;while(t<r){const s=t+r>>>1,n=this._kCmp(this._keys[s],e);if(n<0)t=s+1;else{if(!(n>0))return s;r=s}}return t}*keys(){for(const e of this._keys)yield e}*values(){for(const e of this._keys)yield this.get(e)}*entries(){for(const e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t){if(e)for(const r of this._keys)e.apply(t,[[r,this.get(r)]])}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}}e.exports=s},"190a":function(e,t,r){"use strict";const{exporter:s,recursive:n}=r("d6d7"),i=r("b6aa"),{normalizeCidPath:o,mapFile:a}=r("4d04"),c=r("a29d"),u=r("c449");e.exports=function({ipld:e,preload:t}){async function*r(r,c={}){const l=o(r),d=l.split("/");!1!==c.preload&&t(new u(d[0]));const h=await s(r,e,c);if("file"!==h.type){if("directory"!==h.type)throw i(new Error("Unknown UnixFS type "+h.type),"ERR_UNKNOWN_UNIXFS_TYPE");if(c.recursive){for await(const t of n(h.cid,e,c))h.cid.toBaseEncodedString()!==t.cid.toBaseEncodedString()&&(yield a(t,c));return}for await(const e of h.content()){const t=a(e,c);t.depth--,yield t}}else yield a(h,c)}return c(r)}},"191e":function(e,t,r){"use strict";const s=r("aef6"),n=r("0e80"),i=r("c449"),o=r("b306"),a=r("a29d");e.exports=({blockService:e,pin:t,gcLock:r,preload:c})=>{async function u(a,u={}){if(Array.isArray(a))throw new Error("Array is not supported");if(!s.isBlock(a)){const e=a;if(u.cid&&o.cid(u.cid)){const t=i.isCID(u.cid)?u.cid:new i(u.cid);a=new s(e,t)}else{const t=u.mhtype||"sha2-256",r=u.format||"dag-pb";let o=1;o=null==u.version?"sha2-256"===t&&"dag-pb"===r?0:1:u.version;const c=await n(e,t),l=new i(o,r,c);a=new s(e,l)}}const l=await r.readLock();try{return await e.put(a,{signal:u.signal}),!1!==u.preload&&c(a.cid),!0===u.pin&&await t.add(a.cid,{recursive:!0,signal:u.signal}),a}finally{l()}}return a(u)}},"1a4e":function(e,t,r){"use strict";const s=r("c449"),n=r("0e80");e.exports.namespaceToCid=async e=>{const t=(new TextEncoder).encode(e),r=await n(t,"sha2-256");return new s(r)}},"1ad7":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("24ea"),n=r("1755"),i=r("e3dbc"),o=r("ac23"),a=r("0ad3"),c=r("3ef0"),u=r("b92d"),l=r("7cf7"),d=r("a4cc"),h=r("83ec"),p=r("e80e"),f=r("d6fc"),y=r("68c3"),g=r("237f");const b={float64:!1,mapSorter:A,quickEncodeToken:a.quickEncodeToken},m=[];m[n.Type.uint.major]=u.encodeUint,m[n.Type.negint.major]=l.encodeNegint,m[n.Type.bytes.major]=d.encodeBytes,m[n.Type.string.major]=h.encodeString,m[n.Type.array.major]=p.encodeArray,m[n.Type.map.major]=f.encodeMap,m[n.Type.tag.major]=y.encodeTag,m[n.Type.float.major]=g.encodeFloat;const w=new i.Bl;class _{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(o.encodeErrPrefix+" object contains circular references");return new _(t,e)}}const E={null:new n.Token(n.Type.null,null),undefined:new n.Token(n.Type.undefined,void 0),true:new n.Token(n.Type.true,!0),false:new n.Token(n.Type.false,!1),emptyArray:new n.Token(n.Type.array,0),emptyMap:new n.Token(n.Type.map,0)},v={number(e,t,r,s){return Number.isInteger(e)&&Number.isSafeInteger(e)?e>=0?new n.Token(n.Type.uint,e):new n.Token(n.Type.negint,e):new n.Token(n.Type.float,e)},bigint(e,t,r,s){return e>=BigInt(0)?new n.Token(n.Type.uint,e):new n.Token(n.Type.negint,e)},Uint8Array(e,t,r,s){return new n.Token(n.Type.bytes,e)},string(e,t,r,s){return new n.Token(n.Type.string,e)},boolean(e,t,r,s){return e?E.true:E.false},null(e,t,r,s){return E.null},undefined(e,t,r,s){return E.undefined},ArrayBuffer(e,t,r,s){return new n.Token(n.Type.bytes,new Uint8Array(e))},DataView(e,t,r,s){return new n.Token(n.Type.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,s){if(!e.length)return!0===r.addBreakTokens?[E.emptyArray,new n.Token(n.Type.break)]:E.emptyArray;s=_.createCheck(s,e);const i=[];let o=0;for(const n of e)i[o++]=S(n,r,s);return r.addBreakTokens?[new n.Token(n.Type.array,e.length),i,new n.Token(n.Type.break)]:[new n.Token(n.Type.array,e.length),i]},Object(e,t,r,s){const i="Object"!==t,o=i?e.keys():Object.keys(e),a=i?e.size:o.length;if(!a)return!0===r.addBreakTokens?[E.emptyMap,new n.Token(n.Type.break)]:E.emptyMap;s=_.createCheck(s,e);const c=[];let u=0;for(const n of o)c[u++]=[S(n,r,s),S(i?e.get(n):e[n],r,s)];return I(c,r),r.addBreakTokens?[new n.Token(n.Type.map,a),c,new n.Token(n.Type.break)]:[new n.Token(n.Type.map,a),c]}};v.Map=v.Object,v.Buffer=v.Uint8Array;for(const P of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))v[P+"Array"]=v.DataView;function S(e,t={},r){const n=s.is(e),i=t&&t.typeEncoders&&t.typeEncoders[n]||v[n];if("function"===typeof i){const s=i(e,n,t,r);if(null!=s)return s}const a=v[n];if(!a)throw new Error(`${o.encodeErrPrefix} unsupported type: ${n}`);return a(e,n,t,r)}function I(e,t){t.mapSorter&&e.sort(t.mapSorter)}function A(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],s=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==s.type)return r.type.compare(s.type);const n=r.type.major,i=m[n].compareTokens(r,s);return 0===i&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i}function R(e,t,r,s){if(Array.isArray(t))for(const n of t)R(e,n,r,s);else r[t.type.major](e,t,s)}function T(e,t,r){const s=S(e,r);if(!Array.isArray(s)&&r.quickEncodeToken){const e=r.quickEncodeToken(s);if(e)return e;const n=t[s.type.major];if(n.encodedSize){const e=n.encodedSize(s,r),t=new i.Bl(e);if(n(t,s,r),1!==t.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${s} was wrong`);return c.asU8A(t.chunks[0])}}return R(w,s,t,r),w.toBytes(!0)}function k(e,t){return t=Object.assign({},b,t),T(e,m,t)}t.Ref=_,t.encode=k,t.encodeCustom=T,t.objectToTokens=S},"1b9b":function(e,t,r){"use strict";const s=r("a29d");e.exports=({network:e})=>{async function t(t,r={}){const{libp2p:s}=await e.use(r);await s.hangUp(t)}return s(t)}},"1c94":function(e,t,r){"use strict";const s=r("a29d");e.exports=({ipld:e,gcLock:t,preload:n})=>{const i=r("69d3")({ipld:e,preload:n}),o=r("5ec0")({ipld:e,gcLock:t,preload:n});async function a(e,t,r={}){const s=await i(e,r);return s.addLink(t),o(s,r)}return s(a)}},"1d4f":function(e,t,r){"use strict";const{default:s}=r("987e");class n{constructor(e,t,r,s){this.dht=e,this.run=t,this.path=r,this.log=s,this.concurrency=this.dht.concurrency,this.queue=this.setupQueue(),this.execution=null,this.queuedPeerIds=new Set}setupQueue(){const e=new s({concurrency:this.concurrency});return e.on("idle",()=>{this.path.peersToQuery&&!this.path.peersToQuery.length&&(this.log("queue:drain"),this.stop())}),e.on("next",()=>{this.running&&e.pending<this.concurrency&&this.fill()}),e}stop(e){this.running&&(this.running=!1,this.queue.clear(),this.log("worker:stop, %d workers still running",this.run.workers.filter(e=>e.running).length),this.execution&&(e?this.execution.reject(e):this.execution.resolve()))}async execute(){this.running=!0,this.execution=null;const e=new Promise((e,t)=>{this.execution={resolve:e,reject:t}});this.fill(),await e}fill(){if(this.path.peersToQuery)while(this.queue.pending+this.queue.size<this.concurrency&&this.path.peersToQuery.length>0){const e=this.path.peersToQuery.dequeue();this.queuedPeerIds.add(e),this.queue.add(()=>this.processNext(e).catch(e=>{this.log.error("queue",e),this.stop(e)}).finally(()=>{this.queuedPeerIds.delete(e)}))}}async processNext(e){if(!this.running)return;if(this.run.peersSeen.has(e.toB58String()))return;let t,r,s,n;try{t=await this.run.continueQuerying(this)}catch(i){r=i}if(this.running){if(r)throw r;if(t){if(!this.run.peersSeen.has(e.toB58String())){this.run.peersSeen.add(e.toB58String()),this.log("queue:work");try{s=await this.execQuery(e)}catch(i){n=i}if(this.running){if(this.log("queue:work:done",n,s),n)throw n;if(s&&s.queryComplete)return this.log("query:complete"),void this.run.stop();s&&s.pathComplete&&this.stop()}}}else this.stop()}}async execQuery(e){let t,r;try{t=await this.path.queryFunc(e)}catch(s){r=s}if(this.running)if(r)this.run.errors.push(r);else if(this.run.peersQueried&&await this.run.peersQueried.add(e),t){if(t.pathComplete||t.queryComplete)return this.path.res=t,{pathComplete:t.pathComplete,queryComplete:t.queryComplete};if(t.closerPeers&&t.closerPeers.length>0){const e=async e=>{this.dht._isSelf(e.id)||(this.dht._peerDiscovered(e.id,e.multiaddrs),await this.path.addPeerToQuery(e.id))};await Promise.all(t.closerPeers.map(e))}}}}e.exports=n},"1eaa":function(e,t,r){"use strict";const{walkPath:s}=r("d6d7"),n=r("34eb")("ipfs:mfs:utils:to-trail"),i=async(e,t)=>{n("Creating trail for path "+t);const r=[];for await(const n of s(t,e.ipld)){let e;e=n.node instanceof Uint8Array?n.node.length:n.node.size,r.push({name:n.name,cid:n.cid,size:e,type:n.type})}return r};e.exports=i},"1f20":function(e,t){(function(){var e,r,s,n,i,o,a,c;c=function(e){var t,r,s,n;return t=(e&255<<24)>>>24,r=(e&255<<16)>>>16,s=(65280&e)>>>8,n=255&e,[t,r,s,n].join(".")},a=function(e){var t,s,n,i,o,a;for(t=[],n=i=0;i<=3;n=++i){if(0===e.length)break;if(n>0){if("."!==e[0])throw new Error("Invalid IP");e=e.substring(1)}a=r(e),o=a[0],s=a[1],e=e.substring(s),t.push(o)}if(0!==e.length)throw new Error("Invalid IP");switch(t.length){case 1:if(t[0]>4294967295)throw new Error("Invalid IP");return t[0]>>>0;case 2:if(t[0]>255||t[1]>16777215)throw new Error("Invalid IP");return(t[0]<<24|t[1])>>>0;case 3:if(t[0]>255||t[1]>255||t[2]>65535)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2])>>>0;case 4:if(t[0]>255||t[1]>255||t[2]>255||t[3]>255)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2]<<8|t[3])>>>0;default:throw new Error("Invalid IP")}},s=function(e){return e.charCodeAt(0)},n=s("0"),o=s("a"),i=s("A"),r=function(e){var t,r,a,c,u;c=0,t=10,r="9",a=0,e.length>1&&"0"===e[a]&&("x"===e[a+1]||"X"===e[a+1]?(a+=2,t=16):"0"<=e[a+1]&&e[a+1]<="9"&&(a++,t=8,r="7")),u=a;while(a<e.length){if("0"<=e[a]&&e[a]<=r)c=c*t+(s(e[a])-n)>>>0;else{if(16!==t)break;if("a"<=e[a]&&e[a]<="f")c=c*t+(10+s(e[a])-o)>>>0;else{if(!("A"<=e[a]&&e[a]<="F"))break;c=c*t+(10+s(e[a])-i)>>>0}}if(c>4294967295)throw new Error("too large");a++}if(a===u)throw new Error("empty octet");return[c,a]},e=function(){function e(e,t){var r,s,n;if("string"!==typeof e)throw new Error("Missing `net' parameter");if(t||(n=e.split("/",2),e=n[0],t=n[1]),t||(t=32),"string"===typeof t&&t.indexOf(".")>-1){try{this.maskLong=a(t)}catch(i){throw i,new Error("Invalid mask: "+t)}for(r=s=32;s>=0;r=--s)if(this.maskLong===4294967295<<32-r>>>0){this.bitmask=r;break}}else{if(!t&&0!==t)throw new Error("Invalid mask: empty");this.bitmask=parseInt(t,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0)}try{this.netLong=(a(e)&this.maskLong)>>>0}catch(i){throw i,new Error("Invalid net address: "+e)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+t);this.size=Math.pow(2,32-this.bitmask),this.base=c(this.netLong),this.mask=c(this.maskLong),this.hostmask=c(~this.maskLong),this.first=this.bitmask<=30?c(this.netLong+1):this.base,this.last=this.bitmask<=30?c(this.netLong+this.size-2):c(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?c(this.netLong+this.size-1):void 0}return e.prototype.contains=function(t){return"string"===typeof t&&(t.indexOf("/")>0||4!==t.split(".").length)&&(t=new e(t)),t instanceof e?this.contains(t.base)&&this.contains(t.broadcast||t.last):(a(t)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},e.prototype.next=function(t){return null==t&&(t=1),new e(c(this.netLong+this.size*t),this.mask)},e.prototype.forEach=function(e){var t,r,s;s=a(this.first),r=a(this.last),t=0;while(s<=r)e(c(s),s,t),t++,s++},e.prototype.toString=function(){return this.base+"/"+this.bitmask},e}(),t.ip2long=a,t.long2ip=c,t.Netmask=e}).call(this)},"1f97":function(e,t,r){"use strict";const s=r("c449"),n=r("b6aa"),i="/ipfs/",o=e=>{if(e instanceof Uint8Array)try{e=new s(e)}catch(a){throw n(a,"ERR_INVALID_CID")}if(s.isCID(e))return{cid:e,path:void 0};e.startsWith(i)&&(e=e.substring(i.length));const t=e.split("/");let r,o;try{r=new s(t.shift())}catch(a){throw n(a,"ERR_INVALID_CID")}return t.length&&(o="/"+t.join("/")),{cid:r,path:o}};e.exports=o},"1fdc":function(e,t,r){"use strict";const{Buffer:s}=r("1c35"),n=r("a1c8"),i=r("ac25");class o extends n{createTag(e,t){return`${e}(${t})`}createInt(e){return super.createInt(e).toString()}createInt32(e,t){return super.createInt32(e,t).toString()}createInt64(e,t,r,s){return super.createInt64(e,t,r,s).toString()}createInt32Neg(e,t){return super.createInt32Neg(e,t).toString()}createInt64Neg(e,t,r,s){return super.createInt64Neg(e,t,r,s).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(e){const t=super.createFloat(e);return i.isNegativeZero(e)?"-0_1":t+"_1"}createFloatSingle(e,t,r,s){const n=super.createFloatSingle(e,t,r,s);return n+"_2"}createFloatDouble(e,t,r,s,n,i,o,a){const c=super.createFloatDouble(e,t,r,s,n,i,o,a);return c+"_3"}createByteString(e,t){const r=e.join(", ");return-1===t?`(_ ${r})`:"h'"+r}createByteStringFromHeap(e,t){const r=s.from(super.createByteStringFromHeap(e,t)).toString("hex");return`h'${r}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(e){return`simple(${e})`}createArray(e,t){const r=super.createArray(e,t);return-1===t?`[_ ${r.join(", ")}]`:`[${r.join(", ")}]`}createMap(e,t){const r=super.createMap(e),s=Array.from(r.keys()).reduce(a(r),"");return-1===t?`{_ ${s}}`:`{${s}}`}createObject(e,t){const r=super.createObject(e),s=Object.keys(r).reduce(a(r),"");return-1===t?`{_ ${s}}`:`{${s}}`}createUtf8String(e,t){const r=e.join(", ");return-1===t?`(_ ${r})`:`"${r}"`}createUtf8StringFromHeap(e,t){const r=s.from(super.createUtf8StringFromHeap(e,t)).toString("utf8");return`"${r}"`}static diagnose(e,t){"string"===typeof e&&(e=s.from(e,t||"hex"));const r=new o;return r.decodeFirst(e)}}function a(e){return(t,r)=>t?`${t}, ${r}: ${e[r]}`:`${r}: ${e[r]}`}e.exports=o},"1fe5":function(e,t,r){"use strict";class s{constructor(e,t,r){this._refCounter=1,this.cid=e,this.priority=t||1,this.wantType=r}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){const e=this.cid.toString("base58btc");return`WantlistEntry <key: ${e}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}}e.exports=s},"206f":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IWantTracer=void 0;const s=r("54f0"),n=r("79ff"),i=r("a4ad"),{ERR_INVALID_SIGNATURE:o,ERR_MISSING_SIGNATURE:a}=i.codes;class c{constructor(e){this.getMsgId=e,this.promises=new Map}addPromise(e,t){const r=Math.floor(Math.random()*t.length),i=t[r],o=n.messageIdToString(i);let a=this.promises.get(o);a||(a=new Map,this.promises.set(o,a)),a.has(e)||a.set(e,Date.now()+s.GossipsubIWantFollowupTime)}getBrokenPromises(){const e=Date.now(),t=new Map;return this.promises.forEach((r,s)=>{r.forEach((s,n)=>{s<e&&(t.set(n,(t.get(n)||0)+1),r.delete(n))}),r.size||this.promises.delete(s)}),t}deliverMessage(e){const t=this.getMsgId(e),r=n.messageIdToString(t);this.promises.delete(r)}rejectMessage(e,t){switch(t){case o:case a:return}const r=this.getMsgId(e),s=n.messageIdToString(r);this.promises.delete(s)}clear(){this.promises.clear()}}t.IWantTracer=c},"20a0":function(e,t,r){"use strict";const s=r("cd53"),n=r("69d3"),i=r("e37e1"),o=r("2f54"),a=r("5ec0"),c=r("3792"),u=r("4fd0");class l{constructor({ipld:e,preload:t,gcLock:r}){this.data=s({ipld:e,preload:t}),this.get=n({ipld:e,preload:t}),this.links=i({ipld:e}),this.new=o({ipld:e,preload:t}),this.put=a({ipld:e,preload:t,gcLock:r}),this.stat=c({ipld:e,preload:t}),this.patch=new u({ipld:e,preload:t,gcLock:r})}}e.exports=l},2103:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateTopicScoreParams=t.validatePeerScoreParams=t.createTopicScoreParams=t.createPeerScoreParams=t.defaultTopicScoreParams=t.defaultPeerScoreParams=void 0;const s=r("4ab6"),n=r("2453");function i(e={}){return Object.assign(Object.assign(Object.assign({},t.defaultPeerScoreParams),e),{topics:e.topics?Object.entries(e.topics).reduce((e,[t,r])=>(e[t]=o(r),e),{}):{}})}function o(e={}){return Object.assign(Object.assign({},t.defaultTopicScoreParams),e)}function a(e){for(const[r,i]of Object.entries(e.topics))try{c(i)}catch(t){throw n(new Error(`invalid score parameters for topic ${r}: ${t.message}`),s.ERR_INVALID_PEER_SCORE_PARAMS)}if(e.topicScoreCap<0)throw n(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(null===e.appSpecificScore||void 0===e.appSpecificScore)throw n(new Error("missing application specific score function"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(e.IPColocationFactorWeight>0)throw n(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(0!==e.IPColocationFactorWeight&&e.IPColocationFactorThreshold<1)throw n(new Error("invalid IPColocationFactorThreshold; must be at least 1"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(e.behaviourPenaltyWeight>0)throw n(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(0!==e.behaviourPenaltyWeight&&(e.behaviourPenaltyDecay<=0||e.behaviourPenaltyDecay>=1))throw n(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(e.decayInterval<1e3)throw n(new Error("invalid DecayInterval; must be at least 1s"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(e.decayToZero<=0||e.decayToZero>=1)throw n(new Error("invalid DecayToZero; must be between 0 and 1"),s.ERR_INVALID_PEER_SCORE_PARAMS)}function c(e){if(e.topicWeight<0)throw n(new Error("invalid topic weight; must be >= 0"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(0===e.timeInMeshQuantum)throw n(new Error("invalid TimeInMeshQuantum; must be non zero"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(e.timeInMeshWeight<0)throw n(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(0!==e.timeInMeshWeight&&e.timeInMeshQuantum<=0)throw n(new Error("invalid TimeInMeshQuantum; must be positive"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(0!==e.timeInMeshWeight&&e.timeInMeshCap<=0)throw n(new Error("invalid TimeInMeshCap; must be positive"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(e.firstMessageDeliveriesWeight<0)throw n(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(0!==e.firstMessageDeliveriesWeight&&(e.firstMessageDeliveriesDecay<=0||e.firstMessageDeliveriesDecay>=1))throw n(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(0!==e.firstMessageDeliveriesWeight&&e.firstMessageDeliveriesCap<=0)throw n(new Error("invalid FirstMessageDeliveriesCap; must be positive"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(e.meshMessageDeliveriesWeight>0)throw n(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(0!==e.meshMessageDeliveriesWeight&&(e.meshMessageDeliveriesDecay<=0||e.meshMessageDeliveriesDecay>=1))throw n(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesCap<=0)throw n(new Error("invalid MeshMessageDeliveriesCap; must be positive"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesThreshold<=0)throw n(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(e.meshMessageDeliveriesWindow<0)throw n(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesActivation<1e3)throw n(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(e.meshFailurePenaltyWeight>0)throw n(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(0!==e.meshFailurePenaltyWeight&&(e.meshFailurePenaltyDecay<=0||e.meshFailurePenaltyDecay>=1))throw n(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(e.invalidMessageDeliveriesWeight>0)throw n(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),s.ERR_INVALID_PEER_SCORE_PARAMS);if(e.invalidMessageDeliveriesDecay<=0||e.invalidMessageDeliveriesDecay>=1)throw n(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),s.ERR_INVALID_PEER_SCORE_PARAMS)}t.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:36e5},t.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3},t.createPeerScoreParams=i,t.createTopicScoreParams=o,t.validatePeerScoreParams=a,t.validateTopicScoreParams=c},"22b4":function(e,t,r){"use strict";class s{constructor(e,t,r){if(this.tag=e,this.value=t,this.err=r,"number"!==typeof this.tag)throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(0|this.tag)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){let t,r;if(r=null!=e?e[this.tag]:void 0,"function"!==typeof r&&(r=s["_tag"+this.tag],"function"!==typeof r))return this;try{return r.call(s,this.value)}catch(n){return t=n,this.err=t,this}}}e.exports=s},"231c":function(e,t){e.exports=n;var r=128,s=127;function n(e,t){var i,o=0,a=(t=t||0,0),c=t,u=e.length;do{if(c>=u||a>49)throw n.bytes=0,new RangeError("Could not decode varint");i=e[c++],o+=a<28?(i&s)<<a:(i&s)*Math.pow(2,a),a+=7}while(i>=r);return n.bytes=c-t,o}},"232f":function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["ipfs-ipns"]||(s.roots["ipfs-ipns"]={});a.IpnsEntry=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.value=o.newBuffer([]),e.prototype.signature=o.newBuffer([]),e.prototype.validityType=0,e.prototype.validity=o.newBuffer([]),e.prototype.sequence=o.Long?o.Long.fromBits(0,0,!0):0,e.prototype.ttl=o.Long?o.Long.fromBits(0,0,!0):0,e.prototype.pubKey=o.newBuffer([]),e.prototype.signatureV2=o.newBuffer([]),e.prototype.data=o.newBuffer([]),e.encode=function(e,t){return t||(t=i.create()),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(10).bytes(e.value),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(18).bytes(e.signature),null!=e.validityType&&Object.hasOwnProperty.call(e,"validityType")&&t.uint32(24).int32(e.validityType),null!=e.validity&&Object.hasOwnProperty.call(e,"validity")&&t.uint32(34).bytes(e.validity),null!=e.sequence&&Object.hasOwnProperty.call(e,"sequence")&&t.uint32(40).uint64(e.sequence),null!=e.ttl&&Object.hasOwnProperty.call(e,"ttl")&&t.uint32(48).uint64(e.ttl),null!=e.pubKey&&Object.hasOwnProperty.call(e,"pubKey")&&t.uint32(58).bytes(e.pubKey),null!=e.signatureV2&&Object.hasOwnProperty.call(e,"signatureV2")&&t.uint32(66).bytes(e.signatureV2),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(74).bytes(e.data),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.IpnsEntry;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.value=e.bytes();break;case 2:s.signature=e.bytes();break;case 3:s.validityType=e.int32();break;case 4:s.validity=e.bytes();break;case 5:s.sequence=e.uint64();break;case 6:s.ttl=e.uint64();break;case 7:s.pubKey=e.bytes();break;case 8:s.signatureV2=e.bytes();break;case 9:s.data=e.bytes();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.IpnsEntry)return e;var t=new a.IpnsEntry;switch(null!=e.value&&("string"===typeof e.value?o.base64.decode(e.value,t.value=o.newBuffer(o.base64.length(e.value)),0):e.value.length&&(t.value=e.value)),null!=e.signature&&("string"===typeof e.signature?o.base64.decode(e.signature,t.signature=o.newBuffer(o.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),e.validityType){case"EOL":case 0:t.validityType=0;break}return null!=e.validity&&("string"===typeof e.validity?o.base64.decode(e.validity,t.validity=o.newBuffer(o.base64.length(e.validity)),0):e.validity.length&&(t.validity=e.validity)),null!=e.sequence&&(o.Long?(t.sequence=o.Long.fromValue(e.sequence)).unsigned=!0:"string"===typeof e.sequence?t.sequence=parseInt(e.sequence,10):"number"===typeof e.sequence?t.sequence=e.sequence:"object"===typeof e.sequence&&(t.sequence=new o.LongBits(e.sequence.low>>>0,e.sequence.high>>>0).toNumber(!0))),null!=e.ttl&&(o.Long?(t.ttl=o.Long.fromValue(e.ttl)).unsigned=!0:"string"===typeof e.ttl?t.ttl=parseInt(e.ttl,10):"number"===typeof e.ttl?t.ttl=e.ttl:"object"===typeof e.ttl&&(t.ttl=new o.LongBits(e.ttl.low>>>0,e.ttl.high>>>0).toNumber(!0))),null!=e.pubKey&&("string"===typeof e.pubKey?o.base64.decode(e.pubKey,t.pubKey=o.newBuffer(o.base64.length(e.pubKey)),0):e.pubKey.length&&(t.pubKey=e.pubKey)),null!=e.signatureV2&&("string"===typeof e.signatureV2?o.base64.decode(e.signatureV2,t.signatureV2=o.newBuffer(o.base64.length(e.signatureV2)),0):e.signatureV2.length&&(t.signatureV2=e.signatureV2)),null!=e.data&&("string"===typeof e.data?o.base64.decode(e.data,t.data=o.newBuffer(o.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(t.bytes===String?r.value="":(r.value=[],t.bytes!==Array&&(r.value=o.newBuffer(r.value))),t.bytes===String?r.signature="":(r.signature=[],t.bytes!==Array&&(r.signature=o.newBuffer(r.signature))),r.validityType=t.enums===String?"EOL":0,t.bytes===String?r.validity="":(r.validity=[],t.bytes!==Array&&(r.validity=o.newBuffer(r.validity))),o.Long){var s=new o.Long(0,0,!0);r.sequence=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else r.sequence=t.longs===String?"0":0;if(o.Long){s=new o.Long(0,0,!0);r.ttl=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else r.ttl=t.longs===String?"0":0;t.bytes===String?r.pubKey="":(r.pubKey=[],t.bytes!==Array&&(r.pubKey=o.newBuffer(r.pubKey))),t.bytes===String?r.signatureV2="":(r.signatureV2=[],t.bytes!==Array&&(r.signatureV2=o.newBuffer(r.signatureV2))),t.bytes===String?r.data="":(r.data=[],t.bytes!==Array&&(r.data=o.newBuffer(r.data)))}return null!=e.value&&e.hasOwnProperty("value")&&(r.value=t.bytes===String?o.base64.encode(e.value,0,e.value.length):t.bytes===Array?Array.prototype.slice.call(e.value):e.value),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?o.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature),null!=e.validityType&&e.hasOwnProperty("validityType")&&(r.validityType=t.enums===String?a.IpnsEntry.ValidityType[e.validityType]:e.validityType),null!=e.validity&&e.hasOwnProperty("validity")&&(r.validity=t.bytes===String?o.base64.encode(e.validity,0,e.validity.length):t.bytes===Array?Array.prototype.slice.call(e.validity):e.validity),null!=e.sequence&&e.hasOwnProperty("sequence")&&("number"===typeof e.sequence?r.sequence=t.longs===String?String(e.sequence):e.sequence:r.sequence=t.longs===String?o.Long.prototype.toString.call(e.sequence):t.longs===Number?new o.LongBits(e.sequence.low>>>0,e.sequence.high>>>0).toNumber(!0):e.sequence),null!=e.ttl&&e.hasOwnProperty("ttl")&&("number"===typeof e.ttl?r.ttl=t.longs===String?String(e.ttl):e.ttl:r.ttl=t.longs===String?o.Long.prototype.toString.call(e.ttl):t.longs===Number?new o.LongBits(e.ttl.low>>>0,e.ttl.high>>>0).toNumber(!0):e.ttl),null!=e.pubKey&&e.hasOwnProperty("pubKey")&&(r.pubKey=t.bytes===String?o.base64.encode(e.pubKey,0,e.pubKey.length):t.bytes===Array?Array.prototype.slice.call(e.pubKey):e.pubKey),null!=e.signatureV2&&e.hasOwnProperty("signatureV2")&&(r.signatureV2=t.bytes===String?o.base64.encode(e.signatureV2,0,e.signatureV2.length):t.bytes===Array?Array.prototype.slice.call(e.signatureV2):e.signatureV2),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?o.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.ValidityType=function(){var e={},t=Object.create(e);return t[e[0]="EOL"]=0,t}(),e}(),e.exports=a},"237f":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("1755"),n=r("ac23"),i=r("b92d");const o=20,a=21,c=22,u=23;function l(e,t,r,i){if(!1===i.allowUndefined)throw new Error(n.decodeErrPrefix+" undefined values are not supported");return new s.Token(s.Type.undefined,void 0,1)}function d(e,t,r,i){if(!1===i.allowIndefinite)throw new Error(n.decodeErrPrefix+" indefinite length items not allowed");return new s.Token(s.Type.break,void 0,1)}function h(e,t,r){if(r){if(!1===r.allowNaN&&Number.isNaN(e))throw new Error(n.decodeErrPrefix+" NaN values are not supported");if(!1===r.allowInfinity&&(e===1/0||e===-1/0))throw new Error(n.decodeErrPrefix+" Infinity values are not supported")}return new s.Token(s.Type.float,e,t)}function p(e,t,r,s){return h(E(e,t+1),3,s)}function f(e,t,r,s){return h(S(e,t+1),5,s)}function y(e,t,r,s){return h(A(e,t+1),9,s)}function g(e,t,r){const n=t.value;if(!1===n)e.push([s.Type.float.majorEncoded|o]);else if(!0===n)e.push([s.Type.float.majorEncoded|a]);else if(null===n)e.push([s.Type.float.majorEncoded|c]);else if(void 0===n)e.push([s.Type.float.majorEncoded|u]);else{let t,s=!1;r&&!0===r.float64||(_(n),t=E(w,1),n===t||Number.isNaN(n)?(w[0]=249,e.push(w.slice(0,3)),s=!0):(v(n),t=S(w,1),n===t&&(w[0]=250,e.push(w.slice(0,5)),s=!0))),s||(I(n),t=A(w,1),w[0]=251,e.push(w.slice(0,9)))}}g.encodedSize=function(e,t){const r=e.value;if(!1===r||!0===r||null===r||void 0===r)return 1;let s;if(!t||!0!==t.float64){if(_(r),s=E(w,1),r===s||Number.isNaN(r))return 3;if(v(r),s=S(w,1),r===s)return 5}return 9};const b=new ArrayBuffer(9),m=new DataView(b,1),w=new Uint8Array(b,0);function _(e){if(e===1/0)m.setUint16(0,31744,!1);else if(e===-1/0)m.setUint16(0,64512,!1);else if(Number.isNaN(e))m.setUint16(0,32256,!1);else{m.setFloat32(0,e);const t=m.getUint32(0),r=(2139095040&t)>>23,s=8388607&t;if(255===r)m.setUint16(0,31744,!1);else if(0===r)m.setUint16(0,(2147483648&e)>>16|s>>13,!1);else{const e=r-127;e<-24?m.setUint16(0,0):e<-14?m.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):m.setUint16(0,(2147483648&t)>>16|e+15<<10|s>>13,!1)}}}function E(e,t){if(e.length-t<2)throw new Error(n.decodeErrPrefix+" not enough data for float16");const r=(e[t]<<8)+e[t+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const s=r>>10&31,i=1023&r;let o;return o=0===s?i*2**-24:31!==s?(i+1024)*2**(s-25):0===i?1/0:NaN,32768&r?-o:o}function v(e){m.setFloat32(0,e,!1)}function S(e,t){if(e.length-t<4)throw new Error(n.decodeErrPrefix+" not enough data for float32");const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function I(e){m.setFloat64(0,e,!1)}function A(e,t){if(e.length-t<8)throw new Error(n.decodeErrPrefix+" not enough data for float64");const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}g.compareTokens=i.encodeUint.compareTokens,t.decodeBreak=d,t.decodeFloat16=p,t.decodeFloat32=f,t.decodeFloat64=y,t.decodeUndefined=l,t.encodeFloat=g},"23bb":function(e,t,r){"use strict";const s=r("34eb"),{EventEmitter:n}=r("faa1"),i=r("b6aa"),{pipe:o}=r("66f2"),a=r("c31e"),{codes:c}=r("a4ad"),{RPC:u}=r("9aaa"),l=r("5960"),{SignaturePolicy:d}=r("dbc6"),h=r("dcea"),{signMessage:p,verifySignature:f}=r("7102");class y extends n{constructor({debugName:e,multicodecs:t,libp2p:r,globalSignaturePolicy:n=d.StrictSign,canRelayMessage:o=!1,emitSelf:a=!1}){if("string"!==typeof e)throw new Error("a debugname `string` is required");if(!t)throw new Error("multicodecs are required");if(!r)throw new Error("libp2p is required");if(super(),this.log=Object.assign(s(e),{err:s(e+":error")}),this.multicodecs=h.ensureArray(t),this._libp2p=r,this.registrar=r.registrar,this.peerId=r.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!d[n])throw i(new Error("Invalid global signature policy"),c.ERR_INVALID_SIGNATURE_POLICY);this.globalSignaturePolicy=n,this.canRelayMessage=o,this.emitSelf=a,this.topicValidators=new Map,this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);const e=new a({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=this.registrar.register(e),this.log("started"),this.started=!0}stop(){this.started&&(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(e=>e.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:e,stream:t,connection:r}){const s=r.remotePeer,n=s.toB58String(),i=this._addPeer(s,e),o=i.attachInboundStream(t);this._processMessages(n,o,i)}async _onPeerConnected(e,t){const r=e.toB58String();this.log("connected",r);try{const{stream:r,protocol:s}=await t.newStream(this.multicodecs),n=this._addPeer(e,s);await n.attachOutboundStream(r)}catch(s){this.log.err(s)}this._sendSubscriptions(r,Array.from(this.subscriptions),!0)}_onPeerDisconnected(e,t){const r=e.toB58String();this.log("connection ended",r,t?t.message:""),this._removePeer(e)}_addPeer(e,t){const r=e.toB58String(),s=this.peers.get(r);if(s)return s;this.log("new peer",r);const n=new l({id:e,protocol:t});return this.peers.set(r,n),n.once("close",()=>this._removePeer(e)),n}_removePeer(e){if(!e)return;const t=e.toB58String(),r=this.peers.get(t);if(r){r.removeAllListeners(),r.close(),this.log("delete peer",t),this.peers.delete(t);for(const e of this.topics.values())e.delete(t);return r}}async _processMessages(e,t,r){try{await o(t,async t=>{for await(const s of t){const t=s instanceof Uint8Array?s:s.slice(),n=this._decodeRpc(t);this._processRpc(e,r,n)}})}catch(s){this._onPeerDisconnected(r.id,s)}}_processRpc(e,t,r){this.log("rpc from",e);const s=r.subscriptions,n=r.msgs;return s.length&&(s.forEach(t=>{this._processRpcSubOpt(e,t)}),this.emit("pubsub:subscription-change",t.id,s)),this._acceptFrom(e)?(n.length&&n.forEach(t=>{if(!(this.canRelayMessage||t.topicIDs&&t.topicIDs.some(e=>this.subscriptions.has(e))))return void this.log("received message we didn't subscribe to. Dropping.");const r=h.normalizeInRpcMessage(t,e);this._processRpcMessage(r)}),!0):(this.log("received message from unacceptable peer %s",e),!1)}_processRpcSubOpt(e,t){const r=t.topicID;if(!r)return;let s=this.topics.get(r);s||(s=new Set,this.topics.set(r,s)),t.subscribe?s.add(e):s.delete(e)}async _processRpcMessage(e){if(this.peerId.toB58String()!==e.from||this.emitSelf){try{await this.validate(e)}catch(t){return void this.log("Message is invalid, dropping it. %O",t)}this._emitMessage(e),this._publish(h.normalizeOutRpcMessage(e))}}_emitMessage(e){e.topicIDs.forEach(t=>{this.subscriptions.has(t)&&this.emit(t,e)})}getMsgId(e){const t=this.globalSignaturePolicy;switch(t){case d.StrictSign:return h.msgId(e.from,e.seqno);case d.StrictNoSign:return h.noSignMsgId(e.data);default:throw i(new Error("Cannot get message id: unhandled signature policy: "+t),c.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(e){return!0}_decodeRpc(e){return u.decode(e)}_encodeRpc(e){return u.encode(e).finish()}_sendRpc(e,t){const r=this.peers.get(e);if(r&&r.isWritable)r.write(this._encodeRpc(t));else{const t=`Cannot send RPC to ${e} as there is no open stream to it available`;this.log.err(t)}}_sendSubscriptions(e,t,r){return this._sendRpc(e,{subscriptions:t.map(e=>({topicID:e,subscribe:r}))})}async validate(e){const t=this.globalSignaturePolicy;switch(t){case d.StrictNoSign:if(e.from)throw i(new Error("StrictNoSigning: from should not be present"),c.ERR_UNEXPECTED_FROM);if(e.signature)throw i(new Error("StrictNoSigning: signature should not be present"),c.ERR_UNEXPECTED_SIGNATURE);if(e.key)throw i(new Error("StrictNoSigning: key should not be present"),c.ERR_UNEXPECTED_KEY);if(e.seqno)throw i(new Error("StrictNoSigning: seqno should not be present"),c.ERR_UNEXPECTED_SEQNO);break;case d.StrictSign:if(!e.signature)throw i(new Error("StrictSigning: Signing required and no signature was present"),c.ERR_MISSING_SIGNATURE);if(!e.seqno)throw i(new Error("StrictSigning: Signing required and no seqno was present"),c.ERR_MISSING_SEQNO);if(!await f(e))throw i(new Error("StrictSigning: Invalid message signature"),c.ERR_INVALID_SIGNATURE);break;default:throw i(new Error("Cannot validate message: unhandled signature policy: "+t),c.ERR_UNHANDLED_SIGNATURE_POLICY)}for(const r of e.topicIDs){const t=this.topicValidators.get(r);t&&await t(r,e)}}_buildMessage(e){const t=this.globalSignaturePolicy;switch(t){case d.StrictSign:return e.from=this.peerId.toB58String(),e.seqno=h.randomSeqno(),p(this.peerId,h.normalizeOutRpcMessage(e));case d.StrictNoSign:return Promise.resolve(e);default:throw i(new Error("Cannot build message: unhandled signature policy: "+t),c.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(e){if(!this.started)throw i(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!e||"string"!==typeof e)throw i(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");const t=this.topics.get(e);return t?Array.from(t):[]}async publish(e,t){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",e,t);const r=this.peerId.toB58String(),s={receivedFrom:r,data:t,topicIDs:[e]},n=await this._buildMessage(s),i=h.normalizeInRpcMessage(n);this.emitSelf&&this._emitMessage(i),await this._publish(i)}_publish(e){throw i(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(e){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(e)||(this.subscriptions.add(e),this.peers.forEach((t,r)=>this._sendSubscriptions(r,[e],!0)))}unsubscribe(e){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(e)&&0===this.listenerCount(e)&&(this.subscriptions.delete(e),this.peers.forEach((t,r)=>this._sendSubscriptions(r,[e],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}}y.utils=h,y.SignaturePolicy=d,e.exports=y},"23bc":function(e,t,r){"use strict";const s=r("7e03"),n=r("f9a3"),i=(e,t)=>{const r=e.nameAsBuffer,s=t.nameAsBuffer;return n(r,s)},o=e=>{s.inplace(e,i)};e.exports=o},"23c4":function(e,t,r){"use strict";const{createStore:s,findLevelJs:n}=r("d268"),i=r("d46b"),o=r("9b62");async function a(e,t,r=(()=>{})){let s=n(t);if(!s)return void r(e+" did not need an upgrade");r("Upgrading "+e);const o=(e,t)=>[{type:"del",key:e},{type:"put",key:i(e),value:t}];await l(s,o)}async function c(e,t,r=(()=>{})){let s=n(t);if(!s)return void r(e+" did not need a downgrade");r("Downgrading "+e);const i=(e,t)=>[{type:"del",key:e},{type:"put",key:o(e),value:t}];await l(s,i)}async function u(e,t,r,n){const i=Object.keys(t.storageBackends).filter(e=>"LevelDatastore"===t.storageBackends[e].name).map(r=>({name:r,store:s(e,r,t)}));r(0,`Migrating ${i.length} dbs`);let o=0;for(const{name:s,store:a}of i){await a.open();try{const e=e=>{r(Math.round(o/i.length*100),e)};await n(s,a,e)}finally{o++,a.close()}}r(100,`Migrated ${i.length} dbs`)}function l(e,t){function r(t,r){const s=e.store("readwrite"),n=s.transaction;let i,o=0;function a(){var e=t[o++],r=e.key;try{var c="del"===e.type?s.delete(r):s.put(e.value,r)}catch(u){return i=u,void n.abort()}o<t.length&&(c.onsuccess=a)}n.onabort=()=>r(i||n.error||new Error("aborted by user")),n.oncomplete=()=>r(),a()}return new Promise((s,n)=>{const i=e.iterator(),o=e=>e;function a(){const e=(e,o,c)=>{if(e||void 0===o){const e=e=>{e?n(e):s()};i.end(e)}else r(t(o,c),a)};i.next(e)}i._deserializeKey=i._deserializeValue=o,a()})}e.exports={version:10,description:"Migrates datastore-level keys to binary",migrate:(e,t,r=(()=>{}))=>u(e,t,r,a),revert:(e,t,r=(()=>{}))=>u(e,t,r,c)}},2452:function(e,t,r){"use strict";const s=r("3301"),{create:n}=r("d078"),i=r("b6aa");async function*o(e,t){const r=await n(t.bits,t.min,t.max,t.window),i=new s;for await(const s of e){i.append(s);const e=r.fingerprint(s);for(let t=0;t<e.length;t++){const r=e[t],s=i.slice(0,r);i.consume(r),yield s}}i.length&&(yield i.slice(0))}e.exports=async function*(e,t){let r,s,n;if(t.minChunkSize&&t.maxChunkSize&&t.avgChunkSize)n=t.avgChunkSize,r=t.minChunkSize,s=t.maxChunkSize;else{if(!t.avgChunkSize)throw i(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");n=t.avgChunkSize,r=n/3,s=n+n/2}if(r<16)throw i(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");s<r&&(s=r),n<r&&(n=r);const a=Math.floor(Math.log2(n));for await(const i of o(e,{min:r,max:s,bits:a,window:t.window,polynomial:t.polynomial}))yield i}},2453:function(e,t,r){"use strict";function s(e,t){for(const r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function n(e,t,r){if(!e||"string"===typeof e)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"===typeof t&&(r=t,t=void 0),null!=t&&(r.code=t);try{return s(e,r)}catch(n){r.message=e.message,r.stack=e.stack;const t=function(){};return t.prototype=Object.create(Object.getPrototypeOf(e)),s(new t,r)}}e.exports=n},"246c":function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:upgrader"),{error:s("libp2p:upgrader:err")}),i=r("b6aa"),o=r("c871"),{Connection:a}=r("fa2a"),c=r("eddf"),{pipe:u}=r("66f2"),l=r("5e2f"),{codes:d}=r("b73a");class h{constructor({localPeer:e,metrics:t,cryptos:r=new Map,muxers:s=new Map,onConnectionEnd:n=(()=>{}),onConnection:i=(()=>{})}){this.localPeer=e,this.metrics=t,this.cryptos=r,this.muxers=s,this.protector=null,this.protocols=new Map,this.onConnection=i,this.onConnectionEnd=n}async upgradeInbound(e){let t,r,s,i,o,a,c;if(this.metrics){({setTarget:a,proxy:c}=l());const t=(1e9*Math.random()).toString(36)+Date.now();a({toB58String:()=>t}),e=this.metrics.trackStream({stream:e,remotePeer:c})}n("Starting the inbound connection upgrade");let u=e;this.protector&&(u=await this.protector.protect(e));try{({conn:t,remotePeer:r,protocol:o}=await this._encryptInbound(this.localPeer,u,this.cryptos)),this.muxers.size?({stream:s,Muxer:i}=await this._multiplexInbound(t,this.muxers)):s=t}catch(d){throw n.error("Failed to upgrade inbound connection",d),await e.close(d),d}return this.metrics&&(this.metrics.updatePlaceholder(c,r),a(r)),n("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:s,Muxer:i,remotePeer:r})}async upgradeOutbound(e){const t=e.remoteAddr.getPeerId();if(!t)throw i(new Error("outbound connection must have a peer id"),d.ERR_INVALID_MULTIADDR);const r=c.createFromB58String(t);let s,o,a,u,h,p,f;if(this.metrics){({setTarget:p,proxy:f}=l());const t=(1e9*Math.random()).toString(36)+Date.now();p({toB58String:()=>t}),e=this.metrics.trackStream({stream:e,remotePeer:f})}n("Starting the outbound connection upgrade");let y=e;this.protector&&(y=await this.protector.protect(e));try{({conn:s,remotePeer:o,protocol:u}=await this._encryptOutbound(this.localPeer,y,r,this.cryptos)),this.muxers.size?({stream:a,Muxer:h}=await this._multiplexOutbound(s,this.muxers)):a=s}catch(g){throw n.error("Failed to upgrade outbound connection",g),await e.close(g),g}return this.metrics&&(this.metrics.updatePlaceholder(f,o),p(o)),n("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:u,direction:"outbound",maConn:e,upgradedConn:a,Muxer:h,remotePeer:o})}_createConnection({cryptoProtocol:e,direction:t,maConn:r,upgradedConn:s,Muxer:c,remotePeer:l}){let h,p,f;c&&(h=new c({onStream:async e=>{if(!f)return;const r=new o.Listener(e);try{const{stream:s,protocol:i}=await r.handle(Array.from(this.protocols.keys()));n("%s: incoming stream opened on %s",t,i),this.metrics&&this.metrics.trackStream({stream:s,remotePeer:l,protocol:i}),f.addStream(e,{protocol:i}),this._onStream({connection:f,stream:{...e,...s},protocol:i})}catch(s){n.error(s)}},onStreamEnd:e=>{f.removeStream(e.id)}}),p=async e=>{n("%s: starting new stream on %s",t,e);const r=h.newStream(),s=new o.Dialer(r);try{const{stream:t,protocol:n}=await s.select(e);return this.metrics&&this.metrics.trackStream({stream:t,remotePeer:l,protocol:n}),{stream:{...r,...t},protocol:n}}catch(a){throw n.error("could not create new stream",a),i(a,d.ERR_UNSUPPORTED_PROTOCOL)}},u(s,h,s).catch(n.error));const y=r.timeline;r.timeline=new Proxy(y,{set:(...e)=>(f&&"close"===e[1]&&e[2]&&!y.close&&(async()=>{try{"open"===f.stat.status&&await f.close()}catch(e){n.error(e)}finally{this.onConnectionEnd(f)}})(),Reflect.set(...e))}),r.timeline.upgraded=Date.now();const g=()=>{throw i(new Error("connection is not multiplexed"),"ERR_CONNECTION_NOT_MULTIPLEXED")};return f=new a({localAddr:r.localAddr,remoteAddr:r.remoteAddr,localPeer:this.localPeer,remotePeer:l,stat:{direction:t,timeline:r.timeline,multiplexer:c&&c.multicodec,encryption:e},newStream:p||g,getStreams:()=>h?h.streams:g(),close:async()=>{await r.close(),h&&h.streams.map(e=>e.abort())}}),this.onConnection(f),f}_onStream({connection:e,stream:t,protocol:r}){const s=this.protocols.get(r);s({connection:e,stream:t,protocol:r})}async _encryptInbound(e,t,r){const s=new o.Listener(t),a=Array.from(r.keys());n("handling inbound crypto protocol selection",a);try{const{stream:t,protocol:i}=await s.handle(a),o=r.get(i);if(n("encrypting inbound connection..."),!o)throw new Error("no crypto module found for "+i);return{...await o.secureInbound(e,t),protocol:i}}catch(c){throw i(c,d.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t,r,s){const a=new o.Dialer(t),c=Array.from(s.keys());n("selecting outbound crypto protocol",c);try{const{stream:t,protocol:i}=await a.select(c),o=s.get(i);if(n("encrypting outbound connection to %j",r),!o)throw new Error("no crypto module found for "+i);return{...await o.secureOutbound(e,t,r),protocol:i}}catch(u){throw i(u,d.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){const r=new o.Dialer(e),s=Array.from(t.keys());n("outbound selecting muxer %s",s);try{const{stream:e,protocol:i}=await r.select(s);n("%s selected as muxer protocol",i);const o=t.get(i);return{stream:e,Muxer:o}}catch(a){throw i(a,d.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){const r=new o.Listener(e),s=Array.from(t.keys());n("inbound handling muxers %s",s);try{const{stream:e,protocol:n}=await r.handle(s),i=t.get(n);return{stream:e,Muxer:i}}catch(a){throw i(a,d.ERR_MUXER_UNAVAILABLE)}}}e.exports=h},"246e":function(e,t,r){"use strict";const s=r("2612");e.exports=e=>{if(!(e instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");const t=[];while(e.length>0){const r=s.decode(e);t.push(r),e=e.slice(s.decode.bytes)}return t}},"24cf":function(e,t,r){"use strict";const s=r("b306"),n=r("1f97"),i=r("5268");t.resolvePath=async({ipns:e,ipld:t},r)=>{if(s.ipnsPath(r))return e.resolve(r);const{cid:o,path:a}=n(r);await i(t.resolve(o,a||""))}},"24e2":function(e,t,r){"use strict";var s=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;e.exports=function(e,t){if(null==t&&(t=!1),e.length<2)return!1;if(e.length>255)return!1;var r=e[e.length-1];if(t){if("."!==r)return!1}else if("."===r)return!1;return s.test(e)}},"24ea":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=["string","number","bigint","symbol"],n=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function i(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(s.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(o(e))return"Buffer";const r=a(e);return r||"Object"}function o(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function a(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(n.includes(t))return t}t.is=i},2621:function(e,t,r){"use strict";const s=r("eddf"),n=r("a29d");e.exports=({network:e})=>{async function t(t,r={}){const{bitswap:n}=await e.use(r),i=n.wantlistForPeer(s.createFromCID(t),r);return Array.from(i).map(e=>e[1].cid)}return n(t)}},"266c":function(e,t,r){"use strict";const s=r("c449"),n=r("a29d"),i=r("1f97");e.exports=({ipld:e,preload:t})=>{async function r(r,n={}){const{cid:o,path:a}=i(r);!1!==n.preload&&t(o),a&&(n.path=a);let c=o,u=n.path||"";if(u.startsWith("/")&&(u=u.substring(1)),n.path)try{for await(const{value:t,remainderPath:r}of e.resolve(o,n.path,{signal:n.signal})){if(!s.isCID(t))break;u=r,c=t}}catch(l){throw l.message.startsWith("Object has no property")&&(l.message=`no link named "${u.split("/")[0]}" under ${c}`,l.code="ERR_NO_LINK"),l}return{cid:c,remainderPath:u||""}}return n(r)}},"26a22":function(e,t,r){"use strict";const s=r("5425").AbstractIterator,n=r("3fb5");function i(e,t){s.call(this,e),this._options=t,this._iterator=null,this._operations=[]}n(i,s),i.prototype.setDb=function(e){const t=this._iterator=e.iterator(this._options);for(const r of this._operations)t[r.method](...r.args)},i.prototype._operation=function(e,t){if(this._iterator)return this._iterator[e](...t);this._operations.push({method:e,args:t})};for(const o of["next","end"])i.prototype["_"+o]=function(...e){this._operation(o,e)};i.prototype.seek=function(...e){this._operation("seek",e)},e.exports=i},"26f6":function(e,t,r){"use strict";const s={hasNewInfo(e,t){let r=!1,s=!1;for(const n of t)n.data.haveBlock&&(r=!0),n.data.isWantBlock&&(s=!0);return!(s||!e.data.isWantBlock)||!(r||!e.data.haveBlock)},merge(e,t){const r=e.data,s=t.data;!s.haveBlock&&r.haveBlock&&(s.haveBlock=r.haveBlock,s.blockSize=r.blockSize),!s.isWantBlock&&r.isWantBlock&&(s.isWantBlock=!0,s.haveBlock&&!r.haveBlock||(s.haveBlock=r.haveBlock,t.size=e.size)),s.isWantBlock&&s.haveBlock&&(t.size=s.blockSize)}};e.exports=s},27:function(e,t){},2712:function(e,t,r){"use strict";const s=r("34eb")("ipfs:components:peer:storage"),n=r("b6c5"),i=r("0f68"),{ERR_REPO_NOT_INITIALIZED:o}=r("888a").errors,a=r("d46b"),c=r("9b62"),u=r("eddf"),{mergeOptions:l}=r("4d04"),d=r("2e6e"),{NotEnabledError:h,NotInitializedError:p}=r("fabb"),f=r("7bf9");class y{constructor(e,t,r,s,n){this.print=s,this.peerId=e,this.keychain=t,this.repo=r,this.print=s,this.isNew=n}static async start(e,t){const{repoAutoMigrate:r,repo:s,onMigrationProgress:i}=t,o="string"===typeof s||null==s?n(e,{path:s,autoMigrate:r,onMigrationProgress:i}):s,{peerId:a,keychain:c,isNew:u}=await g(e,o,t);return new y(a,c,o,e,u)}}e.exports=y;const g=async(e,t,r)=>{if(!t.closed)return{...await E(t,r),isNew:!1};try{return await t.open(),{...await E(t,r),isNew:!1}}catch(s){if(s.code!==o)throw s;if(r.init&&!1===r.init.allowNew)throw new h("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await b(e,t,r),isNew:!0}}},b=async(e,t,r)=>{const n=r.init||{},o=await t.exists();if(s("repo exists?",o),!0===o)throw new Error("repo already exists");const a=n.privateKey?await m(n.privateKey):await w(e,n),c=_(a);s("peer identity: %s",c.PeerID);const u={...l(S(i(),n.profiles),r.config),Identity:c};await t.init(u),await t.open(),s("repo opened");const d=await f({options:void 0,multiaddrs:void 0,peerId:a,repo:t,config:u,keychainConfig:{pass:r.pass}});return d.keychain&&d.keychain.opts&&(await d.loadKeychain(),await t.config.set("Keychain",{dek:d.keychain.opts.dek})),{peerId:a,keychain:d.keychain}},m=e=>(s("using user-supplied private-key"),"object"===typeof e?e:u.createFromPrivKey(a(e,"base64pad"))),w=(e,{algorithm:t="RSA",bits:r=2048})=>(e("generating %s-bit (rsa only) %s keypair...",r,t),u.create({keyType:t,bits:r})),_=e=>({PeerID:e.toB58String(),PrivKey:c(e.privKey.bytes,"base64pad")}),E=async(e,t)=>{const r=t.config,s=t.init&&t.init.profiles||[],n=t.pass,i=await e.config.getAll(),o=v(S(i,s),r);if(i!==o&&await e.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new p("No private key was found in the config, please intialize the repo");const a=await u.createFromPrivKey(o.Identity.PrivKey),c=await f({options:void 0,multiaddrs:void 0,peerId:a,repo:e,config:o,keychainConfig:{pass:n,...o.Keychain}});return c.keychain&&await c.loadKeychain(),{peerId:a,keychain:c.keychain}},v=(e,t)=>t?l(e,t):e,S=(e,t)=>(t||[]).reduce((e,t)=>{const r=d.profiles[t];if(!r)throw new Error(`Could not find profile with name '${t}'`);return s("applying profile %s",t),r.transform(e)},e)},"273a":function(e,t,r){"use strict";const{TimeoutError:s,AbortError:n}=r("d2aa"),{Response:i,Request:o,Headers:a,default:c}=r("c09e"),u=(e,t={})=>{const r=new XMLHttpRequest;r.open(t.method||"GET",e.toString(),!0);const{timeout:o,headers:c}=t;if(o&&o>0&&o<1/0&&(r.timeout=o),null!=t.overrideMimeType&&r.overrideMimeType(t.overrideMimeType),c)for(const[s,n]of new a(c))r.setRequestHeader(s,n);return t.signal&&(t.signal.onabort=()=>r.abort()),t.onUploadProgress&&(r.upload.onprogress=t.onUploadProgress),r.responseType="arraybuffer",new Promise((e,o)=>{const a=t=>{switch(t.type){case"error":e(i.error());break;case"load":e(new p(r.responseURL,r.response,{status:r.status,statusText:r.statusText,headers:h(r.getAllResponseHeaders())}));break;case"timeout":o(new s);break;case"abort":o(new n);break;default:break}};r.onerror=a,r.onload=a,r.ontimeout=a,r.onabort=a,r.send(t.body)})},l=c,d=(e,t={})=>null!=t.onUploadProgress?u(e,t):l(e,t),h=e=>{const t=new a;for(const r of e.trim().split(/[\r\n]+/)){const e=r.indexOf(": ");e>0&&t.set(r.slice(0,e),r.slice(e+1))}return t};class p extends i{constructor(e,t,r){super(t,r),Object.defineProperty(this,"url",{value:e})}}e.exports={fetch:d,Request:o,Headers:a}},"273b":function(e,t,r){"use strict";const s=r("d507"),{PinTypes:n}=s,i=r("e4e8"),{resolvePath:o}=r("4d04"),a=r("a29d");function c(e,t,r){const s={type:e,cid:t};return r&&(s.metadata=r),s}e.exports=({pinManager:e,ipld:t})=>{async function*r(r={}){let a=n.all;if(r.type&&(a=r.type,s.checkPinType(a)),r.paths){let s=!1;for await(const{path:u}of i(r.paths)){const r=await o(t,u),{reason:i,pinned:l,parent:d,metadata:h}=await e.isPinnedWithType(r,a);if(!l)throw new Error(`path '${u}' is not pinned`);switch(i){case n.direct:case n.recursive:s=!0,yield c(i,r,h);break;default:s=!0,yield c(`${n.indirect} through ${d}`,r,h)}}if(!s)throw new Error("No match found")}else{if(a===n.recursive||a===n.all)for await(const{cid:t,metadata:r}of e.recursiveKeys())yield c(n.recursive,t,r);if(a===n.indirect||a===n.all)for await(const t of e.indirectKeys(r))yield c(n.indirect,t);if(a===n.direct||a===n.all)for await(const{cid:t,metadata:r}of e.directKeys())yield c(n.direct,t,r)}}return a(r)}},"276c":function(e,t,r){"use strict";const s=r("8cd7"),n=r("0e8e");function i(e){function t(t,i,o){return"function"===typeof t?o=t:"function"===typeof i&&(o=i),r(i)||(i=r(t)?t:{}),s(n(e(t,i),i),i,o)}function r(e){return"object"===typeof e&&null!==e}for(const s of["destroy","repair"])"function"===typeof e[s]&&(t[s]=function(...t){e[s](...t)});return t.errors=s.errors,t}e.exports=i},2775:function(e,t){const r={},s=e=>{e.addEventListener("message",t=>{s.dispatchEvent("message",e,t)}),e.port&&e.port.addEventListener("message",t=>{s.dispatchEvent("message",e,t)})};s.addEventListener=(e,t)=>{r[e]||(r[e]=[]),r[e].push(t)},s.removeEventListener=(e,t)=>{r[e]&&(r[e]=r[e].filter(e=>e===t))},s.dispatchEvent=function(){const e=Array.prototype.slice.call(arguments),t=e.shift();r[t]&&r[t].forEach(t=>t.apply(null,e))},e.exports=s},2786:function(e,t,r){"use strict";const s=r(27),n=r("449d"),i=r("eddf"),o=r("ff5f"),a=r("b306"),{multiaddr:c}=r("2054"),u=r("675c"),l=r("5d98"),d=r("0e80"),h=d.multihash,p=r("c449"),{create:f}=r("7444");e.exports={create:f,crypto:o,isIPFS:a,CID:p,multiaddr:c,multibase:u,multihash:h,multihashing:d,multicodec:l,PeerId:i,globSource:s,urlSource:n}},2791:function(e,t,r){"use strict";const s=r("db9e5"),n=r("3768d"),i=r("273b"),o=r("9640"),a=r("4fcf7");class c{constructor({gcLock:e,ipld:t,pinManager:r}){const c=n({gcLock:e,ipld:t,pinManager:r});this.addAll=c,this.add=s({addAll:c});const u=a({gcLock:e,ipld:t,pinManager:r});this.rmAll=u,this.rm=o({rmAll:u}),this.ls=i({ipld:t,pinManager:r}),this.remote={add:(e,t={})=>Promise.reject(new Error("Not implemented")),ls:async function*(e,t={}){return Promise.reject(new Error("Not implemented"))},rm:(e,t={})=>Promise.reject(new Error("Not implemented")),rmAll:(e,t={})=>Promise.reject(new Error("Not implemented")),service:{add:(e,t)=>Promise.reject(new Error("Not implemented")),rm:(e,t={})=>Promise.reject(new Error("Not implemented")),ls:(e={})=>Promise.reject(new Error("Not implemented"))}}}}e.exports=c},"27da":function(e,t,r){"use strict";const s=r("4e81"),n=r("7eb4"),i=({blockService:e,options:t})=>new n(s(e,t));e.exports=i},28:function(e,t){},"28fe":function(e,t,r){"use strict";const s=r("6101"),n=r("b04a"),i=r("d6e3"),{NOISE:o}=r("2f85"),a=r("b1bf"),c=r("2f0b"),u=r("77a6");e.exports=()=>{const e={dialer:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4},modules:{transport:[s,n],streamMuxer:[i],connEncryption:[o],peerDiscovery:[],dht:a,pubsub:c},config:{peerDiscovery:{autoDial:!0,bootstrap:{enabled:!0},webRTCStar:{enabled:!0}},dht:{kBucketSize:20,enabled:!1,clientMode:!0,randomWalk:{enabled:!1},validators:{ipns:u.validator},selectors:{ipns:u.selector}},pubsub:{enabled:!0,emitSelf:!0},nat:{enabled:!1}},metrics:{enabled:!0},peerStore:{persistence:!0,threshold:1}};return e}},29:function(e,t){},"29b0":function(e,t,r){"use strict";const{getPubsubRouting:s}=r("a866"),n=r("a29d");e.exports=({ipns:e,options:t})=>{const r=t.EXPERIMENTAL;async function i(t={}){try{return{enabled:Boolean(s(e,r))}}catch(n){return{enabled:!1}}}return n(i)}},"2a9c":function(e,t,r){"use strict";const s=1e3;e.exports={maxProvidersPerRequest:3,providerRequestTimeout:10*s,hasBlockTimeout:15*s,provideTimeout:15*s,kMaxPriority:Math.pow(2,31)-1,maxListeners:1e3,wantlistSendDebounceMs:1}},"2b45":function(e,t,r){"use strict";const{createFromPrivKey:s}=r("eddf"),n=r("b6aa"),i=r("34eb"),o=Object.assign(i("ipfs:ipns"),{error:i("ipfs:ipns:error")}),a=r("70eb"),c=r("0280"),u=r("6e04"),l=r("ea84"),d=6e4,h=r("9b62");class p{constructor(e,t,r,s,n){this.publisher=new a(e,t),this.republisher=new c(this.publisher,t,r,s,n),this.resolver=new u(e),this.cache=new l(1e3),this.routing=e}async publish(e,t,r=a.defaultRecordLifetime){try{const n=await s(e.bytes);await this.publisher.publishWithEOL(e,t,r),o(`IPNS value ${h(t,"base32")} was published correctly`);const i=n.toB58String(),a=parseFloat(r),c=a<d?a:d;return this.cache.set(i,t,c),o(`IPNS value ${h(t,"base32")} was cached correctly`),{name:i,value:t}}catch(n){throw o.error(n),n}}async resolve(e,t={}){if("string"!==typeof e)throw n(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!t.nocache&&!t.recursive){const t=e.split("/")[2],r=this.cache.get(t);if(r)return r}try{const r=await this.resolver.resolve(e,t);return o(`IPNS record from ${e} was resolved correctly`),r}catch(r){throw o.error(r),r}}async initializeKeyspace(e,t){return this.publish(e,t,a.defaultRecordLifetime)}}e.exports=p},"2bc2":function(e,t,r){"use strict";const s=r("41c5");e.exports=async function(e,t){return t(await s(e))}},"2c8c":function(e,t){var r=Math.pow(2,7),s=Math.pow(2,14),n=Math.pow(2,21),i=Math.pow(2,28),o=Math.pow(2,35),a=Math.pow(2,42),c=Math.pow(2,49),u=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<r?1:e<s?2:e<n?3:e<i?4:e<o?5:e<a?6:e<c?7:e<u?8:e<l?9:10}},"2cdb":function(e,t,r){"use strict";const s=r("c449"),n=r("85b8");t.resolve=(e,t="/")=>{let r=n.deserialize(e);const i=t.split("/").filter(Boolean);while(i.length){const e=i.shift();if(void 0===r[e]){for(const t of r.Links)if(t.Name===e)return{value:t.Hash,remainderPath:i.join("/")};throw new Error(`Object has no property '${e}'`)}if(r=r[e],s.isCID(r))return{value:r,remainderPath:i.join("/")}}return{value:r,remainderPath:""}},t.tree=function*(e){const t=n.deserialize(e);yield"Data",yield"Links";for(let r=0;r<t.Links.length;r++)yield"Links/"+r,yield`Links/${r}/Name`,yield`Links/${r}/Tsize`,yield`Links/${r}/Hash`}},"2ce1":function(e,t,r){"use strict";const s=async e=>{try{const t=await e;return{isFulfilled:!0,isRejected:!1,value:t}}catch(t){return{isFulfilled:!1,isRejected:!0,reason:t}}};e.exports=s,e.exports.default=s},"2dc7":function(e,t,r){"use strict";const{Buffer:s}=r("1c35"),{URL:n}=r("16af"),i=r("901e").BigNumber,o=r("5ee5"),a=r("85be"),c=a.MT,u=a.NUMBYTES,l=a.SHIFT32,d=a.SYMS,h=a.TAG,p=a.MT.SIMPLE_FLOAT<<5|a.NUMBYTES.TWO,f=a.MT.SIMPLE_FLOAT<<5|a.NUMBYTES.FOUR,y=a.MT.SIMPLE_FLOAT<<5|a.NUMBYTES.EIGHT,g=a.MT.SIMPLE_FLOAT<<5|a.SIMPLE.TRUE,b=a.MT.SIMPLE_FLOAT<<5|a.SIMPLE.FALSE,m=a.MT.SIMPLE_FLOAT<<5|a.SIMPLE.UNDEFINED,w=a.MT.SIMPLE_FLOAT<<5|a.SIMPLE.NULL,_=new i("0x20000000000000"),E=s.from("f97e00","hex"),v=s.from("f9fc00","hex"),S=s.from("f97c00","hex");function I(e){return{}.toString.call(e).slice(8,-1)}class A{constructor(e){e=e||{},this.streaming="function"===typeof e.stream,this.onData=e.stream,this.semanticTypes=[[n,this._pushUrl],[i,this._pushBigNumber]];const t=e.genTypes||[],r=t.length;for(let s=0;s<r;s++)this.addSemanticType(t[s][0],t[s][1]);this._reset()}addSemanticType(e,t){const r=this.semanticTypes.length;for(let s=0;s<r;s++){const r=this.semanticTypes[s][0];if(r===e){const e=this.semanticTypes[s][1];return this.semanticTypes[s][1]=t,e}}return this.semanticTypes.push([e,t]),null}push(e){return!e||(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize()),!0)}pushWrite(e,t,r){return this.result[this.offset]=e,this.resultMethod[this.offset]=t,this.resultLength[this.offset]=r,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(e){return this.pushWrite(e,1,1)}_pushUInt16BE(e){return this.pushWrite(e,2,2)}_pushUInt32BE(e){return this.pushWrite(e,3,4)}_pushDoubleBE(e){return this.pushWrite(e,4,8)}_pushNaN(){return this.push(E)}_pushInfinity(e){const t=e<0?v:S;return this.push(t)}_pushFloat(e){const t=s.allocUnsafe(2);if(o.writeHalf(t,e)&&o.parseHalf(t)===e)return this._pushUInt8(p)&&this.push(t);const r=s.allocUnsafe(4);return r.writeFloatBE(e,0),r.readFloatBE(0)===e?this._pushUInt8(f)&&this.push(r):this._pushUInt8(y)&&this._pushDoubleBE(e)}_pushInt(e,t,r){const s=t<<5;return e<24?this._pushUInt8(s|e):e<=255?this._pushUInt8(s|u.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(s|u.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(s|u.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(s|u.EIGHT)&&this._pushUInt32BE(Math.floor(e/l))&&this._pushUInt32BE(e%l):t===c.NEG_INT?this._pushFloat(r):this._pushFloat(e)}_pushIntNum(e){return e<0?this._pushInt(-e-1,c.NEG_INT,e):this._pushInt(e,c.POS_INT)}_pushNumber(e){switch(!1){case e===e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!==0:return this._pushIntNum(e);default:return this._pushFloat(e)}}_pushString(e){const t=s.byteLength(e,"utf8");return this._pushInt(t,c.UTF8_STRING)&&this.pushWrite(e,5,t)}_pushBoolean(e){return this._pushUInt8(e?g:b)}_pushUndefined(e){return this._pushUInt8(m)}_pushArray(e,t){const r=t.length;if(!e._pushInt(r,c.ARRAY))return!1;for(let s=0;s<r;s++)if(!e.pushAny(t[s]))return!1;return!0}_pushTag(e){return this._pushInt(e,c.TAG)}_pushDate(e,t){return e._pushTag(h.DATE_EPOCH)&&e.pushAny(Math.round(t/1e3))}_pushBuffer(e,t){return e._pushInt(t.length,c.BYTE_STRING)&&e.push(t)}_pushNoFilter(e,t){return e._pushBuffer(e,t.slice())}_pushRegexp(e,t){return e._pushTag(h.REGEXP)&&e.pushAny(t.source)}_pushSet(e,t){if(!e._pushInt(t.size,c.ARRAY))return!1;for(const r of t)if(!e.pushAny(r))return!1;return!0}_pushUrl(e,t){return e._pushTag(h.URI)&&e.pushAny(t.format())}_pushBigint(e){let t=h.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),t=h.NEG_BIGINT);let r=e.toString(16);r.length%2&&(r="0"+r);const n=s.from(r,"hex");return this._pushTag(t)&&this._pushBuffer(this,n)}_pushBigNumber(e,t){if(t.isNaN())return e._pushNaN();if(!t.isFinite())return e._pushInfinity(t.isNegative()?-1/0:1/0);if(t.isInteger())return e._pushBigint(t);if(!e._pushTag(h.DECIMAL_FRAC)||!e._pushInt(2,c.ARRAY))return!1;const r=t.decimalPlaces(),s=t.multipliedBy(new i(10).pow(r));return!!e._pushIntNum(-r)&&(s.abs().isLessThan(_)?e._pushIntNum(s.toNumber()):e._pushBigint(s))}_pushMap(e,t){return!!e._pushInt(t.size,c.MAP)&&this._pushRawMap(t.size,Array.from(t))}_pushObject(e){if(!e)return this._pushUInt8(w);const t=this.semanticTypes.length;for(let i=0;i<t;i++)if(e instanceof this.semanticTypes[i][0])return this.semanticTypes[i][1].call(e,this,e);const r=e.encodeCBOR;if("function"===typeof r)return r.call(e,this);const s=Object.keys(e),n=s.length;return!!this._pushInt(n,c.MAP)&&this._pushRawMap(n,s.map(t=>[t,e[t]]))}_pushRawMap(e,t){t=t.map((function(e){return e[0]=A.encode(e[0]),e})).sort(o.keySorter);for(let r=0;r<e;r++){if(!this.push(t[r][0]))return!1;if(!this.pushAny(t[r][1]))return!1}return!0}write(e){return this.pushAny(e)}pushAny(e){const t=I(e);switch(t){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,s.isBuffer(e)?e:s.from(e));case"Null":return this._pushUInt8(w);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case d.NULL:return this._pushObject(null);case d.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(0===this.offset)return null;const e=this.result,t=this.resultLength,r=this.resultMethod,n=this.offset;let i=0,o=0;for(;o<n;o++)i+=t[o];const a=s.allocUnsafe(i);let c=0,u=0;for(o=0;o<n;o++){switch(u=t[o],r[o]){case 0:e[o].copy(a,c);break;case 1:a.writeUInt8(e[o],c,!0);break;case 2:a.writeUInt16BE(e[o],c,!0);break;case 3:a.writeUInt32BE(e[o],c,!0);break;case 4:a.writeDoubleBE(e[o],c,!0);break;case 5:a.write(e[o],c,u,"utf8");break;default:throw new Error("unkown method")}c+=u}const l=a;return this._reset(),l}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(e){const t=new A,r=t.pushAny(e);if(!r)throw new Error("Failed to encode input");return t.finalize()}}e.exports=A},"2e15":function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:peer-store:key-book"),{error:s("libp2p:peer-store:key-book:err")}),i=r("b6aa"),o=r("eddf"),a=r("bd20"),{codes:{ERR_INVALID_PARAMETERS:c}}=r("b73a");class u extends a{constructor(e){super({peerStore:e,eventName:"change:pubkey",eventProperty:"pubkey",eventTransformer:e=>e.pubKey}),this.data=new Map}set(e,t){if(!o.isPeerId(e))throw n.error("peerId must be an instance of peer-id to store data"),i(new Error("peerId must be an instance of peer-id"),c);const r=e.toB58String(),s=this.data.get(r);return!s&&t&&(e.pubKey=t,this._setData(e,e),n("stored provided public key for "+r)),this}get(e){if(!o.isPeerId(e))throw i(new Error("peerId must be an instance of peer-id"),c);const t=this.data.get(e.toB58String());return t?t.pubKey:void 0}}e.exports=u},"2e6e":function(e,t,r){"use strict";const s=r("64f9"),n=r("0f68"),i=r("a29d"),o=r("34eb")("ipfs:core:config");async function a(e){return Object.keys(c).map(e=>({name:e,description:c[e].description}))}e.exports=({repo:e})=>{return{getAll:i(t),get:i(r),set:i(s),replace:i(n),profiles:{apply:i(u),list:i(a)}};async function t(t={}){return e.config.getAll(t)}async function r(t,r){return t?e.config.get(t,r):Promise.reject(new Error("key argument is required"))}async function s(t,r,s){return e.config.set(t,r,s)}async function n(t,r){return e.config.replace(t,r)}async function u(t,r={dryRun:!1}){const{dryRun:s}=r,n=c[t];if(!n)throw new Error(`No profile with name '${t}' exists`);try{const t=await e.config.getAll(r);let i=JSON.parse(JSON.stringify(t));return i=n.transform(i),s||await e.config.replace(i,r),delete t.Identity.PrivKey,delete i.Identity.PrivKey,{original:t,updated:i}}catch(i){throw o(i),new Error(`Could not apply profile '${t}' to config: ${i.message}`)}}};const c={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:e=>(s(e,"Discovery.MDNS.Enabled",!1),s(e,"Discovery.webRTCStar.Enabled",!1),e.Swarm={...e.Swarm||{},DisableNatPortMap:!0},e)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:e=>(s(e,"Discovery.MDNS.Enabled",!0),s(e,"Discovery.webRTCStar.Enabled",!0),s(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!1}),e)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:e=>{const t=n();return s(e,"Addresses.API",t.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),s(e,"Addresses.Gateway",t.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),s(e,"Addresses.Swarm",t.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),s(e,"Addresses.Delegates",[]),s(e,"Bootstrap",[]),s(e,"Discovery.MDNS.Enabled",!1),s(e,"Discovery.webRTCStar.Enabled",!1),s(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!0}),e}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:e=>{const t=n();return s(e,"Addresses.API",t.Addresses.API),s(e,"Addresses.Gateway",t.Addresses.Gateway),s(e,"Addresses.Swarm",t.Addresses.Swarm),s(e,"Addresses.Delegates",t.Addresses.Delegates),s(e,"Bootstrap",t.Bootstrap),s(e,"Discovery.MDNS.Enabled",t.Discovery.MDNS.Enabled),s(e,"Discovery.webRTCStar.Enabled",t.Discovery.webRTCStar.Enabled),s(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!1}),e}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:e=>{const t=e.Swarm||{},r=t.ConnMgr||{};return r.LowWater=20,r.HighWater=40,t.ConnMgr=r,e.Swarm=t,e}},"default-power":{description:'Inverse of "lowpower" profile.',transform:e=>{const t=n();return e.Swarm=t.Swarm,e}}};e.exports.profiles=c},"2f0b":function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return n(t,e),t},o=this&&this.__awaiter||function(e,t,r,s){function n(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(t){i(t)}}function a(e){try{c(s["throw"](e))}catch(t){i(t)}}function c(e){e.done?r(e.value):n(e.value).then(o,a)}c((s=s.apply(e,t||[])).next())}))};const a=i(r("23bb")),c=r("63ce"),u=r("dcc7"),l=i(r("54f0")),d=r("638d"),h=r("588d"),p=r("79ff"),f=r("7ee4"),y=r("206f"),g=r("86b2"),b=r("eddf"),m=r("7cb6");class w extends a.default{constructor(e,t={}){const r=[l.GossipsubIDv11,l.GossipsubIDv10],s=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:l.GossipsubD,Dlo:l.GossipsubDlo,Dhi:l.GossipsubDhi,Dscore:l.GossipsubDscore,Dout:l.GossipsubDout,Dlazy:l.GossipsubDlazy},t),{scoreParams:f.createPeerScoreParams(t.scoreParams),scoreThresholds:f.createPeerScoreThresholds(t.scoreThresholds)});s.fallbackToFloodsub&&r.push(l.FloodsubID),super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:r,libp2p:e},s)),this._options=s,this.direct=new Set(s.directPeers.map(e=>e.id.toB58String())),s.directPeers.forEach(t=>{e.peerStore.addressBook.add(t.id,t.addrs)}),this.seenCache=new g,this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=t.messageCache||new c.MessageCache(l.GossipsubHistoryGossip,l.GossipsubHistoryLength,this.getMsgId.bind(this)),this.heartbeat=new d.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new y.IWantTracer(this.getMsgId.bind(this)),this._libp2p=e,this.score=new f.PeerScore(this._options.scoreParams,e.connectionManager,this.getMsgId.bind(this))}_decodeRpc(e){return u.RPC.decode(e)}_encodeRpc(e){return u.RPC.encode(e).finish()}_addPeer(e,t){const r=super._addPeer(e,t);this.score.addPeer(e.toB58String());let s=!1;for(const n of this._libp2p.connectionManager.getAll(e))if("outbound"===n.stat.direction&&Array.from(n.registry.values()).some(e=>t===e.protocol)){s=!0;break}return this.outbound.set(r.id.toB58String(),s),r}_removePeer(e){const t=super._removePeer(e),r=e.toB58String();for(const s of this.mesh.values())s.delete(r);for(const s of this.fanout.values())s.delete(r);return this.gossip.delete(r),this.control.delete(r),this.outbound.delete(r),this.score.removePeer(r),t}_processRpc(e,t,r){return!!super._processRpc(e,t,r)&&(r.control&&this._processRpcControlMessage(e,r.control),!0)}_processRpcControlMessage(e,t){if(!t)return;const r=t.ihave?this._handleIHave(e,t.ihave):[],s=t.iwant?this._handleIWant(e,t.iwant):[],n=t.graft?this._handleGraft(e,t.graft):[];if(t.prune&&this._handlePrune(e,t.prune),!r.length&&!s.length&&!n.length)return;const i=p.createGossipRpc(s,{iwant:r,prune:n});this._sendRpc(e,i)}_processRpcMessage(e){const t=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return o(this,void 0,void 0,(function*(){const r=this.getMsgId(e),s=p.messageIdToString(r);this.seenCache.has(s)?this.score.duplicateMessage(e):(this.seenCache.put(s),this.score.validateMessage(e),yield t._processRpcMessage.call(this,e))}))}_acceptFrom(e){return this.direct.has(e)||this.score.score(e)>=this._options.scoreThresholds.graylistThreshold}validate(e){const t=Object.create(null,{validate:{get:()=>super.validate}});return o(this,void 0,void 0,(function*(){try{yield t.validate.call(this,e)}catch(r){throw this.score.rejectMessage(e,r.code),this.gossipTracer.rejectMessage(e,r.code),r}}))}_handleIHave(e,t){if(!t.length)return[];const r=this.score.score(e);if(r<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,r),[];const s=(this.peerhave.get(e)||0)+1;if(this.peerhave.set(e,s),s>l.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,s),[];const n=this.iasked.get(e)||0;if(n>=l.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,n),[];const i=new Map;if(t.forEach(({topicID:e,messageIDs:t})=>{e&&t&&this.mesh.has(e)&&t.forEach(e=>{const t=p.messageIdToString(e);this.seenCache.has(t)||i.set(t,e)})}),!i.size)return[];let o=i.size;o+n>l.GossipsubMaxIHaveLength&&(o=l.GossipsubMaxIHaveLength-n),this.log("IHAVE: Asking for %d out of %d messages from %s",o,i.size,e);let a=Array.from(i.values());return p.shuffle(a),a=a.slice(0,o),this.iasked.set(e,n+o),this.gossipTracer.addPromise(e,a),[{messageIDs:a}]}_handleIWant(e,t){if(!t.length)return[];const r=this.score.score(e);if(r<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,r),[];const s=new Map;return t.forEach(({messageIDs:t})=>{t&&t.forEach(t=>{const[r,n]=this.messageCache.getForPeer(t,e);r&&(n>l.GossipsubGossipRetransmission?this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,t):s.set(p.messageIdToString(t),r))})}),s.size?(this.log("IWANT: Sending %d messages to %s",s.size,e),Array.from(s.values()).map(a.utils.normalizeOutRpcMessage)):[]}_handleGraft(e,t){const r=[],s=this.score.score(e),n=this._now();let i=this._options.doPX;return t.forEach(({topicID:t})=>{var o;if(!t)return;const a=this.mesh.get(t);if(!a)return void(i=!1);if(a.has(e))return;if(this.direct.has(e))return this.log("GRAFT: ignoring request from direct peer %s",e),r.push(t),void(i=!1);const c=null===(o=this.backoff.get(t))||void 0===o?void 0:o.get(e);if("number"===typeof c&&n<c){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1),i=!1;const s=c+l.GossipsubGraftFloodThreshold-l.GossipsubPruneBackoff;return n<s&&this.score.addPenalty(e,1),this._addBackoff(e,t),void r.push(t)}return s<0?(this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,s,t),r.push(t),i=!1,void this._addBackoff(e,t)):a.size>=this._options.Dhi&&!this.outbound.get(e)?(r.push(t),void this._addBackoff(e,t)):(this.log("GRAFT: Add mesh link from %s in %s",e,t),this.score.graft(e,t),void a.add(e))}),r.length?r.map(t=>this._makePrune(e,t,i)):[]}_handlePrune(e,t){const r=this.score.score(e);t.forEach(({topicID:t,backoff:s,peers:n})=>{if(!t)return;const i=this.mesh.get(t);if(i&&(this.log("PRUNE: Remove mesh link to %s in %s",e,t),this.score.prune(e,t),i.delete(e),"number"===typeof s&&s>0?this._doAddBackoff(e,t,1e3*s):this._addBackoff(e,t),n&&n.length)){if(r<this._options.scoreThresholds.acceptPXThreshold)return void this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,r,t);this._pxConnect(n)}})}_addBackoff(e,t){this._doAddBackoff(e,t,l.GossipsubPruneBackoff)}_doAddBackoff(e,t,r){let s=this.backoff.get(t);s||(s=new Map,this.backoff.set(t,s));const n=this._now()+r,i=s.get(e)||0;i<n&&s.set(e,n)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e)})}_clearBackoff(){if(this.heartbeatTicks%l.GossipsubPruneBackoffTicks!==0)return;const e=this._now();this.backoff.forEach((t,r)=>{t.forEach((r,s)=>{r<e&&t.delete(s)}),0===t.size&&this.backoff.delete(r)})}_directConnect(){if(this.heartbeatTicks%l.GossipsubDirectConnectTicks!==0)return;const e=[];this.direct.forEach(t=>{const r=this.peers.get(t);r&&r.isWritable||e.push(t)}),e.length&&e.forEach(e=>{this._connect(e)})}_pxConnect(e){return o(this,void 0,void 0,(function*(){e.length>l.GossipsubPrunePeers&&(p.shuffle(e),e=e.slice(0,l.GossipsubPrunePeers));const t=[];yield Promise.all(e.map(e=>o(this,void 0,void 0,(function*(){if(!e.peerID)return;const r=b.createFromBytes(e.peerID),s=r.toB58String();if(!this.peers.has(s))if(e.signedPeerRecord)try{const r=yield m.openAndCertify(e.signedPeerRecord,"libp2p-peer-record"),n=r.peerId.toB58String();if(s!==n)return void this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",n,s);if(!this._libp2p.peerStore.addressBook.consumePeerRecord(r))return void this.log("bogus peer record obtained through px: could not add peer record to address book");t.push(s)}catch(n){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}else t.push(s)})))),t.length&&t.forEach(e=>this._connect(e))}))}start(){super.start(),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(e=>{this._connect(e)})},l.GossipsubDirectConnectInitialDelay)}stop(){super.stop(),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),clearTimeout(this._directPeerInitial)}_connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol(b.createFromB58String(e),this.multicodecs)}subscribe(e){super.subscribe(e),this.join(e)}unsubscribe(e){super.unsubscribe(e),this.leave(e)}join(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",e);const t=this.fanout.get(e);if(t)t.forEach(e=>{this.score.score(e)<0&&t.delete(e)}),t.size<this._options.D&&h.getGossipPeers(this,e,this._options.D-t.size,e=>!t.has(e)&&!this.direct.has(e)&&this.score.score(e)>=0).forEach(e=>t.add(e)),this.mesh.set(e,t),this.fanout.delete(e),this.lastpub.delete(e);else{const t=h.getGossipPeers(this,e,this._options.D,e=>!this.direct.has(e)&&this.score.score(e)>=0);this.mesh.set(e,t)}this.mesh.get(e).forEach(t=>{this.log("JOIN: Add mesh link to %s in %s",t,e),this._sendGraft(t,e)})}leave(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e);const t=this.mesh.get(e);t&&(t.forEach(t=>{this.log("LEAVE: Remove mesh link to %s in %s",t,e),this._sendPrune(t,e)}),this.mesh.delete(e))}_publish(e){return o(this,void 0,void 0,(function*(){e.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(e),this.gossipTracer.deliverMessage(e));const t=this.getMsgId(e),r=p.messageIdToString(t);this.seenCache.put(r),this.messageCache.put(e);const s=new Set;e.topicIDs.forEach(t=>{const r=this.topics.get(t);if(r)if(this._options.floodPublish&&e.from===this.peerId.toB58String())r.forEach(e=>{(this.direct.has(e)||this.score.score(e)>=this._options.scoreThresholds.publishThreshold)&&s.add(e)});else{this.direct.forEach(e=>{s.add(e)}),r.forEach(e=>{const t=this.score.score(e),r=this.peers.get(e);r&&r.protocol===l.FloodsubID&&t>=this._options.scoreThresholds.publishThreshold&&s.add(e)});let e=this.mesh.get(t);if(!e||!e.size){if(e=this.fanout.get(t),!e){const r=h.getGossipPeers(this,t,this._options.D,e=>this.score.score(e)>=this._options.scoreThresholds.publishThreshold);r.size>0?(e=r,this.fanout.set(t,r)):e=new Set}this.lastpub.set(t,this._now())}e.forEach(e=>{s.add(e)})}});const n=p.createGossipRpc([a.utils.normalizeOutRpcMessage(e)]);s.forEach(t=>{t!==e.from&&this._sendRpc(t,n)})}))}_sendGraft(e,t){const r=[{topicID:t}],s=p.createGossipRpc([],{graft:r});this._sendRpc(e,s)}_sendPrune(e,t){const r=[this._makePrune(e,t,this._options.doPX)],s=p.createGossipRpc([],{prune:r});this._sendRpc(e,s)}_sendRpc(e,t){const r=this.peers.get(e);if(!r||!r.isWritable)return;const s=this.control.get(e);s&&(this._piggybackControl(e,t,s),this.control.delete(e));const n=this.gossip.get(e);n&&(this._piggybackGossip(e,t,n),this.gossip.delete(e)),r.write(u.RPC.encode(t).finish())}_piggybackControl(e,t,r){const s=(r.graft||[]).filter(({topicID:t})=>(t&&this.mesh.get(t)||new Set).has(e)),n=(r.prune||[]).filter(({topicID:t})=>!(t&&this.mesh.get(t)||new Set).has(e));(s.length||n.length)&&(t.control?(t.control.graft=t.control.graft&&t.control.graft.concat(s),t.control.prune=t.control.prune&&t.control.prune.concat(n)):t.control={ihave:[],iwant:[],graft:s,prune:n})}_piggybackGossip(e,t,r){t.control||(t.control={ihave:[],iwant:[],graft:[],prune:[]}),t.control.ihave=r}_sendGraftPrune(e,t,r){const s=this._options.doPX;for(const[n,i]of e){const e=i.map(e=>({topicID:e}));let o=[];const a=t.get(n);a&&(o=a.map(e=>this._makePrune(n,e,s&&!r.get(n))),t.delete(n));const c=p.createGossipRpc([],{graft:e,prune:o});this._sendRpc(n,c)}for(const[n,i]of t){const e=i.map(e=>this._makePrune(n,e,s&&!r.get(n))),t=p.createGossipRpc([],{prune:e});this._sendRpc(n,t)}}_emitGossip(e,t){const r=this.messageCache.getGossipIDs(e);if(!r.length)return;p.shuffle(r),r.length>l.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",r.length);const s=[],n=this.topics.get(e);if(!n)return;n.forEach(e=>{const r=this.peers.get(e);r&&!t.has(e)&&!this.direct.has(e)&&p.hasGossipProtocol(r.protocol)&&this.score.score(e)>=this._options.scoreThresholds.gossipThreshold&&s.push(e)});let i=this._options.Dlazy;const o=l.GossipsubGossipFactor*s.length;o>i&&(i=o),i>s.length?i=s.length:p.shuffle(s),s.slice(0,i).forEach(t=>{let s=r;r.length>l.GossipsubMaxIHaveLength&&(s=p.shuffle(s.slice()).slice(0,l.GossipsubMaxIHaveLength)),this._pushGossip(t,{topicID:e,messageIDs:s})})}_flush(){for(const[e,t]of this.gossip.entries()){this.gossip.delete(e);const r=p.createGossipRpc([],{ihave:t});this._sendRpc(e,r)}for(const[e,t]of this.control.entries()){this.control.delete(e);const r=p.createGossipRpc([],{graft:t.graft,prune:t.prune});this._sendRpc(e,r)}}_pushGossip(e,t){this.log("Add gossip to %s",e);const r=this.gossip.get(e)||[];this.gossip.set(e,r.concat(t))}_now(){return Date.now()}_makePrune(e,t,r){if(this.peers.get(e).protocol===l.GossipsubIDv10)return{topicID:t,peers:[]};const s=l.GossipsubPruneBackoff/1e3,n=[];if(r){const r=h.getGossipPeers(this,t,l.GossipsubPrunePeers,t=>t!==e&&this.score.score(t)>=0);r.forEach(e=>{const t=b.createFromB58String(e);n.push({peerID:t.toBytes(),signedPeerRecord:this._libp2p.peerStore.addressBook.getRawEnvelope(t)})})}return{topicID:t,peers:n,backoff:s}}}w.multicodec=l.GossipsubIDv11,e.exports=w},"2f54":function(e,t,r){"use strict";const{DAGNode:s}=r("8141"),n=r("5d98"),i=r("0e80").multihash,{UnixFS:o}=r("9fd0"),a=r("a29d");e.exports=({ipld:e,preload:t})=>{async function r(r={}){let a;if(r.template){if("unixfs-dir"!==r.template)throw new Error("unknown template");a=new o({type:"directory"}).marshal()}else a=new Uint8Array(0);const c=new s(a),u=await e.put(c,n.DAG_PB,{cidVersion:0,hashAlg:i.names["sha2-256"],signal:r.signal});return!1!==r.preload&&t(u),u}return a(r)}},"2f67":function(e,t,r){"use strict";const s=r("a29d"),{Multiaddr:n}=r("2054");e.exports=({repo:e})=>{async function t(t={}){const r=await e.config.getAll(t),s=r.Bootstrap||[];return r.Bootstrap=[],await e.config.replace(r),{Peers:s.map(e=>new n(e))}}return s(t)}},"2fd4":function(e,t){function r(e,t,r){var s=null,n=null,i=function(){s&&(clearTimeout(s),n=null,s=null)},o=function(){var e=n;i(),e&&e()},a=function(){if(!t)return e.apply(this,arguments);var o=this,a=arguments,c=r&&!s;return i(),n=function(){e.apply(o,a)},s=setTimeout((function(){if(s=null,!c){var e=n;return n=null,e()}}),t),c?n():void 0};return a.cancel=i,a.flush=o,a}e.exports=r},30:function(e,t){},3128:function(e,t,r){"use strict";(function(t){const s=r("aef6"),n=r("335d"),i=r("354e"),o=r("0ad6"),a=r("5268"),c=r("c449"),u=r("b6aa");function l(e){return{open(){return e.open()},query(t,r){return e.query(t,r)},queryKeys(t,r){return e.queryKeys(t,r)},async get(t,r){const n=d(t);return n.isIdentity?Promise.resolve(new s(n.digest,t)):e.get(t,r)},async*getMany(e,t){for await(const r of e)yield this.get(r,t)},async put(t,r){const{isIdentity:s}=d(t.cid);return s?Promise.resolve(t):e.put(t,r)},async*putMany(r,s){const n=o(),i=t&&t.nextTick?t.nextTick:setImmediate;i(async()=>{try{await a(e.putMany(async function*(){for await(const e of r)d(e.cid).isIdentity||(yield e),n.push(e)}())),n.end()}catch(t){n.end(t)}}),yield*n},has(t,r){const{isIdentity:s}=d(t);return s?Promise.resolve(!0):e.has(t,r)},delete(t,r){const{isIdentity:s}=d(t);return s?Promise.resolve():e.delete(t,r)},deleteMany(t,r){return e.deleteMany(n(t,e=>!d(e).isIdentity),r)},close(){return e.close()}}}function d(e){if(!c.isCID(e))throw u(new Error("Not a valid cid"),"ERR_INVALID_CID");const t=i.decode(e.multihash);return"identity"!==t.name?{isIdentity:!1}:{isIdentity:!0,digest:t.digest}}e.exports=l}).call(this,r("4362"))},"312c":function(e,t,r){"use strict";t.Diagnose=r("1fdc"),t.Decoder=r("a1c8"),t.Encoder=r("4442"),t.Simple=r("5be1"),t.Tagged=r("0bac"),t.decodeAll=t.Decoder.decodeAll,t.decodeFirst=t.Decoder.decodeFirst,t.diagnose=t.Diagnose.diagnose,t.encode=t.Encoder.encode,t.decode=t.Decoder.decode,t.leveldb={decode:t.Decoder.decodeAll,encode:t.Encoder.encode,buffer:!0,name:"cbor"}},3184:function(e,t,r){"use strict";e.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32}},"31a1":function(e,t,r){"use strict";const s=r("4fcb").bind({ignoreUndefined:!0}),n=r("0e80");async function i(e){const t=await n(e,"murmur3-128"),r=t.slice(2,10),s=r.length,i=new Uint8Array(s);for(let n=0;n<s;n++)i[s-n-1]=r[n];return i}const o={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hashAlg:"sha2-256",leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:0x3df305dfb2a804,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,pin:!1,recursive:!1,hidden:!1,preload:!1,timeout:void 0,hamtHashFn:i,hamtHashCode:34,hamtBucketBits:8};e.exports=function(e={}){return s(o,e)}},"31e1":function(e,t,r){"use strict";const s=-8,n=-4,i=0,o=1,a=1,c=2,u=5,l=1024,d=2048,h=8192,p=0,f=4,y=8,g=12,b=12,m=16,w="undefined"!==typeof BigUint64Array,_=Symbol(),E=1024;function v(e,t){const r=new Uint32Array(e),s=new Uint16Array(e);var i=r[t+n>>>2]>>>1,o=t>>>1;if(i<=E)return String.fromCharCode.apply(String,s.subarray(o,o+i));const a=[];do{const e=s[o+E-1],t=e>=55296&&e<56320?E-1:E;a.push(String.fromCharCode.apply(String,s.subarray(o,o+=t))),i-=t}while(i>E);return a.join("")+String.fromCharCode.apply(String,s.subarray(o,o+i))}function S(e){const t={};function r(e,t){return e?v(e.buffer,t):"<yet unknown>"}const s=e.env=e.env||{};return s.abort=s.abort||function(e,n,i,o){const a=t.memory||s.memory;throw Error("abort: "+r(a,e)+" at "+r(a,n)+":"+i+":"+o)},s.trace=s.trace||function(e,n){const i=t.memory||s.memory;console.log("trace: "+r(i,e)+(n?" ":"")+Array.prototype.slice.call(arguments,2,2+n).join(", "))},e.Math=e.Math||Math,e.Date=e.Date||Date,t}function I(e,t){const r=t.exports,_=r.memory,E=r.table,S=r["__alloc"],I=r["__retain"],A=r["__rtti_base"]||-1;function R(e){const t=new Uint32Array(_.buffer),r=t[A>>>2];if((e>>>=0)>=r)throw Error("invalid id: "+e);return t[(A+4>>>2)+2*e]}function T(e){const t=new Uint32Array(_.buffer),r=t[A>>>2];if((e>>>=0)>=r)throw Error("invalid id: "+e);return t[(A+4>>>2)+2*e+1]}function k(e){return 31-Math.clz32(e>>>u&31)}function O(e){const t=e.length,r=S(t<<1,o),s=new Uint16Array(_.buffer);for(var n=0,i=r>>>1;n<t;++n)s[i+n]=e.charCodeAt(n);return r}function N(e){const t=_.buffer,r=new Uint32Array(t)[e+s>>>2];if(r!==o)throw Error("not a string: "+e);return v(t,e)}function D(e,t,r){const s=_.buffer;if(r)switch(e){case 2:return new Float32Array(s);case 3:return new Float64Array(s)}else switch(e){case 0:return new(t?Int8Array:Uint8Array)(s);case 1:return new(t?Int16Array:Uint16Array)(s);case 2:return new(t?Int32Array:Uint32Array)(s);case 3:return new(t?BigInt64Array:BigUint64Array)(s)}throw Error("unsupported align: "+e)}function C(e,t){const r=R(e);if(!(r&(a|c)))throw Error("not an array: "+e+" @ "+r);const s=k(r),n=t.length,o=S(n<<s,i),u=S(r&c?m:g,e),w=new Uint32Array(_.buffer);w[u+p>>>2]=I(o),w[u+f>>>2]=o,w[u+y>>>2]=n<<s,r&c&&(w[u+b>>>2]=n);const E=D(s,r&l,r&d);if(r&h)for(let i=0;i<n;++i)E[(o>>>s)+i]=I(t[i]);else E.set(t,o>>>s);return u}function x(e){const t=new Uint32Array(_.buffer),r=t[e+s>>>2],i=R(r);if(!(i&a))throw Error("not an array: "+r);const o=k(i);var u=t[e+f>>>2];const h=i&c?t[e+b>>>2]:t[u+n>>>2]>>>o;return D(o,i&l,i&d).subarray(u>>>=o,u+h)}function L(e){const t=x(e),r=t.length,s=new Array(r);for(let n=0;n<r;n++)s[n]=t[n];return s}function M(e){const t=_.buffer,r=new Uint32Array(t)[e+n>>>2];return t.slice(e,e+r)}function B(e,t,r){return new e(U(e,t,r))}function U(e,t,r){const s=_.buffer,i=new Uint32Array(s),o=i[r+f>>>2];return new e(s,o,i[o+n>>>2]>>>t)}function j(e,t){const r=new Uint32Array(_.buffer);var n=r[e+s>>>2];if(n<=r[A>>>2])do{if(n==t)return!0}while(n=T(n));return!1}return e.__allocString=O,e.__getString=N,e.__allocArray=C,e.__getArrayView=x,e.__getArray=L,e.__getArrayBuffer=M,e.__getInt8Array=B.bind(null,Int8Array,0),e.__getInt8ArrayView=U.bind(null,Int8Array,0),e.__getUint8Array=B.bind(null,Uint8Array,0),e.__getUint8ArrayView=U.bind(null,Uint8Array,0),e.__getUint8ClampedArray=B.bind(null,Uint8ClampedArray,0),e.__getUint8ClampedArrayView=U.bind(null,Uint8ClampedArray,0),e.__getInt16Array=B.bind(null,Int16Array,1),e.__getInt16ArrayView=U.bind(null,Int16Array,1),e.__getUint16Array=B.bind(null,Uint16Array,1),e.__getUint16ArrayView=U.bind(null,Uint16Array,1),e.__getInt32Array=B.bind(null,Int32Array,2),e.__getInt32ArrayView=U.bind(null,Int32Array,2),e.__getUint32Array=B.bind(null,Uint32Array,2),e.__getUint32ArrayView=U.bind(null,Uint32Array,2),w&&(e.__getInt64Array=B.bind(null,BigInt64Array,3),e.__getInt64ArrayView=U.bind(null,BigInt64Array,3),e.__getUint64Array=B.bind(null,BigUint64Array,3),e.__getUint64ArrayView=U.bind(null,BigUint64Array,3)),e.__getFloat32Array=B.bind(null,Float32Array,2),e.__getFloat32ArrayView=U.bind(null,Float32Array,2),e.__getFloat64Array=B.bind(null,Float64Array,3),e.__getFloat64ArrayView=U.bind(null,Float64Array,3),e.__instanceof=j,e.memory=e.memory||_,e.table=e.table||E,P(r,e)}function A(e){return"undefined"!==typeof Response&&e instanceof Response}async function R(e,t){return A(e=await e)?k(e,t):I(S(t||(t={})),await WebAssembly.instantiate(e instanceof WebAssembly.Module?e:await WebAssembly.compile(e),t))}function T(e,t){return I(S(t||(t={})),new WebAssembly.Instance(e instanceof WebAssembly.Module?e:new WebAssembly.Module(e),t))}async function k(e,t){return WebAssembly.instantiateStreaming?I(S(t||(t={})),(await WebAssembly.instantiateStreaming(e,t)).instance):R(A(e=await e)?e.arrayBuffer():e,t)}function P(e,t){var r=t?Object.create(t):{},s=e["__argumentsLength"]?function(t){e["__argumentsLength"].value=t}:e["__setArgumentsLength"]||e["__setargc"]||function(){};for(let n in e){if(!Object.prototype.hasOwnProperty.call(e,n))continue;const t=e[n];let i=n.split("."),o=r;while(i.length>1){let e=i.shift();Object.prototype.hasOwnProperty.call(o,e)||(o[e]={}),o=o[e]}let a=i[0],c=a.indexOf("#");if(c>=0){let r=a.substring(0,c),i=o[r];if("undefined"===typeof i||!i.prototype){let e=function(...t){return e.wrap(e.prototype.constructor(0,...t))};e.prototype={valueOf:function(){return this[_]}},e.wrap=function(t){return Object.create(e.prototype,{[_]:{value:t,writable:!1}})},i&&Object.getOwnPropertyNames(i).forEach(t=>Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))),o[r]=e}if(a=a.substring(c+1),o=o[r].prototype,/^(get|set):/.test(a)){if(!Object.prototype.hasOwnProperty.call(o,a=a.substring(4))){let t=e[n.replace("set:","get:")],r=e[n.replace("get:","set:")];Object.defineProperty(o,a,{get:function(){return t(this[_])},set:function(e){r(this[_],e)},enumerable:!0})}}else"constructor"===a?(o[a]=(...e)=>(s(e.length),t(...e))).original=t:(o[a]=function(...e){return s(e.length),t(this[_],...e)}).original=t}else/^(get|set):/.test(a)?Object.prototype.hasOwnProperty.call(o,a=a.substring(4))||Object.defineProperty(o,a,{get:e[n.replace("set:","get:")],set:e[n.replace("get:","set:")],enumerable:!0}):"function"===typeof t&&t!==s?(o[a]=(...e)=>(s(e.length),t(...e))).original=t:o[a]=t}return r}t.instantiate=R,t.instantiateSync=T,t.instantiateStreaming=k,t.demangle=P},"335d":function(e,t,r){"use strict";const s=async function*(e,t){for await(const r of e)await t(r)&&(yield r)};e.exports=s},"33a3":function(e,t,r){"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?e.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:e.exports={default:r("8801").default,Headers:r("8801").Headers,Request:r("8801").Request,Response:r("8801").Response}},"345f":function(e,t,r){e.exports={encode:r("a56b"),decode:r("c9f3"),encodingLength:r("b98d")}},"355c":function(e,t,r){"use strict";const s=r("7de6"),n=r("179e"),i=r("42a0"),o=r("4be0"),a=r("190a");class c{constructor({preload:e,gcLock:t,pin:r,block:c,ipld:u,options:l}){const d=n({preload:e,gcLock:t,block:c,pin:r,options:l});this.addAll=d,this.add=s({addAll:d}),this.cat=i({ipld:u,preload:e}),this.get=o({ipld:u,preload:e}),this.ls=a({ipld:u,preload:e})}}e.exports=c},3591:function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p"),{error:s("libp2p:err")}),{EventEmitter:i}=r("faa1"),o=r("b6aa"),a=r("eddf"),{Multiaddr:c}=r("2054"),u=r("063c"),l=r("6d1f"),d=r("08c7"),{validate:h}=r("bd3b"),{codes:p,messages:f}=r("b73a"),y=r("e6bd"),g=r("1771"),b=r("6887"),m=r("b5c5"),w=r("9c22"),_=r("91cd"),E=r("baa5"),v=r("9edf"),S=r("246c"),I=r("d04a"),A=r("eaeb"),R=r("602b"),T=r("d06b"),k=r("d9a75"),P=r("713e"),O=P.multicodecs,N=r("b97b"),{updateSelfPeerRecord:D}=r("3eaf");class C extends i{static async create(e){if(e.peerId)return new C(e);const t=await a.create();return e.peerId=t,new C(e)}constructor(e){if(super(),this._options=h(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this.peerStore=this.datastore&&this._options.peerStore.persistence?new R({peerId:this.peerId,datastore:this.datastore,...this._options.peerStore}):new I({peerId:this.peerId}),this.addresses=this._options.addresses,this.addressManager=new y(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{D(this).catch(e=>{n.error("Error updating self peer record",e)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new g(this,{autoDial:this._config.peerDiscovery.autoDial,...this._options.connectionManager}),this._options.metrics.enabled&&(this.metrics=new E({...this._options.metrics,connectionManager:this.connectionManager})),this._options.keychain&&this._options.keychain.datastore){n("creating keychain");const e=_.generateOptions();this.keychain=new _(this._options.keychain.datastore,{...e,...this._options.keychain}),n("keychain constructed")}if(this.upgrader=new S({localPeer:this.peerId,metrics:this.metrics,onConnection:e=>this.connectionManager.onConnect(e),onConnectionEnd:e=>this.connectionManager.onDisconnect(e)}),this.transportManager=new v({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new N({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new T({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw o(new Error(f.CONN_ENCRYPTION_REQUIRED),p.CONN_ENCRYPTION_REQUIRED);const t=this._modules.connEncryption;if(t.forEach(e=>{this.upgrader.cryptos.set(e.protocol,e)}),this.dialer=new w({transportManager:this.transportManager,peerStore:this.peerStore,...this._options.dialer}),this._modules.transport.forEach(e=>{const t=e.prototype[Symbol.toStringTag],r=this._config.transport[t];this.transportManager.add(t,e,r)}),this._config.relay.enabled&&(this.transportManager.add(b.prototype[Symbol.toStringTag],b),this.relay=new m(this)),this._modules.streamMuxer){const e=this._modules.streamMuxer;e.forEach(e=>{this.upgrader.muxers.set(e.multicodec,e)}),this.identifyService=new P({libp2p:this}),this.handle(Object.values(O),this.identifyService.handleMessage)}if(this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(void 0!==globalThis.process&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){const e=this._modules.dht;this._dht=new e({libp2p:this,dialer:this.dialer,peerId:this.peerId,peerStore:this.peerStore,registrar:this.registrar,datastore:this.datastore,...this._config.dht})}if(this._modules.pubsub){const e=this._modules.pubsub;this.pubsub=A(e,this,this._config.pubsub)}this.peerRouting=new u(this),this.contentRouting=new l(this),k.mount(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this)}emit(e,...t){return"error"!==e||this._events.error?super.emit(e,...t):(n.error(t),!1)}async start(){n("libp2p is starting");try{await this._onStarting(),await this._onDidStart(),n("libp2p has started")}catch(e){throw this.emit("error",e),n.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){n("libp2p is stopping");try{this._isStarted=!1,this.relay&&this.relay.stop(),this.peerRouting.stop();for(const e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.peerStore.stop(),await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this._dht&&this._dht.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),k.unmount(this),this.dialer.destroy()}catch(e){e&&(n.error(e),this.emit("error",e))}n("libp2p has stopped")}async loadKeychain(){if(this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,t){return this._dial(e,t)}async dialProtocol(e,t,r){if(!t||!t.length)throw o(new Error("no protocols were provided to open a stream"),p.ERR_INVALID_PROTOCOLS_FOR_STREAM);const s=await this._dial(e,r);return s.newStream(t)}async _dial(e,t){const{id:r,multiaddrs:s}=d(e);if(r.equals(this.peerId))throw o(new Error("Cannot dial self"),p.ERR_DIALED_SELF);let n=this.connectionManager.get(r);return n?s&&this.peerStore.addressBook.add(r,s):n=await this.dialer.connectToPeer(e,t),n}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(e=>e.toString());e.length||(e=this.transportManager.getAddrs().map(e=>e.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(e=>e.toString()));const t=this._options.addresses.announceFilter,r=new Set(e);return t(Array.from(r).map(e=>new c(e)))}async hangUp(e){const{id:t}=d(e),r=this.connectionManager.connections.get(t.toB58String());r&&await Promise.all(r.map(e=>e.close()))}ping(e){const{id:t,multiaddrs:r}=d(e);return k(this,r?r[0]:t)}handle(e,t){e=Array.isArray(e)?e:[e],e.forEach(e=>{this.upgrader.protocols.set(e,t)}),this.peerStore.protoBook.add(this.peerId,e)}unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(e=>{this.upgrader.protocols.delete(e)}),this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){const e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),await this.peerStore.start(),this._config.pubsub.enabled&&this.pubsub&&this.pubsub.start(),this._config.dht.enabled&&(this._dht&&this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e)});for(const e of this.peerStore.peers.values())this.emit("peer:discovery",e.id);this.connectionManager.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){e.id.toB58String()!==this.peerId.toB58String()?(e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols)):n.error(new Error(p.ERR_DISCOVERED_SELF))}async _maybeConnect(e){if(!0===this._config.peerDiscovery.autoDial&&!this.connectionManager.get(e)){const r=this._options.connectionManager.minConnections||0;if(r>this.connectionManager.size){n("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(t){n.error(`could not connect to discovered peer ${e.toB58String()} with ${t}`)}}}}async _setupPeerDiscovery(){const e=e=>{let t={enabled:!0};if(e.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[e.tag]&&(t={...t,...this._config.peerDiscovery[e.tag]}),t.enabled&&!this._discovery.has(e.tag)){let r;r="function"===typeof e?new e(Object.assign({},t,{peerId:this.peerId,libp2p:this})):e,r.on("peer",this._onDiscoveryPeer),this._discovery.set(e.tag,r)}};for(const t of this._modules.peerDiscovery||[])e(t);for(const t of this.transportManager.getTransports())t.discovery&&e(t.discovery);await Promise.all(Array.from(this._discovery.values(),e=>e.start()))}}e.exports=C},3642:function(e,t,r){"use strict";e.exports=e=>{if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}},"36be":function(e,t,r){!function(t,r){e.exports=function(e,t,r,s,n){for(t=t.split?t.split("."):t,s=0;s<t.length;s++)e=e?e[t[s]]:n;return e===n?r:e}}()},"3768d":function(e,t,r){"use strict";const{resolvePath:s}=r("4d04"),n=r("d507"),{PinTypes:i}=n,o=r("a29d"),a=r("e4e8");e.exports=({pinManager:e,gcLock:t,ipld:r})=>{async function*n(n,o={}){const c=async function*(){for await(const{path:t,recursive:o,metadata:c}of a(n)){const n=await s(r,t),{reason:a}=await e.isPinnedWithType(n,[i.recursive,i.direct]);if("recursive"===a&&!o)throw new Error(n+" already pinned recursively");o?await e.pinRecursively(n,{metadata:c}):await e.pinDirectly(n,{metadata:c}),yield n}},u=Boolean(o.lock);if(!u)return void(yield*c());const l=await t.readLock();try{yield*c()}finally{l()}}return o(n)}},3792:function(e,t,r){"use strict";const s=r("8141"),n=r("a29d");e.exports=({ipld:e,preload:t})=>{const i=r("69d3")({ipld:e,preload:t});async function o(e,t={}){const r=await i(e,t),n=s.util.serialize(r),o=await s.util.cid(n,{cidVersion:0}),a=n.length,c=r.Links.reduce((e,t)=>e+t.Tsize,0);return{Hash:o.toBaseEncodedString(),NumLinks:r.Links.length,BlockSize:a,LinksSize:a-r.Data.length,DataSize:r.Data.length,CumulativeSize:a+c}}return n(o)}},3824:function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["ipfs-bitswap"]||(s.roots["ipfs-bitswap"]={});a.Message=function(){function e(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.wantlist=null,e.prototype.blocks=o.emptyArray,e.prototype.payload=o.emptyArray,e.prototype.blockPresences=o.emptyArray,e.prototype.pendingBytes=0,e.encode=function(e,t){if(t||(t=i.create()),null!=e.wantlist&&Object.hasOwnProperty.call(e,"wantlist")&&a.Message.Wantlist.encode(e.wantlist,t.uint32(10).fork()).ldelim(),null!=e.blocks&&e.blocks.length)for(var r=0;r<e.blocks.length;++r)t.uint32(18).bytes(e.blocks[r]);if(null!=e.payload&&e.payload.length)for(r=0;r<e.payload.length;++r)a.Message.Block.encode(e.payload[r],t.uint32(26).fork()).ldelim();if(null!=e.blockPresences&&e.blockPresences.length)for(r=0;r<e.blockPresences.length;++r)a.Message.BlockPresence.encode(e.blockPresences[r],t.uint32(34).fork()).ldelim();return null!=e.pendingBytes&&Object.hasOwnProperty.call(e,"pendingBytes")&&t.uint32(40).int32(e.pendingBytes),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Message;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.wantlist=a.Message.Wantlist.decode(e,e.uint32());break;case 2:s.blocks&&s.blocks.length||(s.blocks=[]),s.blocks.push(e.bytes());break;case 3:s.payload&&s.payload.length||(s.payload=[]),s.payload.push(a.Message.Block.decode(e,e.uint32()));break;case 4:s.blockPresences&&s.blockPresences.length||(s.blockPresences=[]),s.blockPresences.push(a.Message.BlockPresence.decode(e,e.uint32()));break;case 5:s.pendingBytes=e.int32();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Message)return e;var t=new a.Message;if(null!=e.wantlist){if("object"!==typeof e.wantlist)throw TypeError(".Message.wantlist: object expected");t.wantlist=a.Message.Wantlist.fromObject(e.wantlist)}if(e.blocks){if(!Array.isArray(e.blocks))throw TypeError(".Message.blocks: array expected");t.blocks=[];for(var r=0;r<e.blocks.length;++r)"string"===typeof e.blocks[r]?o.base64.decode(e.blocks[r],t.blocks[r]=o.newBuffer(o.base64.length(e.blocks[r])),0):e.blocks[r].length&&(t.blocks[r]=e.blocks[r])}if(e.payload){if(!Array.isArray(e.payload))throw TypeError(".Message.payload: array expected");t.payload=[];for(r=0;r<e.payload.length;++r){if("object"!==typeof e.payload[r])throw TypeError(".Message.payload: object expected");t.payload[r]=a.Message.Block.fromObject(e.payload[r])}}if(e.blockPresences){if(!Array.isArray(e.blockPresences))throw TypeError(".Message.blockPresences: array expected");t.blockPresences=[];for(r=0;r<e.blockPresences.length;++r){if("object"!==typeof e.blockPresences[r])throw TypeError(".Message.blockPresences: object expected");t.blockPresences[r]=a.Message.BlockPresence.fromObject(e.blockPresences[r])}}return null!=e.pendingBytes&&(t.pendingBytes=0|e.pendingBytes),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.blocks=[],r.payload=[],r.blockPresences=[]),t.defaults&&(r.wantlist=null,r.pendingBytes=0),null!=e.wantlist&&e.hasOwnProperty("wantlist")&&(r.wantlist=a.Message.Wantlist.toObject(e.wantlist,t)),e.blocks&&e.blocks.length){r.blocks=[];for(var s=0;s<e.blocks.length;++s)r.blocks[s]=t.bytes===String?o.base64.encode(e.blocks[s],0,e.blocks[s].length):t.bytes===Array?Array.prototype.slice.call(e.blocks[s]):e.blocks[s]}if(e.payload&&e.payload.length){r.payload=[];for(s=0;s<e.payload.length;++s)r.payload[s]=a.Message.Block.toObject(e.payload[s],t)}if(e.blockPresences&&e.blockPresences.length){r.blockPresences=[];for(s=0;s<e.blockPresences.length;++s)r.blockPresences[s]=a.Message.BlockPresence.toObject(e.blockPresences[s],t)}return null!=e.pendingBytes&&e.hasOwnProperty("pendingBytes")&&(r.pendingBytes=e.pendingBytes),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.Wantlist=function(){function e(e){if(this.entries=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.entries=o.emptyArray,e.prototype.full=!1,e.encode=function(e,t){if(t||(t=i.create()),null!=e.entries&&e.entries.length)for(var r=0;r<e.entries.length;++r)a.Message.Wantlist.Entry.encode(e.entries[r],t.uint32(10).fork()).ldelim();return null!=e.full&&Object.hasOwnProperty.call(e,"full")&&t.uint32(16).bool(e.full),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Message.Wantlist;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.entries&&s.entries.length||(s.entries=[]),s.entries.push(a.Message.Wantlist.Entry.decode(e,e.uint32()));break;case 2:s.full=e.bool();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Message.Wantlist)return e;var t=new a.Message.Wantlist;if(e.entries){if(!Array.isArray(e.entries))throw TypeError(".Message.Wantlist.entries: array expected");t.entries=[];for(var r=0;r<e.entries.length;++r){if("object"!==typeof e.entries[r])throw TypeError(".Message.Wantlist.entries: object expected");t.entries[r]=a.Message.Wantlist.Entry.fromObject(e.entries[r])}}return null!=e.full&&(t.full=Boolean(e.full)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.entries=[]),t.defaults&&(r.full=!1),e.entries&&e.entries.length){r.entries=[];for(var s=0;s<e.entries.length;++s)r.entries[s]=a.Message.Wantlist.Entry.toObject(e.entries[s],t)}return null!=e.full&&e.hasOwnProperty("full")&&(r.full=e.full),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.WantType=function(){var e={},t=Object.create(e);return t[e[0]="Block"]=0,t[e[1]="Have"]=1,t}(),e.Entry=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.block=o.newBuffer([]),e.prototype.priority=0,e.prototype.cancel=!1,e.prototype.wantType=0,e.prototype.sendDontHave=!1,e.encode=function(e,t){return t||(t=i.create()),null!=e.block&&Object.hasOwnProperty.call(e,"block")&&t.uint32(10).bytes(e.block),null!=e.priority&&Object.hasOwnProperty.call(e,"priority")&&t.uint32(16).int32(e.priority),null!=e.cancel&&Object.hasOwnProperty.call(e,"cancel")&&t.uint32(24).bool(e.cancel),null!=e.wantType&&Object.hasOwnProperty.call(e,"wantType")&&t.uint32(32).int32(e.wantType),null!=e.sendDontHave&&Object.hasOwnProperty.call(e,"sendDontHave")&&t.uint32(40).bool(e.sendDontHave),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Message.Wantlist.Entry;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.block=e.bytes();break;case 2:s.priority=e.int32();break;case 3:s.cancel=e.bool();break;case 4:s.wantType=e.int32();break;case 5:s.sendDontHave=e.bool();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Message.Wantlist.Entry)return e;var t=new a.Message.Wantlist.Entry;switch(null!=e.block&&("string"===typeof e.block?o.base64.decode(e.block,t.block=o.newBuffer(o.base64.length(e.block)),0):e.block.length&&(t.block=e.block)),null!=e.priority&&(t.priority=0|e.priority),null!=e.cancel&&(t.cancel=Boolean(e.cancel)),e.wantType){case"Block":case 0:t.wantType=0;break;case"Have":case 1:t.wantType=1;break}return null!=e.sendDontHave&&(t.sendDontHave=Boolean(e.sendDontHave)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.block="":(r.block=[],t.bytes!==Array&&(r.block=o.newBuffer(r.block))),r.priority=0,r.cancel=!1,r.wantType=t.enums===String?"Block":0,r.sendDontHave=!1),null!=e.block&&e.hasOwnProperty("block")&&(r.block=t.bytes===String?o.base64.encode(e.block,0,e.block.length):t.bytes===Array?Array.prototype.slice.call(e.block):e.block),null!=e.priority&&e.hasOwnProperty("priority")&&(r.priority=e.priority),null!=e.cancel&&e.hasOwnProperty("cancel")&&(r.cancel=e.cancel),null!=e.wantType&&e.hasOwnProperty("wantType")&&(r.wantType=t.enums===String?a.Message.Wantlist.WantType[e.wantType]:e.wantType),null!=e.sendDontHave&&e.hasOwnProperty("sendDontHave")&&(r.sendDontHave=e.sendDontHave),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e}(),e.Block=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.prefix=o.newBuffer([]),e.prototype.data=o.newBuffer([]),e.encode=function(e,t){return t||(t=i.create()),null!=e.prefix&&Object.hasOwnProperty.call(e,"prefix")&&t.uint32(10).bytes(e.prefix),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Message.Block;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.prefix=e.bytes();break;case 2:s.data=e.bytes();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Message.Block)return e;var t=new a.Message.Block;return null!=e.prefix&&("string"===typeof e.prefix?o.base64.decode(e.prefix,t.prefix=o.newBuffer(o.base64.length(e.prefix)),0):e.prefix.length&&(t.prefix=e.prefix)),null!=e.data&&("string"===typeof e.data?o.base64.decode(e.data,t.data=o.newBuffer(o.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.prefix="":(r.prefix=[],t.bytes!==Array&&(r.prefix=o.newBuffer(r.prefix))),t.bytes===String?r.data="":(r.data=[],t.bytes!==Array&&(r.data=o.newBuffer(r.data)))),null!=e.prefix&&e.hasOwnProperty("prefix")&&(r.prefix=t.bytes===String?o.base64.encode(e.prefix,0,e.prefix.length):t.bytes===Array?Array.prototype.slice.call(e.prefix):e.prefix),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?o.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.BlockPresenceType=function(){var e={},t=Object.create(e);return t[e[0]="Have"]=0,t[e[1]="DontHave"]=1,t}(),e.BlockPresence=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cid=o.newBuffer([]),e.prototype.type=0,e.encode=function(e,t){return t||(t=i.create()),null!=e.cid&&Object.hasOwnProperty.call(e,"cid")&&t.uint32(10).bytes(e.cid),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Message.BlockPresence;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.cid=e.bytes();break;case 2:s.type=e.int32();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Message.BlockPresence)return e;var t=new a.Message.BlockPresence;switch(null!=e.cid&&("string"===typeof e.cid?o.base64.decode(e.cid,t.cid=o.newBuffer(o.base64.length(e.cid)),0):e.cid.length&&(t.cid=e.cid)),e.type){case"Have":case 0:t.type=0;break;case"DontHave":case 1:t.type=1;break}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.cid="":(r.cid=[],t.bytes!==Array&&(r.cid=o.newBuffer(r.cid))),r.type=t.enums===String?"Have":0),null!=e.cid&&e.hasOwnProperty("cid")&&(r.cid=t.bytes===String?o.base64.encode(e.cid,0,e.cid.length):t.bytes===Array?Array.prototype.slice.call(e.cid):e.cid),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?a.Message.BlockPresenceType[e.type]:e.type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e}(),e.exports=a},3842:function(e,t,r){"use strict";const s=r("52ea"),n=r("9888"),i=r("34eb")("ipfs:mfs:cp"),o=r("b6aa"),a=r("e53b"),c=r("57e0"),u=r("5688"),l=r("aaf7"),d=r("4fcb").bind({ignoreUndefined:!0}),h=r("1eaa"),p=r("a29d"),f={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};e.exports=e=>{async function t(t,r,a={}){const c=d(f,a);Array.isArray(t)||(t=[t]);const u=await Promise.all(t.map(t=>l(e,t,c)));let p=await l(e,r,c);if(!u.length||!p)throw o(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");const m=u.find(e=>!e.exists);if(m)throw o(new Error(m.path+" does not exist"),"ERR_INVALID_PARAMS");const w=y(p);if(p.exists){if(i("Destination exists"),1===u.length&&!w)throw o(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(i("Destination does not exist"),u.length>1){if(!c.parents)throw o(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await s(e)(p.path,c),p=await l(e,p.path,c)}else if(p.parts.length>1){const t="/"+p.parts.slice(0,-1).join("/");try{await n(e)(t,c)}catch(v){if("ERR_NOT_FOUND"!==v.code)throw v;if(!c.parents)throw o(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await s(e)(t,c),p=await l(e,p.path,c)}}const _=y(p)?p.mfsPath:p.mfsDirectory,E=await h(e,_);if(1===u.length){const t=u.pop();if(!t)throw o(new Error("could not find source"),"ERR_INVALID_PARAMS");const r=w?t.name:p.name;return i(`Only one source, copying to destination ${w?"directory":"file"} ${r}`),g(e,t,r,E,c)}return i("Multiple sources, wrapping in a directory"),b(e,u,p,E,c)}return p(t)};const y=e=>e.unixfs&&e.unixfs.type&&e.unixfs.type.includes("directory"),g=async(e,t,r,s,n)=>{let i=s.pop();if(!i)throw o(new Error("destination had no parent"),"ERR_INVALID_PARAMS");i=await m(e,t,r,i,n),s.push(i);const u=await a(e,s,n);await c(e,u,n)},b=async(e,t,r,s,n)=>{for(let o=0;o<t.length;o++){const s=t[o];r=await m(e,s,s.name,r,n)}s[s.length-1]=r;const i=await a(e,s,n);await c(e,i,n)},m=async(e,t,r,s,n)=>{const i=await e.repo.blocks.get(t.cid),{node:o,cid:a}=await u(e,{parentCid:s.cid,size:i.data.length,cid:t.cid,name:r,hashAlg:n.hashAlg,cidVersion:n.cidVersion,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold});return s.node=o,s.cid=a,s.size=o.size,s}},38425:function(e){e.exports=JSON.parse('{"name":"libp2p","version":"0.31.7","description":"JavaScript implementation of libp2p, a modular peer to peer network stack","leadMaintainer":"Jacob Heun <jacobheun@gmail.com>","main":"src/index.js","types":"dist/src/index.d.ts","typesVersions":{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},"files":["dist","src"],"scripts":{"lint":"aegir lint","build":"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:address-book":"pbjs -t static-module -w commonjs -r libp2p-address-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/address-book.js ./src/peer-store/persistent/pb/address-book.proto","build:proto:proto-book":"pbjs -t static-module -w commonjs -r libp2p-proto-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/proto-book.js ./src/peer-store/persistent/pb/proto-book.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:address-book":"pbts -o src/peer-store/persistent/pb/address-book.d.ts src/peer-store/persistent/pb/address-book.js","build:proto-types:proto-book":"pbts -o src/peer-store/persistent/pb/proto-book.d.ts src/peer-store/persistent/pb/proto-book.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js","test":"aegir test","test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use","test:node":"aegir test -t node -f \\"./test/**/*.{node,spec}.js\\"","test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all","prepare":"aegir build --no-bundle","release":"aegir release -t node -t browser","release-minor":"aegir release --type minor -t node -t browser","release-major":"aegir release --type major -t node -t browser","coverage":"nyc --reporter=text --reporter=lcov npm run test:node"},"repository":{"type":"git","url":"https://github.com/libp2p/js-libp2p.git"},"keywords":["libp2p","network","p2p","peer","peer-to-peer","IPFS"],"bugs":{"url":"https://github.com/libp2p/js-libp2p/issues"},"homepage":"https://libp2p.io","license":"MIT","engines":{"node":">=14.0.0"},"browser":{"@motrix/nat-api":false},"eslintConfig":{"extends":"ipfs","ignorePatterns":["!.aegir.js","test/ts-use"]},"dependencies":{"@motrix/nat-api":"^0.3.1","@vascosantos/moving-average":"^1.1.0","abort-controller":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^2.1.1","bignumber.js":"^9.0.1","cids":"^1.1.5","class-is":"^1.1.0","debug":"^4.3.1","err-code":"^3.0.0","es6-promisify":"^6.1.1","events":"^3.3.0","hashlru":"^2.3.0","interface-datastore":"^4.0.0","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"1.0.0","it-pipe":"^1.1.0","it-take":"1.0.0","libp2p-crypto":"^0.19.4","libp2p-interfaces":"^0.10.4","libp2p-utils":"^0.3.1","mafmt":"^9.0.0","merge-options":"^3.0.4","multiaddr":"^9.0.1","multicodec":"^3.0.1","multihashing-async":"^2.1.2","multistream-select":"^2.0.0","mutable-proxy":"^1.0.0","node-forge":"^0.10.0","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.14.2","private-ip":"^2.1.0","protobufjs":"^6.10.2","retimer":"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^5.0.2","timeout-abort-controller":"^1.1.1","varint":"^6.0.0","wherearewe":"^1.0.0","xsalsa20":"^1.1.0"},"devDependencies":{"@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node-forge":"^0.9.7","@types/varint":"^6.0.0","abortable-iterator":"^3.0.0","aegir":"^33.1.1","buffer":"^6.0.3","delay":"^5.0.0","interop-libp2p":"^0.4.0","into-stream":"^6.0.0","ipfs-http-client":"^50.1.1","it-concat":"^1.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0","libp2p":".","libp2p-bootstrap":"^0.12.3","libp2p-delegated-content-routing":"^0.10.0","libp2p-delegated-peer-routing":"^0.9.0","libp2p-floodsub":"^0.25.0","libp2p-gossipsub":"^0.9.0","libp2p-kad-dht":"^0.22.0","libp2p-mdns":"^0.16.0","libp2p-mplex":"^0.10.1","libp2p-noise":"^3.0.0","libp2p-tcp":"^0.15.4","libp2p-webrtc-star":"^0.22.2","libp2p-websockets":"^0.15.8","multihashes":"^4.0.2","nock":"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0","rimraf":"^3.0.2","sinon":"^10.0.0","uint8arrays":"^2.1.3","util":"^0.12.3"},"contributors":["David Dias <daviddias.p@gmail.com>","Vasco Santos <vasco.santos@moxy.studio>","Jacob Heun <jacobheun@gmail.com>","Alex Potsides <alex@achingbrain.net>","Alan Shaw <alan@tableflip.io>","Cayman <caymannava@gmail.com>","Pedro Teixeira <i@pgte.me>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Maciej Krüger <mkg20001@gmail.com>","Hugo Dias <mail@hugodias.me>","dirkmc <dirkmdev@gmail.com>","Volker Mische <volker.mische@gmail.com>","Richard Littauer <richard.littauer@gmail.com>","Ryan Bell <ryan@piing.net>","a1300 <matthias-knopp@gmx.net>","ᴠɪᴄᴛᴏʀ ʙᴊᴇʟᴋʜᴏʟᴍ <victorbjelkholm@gmail.com>","Samlior <samlior@foxmail.com>","Andrew Nesbitt <andrewnez@gmail.com>","Thomas Eizinger <thomas@eizinger.io>","Franck Royer <franck@royer.one>","Giovanni T. Parra <fiatjaf@gmail.com>","Elven <mon.samuel@qq.com>","Didrik Nordström <didrik.nordstrom@gmail.com>","RasmusErik Voel Jensen <github@solsort.com>","Smite Chow <xiaopengyou@live.com>","Soeren <nikorpoulsen@gmail.com>","Sönke Hahn <soenkehahn@gmail.com>","TJKoury <TJKoury@gmail.com>","Tiago Alves <alvesjtiago@gmail.com>","Yusef Napora <yusef@napora.org>","Zane Starr <zcstarr@gmail.com>","ebinks <elizabethjbinks@gmail.com>","isan_rivkin <isanrivkin@gmail.com>","mcclure <andi.m.mcclure@gmail.com>","robertkiel <robert.kiel@validitylabs.org>","Aleksei <vozhdb@gmail.com>","Bernd Strehl <bernd.strehl@gmail.com>","Chris Bratlien <chrisbratlien@gmail.com>","Cindy Wu <ciindy.wu@gmail.com>","Daijiro Wachi <daijiro.wachi@gmail.com>","Diogo Silva <fsdiogo@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","Ethan Lam <elmemphis2000@gmail.com>","Fei Liu <liu.feiwood@gmail.com>","Felipe Martins <felipebrasil93@gmail.com>","Florian-Merle <florian.david.merle@gmail.com>","Francis Gulotta <wizard@roborooter.com>","Henrique Dias <hacdias@gmail.com>","Irakli Gozalishvili <rfobic@gmail.com>","Joel Gustafson <joelg@mit.edu>","Julien Bouquillon <contact@revolunet.com>","Kevin Kwok <antimatter15@gmail.com>","Kevin Lacker <lacker@gmail.com>","Miguel Mota <miguelmota2@gmail.com>","Nuno Nogueira <nunofmn@gmail.com>","Philipp Muens <raute1337@gmx.de>"]}')},"388e":function(e,t,r){"use strict";const{sha256:s}=r("88db"),n=r("b6aa"),i=r("9b62"),o=r("5aab"),a=async(e,t)=>{if(!(e instanceof Uint8Array))throw n(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(e.byteLength<5)throw n(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");const r=i(e.subarray(0,4));if("/pk/"!==r)throw n(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");const a=e.slice(4),c=await s.digest(t);if(!o(a,c.bytes))throw n(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")};e.exports={func:a,sign:!1}},"38e2":function(e,t,r){"use strict";(function(t){const s=r("1c35").Buffer,n=function(){if(t.TextEncoder){const e=new TextEncoder("utf-8");return e.encode.bind(e)}return s.from}();e.exports=function(e,t){return t?s.isBuffer(e)?e:n(String(e)):String(e)}}).call(this,r("c8ba"))},"38f3":function(e,t,r){"use strict";const s=r("3fb5"),{Readable:n}=r("e372");function i(e,t){if(!(this instanceof i))return new i(e,t);t=t||{},n.call(this,Object.assign({},t,{objectMode:!0})),this._iterator=e,this._options=t,this.on("end",this.destroy.bind(this,null,null))}e.exports=i,s(i,n),i.prototype._read=function(){this.destroyed||this._iterator.next((e,t,r)=>{if(!this.destroyed)return e?this.destroy(e):void(void 0===t&&void 0===r?this.push(null):!1!==this._options.keys&&!1===this._options.values?this.push(t):!1===this._options.keys&&!1!==this._options.values?this.push(r):this.push({key:t,value:r}))})},i.prototype._destroy=function(e,t){this._iterator.end((function(r){t(e||r)}))}},3971:function(e,t,r){"use strict";const s=r("c449"),{DAGNode:n}=r("8141"),{Errors:i}=r("1304"),o=i.notFoundError().code,a=r("a29d"),c=r("1f97"),u={default:"<dst>",edges:"<src> -> <dst>"};function l(e,t,r){const{cid:s,path:n}=c(t);return!1!==r.preload&&e(s),`/ipfs/${s}${n||""}`}async function*d(e,t,r,s){const n=await e(r),{cid:i}=c(n),o=null!=s.maxDepth?s.maxDepth:1/0,a=s.unique||!1;for await(const c of p(t,i,o,a))c.parent&&(c.isDuplicate||(yield{ref:h(c.parent.cid,c.node.cid,c.node.name,s.format)}))}function h(e,t,r="",s=u.default){let n=s.replace(/<src>/g,e.toString());return n=n.replace(/<dst>/g,t.toString()),n=n.replace(/<linkname>/g,r),n}async function*p(e,t,r,s){const n=new Set;async function*i(t,a){const c=a+1;if(!(c>r))try{for(const r of await f(e,t.cid))yield{parent:t,node:r,isDuplicate:s&&n.has(r.cid.toString())},s&&n.add(r.cid.toString()),yield*i(r,c)}catch(u){throw u.code===o&&(u.message="Could not find object with CID: "+t.cid),u}}yield*i({cid:t},0)}async function f(e,t){const r=await e.get(t);if(r instanceof n){const e=({Name:e,Hash:t})=>({name:e,cid:t});return r.Links.map(e)}return y(r)}function y(e,t=""){let r=[];for(const[n,i]of Object.entries(e))s.isCID(i)?r.push({name:t+n,cid:i}):"object"===typeof i&&(r=r.concat(y(i,t+n+"/")));return r}e.exports=function({ipld:e,resolve:t,preload:r}){async function*s(s,n={}){if(0===n.maxDepth)return;if(n.edges&&n.format&&n.format!==u.default)throw new Error("Cannot set edges to true and also specify format");n.format=n.edges?u.edges:n.format,"number"!==typeof n.maxDepth&&(n.maxDepth=n.recursive?1/0:1);const i=Array.isArray(s)?s:[s],o=i.map(e=>l(r,e,n));for(const r of o)yield*d(t,e,r,n)}return a(s)},e.exports.Format=u},"3a1e":function(e,t,r){"use strict";const s=async function*(e,t){let r=0;if(!(t<1))for await(const s of e)if(yield s,r++,r===t)return};e.exports=s},"3a9b":function(e,t,r){"use strict";const s=r("eddf"),n=r("c449"),i=r("b6aa"),{NotEnabledError:o}=r("fabb"),a=r("36be"),c=r("a29d");e.exports=({network:e,repo:t})=>{const{get:r,put:o,findProvs:a,findPeer:u,provide:h,query:p}={async get(t,r={}){const{libp2p:s}=await d(e,r);return s._dht.get(l(t),r)},async*put(t,r,s){const{libp2p:n}=await d(e,s);yield*n._dht.put(l(t),r)},async*findProvs(t,r={numProviders:20}){const{libp2p:s}=await d(e,r);for await(const e of s._dht.findProviders(l(t),{maxNumProviders:r.numProviders,signal:r.signal}))yield{id:e.id.toB58String(),addrs:e.addrs}},async findPeer(t,r){const{libp2p:n}=await d(e,r),i=await n._dht.findPeer(s.createFromCID(t));return{id:i.id.toB58String(),addrs:i.multiaddrs}},async*provide(r,s={recursive:!1}){const{libp2p:o}=await d(e,s);r=Array.isArray(r)?r:[r];for(const e in r)if("string"===typeof r[e])try{r[e]=new n(r[e])}catch(u){throw i(u,"ERR_INVALID_CID")}const a=await Promise.all(r.map(e=>t.blocks.has(e))),c=a.every(e=>e);if(!c)throw i(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(s.recursive)throw i(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");for(const e of r)yield o._dht.provide(e)},async*query(t,r){const{libp2p:n}=await d(e,r);for await(const e of n._dht.getClosestPeers(s.createFromCID(t).toBytes()))yield{id:e.toB58String(),addrs:[]}}};return{get:c(r),put:c(o),findProvs:c(a),findPeer:c(u),provide:c(h),query:c(p)}};const u=e=>{try{const t=e.toString().split("/").filter(e=>e&&"ipfs"!==e&&"ipns"!==e)[0];return new n(t).bytes}catch(t){throw i(t,"ERR_INVALID_CID")}},l=e=>e instanceof Uint8Array?e:u(e),d=async(e,t)=>{const r=await e.use(t);if(a(r.libp2p,"_config.dht.enabled",!1))return r;throw new o("dht not enabled")}},"3ade":function(e,t,r){"use strict";const s=(e,t)=>0;e.exports=s},"3b27":function(e,t,r){"use strict";e.exports={repoVersion:10}},"3b8e":function(e,t,r){"use strict";t.first=async e=>{for await(const t of e)return t},t.last=async e=>{let t;for await(t of e);return t},t.all=async e=>{const t=[];for await(const r of e)t.push(r);return t},t.extendIterator=e=>(e.first=()=>t.first(e),e.last=()=>t.last(e),e.all=()=>t.all(e),e)},"3ba3":function(e,t,r){"use strict";const s=r("0e80"),n=r("c449"),i=async(e,t,r)=>{r.codec||(r.codec="dag-pb"),r.cidVersion||(r.cidVersion=0),r.hashAlg||(r.hashAlg="sha2-256"),"sha2-256"!==r.hashAlg&&(r.cidVersion=1);const i=await s(e,r.hashAlg),o=new n(r.cidVersion,r.codec,i);return r.onlyHash||await t.put(e,{pin:r.pin,preload:r.preload,timeout:r.timeout,cid:o}),o};e.exports=i},"3c82":function(e,t,r){"use strict";e.exports.NAMESPACE_COMMON="/peers/",e.exports.NAMESPACE_ADDRESS="/peers/addrs/",e.exports.NAMESPACE_KEYS="/peers/keys/",e.exports.NAMESPACE_METADATA="/peers/metadata/",e.exports.NAMESPACE_PROTOCOL="/peers/protos/"},"3c8d":function(e,t,r){"use strict";const s=r("5425").AbstractLevelDOWN,n=r("3fb5"),i=r("26a22"),o="put get del batch clear".split(" "),a="approximateSize compactRange".split(" ");function c(e){s.call(this,e.supports||{});for(const t of a)"function"!==typeof e[t]||this.supports.additionalMethods[t]||(this.supports.additionalMethods[t]=!0);this._db=e,this._operations=[],l(this)}function u(e){for(const t of o.concat("iterator"))e["_"+t]=function(...e){return this._db[t](...e)};for(const t of Object.keys(e.supports.additionalMethods))e[t]=function(...e){return this._db[t](...e)}}function l(e){for(const t of o)e["_"+t]=function(...e){this._operations.push({method:t,args:e})};for(const t of Object.keys(e.supports.additionalMethods))e[t]=function(...e){this._operations.push({method:t,args:e})};e._iterator=function(t){const r=new i(e,t);return this._operations.push({iterator:r}),r}}n(c,s),c.prototype.type="deferred-leveldown",c.prototype._open=function(e,t){this._db.open(e,e=>{if(e)return t(e);for(const t of this._operations)t.iterator?t.iterator.setDb(this._db):this._db[t.method](...t.args);this._operations=[],u(this),t()})},c.prototype._close=function(e){this._db.close(t=>{if(t)return e(t);l(this),e()})},c.prototype._serializeKey=function(e){return e},c.prototype._serializeValue=function(e){return e},e.exports=c,e.exports.DeferredIterator=i},"3cb9":function(e,t,r){"use strict";r.r(t);let s=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/giu;function n(e="",t="ms"){var r=null;return e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2"),e.replace(s,(function(e,t,s){s=i(s),s&&(r=(r||0)+parseFloat(t,10)*s)})),r&&r/(i(t)||1)}function i(e){return n[e]||n[e.toLowerCase().replace(/s$/,"")]}n.nanosecond=n.ns=1e-6,n["µs"]=n["μs"]=n.us=n.microsecond=.001,n.millisecond=n.ms=n[""]=1,n.second=n.sec=n.s=1e3*n.ms,n.minute=n.min=n.m=60*n.s,n.hour=n.hr=n.h=60*n.m,n.day=n.d=24*n.h,n.week=n.wk=n.w=7*n.d,n.month=n.b=30.4375*n.d,n.year=n.yr=n.y=365.25*n.d,t["default"]=n},"3d15":function(e,t,r){"use strict";const s=r("93e7"),n=r("a29d");function i(e){return e.endsWith(".eth")&&(e=e.replace(/.eth$/,".eth.link")),e}e.exports=()=>{const e=async(e,t={recursive:!0})=>{if("string"!==typeof e)throw new Error("Invalid arguments, domain must be a string");return e=i(e),s(e,t)};return n(e)}},"3e53":function(e,t,r){"use strict";const s=r("c449"),n=r("8141"),i=r("c81a"),o=r("5d98"),a=r("675c"),c=r("da0b"),{createStore:u}=r("d268"),{cidToKey:l,PIN_DS_KEY:d,PinTypes:h}=r("7db2"),p=r("fee4");async function f(e,t,r,a){if(!await t.has(d))return;const u=await t.get(d),f=new s(u),y=await e.get(l(f)),g=n.util.deserialize(y);let b,m=0;b=await p(c.loadSet(e,g,h.recursive))+await p(c.loadSet(e,g,h.direct));for await(const s of c.loadSet(e,g,h.recursive)){m++;const e={depth:1/0};0!==s.version&&(e.version=s.version),"dag-pb"!==s.codec&&(e.codec=o.getNumber(s.codec)),await r.put(l(s),i.encode(e)),a(m/b*100,"Migrated recursive pin "+s)}for await(const s of c.loadSet(e,g,h.direct)){m++;const e={depth:0};0!==s.version&&(e.version=s.version),"dag-pb"!==s.codec&&(e.codec=o.getNumber(s.codec)),await r.put(l(s),i.encode(e)),a(m/b*100,"Migrated direct pin "+s)}await e.delete(l(f)),await t.delete(d)}async function y(e,t,r,u){let f=[],y=[],g=0;const b=await p(r.queryKeys({}));for await(const{key:n,value:c}of r.query({})){g++;const e=i.decode(c),t=new s(e.version||0,e.codec&&o.getName(e.codec)||"dag-pb",a.decode("b"+n.toString().split("/").pop()));0===e.depth?(u(g/b*100,"Reverted direct pin "+t),y.push(t)):(u(g/b*100,"Reverted recursive pin "+t),f.push(t))}u(100,"Updating pin root");const m=new n.DAGNode(new Uint8Array,[await c.storeSet(e,h.recursive,f),await c.storeSet(e,h.direct,y)]),w=m.serialize(),_=await n.util.cid(w,{cidVersion:0});await e.put(l(_),w),await t.put(d,_.multihash)}async function g(e,t,r,s){const n=u(e,"blocks",t),i=u(e,"datastore",t),o=u(e,"pins",t);await n.open(),await i.open(),await o.open();try{await s(n,i,o,r)}finally{await o.close(),await i.close(),await n.close()}}e.exports={version:9,description:"Migrates pins to datastore",migrate:(e,t,r=(()=>{}))=>g(e,t,r,f),revert:(e,t,r=(()=>{}))=>g(e,t,r,y)}},"3e7a":function(e,t,r){"use strict";const s=r("c449"),n=r("5aab"),i=(e,t)=>{let r=null;if("string"===typeof t?r=e=>e.Name===t:t instanceof Uint8Array?r=e=>n(e.Hash.bytes,t):s.isCID(t)&&(r=e=>n(e.Hash.bytes,t.bytes)),!r)throw new Error("second arg needs to be a name or CID");{const t=e.Links;let s=0;while(s<t.length){const e=t[s];r(e)?t.splice(s,1):s++}}};e.exports=i},"3e9a":function(e,t,r){"use strict";e.exports.toRFC3339=e=>{const t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),s=String(e.getUTCDate()).padStart(2,"0"),n=String(e.getUTCHours()).padStart(2,"0"),i=String(e.getUTCMinutes()).padStart(2,"0"),o=String(e.getUTCSeconds()).padStart(2,"0"),a=e.getUTCMilliseconds(),c=1e3*a*1e3;return`${t}-${r}-${s}T${n}:${i}:${o}.${c}Z`},e.exports.parseRFC3339=e=>{const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(!r)throw new Error("Invalid format");const s=parseInt(r[1],10),n=parseInt(r[2],10)-1,i=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(s,n,i,o,a,c,u))}},"3eaf":function(e,t,r){"use strict";const s=r("7cb6"),n=r("54b0");async function i(e){const t=new n({peerId:e.peerId,multiaddrs:e.multiaddrs}),r=await s.seal(t,e.peerId);e.peerStore.addressBook.consumePeerRecord(r)}e.exports.updateSelfPeerRecord=i},"3ed3":function(e,t,r){"use strict";const s=r("b623"),n=r("5669");e.exports={util:s,resolver:n,codec:s.codec,defaultHashAlg:s.defaultHashAlg}},"3ef0":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,n=new TextDecoder,i=new TextEncoder;function o(e){return s&&globalThis.Buffer.isBuffer(e)}function a(e){return e instanceof Uint8Array?o(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const c=s?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):w(e,t,r):(e,t,r)=>r-t>64?n.decode(e.subarray(t,r)):w(e,t,r),u=s?e=>e.length>64?globalThis.Buffer.from(e):m(e):e=>e.length>64?i.encode(e):m(e),l=e=>Uint8Array.from(e),d=s?(e,t,r)=>o(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),h=s?(e,t)=>(e=e.map(e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e)),a(globalThis.Buffer.concat(e,t))):(e,t)=>{const r=new Uint8Array(t);let s=0;for(let n of e)s+n.length>r.length&&(n=n.subarray(0,r.length-s)),r.set(n,s),s+=n.length;return r},p=s?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e),f=s?e=>"string"===typeof e?e:globalThis.Buffer.from(g(e)).toString("hex"):e=>"string"===typeof e?e:Array.prototype.reduce.call(g(e),(e,t)=>`${e}${t.toString(16).padStart(2,"0")}`,""),y=s?e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e,"hex"):e=>e instanceof Uint8Array?e:e.length?new Uint8Array(e.split("").map((e,t,r)=>t%2===0?`0x${e}${r[t+1]}`:"").filter(Boolean).map(e=>parseInt(e,16))):new Uint8Array(0);function g(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function b(e,t){if(o(e)&&o(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function m(e,t=1/0){let r;const s=e.length;let n=null;const i=[];for(let o=0;o<s;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===s){(t-=3)>-1&&i.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&i.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function w(e,t,r){const s=[];while(t<r){const n=e[t];let i=null,o=n>239?4:n>223?3:n>191?2:1;if(t+o<=r){let r,s,a,c;switch(o){case 1:n<128&&(i=n);break;case 2:r=e[t+1],128===(192&r)&&(c=(31&n)<<6|63&r,c>127&&(i=c));break;case 3:r=e[t+1],s=e[t+2],128===(192&r)&&128===(192&s)&&(c=(15&n)<<12|(63&r)<<6|63&s,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:r=e[t+1],s=e[t+2],a=e[t+3],128===(192&r)&&128===(192&s)&&128===(192&a)&&(c=(15&n)<<18|(63&r)<<12|(63&s)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,s.push(i>>>10&1023|55296),i=56320|1023&i),s.push(i),t+=o}return E(s)}const _=4096;function E(e){const t=e.length;if(t<=_)return String.fromCharCode.apply(String,e);let r="",s=0;while(s<t)r+=String.fromCharCode.apply(String,e.slice(s,s+=_));return r}t.alloc=p,t.asU8A=a,t.compare=b,t.concat=h,t.decodeCodePointsArray=E,t.fromArray=l,t.fromHex=y,t.fromString=u,t.slice=d,t.toHex=f,t.toString=c,t.useBuffer=s},"3f1c":function(e,t,r){"use strict";const{isValidMultiaddr:s}=r("ac55"),n=r("a29d");e.exports=({repo:e})=>{async function t(t,r={}){if(!s(t))throw new Error(t+" is not a valid Multiaddr");const n=await e.config.getAll(r),i=n.Bootstrap||[];return i.push(t.toString()),n.Bootstrap=Array.from(new Set(i)).sort((e,t)=>e.localeCompare(t)),await e.config.replace(n),{Peers:[t]}}return n(t)}},"3f55":function(e,t,r){"use strict";const s=r("a29d");e.exports=({keychain:e})=>{const t=(t,r,s)=>e.importKey(t,r,s);return s(t)}},"401e":function(e,t,r){"use strict";function s(e){return!isNaN(parseFloat(e))&&isFinite(e)}function n(e){return null!==e&&"object"===typeof e&&e.constructor===Object}function i(e){return o(e)&&"number"===typeof e.length}function o(e){return"object"===typeof e&&null!==e}function a(e){return"undefined"!==typeof e}function c(e){return!a(e)}function u(e){return null===e}function l(e){return a(e)&&!u(e)&&!Number.isNaN(e)}function d(e){return"function"===typeof e&&/^class /.test(Function.prototype.toString.call(e))}function h(e){if(null===e)return!0;switch(typeof e){case"string":case"number":case"symbol":case"undefined":case"boolean":return!0;default:return!1}}function p(e){if(e){const t=a(Promise)&&e instanceof Promise,r=e.then&&"function"===typeof e.then;return!(!t&&!r)}return!1}function f(e){return!(null===e||!a(e))&&("function"===typeof e[Symbol.iterator]||"function"===typeof e[Symbol.asyncIterator])}function y(e){return"string"===typeof e}function g(e){return"function"===typeof e}r.r(t),r.d(t,"isNumber",(function(){return s})),r.d(t,"isPlainObject",(function(){return n})),r.d(t,"isArrayLike",(function(){return i})),r.d(t,"isObject",(function(){return o})),r.d(t,"isDefined",(function(){return a})),r.d(t,"isUndefined",(function(){return c})),r.d(t,"isNull",(function(){return u})),r.d(t,"isDefinedValue",(function(){return l})),r.d(t,"isClass",(function(){return d})),r.d(t,"isPrimitive",(function(){return h})),r.d(t,"isPromise",(function(){return p})),r.d(t,"isIterable",(function(){return f})),r.d(t,"isString",(function(){return y})),r.d(t,"isFunction",(function(){return g})),t["default"]={isNumber:s,isPlainObject:n,isArrayLike:i,isObject:o,isDefined:a,isUndefined:c,isNull:u,isDefinedValue:l,isClass:d,isPrimitive:h,isPromise:p,isIterable:f,isString:y,isFunction:g}},"416e":function(e,t,r){"use strict";const s=r("a9f4");e.exports=e=>{const t=s.logger(e.peerId,"rpc:ping");function r(e,r){return t("from %s",e.toB58String()),r}return r}},"41c5":function(e,t,r){"use strict";const s=async e=>{const t=[];for await(const r of e)t.push(r);return t};e.exports=s},"41c6":function(e,t,r){"use strict";const{AbortController:s}="undefined"!==typeof self?self:"undefined"!==typeof window?window:r("91d3"),n=r("09b5");class i extends s{constructor(e){super(),this._ms=e,this._timer=n(()=>this.abort(),e),Object.setPrototypeOf(this,i.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=n(()=>this.abort(),this._ms)}}e.exports=i,e.exports.TimeoutController=i},"429c":function(e,t,r){"use strict";const s=r("a29d"),n=r("b6aa"),{NotEnabledError:i}=r("fabb"),o=r("36be");e.exports=({network:e,config:t})=>{const r=o(t||{},"Pubsub.Enabled",!0);return{subscribe:r?s(i):a,unsubscribe:r?s(c):a,publish:r?s(u):a,ls:r?s(l):a,peers:r?s(d):a};async function i(t,r,s={}){const{libp2p:n}=await e.use(s);return n.pubsub.subscribe(t,r,s)}async function c(t,r,s={}){const{libp2p:n}=await e.use(s);n.pubsub.unsubscribe(t,r,s)}async function u(t,r,s={}){const{libp2p:i}=await e.use(s);if(!r)throw n(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await i.pubsub.publish(t,r)}async function l(t={}){const{libp2p:r}=await e.use(t);return r.pubsub.getTopics()}async function d(t,r={}){const{libp2p:s}=await e.use(r);return s.pubsub.getSubscribers(t)}};const a=async()=>{throw new i("pubsub not enabled")}},"42a0":function(e,t,r){"use strict";const{exporter:s}=r("d6d7"),{normalizeCidPath:n}=r("4d04"),i=r("a29d"),o=r("c449");e.exports=function({ipld:e,preload:t}){async function*r(r,i={}){if(r=n(r),!1!==i.preload){const e=r.split("/");t(new o(e[0]))}const a=await s(r,e,i);if("directory"===a.type)throw new Error("this dag node is a directory");if(!a.content)throw new Error("this dag node has no content");yield*a.content(i)}return i(r)}},"42f1":function(e,t,r){"use strict";const s=r("0300"),n=r("d46b");class i{constructor(e,t,r=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=r,this._children=new s,this.key=null}async put(e,t){const r=await this._findNewBucketAndPos(e);await r.bucket._putAt(r,e,t)}async get(e){const t=await this._findChild(e);if(t)return t.value}async del(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);r&&r.key===e&&t.bucket._delAt(t.pos)}leafCount(){const e=this._children.compactArray();return e.reduce((e,t)=>t instanceof i?e+t.leafCount():e+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const e=this._children.compactArray();for(const t of e)t instanceof i?yield*t.eachLeafSeries():yield t;return[]}serialize(e,t){const r=[];return t(this._children.reduce((r,s,n)=>(s&&(s instanceof i?r.push(s.serialize(e,t)):r.push(e(s,n))),r),r))}asyncTransform(e,t){return u(this,e,t)}toJSON(){return this.serialize(a,c)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);if(!(r instanceof i))return r&&r.key===e?r:void 0}async _findPlace(e){const t=this._options.hash("string"===typeof e?n(e):e),r=await t.take(this._options.bits),s=this._children.get(r);return s instanceof i?s._findPlace(t):{bucket:this,pos:r,hash:t,existingChild:s}}async _findNewBucketAndPos(e){const t=await this._findPlace(e);if(t.existingChild&&t.existingChild.key!==e){const e=new i(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,e);const r=await e._findPlace(t.existingChild.hash);return r.bucket._putAt(r,t.existingChild.key,t.existingChild.value),e._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,r){this._putObjectAt(e.pos,{key:t,value:r,hash:e.hash})}_putObjectAt(e,t){this._children.get(e)||this._popCount++,this._children.set(e,t)}_delAt(e){if(-1===e)throw new Error("Invalid position");this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(1===this._popCount){const e=this._children.find(o);if(e&&!(e instanceof i)){const t=e.hash;t.untake(this._options.bits);const r={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(r,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}}function o(e){return Boolean(e)}function a(e,t){return e.key}function c(e){return e}async function u(e,t,r){const s=[];for(const n of e._children.compactArray())if(n instanceof i)await u(n,t,r);else{const r=await t(n);s.push({bitField:e._children.bitField(),children:r})}return r(s)}e.exports=i},4442:function(e,t,r){"use strict";const{Buffer:s}=r("1c35"),{URL:n}=r("989e"),i=r("901e").BigNumber,o=r("ac25"),a=r("f0a5"),c=a.MT,u=a.NUMBYTES,l=a.SHIFT32,d=a.SYMS,h=a.TAG,p=a.MT.SIMPLE_FLOAT<<5|a.NUMBYTES.TWO,f=a.MT.SIMPLE_FLOAT<<5|a.NUMBYTES.FOUR,y=a.MT.SIMPLE_FLOAT<<5|a.NUMBYTES.EIGHT,g=a.MT.SIMPLE_FLOAT<<5|a.SIMPLE.TRUE,b=a.MT.SIMPLE_FLOAT<<5|a.SIMPLE.FALSE,m=a.MT.SIMPLE_FLOAT<<5|a.SIMPLE.UNDEFINED,w=a.MT.SIMPLE_FLOAT<<5|a.SIMPLE.NULL,_=new i("0x20000000000000"),E=s.from("f97e00","hex"),v=s.from("f9fc00","hex"),S=s.from("f97c00","hex");function I(e){return{}.toString.call(e).slice(8,-1)}class A{constructor(e){e=e||{},this.streaming="function"===typeof e.stream,this.onData=e.stream,this.semanticTypes=[[n,this._pushUrl],[i,this._pushBigNumber]];const t=e.genTypes||[],r=t.length;for(let s=0;s<r;s++)this.addSemanticType(t[s][0],t[s][1]);this._reset()}addSemanticType(e,t){const r=this.semanticTypes.length;for(let s=0;s<r;s++){const r=this.semanticTypes[s][0];if(r===e){const e=this.semanticTypes[s][1];return this.semanticTypes[s][1]=t,e}}return this.semanticTypes.push([e,t]),null}push(e){return!e||(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize()),!0)}pushWrite(e,t,r){return this.result[this.offset]=e,this.resultMethod[this.offset]=t,this.resultLength[this.offset]=r,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(e){return this.pushWrite(e,1,1)}_pushUInt16BE(e){return this.pushWrite(e,2,2)}_pushUInt32BE(e){return this.pushWrite(e,3,4)}_pushDoubleBE(e){return this.pushWrite(e,4,8)}_pushNaN(){return this.push(E)}_pushInfinity(e){const t=e<0?v:S;return this.push(t)}_pushFloat(e){const t=s.allocUnsafe(2);if(o.writeHalf(t,e)&&o.parseHalf(t)===e)return this._pushUInt8(p)&&this.push(t);const r=s.allocUnsafe(4);return r.writeFloatBE(e,0),r.readFloatBE(0)===e?this._pushUInt8(f)&&this.push(r):this._pushUInt8(y)&&this._pushDoubleBE(e)}_pushInt(e,t,r){const s=t<<5;return e<24?this._pushUInt8(s|e):e<=255?this._pushUInt8(s|u.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(s|u.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(s|u.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(s|u.EIGHT)&&this._pushUInt32BE(Math.floor(e/l))&&this._pushUInt32BE(e%l):t===c.NEG_INT?this._pushFloat(r):this._pushFloat(e)}_pushIntNum(e){return e<0?this._pushInt(-e-1,c.NEG_INT,e):this._pushInt(e,c.POS_INT)}_pushNumber(e){switch(!1){case e===e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!==0:return this._pushIntNum(e);default:return this._pushFloat(e)}}_pushString(e){const t=s.byteLength(e,"utf8");return this._pushInt(t,c.UTF8_STRING)&&this.pushWrite(e,5,t)}_pushBoolean(e){return this._pushUInt8(e?g:b)}_pushUndefined(e){return this._pushUInt8(m)}_pushArray(e,t){const r=t.length;if(!e._pushInt(r,c.ARRAY))return!1;for(let s=0;s<r;s++)if(!e.pushAny(t[s]))return!1;return!0}_pushTag(e){return this._pushInt(e,c.TAG)}_pushDate(e,t){return e._pushTag(h.DATE_EPOCH)&&e.pushAny(Math.round(t/1e3))}_pushBuffer(e,t){return e._pushInt(t.length,c.BYTE_STRING)&&e.push(t)}_pushNoFilter(e,t){return e._pushBuffer(e,t.slice())}_pushRegexp(e,t){return e._pushTag(h.REGEXP)&&e.pushAny(t.source)}_pushSet(e,t){if(!e._pushInt(t.size,c.ARRAY))return!1;for(const r of t)if(!e.pushAny(r))return!1;return!0}_pushUrl(e,t){return e._pushTag(h.URI)&&e.pushAny(t.format())}_pushBigint(e){let t=h.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),t=h.NEG_BIGINT);let r=e.toString(16);r.length%2&&(r="0"+r);const n=s.from(r,"hex");return this._pushTag(t)&&this._pushBuffer(this,n)}_pushBigNumber(e,t){if(t.isNaN())return e._pushNaN();if(!t.isFinite())return e._pushInfinity(t.isNegative()?-1/0:1/0);if(t.isInteger())return e._pushBigint(t);if(!e._pushTag(h.DECIMAL_FRAC)||!e._pushInt(2,c.ARRAY))return!1;const r=t.decimalPlaces(),s=t.multipliedBy(new i(10).pow(r));return!!e._pushIntNum(-r)&&(s.abs().isLessThan(_)?e._pushIntNum(s.toNumber()):e._pushBigint(s))}_pushMap(e,t){return!!e._pushInt(t.size,c.MAP)&&this._pushRawMap(t.size,Array.from(t))}_pushObject(e){if(!e)return this._pushUInt8(w);for(var t=this.semanticTypes.length,r=0;r<t;r++)if(e instanceof this.semanticTypes[r][0])return this.semanticTypes[r][1].call(e,this,e);var s=e.encodeCBOR;if("function"===typeof s)return s.call(e,this);var n=Object.keys(e),i=n.length;return!!this._pushInt(i,c.MAP)&&this._pushRawMap(i,n.map(t=>[t,e[t]]))}_pushRawMap(e,t){t=t.map((function(e){return e[0]=A.encode(e[0]),e})).sort(o.keySorter);for(var r=0;r<e;r++){if(!this.push(t[r][0]))return!1;if(!this.pushAny(t[r][1]))return!1}return!0}write(e){return this.pushAny(e)}pushAny(e){var t=I(e);switch(t){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,s.isBuffer(e)?e:s.from(e));case"Null":return this._pushUInt8(w);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case d.NULL:return this._pushObject(null);case d.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(0===this.offset)return null;for(var e=this.result,t=this.resultLength,r=this.resultMethod,n=this.offset,i=0,o=0;o<n;o++)i+=t[o];var a=s.allocUnsafe(i),c=0,u=0;for(o=0;o<n;o++){switch(u=t[o],r[o]){case 0:e[o].copy(a,c);break;case 1:a.writeUInt8(e[o],c,!0);break;case 2:a.writeUInt16BE(e[o],c,!0);break;case 3:a.writeUInt32BE(e[o],c,!0);break;case 4:a.writeDoubleBE(e[o],c,!0);break;case 5:a.write(e[o],c,u,"utf8");break;default:throw new Error("unkown method")}c+=u}var l=a;return this._reset(),l}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(e){const t=new A,r=t.pushAny(e);if(!r)throw new Error("Failed to encode input");return t.finalize()}}e.exports=A},"4442a":function(e,t,r){const s=r("7986"),n=r("451a");e.exports=class{constructor(){this._buffer=new s,this._waitingConsumers=new s}push(e){const{promise:t,resolve:r}=n();return this._buffer.push({chunk:e,resolve:r}),this._consume(),t}_consume(){while(!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty()){const e=this._waitingConsumers.shift(),t=this._buffer.shift();e.resolve(t.chunk),t.resolve()}}shift(){const{promise:e,resolve:t}=n();return this._waitingConsumers.push({resolve:t}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}},"449d":function(e,t,r){"use strict";const s=r("670b"),n=(e,t)=>({path:decodeURIComponent(new URL(e).pathname.split("/").pop()||""),content:i(e,t)});async function*i(e,t){const r=new s,n=await r.get(e,t);yield*n.iterator()}e.exports=n},"44a35":function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MessageDeliveries=t.DeliveryRecordStatus=void 0;const n=r("54f0"),i=s(r("ad75")),o=r("79ff");var a;(function(e){e[e["unknown"]=0]="unknown",e[e["valid"]=1]="valid",e[e["invalid"]=2]="invalid",e[e["ignored"]=3]="ignored"})(a=t.DeliveryRecordStatus||(t.DeliveryRecordStatus={}));class c{constructor(){this.records=new Map,this.queue=new i.default}ensureRecord(e){const t=o.messageIdToString(e);let r=this.records.get(t);if(r)return r;r={status:a.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(t,r);const s={msgId:t,expire:Date.now()+n.TimeCacheDuration};return this.queue.push(s),r}gc(){const e=Date.now();let t=this.queue.peekFront();while(t&&t.expire<e)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}t.MessageDeliveries=c},"44e9":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasGossipProtocol=void 0;const s=r("54f0");function n(e){return e===s.GossipsubIDv10||e===s.GossipsubIDv11}t.hasGossipProtocol=n},4560:function(e,t,r){"use strict";const s=r("4fcb").bind({ignoreUndefined:!0}),n=r("aaf7"),i=r("34eb")("ipfs:mfs:touch"),o=r("b6aa"),{UnixFS:a}=r("9fd0"),c=r("1eaa"),u=r("5688"),l=r("e53b"),d=r("57e0"),{DAGNode:h}=r("8141"),p=r("5d98"),f=r("0e80").multihash,{pipe:y}=r("66f2"),{importer:g}=r("9495"),{recursive:b}=r("d6d7"),m=r("9975"),w=r("3842"),_=r("d32a"),E=r("3ba3"),v=r("a29d"),S={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function I(e,t,r){let s=0;return(e.includes("x")||e.includes("X")&&(r||1&t||8&t||64&t))&&(s+=1),e.includes("w")&&(s+=2),e.includes("r")&&(s+=4),s}function A(e,t){let r=0;return e.includes("u")&&(r+=t<<6),e.includes("g")&&(r+=t<<3),e.includes("o")&&(r+=t),r}function R(e,t,r){return t.includes("t")&&(r+=parseInt("1000",8)),t.includes("s")&&(e.includes("u")&&(r+=parseInt("4000",8)),e.includes("g")&&(r+=parseInt("2000",8))),r}function T(e,t,r){t||(t=0);const s=e.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!s)throw new Error("Invalid file mode: "+e);let[,n,i,o]=s;"a"!==n&&n||(n="ugo");let a=I(o,t,r);return a=A(n,a),a=R(n,o,a),"="===i?(n.includes("u")&&(t&=parseInt("7077",8),t|=a),n.includes("g")&&(t&=parseInt("7707",8),t|=a),n.includes("o")&&(t&=parseInt("7770",8),t|=a),t):"+"===i?a|t:"-"===i?a^t:t}function k(e,t){if(e instanceof String||"string"===typeof e){const r=""+e;e=r.match(/^\d+$/g)?parseInt(r,8):0+r.split(",").reduce((e,r)=>T(r,e,t.isDirectory()),t.mode||0)}return e}e.exports=e=>{async function t(t,r,v={}){const I=s(S,v);i("Fetching stats for "+t);const{cid:A,mfsDirectory:R,name:T}=await n(e,t,I);if("dag-pb"!==A.codec)throw o(new Error(t+" was not a UnixFS node"),"ERR_NOT_UNIXFS");if(I.recursive){const s=await y((async function*(){for await(const s of b(A,e.ipld)){if("file"!==s.type&&"directory"!==s.type)throw o(new Error(t+" was not a UnixFS node"),"ERR_NOT_UNIXFS");s.unixfs.mode=k(r,s.unixfs);const e=new h(s.unixfs.marshal(),s.node.Links);yield{path:s.path,content:e}}}),t=>g(t,e.block,{...I,pin:!1,dagBuilder:async function*(e,t,r){for await(const s of e)yield async function(){const e=s.content,n=e.serialize(),i=await E(n,t,r),o=a.unmarshal(e.Data);return{cid:i,size:n.length,path:s.path,unixfs:o}}}}),e=>m(e));if(!s)throw o(new Error("Could not chmod "+t),"ERR_COULD_NOT_CHMOD");return await _(e)(t,I),void await w(e)("/ipfs/"+s.cid,t,I)}let P=await e.ipld.get(A);const O=a.unmarshal(P.Data);O.mode=k(r,O),P=new h(O.marshal(),P.Links);const N=I.hashAlg||S.hashAlg,D=await e.ipld.put(P,p.DAG_PB,{cidVersion:A.version,hashAlg:f.names[N],onlyHash:!I.flush}),C=await c(e,R),x=C[C.length-1],L=await e.ipld.get(x.cid),M=await u(e,{parent:L,name:T,cid:D,size:P.serialize().length,flush:I.flush,hashAlg:N,cidVersion:A.version,shardSplitThreshold:1/0});x.cid=M.cid;const B=await l(e,C,I);await d(e,B,I)}return v(t)}},4595:function(e,t,r){var s=r("d327");r("b1d4"),s.mgf=s.mgf||{};var n=e.exports=s.mgf.mgf1=s.mgf1=s.mgf1||{};n.create=function(e){var t={generate:function(t,r){for(var n=new s.util.ByteBuffer,i=Math.ceil(r/e.digestLength),o=0;o<i;o++){var a=new s.util.ByteBuffer;a.putInt32(o),e.start(),e.update(t+a.getBytes()),n.putBuffer(e.digest())}return n.truncate(n.length()-r),n.getBytes()}};return t}},"45f8":function(e,t){function r(e,t){"boolean"===typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=r,r.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},r.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},r.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(void 0===r){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1)}var s=this;return this._timer=setTimeout((function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout((function(){s._operationTimeoutCb(s._attempts)}),s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)}),r),this._options.unref&&this._timer.unref(),!0},r.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){r._operationTimeoutCb()}),r._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},r.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},r.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},r.prototype.start=r.prototype.try,r.prototype.errors=function(){return this._errors},r.prototype.attempts=function(){return this._attempts},r.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,r=0,s=0;s<this._errors.length;s++){var n=this._errors[s],i=n.message,o=(e[i]||0)+1;e[i]=o,o>=r&&(t=n,r=o)}return t}},"46f6":function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["libp2p-circuit"]||(s.roots["libp2p-circuit"]={});a.CircuitRelay=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.type=1,e.prototype.srcPeer=null,e.prototype.dstPeer=null,e.prototype.code=100,e.encode=function(e,t){return t||(t=i.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).int32(e.type),null!=e.srcPeer&&Object.hasOwnProperty.call(e,"srcPeer")&&a.CircuitRelay.Peer.encode(e.srcPeer,t.uint32(18).fork()).ldelim(),null!=e.dstPeer&&Object.hasOwnProperty.call(e,"dstPeer")&&a.CircuitRelay.Peer.encode(e.dstPeer,t.uint32(26).fork()).ldelim(),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(32).int32(e.code),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.CircuitRelay;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.type=e.int32();break;case 2:s.srcPeer=a.CircuitRelay.Peer.decode(e,e.uint32());break;case 3:s.dstPeer=a.CircuitRelay.Peer.decode(e,e.uint32());break;case 4:s.code=e.int32();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.CircuitRelay)return e;var t=new a.CircuitRelay;switch(e.type){case"HOP":case 1:t.type=1;break;case"STOP":case 2:t.type=2;break;case"STATUS":case 3:t.type=3;break;case"CAN_HOP":case 4:t.type=4;break}if(null!=e.srcPeer){if("object"!==typeof e.srcPeer)throw TypeError(".CircuitRelay.srcPeer: object expected");t.srcPeer=a.CircuitRelay.Peer.fromObject(e.srcPeer)}if(null!=e.dstPeer){if("object"!==typeof e.dstPeer)throw TypeError(".CircuitRelay.dstPeer: object expected");t.dstPeer=a.CircuitRelay.Peer.fromObject(e.dstPeer)}switch(e.code){case"SUCCESS":case 100:t.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:t.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:t.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:t.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:t.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:t.code=260;break;case"HOP_CANT_DIAL_DST":case 261:t.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:t.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:t.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:t.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:t.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:t.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:t.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:t.code=351;break;case"STOP_RELAY_REFUSED":case 390:t.code=390;break;case"MALFORMED_MESSAGE":case 400:t.code=400;break}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.type=t.enums===String?"HOP":1,r.srcPeer=null,r.dstPeer=null,r.code=t.enums===String?"SUCCESS":100),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?a.CircuitRelay.Type[e.type]:e.type),null!=e.srcPeer&&e.hasOwnProperty("srcPeer")&&(r.srcPeer=a.CircuitRelay.Peer.toObject(e.srcPeer,t)),null!=e.dstPeer&&e.hasOwnProperty("dstPeer")&&(r.dstPeer=a.CircuitRelay.Peer.toObject(e.dstPeer,t)),null!=e.code&&e.hasOwnProperty("code")&&(r.code=t.enums===String?a.CircuitRelay.Status[e.code]:e.code),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.Status=function(){var e={},t=Object.create(e);return t[e[100]="SUCCESS"]=100,t[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,t[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,t[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,t[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,t[e[260]="HOP_NO_CONN_TO_DST"]=260,t[e[261]="HOP_CANT_DIAL_DST"]=261,t[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,t[e[270]="HOP_CANT_SPEAK_RELAY"]=270,t[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,t[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,t[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,t[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,t[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,t[e[390]="STOP_RELAY_REFUSED"]=390,t[e[400]="MALFORMED_MESSAGE"]=400,t}(),e.Type=function(){var e={},t=Object.create(e);return t[e[1]="HOP"]=1,t[e[2]="STOP"]=2,t[e[3]="STATUS"]=3,t[e[4]="CAN_HOP"]=4,t}(),e.Peer=function(){function e(e){if(this.addrs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.id=o.newBuffer([]),e.prototype.addrs=o.emptyArray,e.encode=function(e,t){if(t||(t=i.create()),t.uint32(10).bytes(e.id),null!=e.addrs&&e.addrs.length)for(var r=0;r<e.addrs.length;++r)t.uint32(18).bytes(e.addrs[r]);return t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.CircuitRelay.Peer;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.id=e.bytes();break;case 2:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(e.bytes());break;default:e.skipType(7&i);break}}if(!s.hasOwnProperty("id"))throw o.ProtocolError("missing required 'id'",{instance:s});return s},e.fromObject=function(e){if(e instanceof a.CircuitRelay.Peer)return e;var t=new a.CircuitRelay.Peer;if(null!=e.id&&("string"===typeof e.id?o.base64.decode(e.id,t.id=o.newBuffer(o.base64.length(e.id)),0):e.id.length&&(t.id=e.id)),e.addrs){if(!Array.isArray(e.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");t.addrs=[];for(var r=0;r<e.addrs.length;++r)"string"===typeof e.addrs[r]?o.base64.decode(e.addrs[r],t.addrs[r]=o.newBuffer(o.base64.length(e.addrs[r])),0):e.addrs[r].length&&(t.addrs[r]=e.addrs[r])}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addrs=[]),t.defaults&&(t.bytes===String?r.id="":(r.id=[],t.bytes!==Array&&(r.id=o.newBuffer(r.id)))),null!=e.id&&e.hasOwnProperty("id")&&(r.id=t.bytes===String?o.base64.encode(e.id,0,e.id.length):t.bytes===Array?Array.prototype.slice.call(e.id):e.id),e.addrs&&e.addrs.length){r.addrs=[];for(var s=0;s<e.addrs.length;++s)r.addrs[s]=t.bytes===String?o.base64.encode(e.addrs[s],0,e.addrs[s].length):t.bytes===Array?Array.prototype.slice.call(e.addrs[s]):e.addrs[s]}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e}(),e.exports=a},4706:function(e,t,r){"use strict";const s=r("23bc"),n=r("0eff"),i=e=>{if(e instanceof n)return e;if(!("cid"in e||"hash"in e||"Hash"in e||"multihash"in e))throw new Error("Link must be a DAGLink or DAGLink-like. Convert the DAGNode into a DAGLink via `node.toDAGLink()`.");return new n(e.Name||e.name,e.Tsize||e.size,e.Hash||e.multihash||e.hash||e.cid)},o=(e,t)=>{const r=i(t);e.Links.push(r),s(e.Links)};e.exports=o},"474f":function(e,t,r){"use strict";const s=r("73fb").TYPES;e.exports=e=>{const t={[s.GET_VALUE]:r("df9f")(e),[s.PUT_VALUE]:r("8385")(e),[s.FIND_NODE]:r("9198")(e),[s.ADD_PROVIDER]:r("f410")(e),[s.GET_PROVIDERS]:r("f10b")(e),[s.PING]:r("416e")(e)};function n(e){return t[e]}return n}},4881:function(e,t,r){"use strict";const s=r("b405"),n=r("b306"),i={stat:r("9888")},o={chmod:r("4560"),cp:r("3842"),flush:r("0e65"),mkdir:r("52ea"),mv:r("0592"),rm:r("d32a"),touch:r("d3c6")},a={write:r("15d0"),read:r("93cf"),ls:r("0c1e")},c=({options:e,mfs:t,operations:r,lock:s})=>{Object.keys(r).forEach(n=>{t[n]=s(r[n](e))})},u={repoOwner:!0,ipld:null,repo:null};function l(e){const{repoOwner:t}=Object.assign({},u||{},e);e.repo={blocks:e.blocks,datastore:e.datastore};const r=s(t),n=e=>r.readLock(e),l=e=>r.writeLock(e),d={};return c({options:e,mfs:d,operations:i,lock:n}),c({options:e,mfs:d,operations:o,lock:l}),Object.keys(a).forEach(t=>{d[t]=a[t](e)}),d}e.exports=({ipld:e,block:t,blockService:r,repo:s,preload:i,options:o})=>{const a=l({ipld:e,block:t,blocks:r,datastore:s.root,repoOwner:o.repoOwner}),c=e=>{const t=(...t)=>{const r=t.filter(e=>n.ipfsPath(e)||n.cid(e));if(r.length){const e=t[t.length-1];e&&!1!==e.preload&&r.forEach(e=>i(e))}return e(...t)};return t};return{...a,chmod:a.chmod,cp:c(a.cp),mkdir:a.mkdir,stat:c(a.stat),rm:a.rm,read:c(a.read),touch:a.touch,write:a.write,mv:c(a.mv),flush:a.flush,ls:c((async function*(...e){for await(const t of a.ls(...e))yield{...t,size:t.size||0}}))}}},"499b":function(e,t,r){"use strict";const s=r("a6ce"),n=r("4ca2"),i=r("b6aa");function o(e){return Symbol.iterator in e}function a(e){return Symbol.asyncIterator in e}function c(e){try{if(e instanceof Uint8Array)return async function*(){yield e}();if(o(e))return async function*(){yield*e}();if(a(e))return e}catch{throw i(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw i(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*u(e,t,i){for await(const o of e)if(o.path&&("./"===o.path.substring(0,2)&&(i.wrapWithDirectory=!0),o.path=o.path.split("/").filter(e=>e&&"."!==e).join("/")),o.content){let e,s;e="function"===typeof i.chunker?i.chunker:"rabin"===i.chunker?r("2452"):r("5087"),s="function"===typeof i.chunkValidator?i.chunkValidator:r("7fbe");const a={path:o.path,mtime:o.mtime,mode:o.mode,content:e(s(c(o.content),i),i)};yield()=>n(a,t,i)}else{if(!o.path)throw new Error("Import candidate must have content or path or both");{const e={path:o.path,mtime:o.mtime,mode:o.mode};yield()=>s(e,t,i)}}}e.exports=u},"4aa2":function(e,t,r){"use strict";const s=r("b789"),n=r("345f"),i=r("eddf"),{Key:o}=r("1304"),{default:a}=r("987e"),c=r("7704"),u=r("a9f4");class l{constructor(e,t,r){this.datastore=e,this._log=u.logger(t,"providers"),this.cleanupInterval=c.PROVIDERS_CLEANUP_INTERVAL,this.provideValidity=c.PROVIDERS_VALIDITY,this.lruCacheSize=r||c.PROVIDERS_LRU_CACHE_SIZE,this.providers=s(this.lruCacheSize),this.syncQueue=new a({concurrency:1})}start(){this._cleaner=setInterval(()=>this._cleanup(),this.cleanupInterval)}stop(){this._cleaner&&(clearInterval(this._cleaner),this._cleaner=null)}_cleanup(){return this.syncQueue.add(async()=>{this._log("start cleanup");const e=Date.now();let t=0,r=0;const s=new Map,n=this.datastore.batch(),i=this.datastore.query({prefix:c.PROVIDERS_KEY_PREFIX});for await(const a of i)try{const{cid:e,peerId:i}=p(a.key),o=y(a.value),c=Date.now(),u=c-o,l=u>this.provideValidity;if(this._log("comparing: %d - %d = %d > %d %s",c,o,u,this.provideValidity,l?"(expired)":""),l){r++,n.delete(a.key);const t=s.get(e)||new Set;t.add(i),s.set(e,t)}t++}catch(o){this._log.error(o.message)}this._log("deleting %d / %d entries",r,t),s.size&&await n.commit();for(const[a,c]of s){const e=d(a),t=this.providers.get(e);if(t){for(const e of c)t.delete(e);0===t.size?this.providers.remove(e):this.providers.set(e,t)}}this._log("Cleanup successful (%dms)",Date.now()-e)})}async _getProvidersMap(e){const t=d(e);let r=this.providers.get(t);return r||(r=await f(this.datastore,e),this.providers.set(t,r)),r}async addProvider(e,t){return this.syncQueue.add(async()=>{this._log("addProvider %s",e.toBaseEncodedString());const r=await this._getProvidersMap(e);this._log("loaded %s provs",r.size);const s=new Date;r.set(u.encodeBase32(t.id),s);const n=d(e);return this.providers.set(n,r),h(this.datastore,e,t,s)})}async getProviders(e){return this.syncQueue.add(async()=>{this._log("getProviders %s",e.toBaseEncodedString());const t=await this._getProvidersMap(e);return[...t.keys()].map(e=>new i(u.decodeBase32(e)))})}}function d(e){return e="string"===typeof e?e:u.encodeBase32(e.bytes),c.PROVIDERS_KEY_PREFIX+e}async function h(e,t,r,s){const i=[d(t),"/",u.encodeBase32(r.id)].join(""),a=new o(i),c=Uint8Array.from(n.encode(s.getTime()));return e.put(a,c)}function p(e){const t=e.toString().split("/");if(4!==t.length)throw new Error("incorrectly formatted provider entry key in datastore: "+e);return{cid:t[2],peerId:t[3]}}async function f(e,t){const r=new Map,s=e.query({prefix:d(t)});for await(const n of s){const{peerId:e}=p(n.key);r.set(e,y(n.value))}return r}function y(e){return n.decode(e)}e.exports=l},"4ab6":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ERR_INVALID_PEER_SCORE_THRESHOLDS=t.ERR_INVALID_PEER_SCORE_PARAMS=void 0,t.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS",t.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"},"4be0":function(e,t,r){"use strict";const s=r("d6d7"),n=r("b6aa"),{normalizeCidPath:i,mapFile:o}=r("4d04"),a=r("a29d"),c=r("c449");e.exports=function({ipld:e,preload:t}){async function*r(r,a={}){if(!1!==a.preload){let e;try{e=i(r).split("/")}catch(u){throw n(u,"ERR_INVALID_PATH")}t(new c(e[0]))}for await(const t of s.recursive(r,e,a))yield o(t,{...a,includeContent:!0})}return a(r)}},"4c0c":function(e,t,r){"use strict";const s=r("04ce");class n{constructor(e,t,r){const n=this;this._started=s(),this._rescheduled=0,this._scheduled=t,this._args=r,this._triggered=!1,this._timerWrapper=()=>{n._rescheduled>0?(n._scheduled=n._rescheduled-(s()-n._started),n._schedule(n._scheduled)):(n._triggered=!0,e.apply(null,n._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);const t=s();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=s(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}}function i(){if("function"!==typeof arguments[0])throw new Error("callback needed");if("number"!==typeof arguments[1])throw new Error("timeout needed");let e;if(arguments.length>0){e=new Array(arguments.length-2);for(var t=0;t<e.length;t++)e[t]=arguments[t+2]}return new n(arguments[0],arguments[1],e)}e.exports=i},"4c43":function(e,t,r){"use strict";const s=r("eddf"),{Multiaddr:n}=r("2054"),i=r("b6aa"),{OPEN:o,CLOSING:a,CLOSED:c}=r("b7df"),u=Symbol.for("@libp2p/interface-connection/connection");class l{constructor({localAddr:e,remoteAddr:t,localPeer:r,remotePeer:s,newStream:n,close:i,getStreams:a,stat:c}){d(e,r,s,n,i,a,c),this.id=parseInt(String(1e9*Math.random())).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=t,this.localPeer=r,this.remotePeer=s,this._stat={...c,status:o},this._newStream=n,this._close=i,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[u](){return!0}static isConnection(e){return Boolean(e&&e[u])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===a)throw i(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===c)throw i(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);const{stream:t,protocol:r}=await this._newStream(e);return this.addStream(t,{protocol:r}),{stream:t,protocol:r}}addStream(e,{protocol:t,metadata:r={}}){this.registry.set(e.id,{protocol:t,...r})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==c){if(this._closing)return this._closing;this.stat.status=a,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=c}}}function d(e,t,r,o,a,c,u){if(e&&!n.isMultiaddr(e))throw i(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!s.isPeerId(t))throw i(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!s.isPeerId(r))throw i(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if("function"!==typeof o)throw i(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if("function"!==typeof a)throw i(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if("function"!==typeof c)throw i(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!u)throw i(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if("inbound"!==u.direction&&"outbound"!==u.direction)throw i(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!u.timeline)throw i(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!u.timeline.open)throw i(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!u.timeline.upgraded)throw i(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}e.exports=l},"4c48":function(e,t,r){"use strict";function s(e=[],t={}){return{subscriptions:[],msgs:e,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.createGossipRpc=void 0,t.createGossipRpc=s},"4c63":function(e,t,r){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PeerScore=void 0;const n=r("2103"),i=r("121c"),o=r("8cbc"),a=r("44a35"),c=r("54f0"),u=s(r("eddf")),l=r("34eb"),d=r("a4ad"),{ERR_INVALID_SIGNATURE:h,ERR_MISSING_SIGNATURE:p}=d.codes,f=l("libp2p:gossipsub:score");class y{constructor(e,t,r){n.validatePeerScoreParams(e),this.params=e,this._connectionManager=t,this.peerStats=new Map,this.peerIPs=new Map,this.deliveryRecords=new a.MessageDeliveries,this.msgId=r}start(){this._backgroundInterval?f("Peer score already running"):(this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),f("started"))}stop(){this._backgroundInterval?(clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),f("stopped")):f("Peer score already stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){const e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach((r,s)=>{r.connected?(Object.entries(r.topics).forEach(([r,s])=>{const n=this.params.topics[r];n&&(s.firstMessageDeliveries*=n.firstMessageDeliveriesDecay,s.firstMessageDeliveries<t&&(s.firstMessageDeliveries=0),s.meshMessageDeliveries*=n.meshMessageDeliveriesDecay,s.meshMessageDeliveries<t&&(s.meshMessageDeliveries=0),s.meshFailurePenalty*=n.meshFailurePenaltyDecay,s.meshFailurePenalty<t&&(s.meshFailurePenalty=0),s.invalidMessageDeliveries*=n.invalidMessageDeliveriesDecay,s.invalidMessageDeliveries<t&&(s.invalidMessageDeliveries=0),s.inMesh&&(s.meshTime=e-s.graftTime,s.meshTime>n.meshMessageDeliveriesActivation&&(s.meshMessageDeliveriesActive=!0)))}),r.behaviourPenalty*=this.params.behaviourPenaltyDecay,r.behaviourPenalty<t&&(r.behaviourPenalty=0)):e>r.expire&&(this._removeIPs(s,r.ips),this.peerStats.delete(s))})}score(e){const t=this.peerStats.get(e);return t?o.computeScore(e,t,this.params,this.peerIPs):0}addPenalty(e,t){const r=this.peerStats.get(e);r&&(r.behaviourPenalty+=t)}addPeer(e){const t=i.createPeerStats({connected:!0});this.peerStats.set(e,t);const r=this._getIPs(e);this._setIPs(e,r,t.ips),t.ips=r}removePeer(e){const t=this.peerStats.get(e);if(t){if(this.score(e)>0)return this._removeIPs(e,t.ips),void this.peerStats.delete(e);Object.entries(t.topics).forEach(([e,t])=>{t.firstMessageDeliveries=0;const r=this.params.topics[e].meshMessageDeliveriesThreshold;if(t.inMesh&&t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<r){const e=r-t.meshMessageDeliveries;t.meshFailurePenalty+=e*e}t.inMesh=!1}),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){const r=this.peerStats.get(e);if(!r)return;const s=i.ensureTopicStats(t,r,this.params);s&&(s.inMesh=!0,s.graftTime=Date.now(),s.meshTime=0,s.meshMessageDeliveriesActive=!1)}prune(e,t){const r=this.peerStats.get(e);if(!r)return;const s=i.ensureTopicStats(t,r,this.params);if(!s)return;const n=this.params.topics[t].meshMessageDeliveriesThreshold;if(s.meshMessageDeliveriesActive&&s.meshMessageDeliveries<n){const e=n-s.meshMessageDeliveries;s.meshFailurePenalty+=e*e}s.inMesh=!1}validateMessage(e){this.deliveryRecords.ensureRecord(this.msgId(e))}deliverMessage(e){const t=e.receivedFrom;this._markFirstMessageDelivery(t,e);const r=this.deliveryRecords.ensureRecord(this.msgId(e)),s=Date.now();r.status===a.DeliveryRecordStatus.unknown?(r.status=a.DeliveryRecordStatus.valid,r.validated=s,r.peers.forEach(r=>{r!==t&&this._markDuplicateMessageDelivery(r,e)})):f("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",t,s-r.firstSeen,a.DeliveryRecordStatus[r.status])}rejectMessage(e,t){const r=e.receivedFrom;switch(t){case p:case h:return void this._markInvalidMessageDelivery(r,e)}const s=this.deliveryRecords.ensureRecord(this.msgId(e));if(s.status===a.DeliveryRecordStatus.unknown){switch(t){case c.ERR_TOPIC_VALIDATOR_IGNORE:return void(s.status=a.DeliveryRecordStatus.ignored)}s.status=a.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(r,e),s.peers.forEach(t=>{this._markInvalidMessageDelivery(t,e)})}else f("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",r,Date.now()-s.firstSeen,a.DeliveryRecordStatus[s.status])}duplicateMessage(e){const t=e.receivedFrom,r=this.deliveryRecords.ensureRecord(this.msgId(e));if(!r.peers.has(t))switch(r.status){case a.DeliveryRecordStatus.unknown:r.peers.add(t);break;case a.DeliveryRecordStatus.valid:r.peers.add(t),this._markDuplicateMessageDelivery(t,e,r.validated);break;case a.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(t,e);break}}_markInvalidMessageDelivery(e,t){const r=this.peerStats.get(e);r&&t.topicIDs.forEach(e=>{const t=i.ensureTopicStats(e,r,this.params);t&&(t.invalidMessageDeliveries+=1)})}_markFirstMessageDelivery(e,t){const r=this.peerStats.get(e);r&&t.topicIDs.forEach(e=>{const t=i.ensureTopicStats(e,r,this.params);if(!t)return;let s=this.params.topics[e].firstMessageDeliveriesCap;t.firstMessageDeliveries+=1,t.firstMessageDeliveries>s&&(t.firstMessageDeliveries=s),t.inMesh&&(s=this.params.topics[e].meshMessageDeliveriesCap,t.meshMessageDeliveries+=1,t.meshMessageDeliveries>s&&(t.meshMessageDeliveries=s))})}_markDuplicateMessageDelivery(e,t,r=0){const s=this.peerStats.get(e);if(!s)return;const n=r?Date.now():0;t.topicIDs.forEach(e=>{const t=i.ensureTopicStats(e,s,this.params);if(!t)return;if(!t.inMesh)return;const o=this.params.topics[e];if(r&&n>r+o.meshMessageDeliveriesWindow)return;const a=o.meshMessageDeliveriesCap;t.meshMessageDeliveries+=1,t.meshMessageDeliveries>a&&(t.meshMessageDeliveries=a)})}_getIPs(e){return this._connectionManager.getAll(u.default.createFromB58String(e)).map(e=>e.remoteAddr.toOptions().host)}_setIPs(e,t,r){e:for(const s of t){for(const e of r)if(s===e)continue e;let t=this.peerIPs.get(s);t||(t=new Set,this.peerIPs.set(s,t)),t.add(e)}e:for(const s of r){for(const e of t)if(s===e)continue e;const r=this.peerIPs.get(s);r&&(r.delete(e),r.size||this.peerIPs.delete(s))}}_removeIPs(e,t){t.forEach(t=>{const r=this.peerIPs.get(t);r&&(r.delete(e),r.size||this.peerIPs.delete(t))})}_updateIPs(){this.peerStats.forEach((e,t)=>{const r=this._getIPs(t);this._setIPs(t,r,e.ips),e.ips=r})}}t.PeerScore=y},"4c82":function(e,t,r){"use strict";const s=r("38425").version;e.exports.PROTOCOL_VERSION="ipfs/0.1.0",e.exports.AGENT_VERSION="js-libp2p/"+s,e.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0",e.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0"},"4ca2":function(e,t,r){"use strict";const s=r("b6aa"),{UnixFS:n}=r("9fd0"),i=r("3ba3"),{DAGNode:o,DAGLink:a}=r("8141"),c=r("e4e2"),u=r("0e80").multihash,l={flat:r("2bc2"),balanced:r("d4ba"),trickle:r("8992")};async function*d(e,t,s){let n,i,o=-1;i="function"===typeof s.bufferImporter?s.bufferImporter:r("af60");for await(const r of c(i(e,t,s),s.blockWriteConcurrency))o++,0!==o?(1===o&&n&&(yield n,n=null),yield r):n=r;n&&(n.single=!0,yield n)}const h=(e,t,r)=>{async function s(s){if(1===s.length&&s[0].single&&r.reduceSingleLeafToSelf){const a=s[0];if("raw"===a.cid.codec&&(void 0!==e.mtime||void 0!==e.mode)){let{data:s}=await t.get(a.cid,r);a.unixfs=new n({type:"file",mtime:e.mtime,mode:e.mode,data:s});const c=u.decode(a.cid.multihash);s=new o(a.unixfs.marshal()).serialize(),a.cid=await i(s,t,{...r,codec:"dag-pb",hashAlg:c.name,cidVersion:r.cidVersion}),a.size=s.length}return{cid:a.cid,path:e.path,unixfs:a.unixfs,size:a.size}}const c=new n({type:"file",mtime:e.mtime,mode:e.mode}),l=s.filter(e=>!("raw"!==e.cid.codec||!e.size)||(!(!e.unixfs||e.unixfs.data||!e.unixfs.fileSize())||Boolean(e.unixfs&&e.unixfs.data&&e.unixfs.data.length))).map(e=>"raw"===e.cid.codec?(c.addBlockSize(e.size),new a("",e.size,e.cid)):(e.unixfs&&e.unixfs.data?c.addBlockSize(e.unixfs.data.length):c.addBlockSize(e.unixfs&&e.unixfs.fileSize()||0),new a("",e.size,e.cid))),d=new o(c.marshal(),l),h=d.serialize(),p=await i(h,t,r);return{cid:p,path:e.path,unixfs:c,size:h.length+d.Links.reduce((e,t)=>e+t.Tsize,0)}}return s};function p(e,t,r){const n=l[r.strategy];if(!n)throw s(new Error("Unknown importer build strategy name: "+r.strategy),"ERR_BAD_STRATEGY");return n(d(e,t,r),h(e,t,r),r)}e.exports=p},"4d04":function(e,t,r){"use strict";const s=r("b306"),n=r("c449"),i=r("1304").Key,o=r("b6aa"),a=r("a29d"),c=r("4fcb"),u=r("266c");t.mergeOptions=c;const l="ERR_BAD_PATH";t.OFFLINE_ERROR="This command must be run in online mode. Try running 'ipfs daemon' first.",t.MFS_ROOT_KEY=new i("/local/filesroot"),t.MFS_MAX_CHUNK_SIZE=262144,t.MFS_MAX_LINKS=174;const d=e=>{if(s.cid(e)||n.isCID(e))return"/ipfs/"+new n(e);if(s.path(e))return e;throw o(new Error("invalid path: "+e),l)},h=e=>e instanceof Uint8Array?new n(e).toString():n.isCID(e)?e.toString():(0===e.indexOf("/ipfs/")&&(e=e.substring("/ipfs/".length)),"/"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),e),p=async function(e,t,r={}){const s=()=>{};s.stop=()=>{},s.start=()=>{};const{cid:n}=await u({ipld:e,preload:s})(t,{preload:!1});return n},f=(e,t={})=>{if("file"!==e.type&&"directory"!==e.type&&"raw"!==e.type)throw new Error(`Unknown node type '${e.type}'`);const r={cid:e.cid,path:e.path,name:e.name,depth:e.path.split("/").length,size:e.size,type:"file"};return"directory"===e.type&&(r.type="dir"),"file"===e.type&&(r.size=e.unixfs.fileSize()),"file"!==e.type&&"directory"!==e.type||(r.mode=e.unixfs.mode,void 0!==e.unixfs.mtime&&(r.mtime=e.unixfs.mtime)),t.includeContent&&("file"!==e.type&&"raw"!==e.type||(r.content=e.content())),r},y=a(async(e,t)=>await e);t.normalizePath=d,t.normalizeCidPath=h,t.resolvePath=p,t.mapFile=f,t.withTimeoutOption=a,t.withTimeout=y},"4d2c":function(e,t,r){"use strict";const{isValidMultiaddr:s}=r("ac55"),n=r("a29d");e.exports=({repo:e})=>{async function t(t,r={}){if(!s(t))throw new Error(t+" is not a valid Multiaddr");const n=await e.config.getAll(r);return n.Bootstrap=(n.Bootstrap||[]).filter(e=>e.toString()!==t.toString()),await e.config.replace(n),{Peers:[t]}}return n(t)}},"4d4f":function(e,t,r){"use strict";e.exports=function(){return Date.now()}},"4d9b":function(e,t,r){"use strict";const s=r("ec58");e.exports=s},"4e03":function(e,t,r){"use strict";const s=r("c449"),n=r("0e80"),{multihash:i}=n,o=r("5d98");e.exports={codec:o.RAW,defaultHashAlg:i.names["sha2-256"],resolver:{resolve:(e,t)=>{if("/"!==t)throw new Error("Only the root path / may be resolved");return{value:e,remainderPath:""}},async*tree(e){}},util:{deserialize:e=>e,serialize:e=>e,cid:async(t,r={})=>{const a={cidVersion:null==r.cidVersion?1:r.cidVersion,hashAlg:null==r.hashAlg?e.exports.defaultHashAlg:r.hashAlg},c=i.codes[a.hashAlg],u=await n(t,c),l=o.getNameFromCode(e.exports.codec),d=new s(a.cidVersion,l,u);return d}}}},"4e81":function(e,t,r){"use strict";const s=r("4fcb"),n=r("5d98"),i={get[n.DAG_PB](){return r("8141")},get[n.DAG_CBOR](){return r("3ed3")},get[n.RAW](){return r("4e03")}};e.exports=(e,t)=>s.call({concatArrays:!0},{blockService:e,formats:[],loadFormat:e=>{if(i[e])return Promise.resolve(i[e]);throw new Error(`Missing IPLD format "${n.getName(e)}"`)}},t)},"4ee3":function(e,t,r){"use strict";const s=r("a29d"),n=r("1f97");e.exports=({ipld:e,preload:t})=>{async function*r(r,s={}){const{cid:i,path:o}=n(r);o&&(s.path=o),!1!==s.preload&&t(i),yield*e.tree(i,s.path,s)}return s(r)}},"4f17":function(e,t,r){"use strict";class s{constructor(){this.queries=new Set,this.running=!1}queryStarted(e){this.queries.add(e)}queryCompleted(e){this.queries.delete(e)}start(){this.running=!0}stop(){this.running=!1;for(const e of this.queries)e.stop();this.queries.clear()}}e.exports=s},"4f9c":function(e,t,r){"use strict";const s=r("a29d");e.exports=({keychain:e})=>{const t=t=>e.removeKey(t);return s(t)}},"4fcb":function(e,t,r){"use strict";const s=r("3642"),{hasOwnProperty:n}=Object.prototype,{propertyIsEnumerable:i}=Object,o=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0}),a=this,c={concatArrays:!1,ignoreUndefined:!1},u=e=>{const t=[];for(const r in e)n.call(e,r)&&t.push(r);if(Object.getOwnPropertySymbols){const r=Object.getOwnPropertySymbols(e);for(const s of r)i.call(e,s)&&t.push(s)}return t};function l(e){return Array.isArray(e)?d(e):s(e)?h(e):e}function d(e){const t=e.slice(0,0);return u(e).forEach(r=>{o(t,r,l(e[r]))}),t}function h(e){const t=null===Object.getPrototypeOf(e)?Object.create(null):{};return u(e).forEach(r=>{o(t,r,l(e[r]))}),t}const p=(e,t,r,s)=>(r.forEach(r=>{"undefined"===typeof t[r]&&s.ignoreUndefined||(r in e&&e[r]!==Object.getPrototypeOf(e)?o(e,r,y(e[r],t[r],s)):o(e,r,l(t[r])))}),e),f=(e,t,r)=>{let s=e.slice(0,0),i=0;return[e,t].forEach(t=>{const a=[];for(let r=0;r<t.length;r++)n.call(t,r)&&(a.push(String(r)),o(s,i++,t===e?t[r]:l(t[r])));s=p(s,t,u(t).filter(e=>!a.includes(e)),r)}),s};function y(e,t,r){return r.concatArrays&&Array.isArray(e)&&Array.isArray(t)?f(e,t,r):s(t)&&s(e)?p(e,t,u(t),r):l(t)}e.exports=function(...e){const t=y(l(c),this!==a&&this||{},c);let r={_:{}};for(const n of e)if(void 0!==n){if(!s(n))throw new TypeError("`"+n+"` is not an Option Object");r=y(r,{_:n},t)}return r._}},"4fcf7":function(e,t,r){"use strict";const s=r("e4e8"),{resolvePath:n}=r("4d04"),i=r("a29d"),{PinTypes:o}=r("d507");e.exports=({pinManager:e,gcLock:t,ipld:r})=>{async function*a(i,a={}){const c=await t.readLock();try{for await(const{path:t,recursive:a}of s(i)){const s=await n(r,t),{pinned:i,reason:c}=await e.isPinnedWithType(s,o.all);if(!i)throw new Error(s+" is not pinned");switch(c){case o.recursive:if(!a)throw new Error(s+" is pinned recursively");await e.unpin(s),yield s;break;case o.direct:await e.unpin(s),yield s;break;default:throw new Error(`${s} is pinned indirectly under ${c}`)}}}finally{c()}}return i(a)}},"4fd0":function(e,t,r){"use strict";const s=r("1c94"),n=r("a32a"),i=r("c2a4"),o=r("7f5a");class a{constructor({ipld:e,preload:t,gcLock:r}){this.addLink=s({ipld:e,preload:t,gcLock:r}),this.appendData=n({ipld:e,preload:t,gcLock:r}),this.rmLink=i({ipld:e,preload:t,gcLock:r}),this.setData=o({ipld:e,preload:t,gcLock:r})}}e.exports=a},"500d":function(e,t,r){"use strict";const s=r("0ad6"),n=async function*(...e){const t=s();setTimeout(async()=>{try{await Promise.all(e.map(async e=>{for await(const r of e)t.push(r)})),t.end()}catch(r){t.end(r)}},0),yield*t};e.exports=n},"505b":function(e,t,r){"use strict";e.exports={autoMigrate:!0,onMigrationProgress:()=>{},lock:"memory",storageBackends:{root:r("5eec"),blocks:r("5eec"),keys:r("5eec"),datastore:r("5eec"),pins:r("5eec")},storageBackendOptions:{root:{extension:"",prefix:"",version:2},blocks:{sharding:!1,prefix:"",version:2},keys:{sharding:!1,prefix:"",version:2},datastore:{sharding:!1,prefix:"",version:2},pins:{sharding:!1,prefix:"",version:2}}}},5061:function(e,t,r){"use strict";const s=r("910b");e.exports=({network:e,preload:t,peerId:r,keychain:n,repo:i,ipns:o,blockService:a,mfsPreload:c,print:u,options:l})=>{const d=async()=>{const{bitswap:d,libp2p:h}=await s.start(e,{peerId:r,repo:i,print:u,options:l});a.setExchange(d),await Promise.all([o.startOnline({keychain:n,libp2p:h,peerId:r,repo:i}),t.start(),c.start()])};return d}},5076:function(e,t,r){"use strict";const s=r("85be"),n=s.MT,i=s.SIMPLE,o=s.SYMS;class a{constructor(e){if("number"!==typeof e)throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(0|e)!==e)throw new Error("value must be a small positive integer: "+e);this.value=e}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(e){return e._pushInt(this.value,n.SIMPLE_FLOAT)}static isSimple(e){return e instanceof a}static decode(e,t){switch(null==t&&(t=!0),e){case i.FALSE:return!1;case i.TRUE:return!0;case i.NULL:return t?null:o.NULL;case i.UNDEFINED:return t?void 0:o.UNDEFINED;case-1:if(!t)throw new Error("Invalid BREAK");return o.BREAK;default:return new a(e)}}}e.exports=a},5087:function(e,t,r){"use strict";const s=r("3301");e.exports=async function*(e,t){let r=new s,n=0,i=!1;const o=t.maxChunkSize;for await(const a of e){r.append(a),n+=a.length;while(n>=o)if(yield r.slice(0,o),i=!0,o===r.length)r=new s,n=0;else{const e=new s;e.append(r.shallowSlice(o)),r=e,n-=o}}i&&!n||(yield r.slice(0,n))}},"509b":function(e,t,r){"use strict";const s=r("b2a9"),n=r("b846"),{UnixFS:i}=r("9fd0"),o=r("b6aa");async function*a(e,t,r,n,c=0,u){if(t instanceof Uint8Array){const e=s(t,c,r,n);return e.length&&(yield e),c+=e.length,c}let l;try{l=i.unmarshal(t.Data)}catch(h){throw o(h,"ERR_NOT_UNIXFS")}if(l.data&&l.data.length){const e=s(l.data,c,r,n);e.length&&(yield e),c+=l.data.length}let d=c;for(let s=0;s<t.Links.length;s++){const i=t.Links[s],o=c+l.blockSizes[s];if(r>=d&&r<o||n>d&&n<=o||r<d&&n>o){const t=await e.get(i.Hash,{signal:u.signal});for await(const s of a(e,t,r,n,c,u))c+=s.length,yield s}c=o,d=o+1}}const c=(e,t,r,s,i,o,c)=>{function u(e={}){const s=r.fileSize();if(void 0===s)throw new Error("File was a directory");const{offset:i,length:o}=n(s,e.offset,e.length),u=i,l=i+o;return a(c,t,u,l,0,e)}return u};e.exports=c},5102:function(e,t,r){var s=e.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];e.exports.errno={},e.exports.code={},s.forEach((function(t){e.exports.errno[t.errno]=t,e.exports.code[t.code]=t})),e.exports.custom=r("eb8b")(e.exports),e.exports.create=e.exports.custom.createError},5144:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("ac23"),n=r("1755"),i=r("0ad3");const o={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class a{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){const e=this.data[this.pos];let t=i.quick[e];if(void 0===t){const r=i.jump[e];if(!r)throw new Error(`${s.decodeErrPrefix} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const n=31&e;t=r(this.data,this.pos,n,this.options)}return this.pos+=t.encodedLength,t}}const c=Symbol.for("DONE"),u=Symbol.for("BREAK");function l(e,t,r){const n=[];for(let i=0;i<e.value;i++){const o=h(t,r);if(o===u){if(e.value===1/0)break;throw new Error(s.decodeErrPrefix+" got unexpected break to lengthed array")}if(o===c)throw new Error(`${s.decodeErrPrefix} found array but not enough entries (got ${i}, expected ${e.value})`);n[i]=o}return n}function d(e,t,r){const n=!0===r.useMaps,i=n?void 0:{},o=n?new Map:void 0;for(let a=0;a<e.value;a++){const l=h(t,r);if(l===u){if(e.value===1/0)break;throw new Error(s.decodeErrPrefix+" got unexpected break to lengthed map")}if(l===c)throw new Error(`${s.decodeErrPrefix} found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(!0!==n&&"string"!==typeof l)throw new Error(`${s.decodeErrPrefix} non-string keys not supported (got ${typeof l})`);const d=h(t,r);if(d===c)throw new Error(`${s.decodeErrPrefix} found map but not enough entries (got ${a} [no value], expected ${e.value})`);n?o.set(l,d):i[l]=d}return n?o:i}function h(e,t){if(e.done())return c;const r=e.next();if(r.type===n.Type.break)return u;if(r.type.terminal)return r.value;if(r.type===n.Type.array)return l(r,e,t);if(r.type===n.Type.map)return d(r,e,t);if(r.type===n.Type.tag){if(t.tags&&"function"===typeof t.tags[r.value]){const s=h(e,t);return t.tags[r.value](s)}throw new Error(`${s.decodeErrPrefix} tag not supported (${r.value})`)}throw new Error("unsupported")}function p(e,t){if(!(e instanceof Uint8Array))throw new Error(s.decodeErrPrefix+" data to decode must be a Uint8Array");t=Object.assign({},o,t);const r=t.tokenizer||new a(e,t),n=h(r,t);if(n===c)throw new Error(s.decodeErrPrefix+" did not find any content to decode");if(n===u)throw new Error(s.decodeErrPrefix+" got unexpected break");if(!r.done())throw new Error(s.decodeErrPrefix+" too many terminals, data makes no sense");return n}t.Tokeniser=a,t.decode=p,t.tokensToObject=h},"519e":function(e,t,r){"use strict";const s=r("34eb"),{cidToString:n}=r("a2b5"),i=Object.assign(s("ipfs:mfs-preload"),{error:s("ipfs:mfs-preload:error")});e.exports=({preload:e,files:t,options:r={}})=>{if(r.interval=r.interval||3e4,!r.enabled){i("MFS preload disabled");const e=async()=>{};return{start:e,stop:e}}let s,o="";const a=async()=>{try{const c=await t.stat("/"),u=n(c.cid,{base:"base32"});o!==u&&(i(`preloading updated MFS root ${o} -> ${c.cid}`),await e(c.cid),o=u)}catch(c){i.error("failed to preload MFS root",c)}finally{s=setTimeout(a,r.interval)}};return{async start(){const e=await t.stat("/");o=n(e.cid,{base:"base32"}),i("monitoring MFS root "+e.cid),s=setTimeout(a,r.interval)},stop(){clearTimeout(s)}}}},"51e8":function(e,t,r){var s=r("d327");r("0069"),r("8272"),r("2cf7"),r("eb9d"),r("5677"),r("f76f"),r("b1ab"),r("b380"),r("a842"),r("b1d4");var n=s.asn1,i=e.exports=s.pki=s.pki||{},o=i.oids,a={};a["CN"]=o["commonName"],a["commonName"]="CN",a["C"]=o["countryName"],a["countryName"]="C",a["L"]=o["localityName"],a["localityName"]="L",a["ST"]=o["stateOrProvinceName"],a["stateOrProvinceName"]="ST",a["O"]=o["organizationName"],a["organizationName"]="O",a["OU"]=o["organizationalUnitName"],a["organizationalUnitName"]="OU",a["E"]=o["emailAddress"],a["emailAddress"]="E";var c=s.pki.rsa.publicKeyValidator,u={name:"Certificate",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:n.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:n.Class.UNIVERSAL,type:n.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:n.Class.UNIVERSAL,type:n.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:n.Class.UNIVERSAL,type:n.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:n.Class.UNIVERSAL,type:n.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},c,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:n.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:n.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:n.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},l={name:"rsapss",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:n.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:n.Class.UNIVERSAL,type:n.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:n.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:n.Class.UNIVERSAL,type:n.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},d={name:"CertificationRequestInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},c,{name:"CertificationRequestInfo.attributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:!0}]}]}]},h={name:"CertificationRequest",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[d,{name:"CertificationRequest.signatureAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:n.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function p(e,t){"string"===typeof t&&(t={shortName:t});for(var r,s=null,n=0;null===s&&n<e.attributes.length;++n)r=e.attributes[n],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(s=r);return s}i.RDNAttributesAsArray=function(e,t){for(var r,s,i,c=[],u=0;u<e.value.length;++u){r=e.value[u];for(var l=0;l<r.value.length;++l)i={},s=r.value[l],i.type=n.derToOid(s.value[0].value),i.value=s.value[1].value,i.valueTagClass=s.value[1].type,i.type in o&&(i.name=o[i.type],i.name in a&&(i.shortName=a[i.name])),t&&(t.update(i.type),t.update(i.value)),c.push(i)}return c},i.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var s=e[r],c=n.derToOid(s.value[0].value),u=s.value[1].value,l=0;l<u.length;++l){var d={};if(d.type=c,d.value=u[l].value,d.valueTagClass=u[l].type,d.type in o&&(d.name=o[d.type],d.name in a&&(d.shortName=a[d.name])),d.type===o.extensionRequest){d.extensions=[];for(var h=0;h<d.value.length;++h)d.extensions.push(i.certificateExtensionFromAsn1(d.value[h]))}t.push(d)}return t};var f=function(e,t,r){var s={};if(e!==o["RSASSA-PSS"])return s;r&&(s={hash:{algorithmOid:o["sha1"]},mgf:{algorithmOid:o["mgf1"],hash:{algorithmOid:o["sha1"]}},saltLength:20});var i={},a=[];if(!n.validate(t,l,i,a)){var c=new Error("Cannot read RSASSA-PSS parameter block.");throw c.errors=a,c}return void 0!==i.hashOid&&(s.hash=s.hash||{},s.hash.algorithmOid=n.derToOid(i.hashOid)),void 0!==i.maskGenOid&&(s.mgf=s.mgf||{},s.mgf.algorithmOid=n.derToOid(i.maskGenOid),s.mgf.hash=s.mgf.hash||{},s.mgf.hash.algorithmOid=n.derToOid(i.maskGenHashOid)),void 0!==i.saltLength&&(s.saltLength=i.saltLength.charCodeAt(0)),s};function y(e){for(var t,r,i=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),o=e.attributes,a=0;a<o.length;++a){t=o[a];var c=t.value,u=n.Type.PRINTABLESTRING;"valueTagClass"in t&&(u=t.valueTagClass,u===n.Type.UTF8&&(c=s.util.encodeUtf8(c))),r=n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(t.type).getBytes()),n.create(n.Class.UNIVERSAL,u,!1,c)])]),i.value.push(r)}return i}function g(e){for(var t,r=0;r<e.length;++r){if(t=e[r],"undefined"===typeof t.name&&(t.type&&t.type in i.oids?t.name=i.oids[t.type]:t.shortName&&t.shortName in a&&(t.name=i.oids[a[t.shortName]])),"undefined"===typeof t.type){if(!t.name||!(t.name in i.oids)){var s=new Error("Attribute type not specified.");throw s.attribute=t,s}t.type=i.oids[t.name]}if("undefined"===typeof t.shortName&&t.name&&t.name in a&&(t.shortName=a[t.name]),t.type===o.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=n.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var c=0;c<t.extensions.length;++c)t.value.push(i.certificateExtensionToAsn1(b(t.extensions[c])))}if("undefined"===typeof t.value){s=new Error("Attribute value not specified.");throw s.attribute=t,s}}}function b(e,t){if(t=t||{},"undefined"===typeof e.name&&e.id&&e.id in i.oids&&(e.name=i.oids[e.id]),"undefined"===typeof e.id){if(!e.name||!(e.name in i.oids)){var r=new Error("Extension ID not specified.");throw r.extension=e,r}e.id=i.oids[e.name]}if("undefined"!==typeof e.value)return e;if("keyUsage"===e.name){var a=0,c=0,u=0;e.digitalSignature&&(c|=128,a=7),e.nonRepudiation&&(c|=64,a=6),e.keyEncipherment&&(c|=32,a=5),e.dataEncipherment&&(c|=16,a=4),e.keyAgreement&&(c|=8,a=3),e.keyCertSign&&(c|=4,a=2),e.cRLSign&&(c|=2,a=1),e.encipherOnly&&(c|=1,a=0),e.decipherOnly&&(u|=128,a=7);var l=String.fromCharCode(a);0!==u?l+=String.fromCharCode(c)+String.fromCharCode(u):0!==c&&(l+=String.fromCharCode(c)),e.value=n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,l)}else if("basicConstraints"===e.name)e.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(n.create(n.Class.UNIVERSAL,n.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);var d=e.value.value;for(var h in e)!0===e[h]&&(h in o?d.push(n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(o[h]).getBytes())):-1!==h.indexOf(".")&&d.push(n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(h).getBytes())))}else if("nsCertType"===e.name){a=0,c=0;e.client&&(c|=128,a=7),e.server&&(c|=64,a=6),e.email&&(c|=32,a=5),e.objsign&&(c|=16,a=4),e.reserved&&(c|=8,a=3),e.sslCA&&(c|=4,a=2),e.emailCA&&(c|=2,a=1),e.objCA&&(c|=1,a=0);l=String.fromCharCode(a);0!==c&&(l+=String.fromCharCode(c)),e.value=n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,l)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);for(var p=0;p<e.altNames.length;++p){w=e.altNames[p];l=w.value;if(7===w.type&&w.ip){if(l=s.util.bytesFromIP(w.ip),null===l){r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=e,r}}else 8===w.type&&(l=w.oid?n.oidToDer(n.oidToDer(w.oid)):n.oidToDer(l));e.value.value.push(n.create(n.Class.CONTEXT_SPECIFIC,w.type,!1,l))}}else if("nsComment"===e.name&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=n.create(n.Class.UNIVERSAL,n.Type.IA5STRING,!1,e.comment)}else if("subjectKeyIdentifier"===e.name&&t.cert){var f=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=f.toHex(),e.value=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,f.getBytes())}else if("authorityKeyIdentifier"===e.name&&t.cert){e.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);d=e.value.value;if(e.keyIdentifier){var g=!0===e.keyIdentifier?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;d.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!1,g))}if(e.authorityCertIssuer){var b=[n.create(n.Class.CONTEXT_SPECIFIC,4,!0,[y(!0===e.authorityCertIssuer?t.cert.issuer:e.authorityCertIssuer)])];d.push(n.create(n.Class.CONTEXT_SPECIFIC,1,!0,b))}if(e.serialNumber){var m=s.util.hexToBytes(!0===e.serialNumber?t.cert.serialNumber:e.serialNumber);d.push(n.create(n.Class.CONTEXT_SPECIFIC,2,!1,m))}}else if("cRLDistributionPoints"===e.name){e.value=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);d=e.value.value;var w,_=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),E=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[]);for(p=0;p<e.altNames.length;++p){w=e.altNames[p];l=w.value;if(7===w.type&&w.ip){if(l=s.util.bytesFromIP(w.ip),null===l){r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=e,r}}else 8===w.type&&(l=w.oid?n.oidToDer(n.oidToDer(w.oid)):n.oidToDer(l));E.value.push(n.create(n.Class.CONTEXT_SPECIFIC,w.type,!1,l))}_.value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[E])),d.push(_)}if("undefined"===typeof e.value){r=new Error("Extension value not specified.");throw r.extension=e,r}return e}function m(e,t){switch(e){case o["RSASSA-PSS"]:var r=[];return void 0!==t.hash.algorithmOid&&r.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(t.hash.algorithmOid).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(n.create(n.Class.CONTEXT_SPECIFIC,1,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(t.mgf.algorithmOid).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(t.mgf.hash.algorithmOid).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(n.create(n.Class.CONTEXT_SPECIFIC,2,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(t.saltLength).getBytes())])),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,r);default:return n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")}}function w(e){var t=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var r=e.attributes,i=0;i<r.length;++i){var o=r[i],a=o.value,c=n.Type.UTF8;"valueTagClass"in o&&(c=o.valueTagClass),c===n.Type.UTF8&&(a=s.util.encodeUtf8(a));var u=!1;"valueConstructed"in o&&(u=o.valueConstructed);var l=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(o.type).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[n.create(n.Class.UNIVERSAL,c,u,a)])]);t.value.push(l)}return t}i.certificateFromPem=function(e,t,r){var o=s.pem.decode(e)[0];if("CERTIFICATE"!==o.type&&"X509 CERTIFICATE"!==o.type&&"TRUSTED CERTIFICATE"!==o.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var c=n.fromDer(o.body,r);return i.certificateFromAsn1(c,t)},i.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:n.toDer(i.certificateToAsn1(e)).getBytes()};return s.pem.encode(r,{maxline:t})},i.publicKeyFromPem=function(e){var t=s.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var o=n.fromDer(t.body);return i.publicKeyFromAsn1(o)},i.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:n.toDer(i.publicKeyToAsn1(e)).getBytes()};return s.pem.encode(r,{maxline:t})},i.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:n.toDer(i.publicKeyToRSAPublicKey(e)).getBytes()};return s.pem.encode(r,{maxline:t})},i.getPublicKeyFingerprint=function(e,t){t=t||{};var r,o=t.md||s.md.sha1.create(),a=t.type||"RSAPublicKey";switch(a){case"RSAPublicKey":r=n.toDer(i.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":r=n.toDer(i.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}o.start(),o.update(r);var c=o.digest();if("hex"===t.encoding){var u=c.toHex();return t.delimiter?u.match(/.{2}/g).join(t.delimiter):u}if("binary"===t.encoding)return c.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return c},i.certificationRequestFromPem=function(e,t,r){var o=s.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==o.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var c=n.fromDer(o.body,r);return i.certificationRequestFromAsn1(c,t)},i.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:n.toDer(i.certificationRequestToAsn1(e)).getBytes()};return s.pem.encode(r,{maxline:t})},i.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return p(e.issuer,t)},e.issuer.addField=function(t){g([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return p(e.subject,t)},e.subject.addField=function(t){g([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){g(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){g(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)b(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){"string"===typeof t&&(t={name:t});for(var r,s=null,n=0;null===s&&n<e.extensions.length;++n)r=e.extensions[n],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(s=r);return s},e.sign=function(t,r){e.md=r||s.md.sha1.create();var a=o[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.tbsCertificate=i.getTBSCertificate(e);var u=n.toDer(e.tbsCertificate);e.md.update(u.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var a=t.issuer,c=e.subject,u=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw u.expectedIssuer=a.attributes,u.actualIssuer=c.attributes,u}var l=t.md;if(null===l){if(t.signatureOid in o){var d=o[t.signatureOid];switch(d){case"sha1WithRSAEncryption":l=s.md.sha1.create();break;case"md5WithRSAEncryption":l=s.md.md5.create();break;case"sha256WithRSAEncryption":l=s.md.sha256.create();break;case"sha384WithRSAEncryption":l=s.md.sha384.create();break;case"sha512WithRSAEncryption":l=s.md.sha512.create();break;case"RSASSA-PSS":l=s.md.sha256.create();break}}if(null===l){u=new Error("Could not compute certificate digest. Unknown signature OID.");throw u.signatureOid=t.signatureOid,u}var h=t.tbsCertificate||i.getTBSCertificate(t),p=n.toDer(h);l.update(p.getBytes())}if(null!==l){var f;switch(t.signatureOid){case o.sha1WithRSAEncryption:f=void 0;break;case o["RSASSA-PSS"]:var y,g;if(y=o[t.signatureParameters.mgf.hash.algorithmOid],void 0===y||void 0===s.md[y]){u=new Error("Unsupported MGF hash function.");throw u.oid=t.signatureParameters.mgf.hash.algorithmOid,u.name=y,u}if(g=o[t.signatureParameters.mgf.algorithmOid],void 0===g||void 0===s.mgf[g]){u=new Error("Unsupported MGF function.");throw u.oid=t.signatureParameters.mgf.algorithmOid,u.name=g,u}if(g=s.mgf[g].create(s.md[y].create()),y=o[t.signatureParameters.hash.algorithmOid],void 0===y||void 0===s.md[y])throw{message:"Unsupported RSASSA-PSS hash function.",oid:t.signatureParameters.hash.algorithmOid,name:y};f=s.pss.create(s.md[y].create(),g,t.signatureParameters.saltLength);break}r=e.publicKey.verify(l.digest().getBytes(),t.signature,f)}return r},e.isIssuer=function(t){var r=!1,s=e.issuer,n=t.subject;if(s.hash&&n.hash)r=s.hash===n.hash;else if(s.attributes.length===n.attributes.length){var i,o;r=!0;for(var a=0;r&&a<s.attributes.length;++a)i=s.attributes[a],o=n.attributes[a],i.type===o.type&&i.value===o.value||(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return i.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=o["subjectKeyIdentifier"],r=0;r<e.extensions.length;++r){var n=e.extensions[r];if(n.id===t){var i=e.generateSubjectKeyIdentifier().getBytes();return s.util.hexToBytes(n.subjectKeyIdentifier)===i}}return!1},e},i.certificateFromAsn1=function(e,t){var r={},a=[];if(!n.validate(e,u,r,a)){var c=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw c.errors=a,c}var l=n.derToOid(r.publicKeyOid);if(l!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var d=i.createCertificate();d.version=r.certVersion?r.certVersion.charCodeAt(0):0;var h=s.util.createBuffer(r.certSerialNumber);d.serialNumber=h.toHex(),d.signatureOid=s.asn1.derToOid(r.certSignatureOid),d.signatureParameters=f(d.signatureOid,r.certSignatureParams,!0),d.siginfo.algorithmOid=s.asn1.derToOid(r.certinfoSignatureOid),d.siginfo.parameters=f(d.siginfo.algorithmOid,r.certinfoSignatureParams,!1),d.signature=r.certSignature;var y=[];if(void 0!==r.certValidity1UTCTime&&y.push(n.utcTimeToDate(r.certValidity1UTCTime)),void 0!==r.certValidity2GeneralizedTime&&y.push(n.generalizedTimeToDate(r.certValidity2GeneralizedTime)),void 0!==r.certValidity3UTCTime&&y.push(n.utcTimeToDate(r.certValidity3UTCTime)),void 0!==r.certValidity4GeneralizedTime&&y.push(n.generalizedTimeToDate(r.certValidity4GeneralizedTime)),y.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(y.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(d.validity.notBefore=y[0],d.validity.notAfter=y[1],d.tbsCertificate=r.tbsCertificate,t){if(d.md=null,d.signatureOid in o){l=o[d.signatureOid];switch(l){case"sha1WithRSAEncryption":d.md=s.md.sha1.create();break;case"md5WithRSAEncryption":d.md=s.md.md5.create();break;case"sha256WithRSAEncryption":d.md=s.md.sha256.create();break;case"sha384WithRSAEncryption":d.md=s.md.sha384.create();break;case"sha512WithRSAEncryption":d.md=s.md.sha512.create();break;case"RSASSA-PSS":d.md=s.md.sha256.create();break}}if(null===d.md){c=new Error("Could not compute certificate digest. Unknown signature OID.");throw c.signatureOid=d.signatureOid,c}var b=n.toDer(d.tbsCertificate);d.md.update(b.getBytes())}var m=s.md.sha1.create();d.issuer.getField=function(e){return p(d.issuer,e)},d.issuer.addField=function(e){g([e]),d.issuer.attributes.push(e)},d.issuer.attributes=i.RDNAttributesAsArray(r.certIssuer,m),r.certIssuerUniqueId&&(d.issuer.uniqueId=r.certIssuerUniqueId),d.issuer.hash=m.digest().toHex();var w=s.md.sha1.create();return d.subject.getField=function(e){return p(d.subject,e)},d.subject.addField=function(e){g([e]),d.subject.attributes.push(e)},d.subject.attributes=i.RDNAttributesAsArray(r.certSubject,w),r.certSubjectUniqueId&&(d.subject.uniqueId=r.certSubjectUniqueId),d.subject.hash=w.digest().toHex(),r.certExtensions?d.extensions=i.certificateExtensionsFromAsn1(r.certExtensions):d.extensions=[],d.publicKey=i.publicKeyFromAsn1(r.subjectPublicKeyInfo),d},i.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var s=e.value[r],n=0;n<s.value.length;++n)t.push(i.certificateExtensionFromAsn1(s.value[n]));return t},i.certificateExtensionFromAsn1=function(e){var t={};if(t.id=n.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===n.Type.BOOLEAN?(t.critical=0!==e.value[1].value.charCodeAt(0),t.value=e.value[2].value):t.value=e.value[1].value,t.id in o)if(t.name=o[t.id],"keyUsage"===t.name){var r=n.fromDer(t.value),i=0,a=0;r.value.length>1&&(i=r.value.charCodeAt(1),a=r.value.length>2?r.value.charCodeAt(2):0),t.digitalSignature=128===(128&i),t.nonRepudiation=64===(64&i),t.keyEncipherment=32===(32&i),t.dataEncipherment=16===(16&i),t.keyAgreement=8===(8&i),t.keyCertSign=4===(4&i),t.cRLSign=2===(2&i),t.encipherOnly=1===(1&i),t.decipherOnly=128===(128&a)}else if("basicConstraints"===t.name){r=n.fromDer(t.value);r.value.length>0&&r.value[0].type===n.Type.BOOLEAN?t.cA=0!==r.value[0].value.charCodeAt(0):t.cA=!1;var c=null;r.value.length>0&&r.value[0].type===n.Type.INTEGER?c=r.value[0].value:r.value.length>1&&(c=r.value[1].value),null!==c&&(t.pathLenConstraint=n.derToInteger(c))}else if("extKeyUsage"===t.name){r=n.fromDer(t.value);for(var u=0;u<r.value.length;++u){var l=n.derToOid(r.value[u].value);l in o?t[o[l]]=!0:t[l]=!0}}else if("nsCertType"===t.name){r=n.fromDer(t.value),i=0;r.value.length>1&&(i=r.value.charCodeAt(1)),t.client=128===(128&i),t.server=64===(64&i),t.email=32===(32&i),t.objsign=16===(16&i),t.reserved=8===(8&i),t.sslCA=4===(4&i),t.emailCA=2===(2&i),t.objCA=1===(1&i)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){var d;t.altNames=[];r=n.fromDer(t.value);for(var h=0;h<r.value.length;++h){d=r.value[h];var p={type:d.type,value:d.value};switch(t.altNames.push(p),d.type){case 1:case 2:case 6:break;case 7:p.ip=s.util.bytesToIP(d.value);break;case 8:p.oid=n.derToOid(d.value);break;default:}}}else if("subjectKeyIdentifier"===t.name){r=n.fromDer(t.value);t.subjectKeyIdentifier=s.util.bytesToHex(r.value)}return t},i.certificationRequestFromAsn1=function(e,t){var r={},a=[];if(!n.validate(e,h,r,a)){var c=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw c.errors=a,c}var u=n.derToOid(r.publicKeyOid);if(u!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var l=i.createCertificationRequest();if(l.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,l.signatureOid=s.asn1.derToOid(r.csrSignatureOid),l.signatureParameters=f(l.signatureOid,r.csrSignatureParams,!0),l.siginfo.algorithmOid=s.asn1.derToOid(r.csrSignatureOid),l.siginfo.parameters=f(l.siginfo.algorithmOid,r.csrSignatureParams,!1),l.signature=r.csrSignature,l.certificationRequestInfo=r.certificationRequestInfo,t){if(l.md=null,l.signatureOid in o){u=o[l.signatureOid];switch(u){case"sha1WithRSAEncryption":l.md=s.md.sha1.create();break;case"md5WithRSAEncryption":l.md=s.md.md5.create();break;case"sha256WithRSAEncryption":l.md=s.md.sha256.create();break;case"sha384WithRSAEncryption":l.md=s.md.sha384.create();break;case"sha512WithRSAEncryption":l.md=s.md.sha512.create();break;case"RSASSA-PSS":l.md=s.md.sha256.create();break}}if(null===l.md){c=new Error("Could not compute certification request digest. Unknown signature OID.");throw c.signatureOid=l.signatureOid,c}var d=n.toDer(l.certificationRequestInfo);l.md.update(d.getBytes())}var y=s.md.sha1.create();return l.subject.getField=function(e){return p(l.subject,e)},l.subject.addField=function(e){g([e]),l.subject.attributes.push(e)},l.subject.attributes=i.RDNAttributesAsArray(r.certificationRequestInfoSubject,y),l.subject.hash=y.digest().toHex(),l.publicKey=i.publicKeyFromAsn1(r.subjectPublicKeyInfo),l.getAttribute=function(e){return p(l,e)},l.addAttribute=function(e){g([e]),l.attributes.push(e)},l.attributes=i.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),l},i.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return p(e.subject,t)},e.subject.addField=function(t){g([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return p(e,t)},e.addAttribute=function(t){g([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){g(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){g(t),e.attributes=t},e.sign=function(t,r){e.md=r||s.md.sha1.create();var a=o[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.certificationRequestInfo=i.getCertificationRequestInfo(e);var u=n.toDer(e.certificationRequestInfo);e.md.update(u.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(null===r){if(e.signatureOid in o){var a=o[e.signatureOid];switch(a){case"sha1WithRSAEncryption":r=s.md.sha1.create();break;case"md5WithRSAEncryption":r=s.md.md5.create();break;case"sha256WithRSAEncryption":r=s.md.sha256.create();break;case"sha384WithRSAEncryption":r=s.md.sha384.create();break;case"sha512WithRSAEncryption":r=s.md.sha512.create();break;case"RSASSA-PSS":r=s.md.sha256.create();break}}if(null===r){var c=new Error("Could not compute certification request digest. Unknown signature OID.");throw c.signatureOid=e.signatureOid,c}var u=e.certificationRequestInfo||i.getCertificationRequestInfo(e),l=n.toDer(u);r.update(l.getBytes())}if(null!==r){var d;switch(e.signatureOid){case o.sha1WithRSAEncryption:break;case o["RSASSA-PSS"]:var h,p;if(h=o[e.signatureParameters.mgf.hash.algorithmOid],void 0===h||void 0===s.md[h]){c=new Error("Unsupported MGF hash function.");throw c.oid=e.signatureParameters.mgf.hash.algorithmOid,c.name=h,c}if(p=o[e.signatureParameters.mgf.algorithmOid],void 0===p||void 0===s.mgf[p]){c=new Error("Unsupported MGF function.");throw c.oid=e.signatureParameters.mgf.algorithmOid,c.name=p,c}if(p=s.mgf[p].create(s.md[h].create()),h=o[e.signatureParameters.hash.algorithmOid],void 0===h||void 0===s.md[h]){c=new Error("Unsupported RSASSA-PSS hash function.");throw c.oid=e.signatureParameters.hash.algorithmOid,c.name=h,c}d=s.pss.create(s.md[h].create(),p,e.signatureParameters.saltLength);break}t=e.publicKey.verify(r.digest().getBytes(),e.signature,d)}return t},e};var _=new Date("1950-01-01T00:00:00Z"),E=new Date("2050-01-01T00:00:00Z");function v(e){return e>=_&&e<E?n.create(n.Class.UNIVERSAL,n.Type.UTCTIME,!1,n.dateToUtcTime(e)):n.create(n.Class.UNIVERSAL,n.Type.GENERALIZEDTIME,!1,n.dateToGeneralizedTime(e))}i.getTBSCertificate=function(e){var t=v(e.validity.notBefore),r=v(e.validity.notAfter),o=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.version).getBytes())]),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,s.util.hexToBytes(e.serialNumber)),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.siginfo.algorithmOid).getBytes()),m(e.siginfo.algorithmOid,e.siginfo.parameters)]),y(e.issuer),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[t,r]),y(e.subject),i.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&o.value.push(n.create(n.Class.CONTEXT_SPECIFIC,1,!0,[n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&o.value.push(n.create(n.Class.CONTEXT_SPECIFIC,2,!0,[n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&o.value.push(i.certificateExtensionsToAsn1(e.extensions)),o},i.getCertificationRequestInfo=function(e){var t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.version).getBytes()),y(e.subject),i.publicKeyToAsn1(e.publicKey),w(e)]);return t},i.distinguishedNameToAsn1=function(e){return y(e)},i.certificateToAsn1=function(e){var t=e.tbsCertificate||i.getTBSCertificate(e);return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[t,n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.signatureOid).getBytes()),m(e.signatureOid,e.signatureParameters)]),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},i.certificateExtensionsToAsn1=function(e){var t=n.create(n.Class.CONTEXT_SPECIFIC,3,!0,[]),r=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);t.value.push(r);for(var s=0;s<e.length;++s)r.value.push(i.certificateExtensionToAsn1(e[s]));return t},i.certificateExtensionToAsn1=function(e){var t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);t.value.push(n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.id).getBytes())),e.critical&&t.value.push(n.create(n.Class.UNIVERSAL,n.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=e.value;return"string"!==typeof e.value&&(r=n.toDer(r).getBytes()),t.value.push(n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,r)),t},i.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||i.getCertificationRequestInfo(e);return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[t,n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.signatureOid).getBytes()),m(e.signatureOid,e.signatureParameters)]),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},i.createCaStore=function(e){var t={certs:{}};function r(e){return o(e),t.certs[e.hash]||null}function o(e){if(!e.hash){var t=s.md.sha1.create();e.attributes=i.RDNAttributesAsArray(y(e),t),e.hash=t.digest().toHex()}}if(t.getIssuer=function(e){var t=r(e.issuer);return t},t.addCertificate=function(e){if("string"===typeof e&&(e=s.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))if(e.subject.hash in t.certs){var r=t.certs[e.subject.hash];s.util.isArray(r)||(r=[r]),r.push(e),t.certs[e.subject.hash]=r}else t.certs[e.subject.hash]=e},t.hasCertificate=function(e){"string"===typeof e&&(e=s.pki.certificateFromPem(e));var t=r(e.subject);if(!t)return!1;s.util.isArray(t)||(t=[t]);for(var o=n.toDer(i.certificateToAsn1(e)).getBytes(),a=0;a<t.length;++a){var c=n.toDer(i.certificateToAsn1(t[a])).getBytes();if(o===c)return!0}return!1},t.listAllCertificates=function(){var e=[];for(var r in t.certs)if(t.certs.hasOwnProperty(r)){var n=t.certs[r];if(s.util.isArray(n))for(var i=0;i<n.length;++i)e.push(n[i]);else e.push(n)}return e},t.removeCertificate=function(e){var a;if("string"===typeof e&&(e=s.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))return null;var c=r(e.subject);if(!s.util.isArray(c))return a=t.certs[e.subject.hash],delete t.certs[e.subject.hash],a;for(var u=n.toDer(i.certificateToAsn1(e)).getBytes(),l=0;l<c.length;++l){var d=n.toDer(i.certificateToAsn1(c[l])).getBytes();u===d&&(a=c[l],c.splice(l,1))}return 0===c.length&&delete t.certs[e.subject.hash],a},e)for(var a=0;a<e.length;++a){var c=e[a];t.addCertificate(c)}return t},i.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},i.verifyCertificateChain=function(e,t,r){"function"===typeof r&&(r={verify:r}),r=r||{},t=t.slice(0);var n=t.slice(0),o=r.validityCheckDate;"undefined"===typeof o&&(o=new Date);var a=!0,c=null,u=0;do{var l=t.shift(),d=null,h=!1;if(o&&(o<l.validity.notBefore||o>l.validity.notAfter)&&(c={message:"Certificate is not valid yet or has expired.",error:i.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:o}),null===c){if(d=t[0]||e.getIssuer(l),null===d&&l.isIssuer(l)&&(h=!0,d=l),d){var p=d;s.util.isArray(p)||(p=[p]);var f=!1;while(!f&&p.length>0){d=p.shift();try{f=d.verify(l)}catch(S){}}f||(c={message:"Certificate signature is invalid.",error:i.certificateError.bad_certificate})}null!==c||d&&!h||e.hasCertificate(l)||(c={message:"Certificate is not trusted.",error:i.certificateError.unknown_ca})}if(null===c&&d&&!l.isIssuer(d)&&(c={message:"Certificate issuer is invalid.",error:i.certificateError.bad_certificate}),null===c)for(var y={keyUsage:!0,basicConstraints:!0},g=0;null===c&&g<l.extensions.length;++g){var b=l.extensions[g];b.critical&&!(b.name in y)&&(c={message:"Certificate has an unsupported critical extension.",error:i.certificateError.unsupported_certificate})}if(null===c&&(!a||0===t.length&&(!d||h))){var m=l.getExtension("basicConstraints"),w=l.getExtension("keyUsage");if(null!==w&&(w.keyCertSign&&null!==m||(c={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:i.certificateError.bad_certificate})),null!==c||null===m||m.cA||(c={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:i.certificateError.bad_certificate}),null===c&&null!==w&&"pathLenConstraint"in m){var _=u-1;_>m.pathLenConstraint&&(c={message:"Certificate basicConstraints pathLenConstraint violated.",error:i.certificateError.bad_certificate})}}var E=null===c||c.error,v=r.verify?r.verify(E,u,n):E;if(!0!==v)throw!0===E&&(c={message:"The application rejected the certificate.",error:i.certificateError.bad_certificate}),(v||0===v)&&("object"!==typeof v||s.util.isArray(v)?"string"===typeof v&&(c.error=v):(v.message&&(c.message=v.message),v.error&&(c.error=v.error))),c;c=null,a=!1,++u}while(t.length>0);return!0}},5268:function(e,t,r){"use strict";const s=async e=>{for await(const t of e);};e.exports=s},"52ea":function(e,t,r){"use strict";const s=r("b6aa"),n=r("34eb")("ipfs:mfs:mkdir"),{exporter:i}=r("d6d7"),o=r("faba"),a=r("57be"),c=r("57e0"),u=r("e53b"),l=r("5688"),d=r("070a"),h=r("4fcb").bind({ignoreUndefined:!0}),p=r("a29d"),f={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};e.exports=e=>{async function t(t,r={}){const l=h(f,r);if(!t)throw new Error("no path given to Mkdir");if(t=t.trim(),"/"===t){if(l.parents)return;throw s(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if("/"!==t.substring(0,1))throw s(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");n("Creating "+t);const p=a(t);if("ipfs"===p[0])throw s(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");const g=await d(e,l);let b;const m=[],w=await o(e,"directory",l);for(let n=0;n<=p.length;n++){const r=p.slice(0,n),o=`/ipfs/${g}/${r.join("/")}`;try{if(b=await i(o,e.ipld),"file"!==b.type&&"directory"!==b.type)throw s(new Error(t+" was not a UnixFS node"),"ERR_NOT_UNIXFS");if(n===p.length){if(l.parents)return;throw s(new Error("file already exists"),"ERR_ALREADY_EXISTS")}m.push({name:b.name,cid:b.cid})}catch(E){if("ERR_NOT_FOUND"!==E.code)throw E;if(n<p.length&&!l.parents)throw s(new Error(`Intermediate directory path ${o} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await y(e,r[r.length-1],w,m[m.length-1],m,l)}}const _=await u(e,m,l);await c(e,_,l)}return p(t)};const y=async(e,t,r,s,i,o)=>{n(`Adding empty dir called ${t} to ${s.cid}`);const a=await l(e,{parent:s.node,parentCid:s.cid,size:r.node.size,cid:r.cid,name:t,hashAlg:o.hashAlg,cidVersion:o.cidVersion,flush:o.flush,shardSplitThreshold:o.shardSplitThreshold});i[i.length-1].cid=a.cid,i.push({name:t,cid:r.cid})}},5349:function(e,t,r){var s=r("45f8");t.operation=function(e){var r=t.timeouts(e);return new s(r,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in e)t[r]=e[r];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var s=[],n=0;n<t.retries;n++)s.push(this.createTimeout(n,t));return e&&e.forever&&!s.length&&s.push(this.createTimeout(n,t)),s.sort((function(e,t){return e-t})),s},t.createTimeout=function(e,t){var r=t.randomize?Math.random()+1:1,s=Math.round(r*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return s=Math.min(s,t.maxTimeout),s},t.wrap=function(e,r,s){if(r instanceof Array&&(s=r,r=null),!s)for(var n in s=[],e)"function"===typeof e[n]&&s.push(n);for(var i=0;i<s.length;i++){var o=s[i],a=e[o];e[o]=function(s){var n=t.operation(r),i=Array.prototype.slice.call(arguments,1),o=i.pop();i.push((function(e){n.retry(e)||(e&&(arguments[0]=n.mainError()),o.apply(this,arguments))})),n.attempt((function(){s.apply(e,i)}))}.bind(e,a),e[o].options=r}}},5425:function(e,t,r){"use strict";t.AbstractLevelDOWN=r("7ca2"),t.AbstractIterator=r("7e11"),t.AbstractChainedBatch=r("e7aa")},54383:function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:circuit:stop"),{error:s("libp2p:circuit:stop:err")}),{CircuitRelay:i}=r("46f6"),o=r("5e54"),a=r("56fc"),{validateAddrs:c}=r("5d03");e.exports.handleStop=function({connection:e,request:t,streamHandler:r}){try{c(t,r)}catch(s){return n.error("invalid stop request via peer %s",e.remotePeer.toB58String(),s)}return n("stop request is valid"),r.write({type:i.Type.STATUS,code:i.Status.SUCCESS}),r.rest()},e.exports.stop=async function({connection:e,request:t}){const{stream:r}=await e.newStream([o.relay]);n("starting stop request to %s",e.remotePeer.toB58String());const s=new a({stream:r});s.write(t);const c=await s.read();return c?c.code===i.Status.SUCCESS?(n("stop request to %s was successful",e.remotePeer.toB58String()),s.rest()):(n("stop request failed with code %d",c.code),void s.close()):s.close()}},5496:function(e,t,r){"use strict";const{DAGNode:s}=r("8141"),{Bucket:n,createHAMT:i}=r("d81a"),o=r("bc82"),a=r("31a1"),c=r("34eb")("ipfs:mfs:core:utils:hamt-utils"),{UnixFS:u}=r("9fd0"),l=r("5d98"),d=r("0e80").multihash,h=r("9975"),p=async(e,t,r,n)=>{const i=a(),o=Uint8Array.from(r._children.bitField().reverse()),c=u.unmarshal(n.parent.Data),h=new u({type:"hamt-sharded-directory",data:o,fanout:r.tableSize(),hashType:i.hamtHashCode,mode:c.mode,mtime:c.mtime}),p=d.names[n.hashAlg],f=new s(h.marshal(),t),y=await e.ipld.put(f,l.DAG_PB,{cidVersion:n.cidVersion,hashAlg:p,onlyHash:!n.flush});return{node:f,cid:y,size:f.size}},f=async(e,t,r,s)=>{const i=new n({hash:t._options.hash,bits:t._options.bits},r,s);return r._putObjectAt(s,i),await g(e,i,t),i},y=async e=>{const t=a(),r=i({hashFn:t.hamtHashFn,bits:t.hamtBucketBits});return await g(e,r,r),r},g=async(e,t,r)=>{await Promise.all(e.map(e=>{if(2===e.Name.length){const s=parseInt(e.Name,16);return t._putObjectAt(s,new n({hash:r._options.hash,bits:r._options.bits},t,s)),Promise.resolve()}return r.put(e.Name.substring(2),{size:e.Tsize,cid:e.Hash})}))},b=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),m=async(e,t,r)=>{const s=await y(r.Links),n=await s._findNewBucketAndPos(t),i=[{bucket:n.bucket,prefix:b(n.pos)}];let o=n.bucket;while(o!==s)i.push({bucket:o,prefix:b(o._posAtParent)}),o=o._parent;i.reverse(),i[0].node=r;for(let a=0;a<i.length;a++){const r=i[a];if(!r.node)throw new Error("Could not generate HAMT path");const n=r.node.Links.filter(e=>e.Name.substring(0,2)===r.prefix).pop();if(!n){c(`Link ${r.prefix}${t} will be added`);continue}if(n.Name===`${r.prefix}${t}`){c(`Link ${r.prefix}${t} will be replaced`);continue}c("Found subshard "+r.prefix);const o=await e.ipld.get(n.Hash);if(!i[a+1]){c("Loaded new subshard "+r.prefix),await f(o.Links,s,r.bucket,parseInt(r.prefix,16));const e=await s._findNewBucketAndPos(t);i.push({bucket:e.bucket,prefix:b(e.pos),node:o});continue}const u=i[a+1];await g(o.Links,u.bucket,s),u.node=o}return await s.put(t,!0),i.reverse(),{rootBucket:s,path:i}},w=async(e,t,r={})=>{const s=a(),n=new o({root:!0,dir:!0,parent:null,parentKey:null,path:"",dirty:!0,flat:!1,mtime:r.mtime,mode:r.mode},{hamtHashFn:s.hamtHashFn,hamtHashCode:s.hamtHashCode,hamtBucketBits:s.hamtBucketBits,...r,codec:"dag-pb"});for(let i=0;i<t.length;i++)await n._bucket.put(t[i].name,{size:t[i].size,cid:t[i].cid});return h(n.flush(e.block))};e.exports={generatePath:m,updateHamtDirectory:p,recreateHamtLevel:f,recreateInitialHamtLevel:y,addLinksToHamtBucket:g,toPrefix:b,createShard:w}},"549a":function(e,t,r){"use strict";const s=e=>{if(e){if(e.startsWith("size-")){const t=e.split("-")[1],r=parseInt(t);if(isNaN(r))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:r}}if(e.startsWith("rabin"))return{chunker:"rabin",...n(e)};throw new Error("Unrecognized chunker option: "+e)}return{chunker:"fixed"}},n=e=>{const t={},r=e.split("-");switch(r.length){case 1:t.avgChunkSize=262144;break;case 2:t.avgChunkSize=i(r[1],"avg");break;case 4:t.minChunkSize=i(r[1],"min"),t.avgChunkSize=i(r[2],"avg"),t.maxChunkSize=i(r[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return t},i=(e,t)=>{const r=parseInt(e);if(isNaN(r))throw new Error(`Chunker parameter ${t} must be an integer`);return r};e.exports={parseChunkSize:i,parseRabinString:n,parseChunkerString:s}},"54a6":function(e,t,r){(function(t){const s=r("b9fa").util,n=r("c449"),i=(e,r=[],o=!0)=>(o&&t.isBuffer(e)&&(e=s.deserialize(e)),function*(){for(let t of Object.keys(e)){let s=r.slice();s.push(t);let o=e[t];if(o&&"object"===typeof o)if(Array.isArray(o))for(let e=0;e<o.length;e++){let t=s.slice();t.push(e);let r=o[e];n.isCID(r)?yield[t.join("/"),r]:"object"===typeof r&&(yield*i(r,s,!1))}else n.isCID(o)?yield[s.join("/"),o]:yield*i(o,s,!1)}}());e.exports=i}).call(this,r("1c35").Buffer)},"54b0":function(e,t,r){"use strict";const{Multiaddr:s}=r("2054"),n=r("eddf"),i=r("ba11"),{PeerRecord:o}=r("a496"),{ENVELOPE_DOMAIN_PEER_RECORD:a,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:c}=r("cee7");class u{constructor({peerId:e,multiaddrs:t=[],seqNumber:r=Date.now()}){this.domain=a,this.codec=c,this.peerId=e,this.multiaddrs=t,this.seqNumber=r,this._marshal=void 0}marshal(){return this._marshal||(this._marshal=o.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish()),this._marshal}equals(e){return e instanceof u&&(!!this.peerId.equals(e.peerId)&&(this.seqNumber===e.seqNumber&&!!i(this.multiaddrs,e.multiaddrs)))}}u.createFromProtobuf=e=>{const t=o.decode(e),r=n.createFromBytes(t.peerId),i=(t.addresses||[]).map(e=>new s(e.multiaddr)),a=Number(t.seq);return new u({peerId:r,multiaddrs:i,seqNumber:a})},u.DOMAIN=a,e.exports=u},"54f0":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ERR_TOPIC_VALIDATOR_IGNORE=t.ERR_TOPIC_VALIDATOR_REJECT=t.TimeCacheDuration=t.GossipsubIWantFollowupTime=t.GossipsubMaxIHaveMessages=t.GossipsubMaxIHaveLength=t.GossipsubGraftFloodThreshold=t.GossipsubOpportunisticGraftPeers=t.GossipsubOpportunisticGraftTicks=t.GossipsubDirectConnectInitialDelay=t.GossipsubDirectConnectTicks=t.GossipsubConnectionTimeout=t.GossipsubMaxPendingConnections=t.GossipsubConnectors=t.GossipsubPruneBackoffTicks=t.GossipsubPruneBackoff=t.GossipsubPrunePeers=t.GossipsubFanoutTTL=t.GossipsubHeartbeatInterval=t.GossipsubHeartbeatInitialDelay=t.GossipsubGossipRetransmission=t.GossipsubGossipFactor=t.GossipsubDlazy=t.GossipsubHistoryGossip=t.GossipsubHistoryLength=t.GossipsubDout=t.GossipsubDscore=t.GossipsubDhi=t.GossipsubDlo=t.GossipsubD=t.GossipsubIDv11=t.GossipsubIDv10=t.FloodsubID=t.minute=t.second=void 0,t.second=1e3,t.minute=60*t.second,t.FloodsubID="/floodsub/1.0.0",t.GossipsubIDv10="/meshsub/1.0.0",t.GossipsubIDv11="/meshsub/1.1.0",t.GossipsubD=6,t.GossipsubDlo=4,t.GossipsubDhi=12,t.GossipsubDscore=4,t.GossipsubDout=2,t.GossipsubHistoryLength=5,t.GossipsubHistoryGossip=3,t.GossipsubDlazy=6,t.GossipsubGossipFactor=.25,t.GossipsubGossipRetransmission=3,t.GossipsubHeartbeatInitialDelay=100,t.GossipsubHeartbeatInterval=t.second,t.GossipsubFanoutTTL=t.minute,t.GossipsubPrunePeers=16,t.GossipsubPruneBackoff=t.minute,t.GossipsubPruneBackoffTicks=15,t.GossipsubConnectors=8,t.GossipsubMaxPendingConnections=128,t.GossipsubConnectionTimeout=30*t.second,t.GossipsubDirectConnectTicks=300,t.GossipsubDirectConnectInitialDelay=t.second,t.GossipsubOpportunisticGraftTicks=60,t.GossipsubOpportunisticGraftPeers=2,t.GossipsubGraftFloodThreshold=10*t.second,t.GossipsubMaxIHaveLength=5e3,t.GossipsubMaxIHaveMessages=10,t.GossipsubIWantFollowupTime=3*t.second,t.TimeCacheDuration=12e4,t.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT",t.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE"},"559d":function(e,t,r){"use strict";const s=r("05d0"),n=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class i extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,({message:e}=e)):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const o=(e,t,r)=>{const s=r.retries-(t-1);return e.attemptNumber=t,e.retriesLeft=s,e},a=e=>n.includes(e),c=(e,t)=>new Promise((r,n)=>{t={onFailedAttempt:()=>{},retries:10,...t};const c=s.operation(t);c.attempt(async s=>{try{r(await e(s))}catch(u){if(!(u instanceof Error))return void n(new TypeError(`Non-error was thrown: "${u}". You should only throw errors.`));if(u instanceof i)c.stop(),n(u.originalError);else if(u instanceof TypeError&&!a(u.message))c.stop(),n(u);else{o(u,s,t);try{await t.onFailedAttempt(u)}catch(u){return void n(u)}c.retry(u)||n(c.mainError())}}})});e.exports=c,e.exports.default=c,e.exports.AbortError=i},"55ab":function(e,t,r){"use strict";const s=Math.exp;e.exports=function(e){if("number"!==typeof e)throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,r,n=0,i=0,o=0,a={};function c(t,r){return 1-s(-(t-r)/e)}return a.push=function(e,s){if(r){const a=c(e,r),u=s-t,l=a*u;t=a*s+(1-a)*t,n=(1-a)*(n+u*l),i=Math.sqrt(n),o=t+a*u}else t=s;r=e},a.movingAverage=function(){return t},a.variance=function(){return n},a.deviation=function(){return i},a.forecast=function(){return o},a}},5669:function(e,t,r){"use strict";const s=r("c449"),n=r("b623");t.resolve=(e,t="")=>{let r=n.deserialize(e);const i=t.split("/").filter(Boolean);while(i.length){const e=i.shift();if(!e||!(e in r))throw new Error(`Object has no property '${e}'`);if(r=r[e],s.isCID(r))return{value:r,remainderPath:i.join("/")}}return{value:r,remainderPath:""}};const i=function*(e,t){if(!(e instanceof Uint8Array||s.isCID(e)||"string"===typeof e||null===e))for(const r of Object.keys(e)){const s=void 0===t?r:t+"/"+r;yield s,yield*i(e[r],s)}};t.tree=function*(e){const t=n.deserialize(e);yield*i(t)}},5677:function(e,t,r){var s=r("d327");r("4595"),e.exports=s.mgf=s.mgf||{},s.mgf.mgf1=s.mgf1},5688:function(e,t,r){"use strict";const{DAGLink:s,DAGNode:n}=r("8141"),i=r("c449"),o=r("34eb")("ipfs:mfs:core:utils:add-link"),{UnixFS:a}=r("9fd0"),c=r("bc82"),u=r("31a1"),{updateHamtDirectory:l,recreateHamtLevel:d,recreateInitialHamtLevel:h,createShard:p,toPrefix:f,addLinksToHamtBucket:y}=r("5496"),g=r("b6aa"),b=r("5d98"),m=r("0e80").multihash,w=r("9975"),_=async(e,t)=>{let r=t.parent;if(t.parentCid){if(!i.isCID(t.parentCid))throw g(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");o("Loading parent node "+t.parentCid),r=await e.ipld.get(t.parentCid)}if(!r)throw g(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!t.cid)throw g(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!t.name)throw g(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(i.isCID(t.cid)||(t.cid=new i(t.cid)),!t.size&&0!==t.size)throw g(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");const s=a.unmarshal(r.Data);return"hamt-sharded-directory"===s.type?(o("Adding link to sharded directory"),S(e,{...t,parent:r})):r.Links.length>=t.shardSplitThreshold?(o("Converting directory to sharded directory"),E(e,{...t,parent:r,mtime:s.mtime,mode:s.mode})):(o(`Adding ${t.name} (${t.cid}) to regular directory`),v(e,{...t,parent:r}))},E=async(e,t)=>{const r=await p(e,t.parent.Links.map(e=>({name:e.Name,size:e.Tsize,cid:e.Hash})).concat({name:t.name,size:t.size,cid:t.cid}),t);return o("Converted directory to sharded directory "+r.cid),r},v=async(e,t)=>{t.parent.rmLink(t.name),t.parent.addLink(new s(t.name,t.size,t.cid));const r=a.unmarshal(t.parent.Data);if(r.mtime){const e=Date.now(),s=Math.floor(e/1e3);r.mtime={secs:s,nsecs:1e3*(e-1e3*s)},t.parent=new n(r.marshal(),t.parent.Links)}const i=m.names[t.hashAlg],o=await e.ipld.put(t.parent,b.DAG_PB,{cidVersion:t.cidVersion,hashAlg:i,onlyHash:!t.flush});return{node:t.parent,cid:o,size:t.parent.size}},S=async(e,t)=>{const{shard:r,path:s}=await I(e,t),n=await w(r.flush(e.block)),i=await e.ipld.get(n.cid),o=t.parent.Links.find(e=>e.Name.substring(0,2)===s[0].prefix),a=i.Links.find(e=>e.Name.substring(0,2)===s[0].prefix);if(!a)throw new Error("No link found with prefix "+s[0].prefix);return o&&t.parent.rmLink(o.Name),t.parent.addLink(a),l(e,t.parent.Links,s[0].bucket,t)},I=async(e,t)=>{const r={name:t.name,cid:t.cid,size:t.size},s=await h(t.parent.Links),n=a.unmarshal(t.parent.Data),i=u(),l=new c({root:!0,dir:!0,parent:null,parentKey:null,path:"",dirty:!0,flat:!1,mode:n.mode},{hamtHashFn:i.hamtHashFn,hamtHashCode:i.hamtHashCode,hamtBucketBits:i.hamtBucketBits,...t});l._bucket=s,n.mtime&&(l.mtime=new Date);const p=await s._findNewBucketAndPos(r.name),g=A(p);g[0].node=t.parent;let b=0;while(b<g.length){const t=g[b];b++;const n=t.node;if(!n)throw new Error("Segment had no node");const i=n.Links.find(e=>e.Name.substring(0,2)===t.prefix);if(!i){o(`Link ${t.prefix}${r.name} will be added`),b=g.length;break}if(i.Name===`${t.prefix}${r.name}`){o(`Link ${t.prefix}${r.name} will be replaced`),b=g.length;break}if(i.Name.length>2){o(`Link ${i.Name} ${i.Hash} will be replaced with a subshard`),b=g.length;break}o("Found subshard "+t.prefix);const a=await e.ipld.get(i.Hash);if(!g[b]){o("Loaded new subshard "+t.prefix),await d(a.Links,s,t.bucket,parseInt(t.prefix,16));const e=await s._findNewBucketAndPos(r.name);g.push({bucket:e.bucket,prefix:f(e.pos),node:a});break}const c=g[b];await y(a.Links,c.bucket,s),c.node=a}return await l._bucket.put(r.name,{size:r.size,cid:r.cid}),{shard:l,path:g}},A=e=>{const t=[{bucket:e.bucket,prefix:f(e.pos)}];let r=e.bucket._parent,s=e.bucket._posAtParent;while(r)t.push({bucket:r,prefix:f(s)}),s=r._posAtParent,r=r._parent;return t.reverse(),t};e.exports=_},"56fc":function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:circuit:stream-handler"),{error:s("libp2p:circuit:stream-handler:err")}),i=r("bbbe"),o=r("4e8e"),{CircuitRelay:a}=r("46f6");class c{constructor({stream:e,maxLength:t=4096}){this.stream=e,this.shake=o(this.stream),this.decoder=i.decode.fromReader(this.shake.reader,{maxDataLength:t})}async read(){const e=await this.decoder.next();if(e.value){const t=a.decode(e.value.slice());return n("read message type",t.type),t}n("read received no value, closing stream"),this.close()}write(e){n("write message type %s",e.type),this.shake.write(i.encode.single(a.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){n("closing the stream"),this.rest().sink([])}}e.exports=c},"57be":function(e,t,r){"use strict";const s=(e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);e.exports=s},"57e0":function(e,t,r){"use strict";const s=r("34eb")("ipfs:mfs:utils:update-mfs-root"),{MFS_ROOT_KEY:n}=r("4d04"),i=r("b6aa"),o=async(e,t,r)=>{if(r&&r.signal&&r.signal.aborted)throw i(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return s("New MFS root will be "+t),await e.repo.datastore.put(n,t.bytes),t};e.exports=o},"588d":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getGossipPeers=void 0;const s=r("79ff");function n(e,t,r,n=(()=>!0)){const i=e.topics.get(t);if(!i)return new Set;let o=[];return i.forEach(t=>{const r=e.peers.get(t);r&&s.hasGossipProtocol(r.protocol)&&n(t)&&o.push(t)}),o=s.shuffle(o),r>0&&o.length>r&&(o=o.slice(0,r)),new Set(o)}t.getGossipPeers=n},"590a":function(e,t,r){"use strict";e.exports=h;const s=r("5425").AbstractLevelDOWN,n=r("3fb5"),i=r("8bb9"),o=r("38e2"),a=r("642a"),c=r("f10d"),u=r("7e08"),l=r("84fa"),d="level-js-";function h(e,t){if(!(this instanceof h))return new h(e,t);if(s.call(this,{bufferKeys:c.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0}),t=t||{},"string"!==typeof e)throw new Error("constructor requires a location string argument");this.location=e,this.prefix=null==t.prefix?d:t.prefix,this.version=parseInt(t.version||1,10)}n(h,s),h.prototype.type="level-js",h.prototype._open=function(e,t){const r=indexedDB.open(this.prefix+this.location,this.version);r.onerror=function(){t(r.error||new Error("unknown error"))},r.onsuccess=()=>{this.db=r.result,t()},r.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this.location)||t.createObjectStore(this.location)}},h.prototype.store=function(e){const t=this.db.transaction([this.location],e);return t.objectStore(this.location)},h.prototype.await=function(e,t){const r=e.transaction;r.onabort=function(){t(r.error||new Error("aborted by user"))},r.oncomplete=function(){t(null,e.result)}},h.prototype._get=function(e,t,r){const s=this.store("readonly");let n;try{n=s.get(e)}catch(i){return this._nextTick(r,i)}this.await(n,(function(e,s){return e?r(e):void 0===s?r(new Error("NotFound")):void r(null,a(s,t.asBuffer))}))},h.prototype._del=function(e,t,r){const s=this.store("readwrite");let n;try{n=s.delete(e)}catch(i){return this._nextTick(r,i)}this.await(n,r)},h.prototype._put=function(e,t,r,s){const n=this.store("readwrite");let i;try{i=n.put(t,e)}catch(o){return this._nextTick(s,o)}this.await(i,s)},h.prototype._serializeKey=function(e){return o(e,this.supports.bufferKeys)},h.prototype._serializeValue=function(e){return o(e,!0)},h.prototype._iterator=function(e){return new i(this,this.location,e)},h.prototype._batch=function(e,t,r){if(0===e.length)return this._nextTick(r);const s=this.store("readwrite"),n=s.transaction;let i,o=0;function a(){const t=e[o++],r=t.key;let c;try{c="del"===t.type?s.delete(r):s.put(t.value,r)}catch(u){return i=u,void n.abort()}o<e.length&&(c.onsuccess=a)}n.onabort=function(){r(i||n.error||new Error("aborted by user"))},n.oncomplete=function(){r()},a()},h.prototype._clear=function(e,t){let r,s;try{r=l(e)}catch(n){return this._nextTick(t)}if(e.limit>=0)return u(this,this.location,r,e,t);try{const e=this.store("readwrite");s=r?e.delete(r):e.clear()}catch(i){return this._nextTick(t,i)}this.await(s,t)},h.prototype._close=function(e){this.db.close(),this._nextTick(e)},h.prototype.upgrade=function(e){if("open"!==this.status)return this._nextTick(e,new Error("cannot upgrade() before open()"));const t=this.iterator(),r={},s=this;function n(e){if(e)return o(e);t.next(i)}function i(e,t,i){if(e||void 0===t)return o(e);const c=s._serializeKey(a(t,!0)),u=s._serializeValue(a(i,!0));s._batch([{type:"del",key:t},{type:"put",key:c,value:u}],r,n)}function o(r){t.end((function(t){e(r||t)}))}function c(e){return e}t._deserializeKey=t._deserializeValue=c,n()},h.destroy=function(e,t,r){"function"===typeof t&&(r=t,t=d);const s=indexedDB.deleteDatabase(t+e);s.onsuccess=function(){r()},s.onerror=function(e){r(e)}}},5960:function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p-pubsub:peer-streams"),{error:s("libp2p-pubsub:peer-streams:err")}),{EventEmitter:i}=r("faa1"),o=r("bbbe"),a=r("0ad6"),{pipe:c}=r("66f2"),{source:u}=r("72af"),l=r("91d3").default;class d extends i{constructor({id:e,protocol:t}){super(),this.id=e,this.protocol=t,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new l,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){const e=this.id.toB58String();throw new Error("No writable connection to "+e)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=u(c(this._rawInboundStream,o.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){const t=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=a({onEnd:e=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,e&&this.emit("close")}}),c(this.outboundStream,o.encode(),this._rawOutboundStream).catch(e=>{n.error(e)}),t||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}}e.exports=d},"59c5":function(e,t,r){"use strict";const s=r("de6c"),n=r("41c5"),i=(e,t)=>async function*(){const r=await n(e);yield*r.sort(t)}(),o=(e,t)=>{const r=new RegExp("^"+t);return e.replace(r,"")};e.exports={sortAll:i,tmpdir:s,replaceStartWith:o}},"5b1e":function(e,t,r){"use strict";const s=r("3301"),n=r("bbbe"),i=r("66f2"),o=r("b6aa"),a=r("d46b"),c=r("9410"),u=a("\n");t.encode=e=>n.encode.single(new s([e,u])),t.write=(e,r)=>e.push(t.encode(r)),t.writeAll=(e,r)=>{e.push(r.reduce((e,r)=>e.append(t.encode(r)),new s))},t.read=async e=>{let t=1;const r={[Symbol.asyncIterator](){return this},next:()=>e.next(t)},s=e=>{t=e},a=await i(r,n.decode({onLength:s}),c);if(a.get(a.length-1)!==u[0])throw o(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return a.shallowSlice(0,-1)}},"5be1":function(e,t,r){"use strict";const s=r("f0a5"),n=s.MT,i=s.SIMPLE,o=s.SYMS;class a{constructor(e){if("number"!==typeof e)throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(0|e)!==e)throw new Error("value must be a small positive integer: "+e);this.value=e}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(e){return e._pushInt(this.value,n.SIMPLE_FLOAT)}static isSimple(e){return e instanceof a}static decode(e,t){switch(null==t&&(t=!0),e){case i.FALSE:return!1;case i.TRUE:return!0;case i.NULL:return t?null:o.NULL;case i.UNDEFINED:return t?void 0:o.UNDEFINED;case-1:if(!t)throw new Error("Invalid BREAK");return o.BREAK;default:return new a(e)}}}e.exports=a},"5c63":function(e,t,r){"use strict";const s=r("c597"),n=r("637e"),i=r("2a9c"),o=r("f48f"),a=r("ce74").logger;e.exports=class{constructor(e,t,r){this.peers=new Map,this.wantlist=new n(r),this.network=t,this._stats=r,this._peerId=e,this._log=a(e,"want")}_addEntries(e,t,r){const n=e.map((e,r)=>new s.Entry(e,i.kMaxPriority-r,s.WantType.Block,t));n.forEach(e=>{e.cancel?r?this.wantlist.removeForce(e.cid.toString()):this.wantlist.remove(e.cid):(this._log("adding to wl"),this.wantlist.add(e.cid,e.priority))});for(const s of this.peers.values())s.addEntries(n)}_startPeerHandler(e){let t=this.peers.get(e.toB58String());if(t)return void t.refcnt++;t=new o(this._peerId,e,this.network);const r=new s(!0);for(const s of this.wantlist.entries())r.addEntry(s[1].cid,s[1].priority);return t.addMessage(r),this.peers.set(e.toB58String(),t),t}_stopPeerHandler(e){const t=this.peers.get(e.toB58String());t&&(t.refcnt--,t.refcnt>0||this.peers.delete(e.toB58String()))}wantBlocks(e,t={}){this._addEntries(e,!1),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}}},"5cfd":function(e,t,r){"use strict";const s=r("eddf"),n={success:!0,time:0,text:""},i=r("a29d");e.exports=({network:e})=>{async function*t(t,r={}){const{libp2p:i}=await e.use();r.count=r.count||10;const o=s.createFromCID(t),a=i.peerStore.get(o);let c=a&&a.id;if(!c){yield{...n,text:"Looking up peer "+t};const e=await i.peerRouting.findPeer(o);c=e&&e.id}if(!c)throw new Error("Peer was not found");yield{...n,text:"PING "+c.toB58String()};let u=0,l=0;for(let e=0;e<r.count;e++)try{const e=await i.ping(c);l+=e,u++,yield{...n,time:e}}catch(d){yield{...n,success:!1,text:d.toString()}}if(u){const e=l/u;yield{...n,text:`Average latency: ${e}ms`}}}return i(t)}},"5d03":function(e,t,r){"use strict";const{Multiaddr:s}=r("2054"),{CircuitRelay:n}=r("46f6");function i(e,t){e.write({type:n.Type.STATUS,code:t})}function o(e,t){try{e.dstPeer&&e.dstPeer.addrs&&e.dstPeer.addrs.forEach(e=>new s(e))}catch(r){throw i(t,e.type===n.Type.HOP?n.Status.HOP_DST_MULTIADDR_INVALID:n.Status.STOP_DST_MULTIADDR_INVALID),r}try{e.srcPeer&&e.srcPeer.addrs&&e.srcPeer.addrs.forEach(e=>new s(e))}catch(r){throw i(t,e.type===n.Type.HOP?n.Status.HOP_SRC_MULTIADDR_INVALID:n.Status.STOP_SRC_MULTIADDR_INVALID),r}}e.exports={validateAddrs:o}},"5d14":function(e,t,r){"use strict";const s=r("1304").Key,n=r("d46b"),i=new s("api");e.exports=e=>({async get(){const t=await e.get(i);return t&&t.toString()},set(t){return e.put(i,n(t.toString()))},delete(){return e.delete(i)}})},"5d6d":function(e,t,r){"use strict";const s=async function*(e,t){for await(const r of e)yield t(r)};e.exports=s},"5e2f":function(e,t,r){"use strict";function s(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}e.exports=function(e){var t=void 0,r=void 0;function n(e){if(!(e instanceof Object))throw new Error('Target "'+e+'" is not an object');r=e}function i(e){Object.keys(e).forEach((function(t){var r=e[t];if("function"!==typeof r)throw new Error('Trap "'+t+": "+r+'" is not a function');if(!Reflect[t])throw new Error('Trap "'+t+": "+r+'" is not a valid trap')})),t=e}n((function(){})),e&&n(e),i(Reflect);var o=new Proxy({},{get:function(e,n){return function(){for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return t[n].apply(null,[r].concat(s(i.slice(1))))}}});return{setTarget:n,setHandler:i,getTarget:function(){return r},getHandler:function(){return t},proxy:new Proxy(r,o)}}},"5e54":function(e,t,r){"use strict";e.exports={relay:"/libp2p/circuit/relay/0.1.0"}},"5ec0":function(e,t,r){"use strict";const{DAGNode:s,DAGLink:n,util:i}=r("8141"),o=r("0e80").multihash,a=r("5d98"),c=r("a29d"),u=r("9b62"),l=r("d46b");function d(e,t){switch(t){case"json":return h(e);case"protobuf":return p(e);default:throw new Error("unknown encoding: "+t)}}function h(e){let t,r;try{const s=JSON.parse(u(e));r=(s.Links||[]).map(e=>new n(e.Name||e.name,e.Size||e.size,o.fromB58String(e.Hash||e.hash||e.multihash))),t=l(s.Data)}catch(i){throw new Error("failed to parse JSON: "+i)}return new s(t,r)}function p(e){return i.deserialize(e)}e.exports=({ipld:e,gcLock:t,preload:r})=>{async function n(n,i={}){const c=i.enc;let u;if(n instanceof Uint8Array)u=c?await d(n,c):new s(n);else if(n instanceof s)u=n;else{if("object"!==typeof n)throw new Error("obj not recognized");u=new s(n.Data,n.Links)}const l=await t.readLock();try{const t=await e.put(u,a.DAG_PB,{cidVersion:0,hashAlg:o.names["sha2-256"]});return!1!==i.preload&&r(t),t}finally{l()}}return c(n)}},"5ee5":function(e,t,r){"use strict";const{Buffer:s}=r("1c35"),n=r("901e").BigNumber,i=r("85be"),o=i.SHIFT32,a=i.SHIFT16,c=2097151;function u(e){return e<16?"0"+e.toString(16):e.toString(16)}t.parseHalf=function(e){const t=128&e[0]?-1:1,r=(124&e[0])>>2,s=(3&e[0])<<8|e[1];return r?31===r?t*(s?NaN:Infinity):t*Math.pow(2,r-25)*(1024+s):5.960464477539063e-8*t*s},t.arrayBufferToBignumber=function(e){const t=e.byteLength;let r="";for(let s=0;s<t;s++)r+=u(e[s]);return new n(r,16)},t.buildMap=e=>{const t=new Map,r=Object.keys(e),s=r.length;for(let n=0;n<s;n++)t.set(r[n],e[r[n]]);return t},t.buildInt32=(e,t)=>e*a+t,t.buildInt64=(e,r,s,i)=>{const a=t.buildInt32(e,r),u=t.buildInt32(s,i);return a>c?new n(a).times(o).plus(u):a*o+u},t.writeHalf=function(e,t){const r=s.allocUnsafe(4);r.writeFloatBE(t,0);const n=r.readUInt32BE(0);if(0!==(8191&n))return!1;let i=n>>16&32768;const o=n>>23&255,a=8388607&n;if(o>=113&&o<=142)i+=(o-112<<10)+(a>>13);else{if(!(o>=103&&o<113))return!1;if(a&(1<<126-o)-1)return!1;i+=a+8388608>>126-o}return e.writeUInt16BE(i,0),!0},t.keySorter=function(e,t){const r=e[0].byteLength,s=t[0].byteLength;return r>s?1:s>r?-1:e[0].compare(t[0])},t.isNegativeZero=e=>0===e&&1/e<0,t.nextPowerOf2=e=>{let t=0;if(e&&!(e&e-1))return e;while(0!==e)e>>=1,t+=1;return 1<<t}},"5eec":function(e,t,r){"use strict";const{Key:s,Errors:n,Adapter:i,utils:{sortAll:o}}=r("1304"),a=r("335d"),c=r("5d6d"),u=r("3a1e");class l extends i{constructor(e,t){super(),this.path=e,this.opts=t,t&&t.db?(this.database=t.db,delete t.db):this.database=r("8ce5")}_initDb(){return new Promise((e,t)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},r=>{if(r)return t(r);e(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(e){throw n.dbOpenFailedError(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(r){throw n.dbWriteFailedError(r)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(r){if(r.notFound)throw n.notFoundError(r);throw n.dbWriteFailedError(r)}return t}async has(e){try{await this.db.get(e.toString())}catch(t){if(t.notFound)return!1;throw t}return!0}async delete(e){try{await this.db.del(e.toString())}catch(t){throw n.dbDeleteFailedError(t)}}close(){return this.db&&this.db.close()}batch(){const e=[];return{put:(t,r)=>{e.push({type:"put",key:t.toString(),value:r})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce((e,t)=>a(e,t),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((e,t)=>o(e,t),t));const{offset:r,limit:s}=e;if(r){let e=0;t=a(t,()=>e++>=r)}return s&&(t=u(t,s)),t}queryKeys(e){let t=c(this._query({values:!1,prefix:e.prefix}),({key:e})=>e);Array.isArray(e.filters)&&(t=e.filters.reduce((e,t)=>a(e,t),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((e,t)=>o(e,t),t));const{offset:r,limit:s}=e;if(r){let e=0;t=a(t,()=>e++>=r)}return s&&(t=u(t,s)),t}_query(e){const t={keys:!0,keyAsBuffer:!0,values:e.values};if(null!=e.prefix){const r=e.prefix.toString();t.gte=r,t.lt=r+"ÿ"}return d(this.db.iterator(t))}}function d(e){return{[Symbol.asyncIterator](){return{next:()=>new Promise((t,r)=>{e.next((n,i,o)=>n?r(n):null==i?e.end(e=>{if(e)return r(e);t({done:!0,value:void 0})}):void t({done:!1,value:{key:new s(i,!1),value:o}}))}),return:()=>new Promise((t,r)=>{e.end(e=>{if(e)return r(e);t({done:!0,value:void 0})})})}}}}e.exports=l},"602b":function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:persistent-peer-store"),{error:s("libp2p:persistent-peer-store:err")}),{Key:i}=r("1304"),{Multiaddr:o}=r("2054"),a=r("eddf"),c=r("d04a"),{NAMESPACE_ADDRESS:u,NAMESPACE_COMMON:l,NAMESPACE_KEYS:d,NAMESPACE_METADATA:h,NAMESPACE_PROTOCOL:p}=r("3c82"),{Addresses:f}=r("11ae"),{Protocols:y}=r("ab71");class g extends c{constructor({peerId:e,datastore:t,threshold:r=5}){super({peerId:e}),this._datastore=t,this._dirtyPeers=new Set,this._dirtyMetadata=new Map,this.threshold=r,this._addDirtyPeer=this._addDirtyPeer.bind(this)}async start(){n("PeerStore is starting"),this.on("change:protocols",this._addDirtyPeer),this.on("change:multiaddrs",this._addDirtyPeer),this.on("change:pubkey",this._addDirtyPeerKey),this.on("change:metadata",this._addDirtyPeerMetadata);for await(const e of this._datastore.query({prefix:l}))await this._processDatastoreEntry(e);n("PeerStore started")}async stop(){n("PeerStore is stopping"),this.removeAllListeners(),await this._commitData(),n("PeerStore stopped")}_addDirtyPeer({peerId:e}){const t=e.toB58String();n("add dirty peer",t),this._dirtyPeers.add(t),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(e=>{n.error("error committing data",e)})}_addDirtyPeerKey({peerId:e}){if(e.hasInlinePublicKey())return;const t=e.toB58String();n("add dirty peer key",t),this._dirtyPeers.add(t),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(e=>{n.error("error committing data",e)})}_addDirtyPeerMetadata({peerId:e,metadata:t}){const r=e.toB58String();n("add dirty metadata peer",r),this._dirtyPeers.add(r);const s=this._dirtyMetadata.get(r)||new Set;s.add(t),this._dirtyMetadata.set(r,s),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(e=>{n.error("error committing data",e)})}async _commitData(){const e=Array.from(this._dirtyPeers);if(!e.length)return;this._dirtyPeers.clear(),n("create batch commit");const t=this._datastore.batch();for(const r of e){const e=this.keyBook.data.get(r)||a.createFromCID(r);this._batchAddressBook(e,t),!e.hasInlinePublicKey()&&this._batchKeyBook(e,t),this._batchMetadataBook(e,t),this._batchProtoBook(e,t)}await t.commit(),n("batch committed")}_batchAddressBook(e,t){const r=e.toString(),s=new i(`${u}${r}`),o=this.addressBook.data.get(e.toB58String());try{if(!o)return void t.delete(s);const e=f.encode({addrs:o.addresses.map(e=>({multiaddr:e.multiaddr.bytes,isCertified:e.isCertified})),certifiedRecord:o.record?{seq:o.record.seqNumber,raw:o.record.raw}:void 0}).finish();t.put(s,e)}catch(a){n.error(a)}}_batchKeyBook(e,t){const r=e.toString(),s=new i(`${d}${r}`);try{if(!e.pubKey)return void t.delete(s);const r=e.marshalPubKey();t.put(s,r)}catch(o){n.error(o)}}_batchMetadataBook(e,t){const r=e.toString(),s=this._dirtyMetadata.get(e.toB58String())||[];try{s.forEach(s=>{const n=new i(`${h}${r}/${s}`),o=this.metadataBook.getValue(e,s);o?t.put(n,o):t.delete(n)})}catch(o){n.error(o)}}_batchProtoBook(e,t){const r=e.toString(),s=new i(`${p}${r}`),o=this.protoBook.get(e);try{if(!o)return void t.delete(s);const e=y.encode({protocols:o}).finish();t.put(s,e)}catch(a){n.error(a)}}async _processDatastoreEntry({key:e,value:t}){try{const r=e.toString().split("/"),s=a.createFromCID(r[3]);let i;switch(r[2]){case"addrs":i=f.decode(t),this.addressBook._setData(s,{addresses:i.addrs.map(e=>({multiaddr:new o(e.multiaddr),isCertified:Boolean(e.isCertified)})),record:i.certifiedRecord?{raw:i.certifiedRecord.raw,seqNumber:i.certifiedRecord.seq}:void 0},{emit:!1});break;case"keys":i=await a.createFromPubKey(t),this.keyBook._setData(i,i,{emit:!1});break;case"metadata":this.metadataBook._setValue(s,r[4],t,{emit:!1});break;case"protos":i=y.decode(t),this.protoBook._setData(s,new Set(i.protocols),{emit:!1});break;default:n("invalid data persisted for: ",e.toString())}}catch(r){n.error(r)}}}e.exports=g},"609c":function(e,t,r){"use strict";const s=r("8724"),n=r("b605"),i=r("e730");class o extends n{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){const t=await this.has(e);if(!t)throw i.notFoundError();return this.data[e.toString()]}async has(e){return void 0!==this.data[e.toString()]}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:new s(e),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new s(e))}}e.exports=o},"620f":function(e,t,r){"use strict";const s=r("66f2"),n=r("0ad6"),i=r("34eb")("libp2p:mplex"),o=r("72af"),a=r("88b3"),c=r("6672"),{MessageTypes:u,MessageTypeNames:l}=r("005c"),d=r("62b7");class h{constructor(e){e=e||{},e="function"===typeof e?{onStream:e}:e,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._options=e,this.sink=this._createSink(),this.source=this._createSource(),this.onStream=e.onStream,this.onStreamEnd=e.onStreamEnd}get streams(){const e=[];return this._streams.initiators.forEach(t=>{e.push(t)}),this._streams.receivers.forEach(t=>{e.push(t)}),e}newStream(e){const t=this._streamId++;e=null==e?t.toString():String(e);const r=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:r})}_newReceiverStream({id:e,name:t}){const r=this._streams.receivers;return this._newStream({id:e,name:t,type:"receiver",registry:r})}_newStream({id:e,name:t,type:r,registry:s}){if(s.has(e))throw new Error(`${r} stream ${e} already exists!`);i("new %s stream %s %s",r,e,t);const n=s=>(i.enabled&&i("%s stream %s %s send",r,e,t,{...s,type:l[s.type],data:s.data&&s.data.slice()}),this.source.push(s)),o=()=>{i("%s stream %s %s ended",r,e,t),s.delete(e),this.onStreamEnd&&this.onStreamEnd(a)},a=d({id:e,name:t,send:n,type:r,onEnd:o,maxMsgSize:this._options.maxMsgSize});return s.set(e,a),a}_createSink(){return async e=>{this._options.signal&&(e=o(e,this._options.signal));try{await s(e,a.decode,c(this._options.maxMsgSize),async e=>{for await(const t of e)for(const e of t)this._handleIncoming(e)})}catch(t){return i("error in sink",t),this.source.end(t)}this.source.end()}}_createSource(){const e=e=>{const{initiators:t,receivers:r}=this._streams;for(const s of t.values())s.abort(e);for(const s of r.values())s.abort(e)},t=n({onEnd:e,writev:!0});return Object.assign(a.encode(t),{push:t.push,end:t.end,return:t.return})}_handleIncoming({id:e,type:t,data:r}){if(i.enabled&&i("incoming message",{id:e,type:l[t],data:r.slice()}),t===u.NEW_STREAM&&this.onStream){const t=this._newReceiverStream({id:e,name:r.toString()});return this.onStream(t)}const s=1&t?this._streams.initiators:this._streams.receivers,n=s.get(e);if(!n)return i("missing stream %s",e);switch(t){case u.MESSAGE_INITIATOR:case u.MESSAGE_RECEIVER:n.source.push(r);break;case u.CLOSE_INITIATOR:case u.CLOSE_RECEIVER:n.close();break;case u.RESET_INITIATOR:case u.RESET_RECEIVER:n.reset();break;default:i("unknown message type %s",t)}}}h.multicodec="/mplex/6.7.0",e.exports=h},6289:function(e,t,r){"use strict";const s=r("c449"),n=r("1304").Key,i=r("675c"),o=r("34eb")("ipfs:repo:migrator:migration-8"),a=r("9b62"),{createStore:c}=r("d268"),u=r("fee4");function l(e){const t=i.decode("b"+e.toString().slice(1));let r=new s(t).multihash;r=i.encode("base32",r).slice(1);const o=a(r).toUpperCase();return new n("/"+o,!1)}function d(e){const t=i.decode("b"+e.toString().slice(1)),r=i.encode("base32",new s(1,"raw",t).bytes).slice(1);return new n(("/"+a(r)).toUpperCase(),!1)}async function h(e,t,r,s){const n=c(e,"blocks",t);let i;await n.open(),i=await u(n.queryKeys({filters:[e=>{const t=s(e);return t.toString()!==e.toString()}]}));try{let e=0;for await(const t of n.query({})){const a=s(t.key);a.toString()!==t.key.toString()&&(e+=1,o(`Migrating Block from ${t.key} to ${a}`),await n.delete(t.key),await n.put(a,t.value),r(e/i*100,`Migrated Block from ${t.key} to ${a}`))}}finally{await n.close()}}e.exports={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(e,t,r=(()=>{}))=>h(e,t,r,l),revert:(e,t,r=(()=>{}))=>h(e,t,r,d)}},"62a1":function(e,t,r){"use strict";const s=r("0ae1"),n=r("f24f"),i=r("c6bb");class o{constructor({gcLock:e,pin:t,repo:r,refs:o}){this.gc=s({gcLock:e,pin:t,refs:o,repo:r}),this.stat=n({repo:r}),this.version=i({repo:r})}}e.exports=o},"62b7":function(e,t,r){"use strict";const s=r("72af"),n=r("91d3"),i=r("34eb")("libp2p:mplex:stream"),o=r("0ad6"),a=r("3301"),c=r("b6aa"),{MAX_MSG_SIZE:u}=r("6672"),{InitiatorMessageTypes:l,ReceiverMessageTypes:d}=r("005c"),h="ERR_MPLEX_STREAM_RESET",p="ERR_MPLEX_STREAM_ABORT";e.exports=({id:e,name:t,send:r,onEnd:f=(()=>{}),type:y="initiator",maxMsgSize:g=u})=>{const b=new n,m=new n,w="initiator"===y?l:d,_="initiator"===y?"i"+e:"r"+e;t=String(null==t?e:t);let E,v=!1,S=!1;const I=e=>{v||(v=!0,i("%s stream %s source end",y,t,e),e&&!E&&(E=e),S&&(R.timeline.close=Date.now(),f(E)))},A=e=>{S||(S=!0,i("%s stream %s sink end",y,t,e),e&&!E&&(E=e),v&&(R.timeline.close=Date.now(),f(E)))},R={close:()=>R.source.end(),abort:e=>{i("%s stream %s abort",y,t,e),R.source.end(e),b.abort(),A(e)},reset:()=>{const e=c(new Error("stream reset"),h);m.abort(),R.source.end(e),A(e)},sink:async n=>{n=s(n,[{signal:b.signal,options:{abortMessage:"stream aborted",abortCode:p}},{signal:m.signal,options:{abortMessage:"stream reset",abortCode:h}}]),"initiator"===y&&r({id:e,type:w.NEW_STREAM,data:t});try{for await(let t of n)while(t.length){if(t.length<=g){r({id:e,type:w.MESSAGE,data:t});break}t=a.isBufferList(t)?t:new a(t),r({id:e,type:w.MESSAGE,data:t.shallowSlice(0,g)}),t.consume(g)}}catch(o){return o.code===h?i("%s stream %s reset",y,t):(i("%s stream %s error",y,t,o),r({id:e,type:w.RESET})),R.source.end(o),A(o)}r({id:e,type:w.CLOSE}),A()},source:o(I),timeline:{open:Date.now(),close:null},id:_};return R}},"636f":function(e,t,r){"use strict";const s=r("78c8");function n(e){const{address:t}=e.nodeAddress();return s(t)}e.exports=n},"637e":function(e,t,r){"use strict";const{sortBy:s}=r("ce74"),n=r("1fe5");class i{constructor(e){this.set=new Map,this._stats=e}get length(){return this.set.size}add(e,t,s){const i=r("c597"),o=e.toString("base58btc"),a=this.set.get(o);a?(a.inc(),a.priority=t,a.wantType===i.WantType.Have&&s===i.WantType.Block&&(a.wantType=s)):(this.set.set(o,new n(e,t,s)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){const t=e.toString("base58btc"),r=this.set.get(t);r&&(r.dec(),r.hasRefs()||(this.set.delete(t),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(s(e=>e[1].key,Array.from(this.set.entries())))}contains(e){const t=e.toString("base58btc");return this.set.get(t)}}i.Entry=n,e.exports=i},"638d":function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Heartbeat=void 0;const o=i(r("54f0")),a=r("588d"),c=r("79ff");class u{constructor(e){this.gossipsub=e}start(){if(this._heartbeatTimer)return;const e=this._heartbeat.bind(this),t=setTimeout(()=>{e(),this._heartbeatTimer.runPeriodically(e,o.GossipsubHeartbeatInterval)},o.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(e,t)=>{this._heartbeatTimer._intervalId=setInterval(e,t)},cancel:()=>{clearTimeout(t),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){this._heartbeatTimer&&(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){const{D:e,Dlo:t,Dhi:r,Dscore:s,Dout:n}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;const i=new Map,u=e=>{let t=i.get(e);return void 0===t&&(t=this.gossipsub.score.score(e),i.set(e,t)),t},l=new Map,d=new Map,h=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((i,p)=>{const f=e=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",e,p),this.gossipsub.score.prune(e,p),this.gossipsub._addBackoff(e,p),i.delete(e);const t=d.get(e);t?t.push(p):d.set(e,[p])},y=e=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",e,p),this.gossipsub.score.graft(e,p),i.add(e);const t=l.get(e);t?t.push(p):l.set(e,[p])};if(i.forEach(e=>{const t=u(e);t<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",e,t,p),f(e),h.set(e,!0))}),i.size<t){const t=this.gossipsub.backoff.get(p),r=e-i.size,s=a.getGossipPeers(this.gossipsub,p,r,e=>!i.has(e)&&!this.gossipsub.direct.has(e)&&(!t||!t.has(e))&&u(e)>=0);s.forEach(y)}if(i.size>r){let t=Array.from(i);t.sort((e,t)=>u(t)-u(e)),t=t.slice(0,s).concat(c.shuffle(t.slice(s)));let r=0;if(t.slice(0,e).forEach(e=>{this.gossipsub.outbound.get(e)&&r++}),r<n){const s=e=>{const r=t[e];for(let s=e;s>0;s--)t[s]=t[s-1];t[0]=r};if(r>0){let n=r;for(let r=1;r<e&&n>0;r++)this.gossipsub.outbound.get(t[r])&&(s(r),n--)}let n=e-r;for(let r=e;r<t.length&&n>0;r++)this.gossipsub.outbound.get(t[r])&&(s(r),n--)}t.slice(e).forEach(f)}if(i.size>=t){let e=0;if(i.forEach(t=>{this.gossipsub.outbound.get(t)&&e++}),e<n){const t=n-e,r=this.gossipsub.backoff.get(p);a.getGossipPeers(this.gossipsub,p,t,e=>!i.has(e)&&!this.gossipsub.direct.has(e)&&(!r||!r.has(e))&&u(e)>=0).forEach(y)}}if(this.gossipsub.heartbeatTicks%o.GossipsubOpportunisticGraftTicks===0&&i.size>1){const e=Array.from(i).sort((e,t)=>u(e)-u(t)),t=i.size/2,r=u(e[t]);if(r<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){const e=this.gossipsub.backoff.get(p),t=a.getGossipPeers(this.gossipsub,p,o.GossipsubOpportunisticGraftPeers,t=>i.has(t)&&!this.gossipsub.direct.has(t)&&(!e||!e.has(t))&&u(t)>r);t.forEach(e=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",e,p),y(e)})}}this.gossipsub._emitGossip(p,i)});const p=this.gossipsub._now();this.gossipsub.lastpub.forEach((e,t)=>{e+o.GossipsubFanoutTTL<p&&(this.gossipsub.fanout.delete(t),this.gossipsub.lastpub.delete(t))}),this.gossipsub.fanout.forEach((t,r)=>{const s=this.gossipsub.topics.get(r);if(t.forEach(e=>{(!s.has(e)||u(e)<this.gossipsub._options.scoreThresholds.publishThreshold)&&t.delete(e)}),t.size<e){const s=e-t.size,n=a.getGossipPeers(this.gossipsub,r,s,e=>!t.has(e)&&!this.gossipsub.direct.has(e)&&u(e)>=this.gossipsub._options.scoreThresholds.publishThreshold);n.forEach(e=>{t.add(e)})}this.gossipsub._emitGossip(r,t)}),this.gossipsub._sendGraftPrune(l,d,h),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}}t.Heartbeat=u},"63ce":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageCache=void 0;const s=r("79ff");class n{constructor(e,t,r){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let s=0;s<t;s++)this.history[s]=[];this.gossip=e,this.msgIdFn=r}put(e){const t=this.getMsgId(e),r=s.messageIdToString(t);this.msgs.set(r,e),this.history[0].push({msgID:t,topics:e.topicIDs})}getMsgId(e){return this.msgIdFn(e)}get(e){return this.msgs.get(s.messageIdToString(e))}getForPeer(e,t){const r=s.messageIdToString(e),n=this.msgs.get(r);if(!n)return[void 0,0];let i=this.peertx.get(r);i||(i=new Map,this.peertx.set(r,i));const o=(i.get(t)||0)+1;return i.set(t,o),[n,o]}getGossipIDs(e){const t=[];for(let r=0;r<this.gossip;r++)this.history[r].forEach(r=>{for(const s of r.topics)if(s===e){t.push(r.msgID);break}});return t}shift(){const e=this.history[this.history.length-1];e.forEach(e=>{const t=s.messageIdToString(e.msgID);this.msgs.delete(t),this.peertx.delete(t)}),this.history.pop(),this.history.unshift([])}}t.MessageCache=n},"63ee":function(e,t,r){"use strict";const s=new Map,n=()=>`${Date.now()}:${Math.floor(1e6*Math.random())}`;async function i(e,t,r){while(s.get(r)){try{await e()}catch(n){setTimeout(()=>{throw n},1);break}if(!s.get(r))break;await new Promise(e=>{const n=setTimeout(e,t);s.set(r,n)})}}function o(e,t,r){r=r||t;const o=n(),a=setTimeout(()=>{i(e,t,o)},r);return s.set(o,a),o}function a(e){const t=s.get(e);t&&(clearTimeout(t),s.delete(e))}e.exports={setDelayedInterval:o,clearDelayedInterval:a}},"642a":function(e,t,r){"use strict";(function(t){const s=r("1c35").Buffer,n=function(){if(t.TextDecoder){const e=new TextDecoder("utf-8");return e.decode.bind(e)}return function(e){return o(e).toString()}}(),i=function(){if(t.TextDecoder){const e=new TextDecoder("utf-8");return e.decode.bind(e)}return function(e){return s.from(e).toString()}}();function o(e){const t=s.from(e.buffer);return e.byteLength===e.buffer.byteLength?t:t.slice(e.byteOffset,e.byteOffset+e.byteLength)}e.exports=function(e,t){return e instanceof Uint8Array?t?o(e):n(e):e instanceof ArrayBuffer?t?s.from(e):i(e):t?s.from(String(e)):String(e)}}).call(this,r("c8ba"))},6469:function(e,t,r){e.exports={encode:r("8b8b"),decode:r("231c"),encodingLength:r("2c8c")}},"64f9":function(e,t){function r(e,t,r){"string"==typeof t&&(t=t.split(".")),"symbol"==typeof t&&(t=[t]);var n,i=t.pop();if(!i)return!1;s(i);while(n=t.shift())if(s(n),"undefined"==typeof e[n]&&(e[n]={}),e=e[n],!e||"object"!=typeof e)return!1;return e[i]=r,!0}function s(e){if("__proto__"===e||"constructor"===e||"prototype"===e)throw new Error("setting of prototype values not supported")}e.exports=r},6512:function(e,t,r){(function(t){const s=r("c1c8"),n=r("9970"),{default:i}=r("987e"),{timeout:o}=r("d086"),a=r("2775"),c={};let u;function l(e,t){let r;const s=new Promise(e=>{r=e});return e.add(()=>o((()=>new Promise(e=>{r(()=>{e()})}))(),t.timeout)),s}const d=(e,t)=>{if(u.isWorker)return{readLock:u.readLock(e,t),writeLock:u.writeLock(e,t)};const r=new i({concurrency:1});let s=null;return{readLock:()=>{if(s)return l(s,t);s=new i({concurrency:t.concurrency,autoStart:!1});const e=s,n=l(s,t);return r.add(()=>(e.start(),e.onIdle().then(()=>{s===e&&(s=null)}))),n},writeLock:()=>(s=null,l(r,t))}},h={concurrency:1/0,timeout:846e5,global:t,singleProcess:!1};e.exports=(e,t)=>(t||(t={}),"object"===typeof e&&(t=e,e="lock"),e||(e="lock"),t=Object.assign({},h,t),u||(u=s(t)||n(t),u.isWorker||(u.on("requestReadLock",(e,t)=>{c[e]&&c[e].readLock().then(e=>t().finally(()=>e()))}),u.on("requestWriteLock",async(e,t)=>{c[e]&&c[e].writeLock().then(e=>t().finally(()=>e()))}))),c[e]||(c[e]=d(e,t)),c[e]),e.exports.Worker=function(e,r){let s;r=r||t.Worker;try{s=new r(e)}catch(n){n.message.includes("not a constructor")&&(s=r(e))}if(!s)throw new Error("Could not create Worker from",r);return a(s),s}}).call(this,r("c8ba"))},"653e":function(e,t,r){"use strict";const s=r("b6aa"),n=r("9b62"),i=(e,t,r)=>{if(0===r.length){const e="No records given";throw s(new Error(e),"ERR_NO_RECORDS_RECEIVED")}const i=n(t),o=i.split("/");if(o.length<3){const e="Record key does not have a selector function";throw s(new Error(e),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}const a=e[o[1].toString()];if(!a){const e="Unrecognized key prefix: "+o[1];throw s(new Error(e),"ERR_UNRECOGNIZED_KEY_PREFIX")}return a(t,r)};e.exports={bestRecord:i,selectors:r("9832")}},6558:function(e,t,r){"use strict";const s=r("6896"),n=r("a9f4"),i=r("76a0"),o=r("5aab");class a{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}async add(e){if(this.peerDistances.find(t=>o(t.peerId.id,e.id)))return;const t=await n.convertPeerId(e),r={peerId:e,distance:s(this.originDhtKey,t)};this.peerDistances.push(r),this.peerDistances.sort((e,t)=>s.compare(e.distance,t.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(!e.length)return!1;if(!this.length)return!0;const t=await i(e,e=>n.convertPeerId(e)),r=this.peerDistances[this.peerDistances.length-1].distance;for(const n of t){const e=s(this.originDhtKey,n);if(s.compare(e,r)<0)return!0}return!1}}e.exports=a},"65a5":function(e,t,r){"use strict";async function*s(e,t=1){let r=[];t<1&&(t=1);for await(const s of e){r.push(s);while(r.length>=t)yield r.slice(0,t),r=r.slice(t)}while(r.length)yield r.slice(0,t),r=r.slice(t)}e.exports=s},"65d4":function(e,t,r){"use strict";const s=r("b6aa"),n=r("9b62"),i=(e,t)=>{const r=t.key,i=n(r),o=i.split("/");if(o.length<3)return;const a=e[o[1].toString()];if(!a){const e="Invalid record keytype";throw s(new Error(e),"ERR_INVALID_RECORD_KEY_TYPE")}return a.func(r,t.value)};e.exports={verifyRecord:i,validators:r("9860")}},6672:function(e,t,r){"use strict";const s=1<<20;e.exports=e=>{e=e||s;const t=t=>{if(t.data&&t.data.length>e)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return e=>async function*(){for await(const r of e)Array.isArray(r)?r.forEach(t):t(r),yield r}()},e.exports.MAX_MSG_SIZE=s},"670b":function(e,t,r){"use strict";const{fetch:s,Request:n,Headers:i}=r("273a"),{TimeoutError:o,HTTPError:a}=r("d2aa"),c=r("4fcb").bind({ignoreUndefined:!0}),{URL:u,URLSearchParams:l}=r("16af"),{AbortController:d}=r("c181"),h=r("74fd"),p=(e,t,r)=>{if(void 0===t)return e;const s=Date.now(),n=()=>{const e=Date.now()-s;return e>=t};return new Promise((s,i)=>{const a=setTimeout(()=>{n()&&(i(new o),r.abort())},t),c=e=>{const t=t=>{clearTimeout(a),n()?i(new o):e(t)};return t};e.then(c(s),c(i))})},f={throwHttpErrors:!0,credentials:"same-origin"};class y{constructor(e={}){this.opts=c(f,e)}async fetch(e,t={}){const r=c(this.opts,t),o=new i(r.headers);if("string"!==typeof e&&!(e instanceof u||e instanceof n))throw new TypeError("`resource` must be a string, URL, or Request");const f=new u(e.toString(),r.base),{searchParams:y,transformSearchParams:m,json:w}=r;y&&(f.search="function"===typeof m?m(new l(r.searchParams)):new l(r.searchParams)),w&&(r.body=JSON.stringify(r.json),o.set("content-type","application/json"));const _=new d,E=h([_.signal,r.signal]),v=await p(s(f.toString(),{...r,signal:E,timeout:void 0,headers:o}),r.timeout,_);if(!v.ok&&r.throwHttpErrors)throw r.handleError&&await r.handleError(v),new a(v);return v.iterator=function(){return b(v.body)},v.ndjson=async function*(){for await(const e of g(v.iterator()))t.transform?yield t.transform(e):yield e},v}post(e,t={}){return this.fetch(e,{...t,method:"POST"})}get(e,t={}){return this.fetch(e,{...t,method:"GET"})}put(e,t={}){return this.fetch(e,{...t,method:"PUT"})}delete(e,t={}){return this.fetch(e,{...t,method:"DELETE"})}options(e,t={}){return this.fetch(e,{...t,method:"OPTIONS"})}}const g=async function*(e){const t=new TextDecoder;let r="";for await(const s of e){r+=t.decode(s,{stream:!0});const e=r.split(/\r?\n/);for(let t=0;t<e.length-1;t++){const r=e[t].trim();r.length>0&&(yield JSON.parse(r))}r=e[e.length-1]}r+=t.decode(),r=r.trim(),0!==r.length&&(yield JSON.parse(r))},b=e=>{if(_(e)){const t=e[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:t.next.bind(t),return(r){return e.destroy(),"function"===typeof t.return?t.return():Promise.resolve({done:!0,value:r})}}}}}if(w(e)){const t=e.getReader();return async function*(){try{while(1){const{done:e,value:r}=await t.read();if(e)return;r&&(yield r)}}finally{t.releaseLock()}}()}if(m(e))return e;throw new TypeError("Body can't be converted to AsyncIterable")},m=e=>"object"===typeof e&&null!==e&&"function"===typeof e[Symbol.asyncIterator],w=e=>e&&"function"===typeof e.getReader,_=e=>Object.prototype.hasOwnProperty.call(e,"readable")&&Object.prototype.hasOwnProperty.call(e,"writable");y.HTTPError=a,y.TimeoutError=o,y.streamToAsyncIterator=b,y.post=(e,t)=>new y(t).post(e,t),y.get=(e,t)=>new y(t).get(e,t),y.put=(e,t)=>new y(t).put(e,t),y.delete=(e,t)=>new y(t).delete(e,t),y.options=(e,t)=>new y(t).options(e,t),e.exports=y},6762:function(e,t,r){"use strict";const s=r("a29d");e.exports=({keychain:e})=>{const t=()=>e.listKeys();return s(t)}},"67f8":function(e,t,r){"use strict";const{default:s,Headers:n}=r("33a3");function i({serverResolver:e,hostname:t,recordType:r}){return`${e}?name=${t}&type=${r}`}function o(e){return s(e,{headers:new n({accept:"application/dns-json"})})}function a(e,t){return`${t}_${e}`}e.exports={buildResource:i,fetch:o,getCacheKey:a}},6844:function(e,t,r){
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
(function(){e.exports=m;var t=86400,r=3200,s=146097*r/400,n=t*s,i=1e3*n,o=1e11*t,a=16777216,c=4294967296,u=1e6,l=1e9,d="000000000",h=Math.trunc||L,p=m.prototype;m.fromDate=R,m.fromInt64BE=C(0,1,2,3,0,4),m.fromInt64LE=C(3,2,1,0,4,0),m.fromString=A,m.fromTimeT=T,p.year=0,p.time=0,p.nano=0,p.addNano=S,p.getNano=I,p.getTimeT=P,p.getYear=w,p.toDate=E,p.toJSON=O,p.toString=N,p.writeInt64BE=D(0,1,2,3,0,4),p.writeInt64LE=D(3,2,1,0,4,0);var f="%Y-%m-%dT%H:%M:%S.%NZ",y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],b={"%":"%",F:"%Y-%m-%d",n:"\n",R:"%H:%M",T:"%H:%M:%S",t:"\t",X:"%T",Z:"GMT",z:"+0000"};return m;function m(e,t,r){var s=this;if(!(s instanceof m))return new m(e,t,r);s.time=+e||0,s.nano=+t||0,s.year=+r||0,_(s)}function w(){var e=this.toDate().getUTCFullYear();return e+this.year}function _(e){var t,s,n=e.year,a=e.time,c=e.nano;if(c<0||u<=c){var l=Math.floor(c/u);c-=l*u,a+=l,t=1}var d=n%r;if(a<-o||o<a||d){s=h(a/i),s&&(n+=s*r,a-=s*i);var p=v(a);p.setUTCFullYear(d+p.getUTCFullYear()),n-=d,a=+p,s=h(n/r);var f=a+s*i;s&&-o<=f&&f<=o&&(n-=s*r,a=f),t=1}return t&&(e.year=n,e.time=a,e.nano=c),e}function E(){var e=_(this);return v(e.time)}function v(e){var t=new Date(0);return t.setTime(e),t}function S(e){return this.nano+=+e||0,this}function I(){var e=_(this);return(e.time%1e3*u+ +e.nano+l)%l}function A(e){var t,r=new m;e+="";var s=e.replace(/^\s*[+\-]?\d+/,(function(e){var t=+e,s=1970+(t-1970)%400;return r.year=t-s,s})).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,(function(e,r,s){return r<0&&(s*=-1),t=6e4*(60*+r+ +s),""})).replace(/\.\d+$/,(function(e){return r.nano=+(e+d).substr(1,9),""})).split(/\D+/);if(s.length>1?s[1]--:s[1]=0,r.time=t=Date.UTC.apply(Date,s)-(t||0),isNaN(t))throw new TypeError("Invalid Date");return _(r)}function R(e){return new m(+e)}function T(e){return k(e,0)}function k(e,t){t|=0,t*=c,e=+e||0;var s=h(t/n)+h(e/n),i=t%n+e%n,o=h(i/n);return o&&(s+=o,i-=o*n),new m(1e3*i,0,s*r)}function P(){var e=_(this),n=Math.floor(e.time/1e3),i=e.year;return i&&(n+=i*s*t/r),n}function O(){return this.toString().replace(/0{1,6}Z$/,"Z")}function N(e){var t=this,r=t.toDate(),s={H:u,L:h,M:l,N:p,S:d,Y:i,a:m,b:w,d:a,e:c,m:o};return n(e||f);function n(e){return e.replace(/%./g,(function(e){var t=e[1],r=b[t],i=s[t];return r?n(r):i?i():e}))}function i(){var e=t.getYear();return e>999999?"+"+e:e>9999?"+"+U(e,6):e>=0?U(e,4):e>=-999999?"-"+U(-e,6):e}function o(){return B(r.getUTCMonth()+1)}function a(){return B(r.getUTCDate())}function c(){return M(r.getUTCDate())}function u(){return B(r.getUTCHours())}function l(){return B(r.getUTCMinutes())}function d(){return B(r.getUTCSeconds())}function h(){return U(r.getUTCMilliseconds(),3)}function p(){return U(t.getNano(),9)}function m(){return g[r.getUTCDay()]}function w(){return y[r.getUTCMonth()]}}function D(e,n,i,o,a,u){return l;function l(e,n){var i=_(this);e||(e=new Array(8)),x(e,n|=0);var o=Math.floor(i.time/1e3),l=i.year*(s*t/r),p=h(l/c)+h(o/c),f=l%c+o%c,y=Math.floor(f/c);return y&&(p+=y,f-=y*c),d(e,n+a,p),d(e,n+u,f),e}function d(t,r,s){t[r+e]=s>>24&255,t[r+n]=s>>16&255,t[r+i]=s>>8&255,t[r+o]=255&s}}function C(e,t,r,s,n,i){return o;function o(e,t){x(e,t|=0);var r=c(e,t+n),s=c(e,t+i);return k(s,r)}function c(n,i){return n[i+e]*a+(n[i+t]<<16|n[i+r]<<8|n[i+s])}}function x(e,t){var r=e&&e.length;if(null==r)throw new TypeError("Invalid Buffer");if(r<t+8)throw new RangeError("Out of range")}function L(e){var t=e-e%1;return 0===t&&(e<0||0===e&&1/e!==1/0)?-0:t}function M(e){return(e>9?"":" ")+(0|e)}function B(e){return(e>9?"":"0")+(0|e)}function U(e,t){return(d+(0|e)).substr(-t)}})()},"684e":function(e,t,r){"use strict";const s=(e,t,r,s,n,i,o)=>{async function*a(e={}){const r=e.offset||0,a=e.length||t.Links.length,c=t.Links.slice(r,a);for(const t of c){const r=await n(t.Hash,t.Name,`${s}/${t.Name}`,[],i+1,o,e);r.entry&&(yield r.entry)}}return a};e.exports=s},6887:function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:circuit"),{error:s("libp2p:circuit:err")}),i=r("b6aa"),o=r("9457"),{Multiaddr:a}=r("2054"),c=r("eddf"),{CircuitRelay:u}=r("46f6"),{codes:l}=r("b73a"),d=r("d08c"),{relay:h}=r("5e54"),p=r("9937"),{handleCanHop:f,handleHop:y,hop:g}=r("0f57"),{handleStop:b}=r("54383"),m=r("56fc"),w=Symbol.for("@libp2p/js-libp2p-circuit/circuit");class _{constructor({libp2p:e,upgrader:t}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=t,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(h,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:t}){const r=new m({stream:t}),s=await r.read();if(!s)return;const i=this;let o;switch(s.type){case u.Type.CAN_HOP:n("received CAN_HOP request from %s",e.remotePeer.toB58String()),await f({circuit:i,connection:e,streamHandler:r});break;case u.Type.HOP:n("received HOP request from %s",e.remotePeer.toB58String()),o=await y({connection:e,request:s,streamHandler:r,circuit:i});break;case u.Type.STOP:n("received STOP request from %s",e.remotePeer.toB58String()),o=await b({connection:e,request:s,streamHandler:r});break;default:n("Request of type %s not supported",s.type)}if(o){const e=new a(s.dstPeer.addrs[0]),t=new a(s.srcPeer.addrs[0]),r=d({stream:o,remoteAddr:e,localAddr:t}),i=s.type===u.Type.HOP?"relay":"inbound";n("new %s connection %s",i,r.remoteAddr);const c=await this._upgrader.upgradeInbound(r);n("%s connection %s upgraded",i,r.remoteAddr),this.handler&&this.handler(c)}}async dial(e,t){const r=e.toString().split("/p2p-circuit"),s=new a(r[0]),o=new a(r[r.length-1]),h=s.getPeerId(),p=o.getPeerId();if(!h||!p){const e="Circuit relay dial failed as addresses did not have peer id";throw n.error(e),i(new Error(e),l.ERR_RELAYED_DIAL)}const f=c.createFromCID(h),y=c.createFromCID(p);let b=!1,m=this._connectionManager.get(f);m||(m=await this._dialer.connectToPeer(s,t),b=!0);try{const t=await g({connection:m,request:{type:u.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(e=>e.bytes)},dstPeer:{id:y.toBytes(),addrs:[new a(o).bytes]}}}),r=s.encapsulate("/p2p-circuit/p2p/"+this.peerId.toB58String()),i=d({stream:t,remoteAddr:e,localAddr:r});return n("new outbound connection %s",i.remoteAddr),this._upgrader.upgradeOutbound(i)}catch(w){throw n.error("Circuit relay dial failed",w),b&&await m.close(),w}}createListener(e,t){return"function"===typeof e&&(t=e,e={}),this.handler=t,p(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(e=>o.Circuit.matches(e))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[w])}}e.exports=_},"68c3":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("1755"),n=r("b92d");function i(e,t,r,n){return new s.Token(s.Type.tag,r,1)}function o(e,t,r,i){return new s.Token(s.Type.tag,n.readUint8(e,t+1,i),2)}function a(e,t,r,i){return new s.Token(s.Type.tag,n.readUint16(e,t+1,i),3)}function c(e,t,r,i){return new s.Token(s.Type.tag,n.readUint32(e,t+1,i),5)}function u(e,t,r,i){return new s.Token(s.Type.tag,n.readUint64(e,t+1,i),9)}function l(e,t){n.encodeUintValue(e,s.Type.tag.majorEncoded,t.value)}l.compareTokens=n.encodeUint.compareTokens,t.decodeTag16=a,t.decodeTag32=c,t.decodeTag64=u,t.decodeTag8=o,t.decodeTagCompact=i,t.encodeTag=l},"68c6":function(e,t,r){"use strict";const s=r("a29d");e.exports=({network:e})=>{async function t(t={}){const{libp2p:r}=await e.use(t),s=[];for(const[e,n]of r.connections)for(const r of n){const n={addr:r.remoteAddr,peer:e};(t.verbose||t.direction)&&(n.direction=r.stat.direction),t.verbose&&(n.muxer=r.stat.multiplexer,n.latency="n/a",n.streams=[]),s.push(n)}return s}return s(t)}},"69d3":function(e,t,r){"use strict";const s=r("c449"),n=r("b6aa"),i=r("a29d");e.exports=({ipld:e,preload:t})=>{async function r(r,i={}){let o;try{o=new s(r)}catch(a){throw n(a,"ERR_INVALID_CID")}return!1!==i.preload&&t(o),e.get(o,{signal:i.signal})}return i(r)}},"6b85":function(e,t,r){"use strict";const{Key:s}=r("1304"),{Record:n}=r("92b9"),{encodeBase32:i}=r("77a6"),o=r("b6aa"),a=r("34eb"),c=Object.assign(a("ipfs:ipns:offline-datastore"),{error:a("ipfs:ipns:offline-datastore:error")});class u{constructor(e){this._repo=e,this.stores=[]}async put(e,t){if(!(e instanceof Uint8Array))throw o(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(t instanceof Uint8Array))throw o(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let r;try{r=this._routingKey(e)}catch(i){throw c.error(i),o(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const s=new n(e,t);return this._repo.datastore.put(r,s.serialize())}async get(e){if(!(e instanceof Uint8Array))throw o(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let t;try{t=this._routingKey(e)}catch(i){throw c.error(i),o(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const r=await this._repo.datastore.get(t);let s;try{s=n.deserialize(r)}catch(i){throw c.error(i),i}return s.value}_routingKey(e){return new s("/"+i(e),!1)}}e.exports=u},"6bd5":function(e,t,r){"use strict";const s=async function*(e,t){let r=0;if(!(t<1))for await(const s of e)if(yield s,r++,r===t)return};e.exports=s},"6ca9":function(e,t,r){"use strict";function s(e){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^::1$/.test(e)}e.exports=s},"6cdb":function(e,t,r){"use strict";const s=r("a29d");e.exports=({network:e})=>{async function t(t={}){const r=(await e.use(t)).bitswap,s=r.stat().snapshot;return{provideBufLen:parseInt(s.providesBufferLength.toString()),blocksReceived:BigInt(s.blocksReceived.toString()),wantlist:Array.from(r.getWantlist()).map(e=>e[1].cid),peers:r.peers().map(e=>e.toB58String()),dupBlksReceived:BigInt(s.dupBlksReceived.toString()),dupDataReceived:BigInt(s.dupDataReceived.toString()),dataReceived:BigInt(s.dataReceived.toString()),blocksSent:BigInt(s.blocksSent.toString()),dataSent:BigInt(s.dataSent.toString())}}return s(t)}},"6d1f":function(e,t,r){"use strict";const s=r("b6aa"),{messages:n,codes:i}=r("b73a"),{storeAddresses:o,uniquePeers:a,requirePeers:c,maybeLimitSource:u}=r("aa14"),l=r("500d"),{pipe:d}=r("66f2");class h{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(this.dht)}async*findProviders(e,t={}){if(!this.routers.length)throw s(new Error("No content this.routers available"),"NO_ROUTERS_AVAILABLE");yield*d(l(...this.routers.map(r=>r.findProviders(e,t))),e=>o(e,this.libp2p.peerStore),e=>a(e),e=>u(e,t.maxNumProviders),e=>c(e))}async provide(e){if(!this.routers.length)throw s(new Error("No content routers available"),"NO_ROUTERS_AVAILABLE");await Promise.all(this.routers.map(t=>t.provide(e)))}put(e,t,r){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw s(new Error(n.NOT_STARTED_YET),i.DHT_NOT_STARTED);return this.dht.put(e,t,r)}get(e,t){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw s(new Error(n.NOT_STARTED_YET),i.DHT_NOT_STARTED);return this.dht.get(e,t)}async getMany(e,t,r){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw s(new Error(n.NOT_STARTED_YET),i.DHT_NOT_STARTED);return this.dht.getMany(e,t,r)}}e.exports=h},"6d6b":function(e,t,r){"use strict";var s=r("aefd"),n=r("b7268");e.exports=s.bind(null,n)},"6e04":function(e,t,r){"use strict";const s=r("6ef9"),n=r("eddf"),i=r("b6aa"),o=r("34eb"),a=Object.assign(o("ipfs:ipns:resolver"),{error:o("ipfs:ipns:resolver:error")}),c=r("9b62"),{Errors:u}=r("1304"),l=u.notFoundError().code,d=32;class h{constructor(e){this._routing=e}async resolve(e,t={}){if("string"!==typeof e)throw i(new Error("invalid name"),"ERR_INVALID_NAME");const r=t.recursive&&"true"===t.recursive.toString(),s=e.split("/");if(3!==s.length||""!==s[0])throw i(new Error("invalid name"),"ERR_INVALID_NAME");const n=s[2];let o=1/0;r&&(o=d);const c=await this.resolver(n,o);return a(e+" was locally resolved correctly"),c}async resolver(e,t){if(0===t){const e=`could not resolve name (recursion limit of ${d} exceeded)`;throw a.error(e),i(new Error(e),"ERR_RESOLVE_RECURSION_LIMIT")}const r=await this._resolveName(e),s=r.split("/");return"ipfs"!==s[1]&&t?this.resolver(s[2],t-1):r}async _resolveName(e){const t=n.createFromCID(e),{routingKey:r}=s.getIdKeys(t.toBytes());let o,c;try{o=await this._routing.get(r.uint8Array())}catch(u){if(a.error("could not get record from routing",u),u.code===l)throw i(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND");throw i(new Error("unexpected error getting the ipns record "+t.toString()),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}try{c=s.unmarshal(o)}catch(u){throw a.error("could not unmarshal record",u),i(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_RECORD_RECEIVED")}return this._validateRecord(t,c)}async _validateRecord(e,t){const r=await s.extractPublicKey(e,t);return await s.validate(r,t),c(t.value)}}e.exports=h},"6e86":function(e,t,r){"use strict";const s=r("bfcd"),n=r("7bf9"),{Multiaddr:i}=r("2054"),o=r("b6aa");class a{constructor(e,t,r){this.peerId=e,this.libp2p=t,this.bitswap=r}static async start({peerId:e,repo:t,print:r,options:i}){t.closed&&await t.open();const o=await t.config.getAll(),u=await n({options:i,repo:t,peerId:e,multiaddrs:c(e,o),config:o,keychainConfig:void 0});u.keychain&&await u.loadKeychain(),await u.start();for(const s of u.multiaddrs)r(`Swarm listening on ${s}/p2p/${e.toB58String()}`);const l=new s(u,t.blocks,{statsEnabled:!0});return await l.start(),new a(e,u,l)}static async stop(e){await Promise.all([e.bitswap.stop(),e.libp2p.stop()])}}e.exports=a;const c=(e,t)=>{const r=e.toB58String(),s=[],n=t.Addresses&&t.Addresses.Swarm||[];for(const a of n){let e=new i(a);if(e.protoCodes().includes(u))throw o(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");const t=e.getPeerId();t&&t!==r&&(e=e.encapsulate("/p2p/"+r)),s.push(e)}return s},u=479},"6ef9":function(e,t,r){"use strict";const s=r("6844"),{Key:n}=r("1304"),i=r("ff5f"),o=r("eddf"),a=r("354e"),c=r("b6aa"),u=r("675c"),l=r("d46b"),d=r("9b62"),h=r("f3bf"),p=r("5aab"),f=r("c81a"),y=r("da5a"),g=r("34eb"),b=Object.assign(g("jsipns"),{error:g("jsipns:error")}),{IpnsEntry:m}=r("232f"),{parseRFC3339:w}=r("79d5"),_=r("a771"),E=a.names.identity,v="/ipns/",S=(e,t,r,n)=>{const i=new s(Date.now()+Number(n)),o=m.ValidityType.EOL,[a,c]=n.toString().split("."),u=100000n*BigInt(a)+BigInt(c||0);return A(e,t,r,o,i,u)},I=(e,t,r,n)=>{const i=s.fromString(n),o=m.ValidityType.EOL,a=i.toDate().getTime()-Date.now(),c=100000n*BigInt(a)+BigInt(i.getNano());return A(e,t,r,o,i,c)},A=async(e,t,r,s,n,i)=>{r=BigInt(r);const o=l(n.toString()),a=await x(e,t,s,o),c=R(t,o,s,r,i),u=B(c),d=await e.sign(u),h={value:t,signature:a,validityType:s,validity:o,sequence:r,ttl:i,signatureV2:d,data:c};return b(`ipns entry for ${t} created`),h},R=(e,t,r,s,n)=>{const i={value:e,validity:t,validityType:r,sequence:s,ttl:n};return f.encode(i)},T=async(e,t)=>{const{value:r,validityType:s,validity:n}=t;let i,o,a;t.signatureV2&&t.data?(o=t.signatureV2,i=B(t.data),k(t)):(o=t.signature,i=M(r,s,n));try{a=await e.verify(i,o)}catch(u){a=!1}if(!a)throw b.error("record signature verification failed"),c(new Error("record signature verification failed"),_.ERR_SIGNATURE_VERIFICATION);if(s===m.ValidityType.EOL){let e;try{e=w(d(n))}catch(l){throw b.error("unrecognized validity format (not an rfc3339 format)"),c(new Error("unrecognized validity format (not an rfc3339 format)"),_.ERR_UNRECOGNIZED_FORMAT)}if(e.getTime()<Date.now())throw b.error("record has expired"),c(new Error("record has expired"),_.ERR_IPNS_EXPIRED_RECORD)}else if(s)throw b.error("unrecognized validity type"),c(new Error("unrecognized validity type"),_.ERR_UNRECOGNIZED_VALIDITY);b(`ipns entry for ${r} is valid`)},k=e=>{if(!e.data)throw c(new Error("Record data is missing"),_.ERR_INVALID_RECORD_DATA);const t=f.decode(e.data);if(Number.isInteger(t.sequence)&&(t.sequence=BigInt(t.sequence)),Number.isInteger(t.ttl)&&(t.ttl=BigInt(t.ttl)),!p(t.value,e.value))throw c(new Error('Field "value" did not match between protobuf and CBOR'),_.ERR_SIGNATURE_VERIFICATION);if(!p(t.validity,e.validity))throw c(new Error('Field "validity" did not match between protobuf and CBOR'),_.ERR_SIGNATURE_VERIFICATION);if(t.validityType!==e.validityType)throw c(new Error('Field "validityType" did not match between protobuf and CBOR'),_.ERR_SIGNATURE_VERIFICATION);if(t.sequence!==e.sequence)throw c(new Error('Field "sequence" did not match between protobuf and CBOR'),_.ERR_SIGNATURE_VERIFICATION);if(t.ttl!==e.ttl)throw c(new Error('Field "ttl" did not match between protobuf and CBOR'),_.ERR_SIGNATURE_VERIFICATION)},P=async(e,t)=>{if(!e||!e.bytes||!t){const e=new Error("one or more of the provided parameters are not defined");throw b.error(e),c(e,_.ERR_UNDEFINED_PARAMETER)}let r,s;try{r=await o.createFromPubKey(e.bytes)}catch(n){throw c(n,_.ERR_PEER_ID_FROM_PUBLIC_KEY)}try{s=U(r)}catch(n){throw b.error(n),c(n,_.ERR_PUBLIC_KEY_FROM_ID)}if(s)return null;try{t.pubKey=i.keys.marshalPublicKey(e)}catch(n){throw b.error(n),n}return t},O=(e,t)=>{if(!t||!e){const e=new Error("one or more of the provided parameters are not defined");throw b.error(e),c(e,_.ERR_UNDEFINED_PARAMETER)}if(t.pubKey){let e;try{e=i.keys.unmarshalPublicKey(t.pubKey)}catch(r){throw b.error(r),r}return e}if(e.pubKey)return e.pubKey;throw Object.assign(new Error("no public key is available"),{code:_.ERR_UNDEFINED_PARAMETER})},N=e=>d(u.encode("base32",e)).slice(1).toUpperCase(),D=e=>new n("/ipns/"+N(e)),C=e=>{const t=l("/pk/"),r=l("/ipns/");return{routingPubKey:new n(h([t,e]),!1),pkKey:new n(N(h([t,e]))),routingKey:new n(h([r,e]),!1),ipnsKey:new n(N(h([r,e])))}},x=(e,t,r,s)=>{try{const n=M(t,r,s);return e.sign(n)}catch(n){throw b.error("record signature creation failed"),c(new Error("record signature creation failed: "+n.message),_.ERR_SIGNATURE_CREATION)}},L=e=>{if("0"===e.toString())return"EOL";const t=new Error("unrecognized validity type "+e.toString());throw b.error(t),c(t,_.ERR_UNRECOGNIZED_VALIDITY)},M=(e,t,r)=>{const s=l(L(t));return h([e,r,s])},B=e=>{const t=l("ipns-signature:");return h([t,e])},U=e=>{const t=a.decode(e.id);return t.code!==E?null:i.keys.unmarshalPublicKey(t.digest)},j=e=>m.encode({...e,sequence:y.fromString(e.sequence.toString()),ttl:null==e.ttl?void 0:y.fromString(e.ttl.toString())}).finish(),F=e=>{const t=m.decode(e),r=m.toObject(t,{defaults:!1,arrays:!0,objects:!1});return{value:r.value,signature:r.signature,validityType:r.validityType,validity:r.validity,sequence:Object.hasOwnProperty.call(r,"sequence")?BigInt(""+r.sequence):0n,pubKey:r.pubKey,ttl:Object.hasOwnProperty.call(r,"ttl")?BigInt(""+r.ttl):void 0}},V={validate:async(e,t)=>{const r=F(e),s=t.slice("/ipns/".length),n=o.createFromBytes(s),i=O(n,r);await T(i,r)},select:(e,t)=>{const r=F(e),s=F(t);return r.sequence>s.sequence?0:1}};e.exports={create:S,createWithExpiration:I,validate:T,embedPublicKey:P,extractPublicKey:O,getLocalKey:D,getIdKeys:C,marshal:j,unmarshal:F,validator:V,namespace:v,namespaceLength:v.length}},"6f2b":function(e,t,r){"use strict";const{Adapter:s}=r("1304"),n=r("5d6d");class i extends s{constructor(e,t){super(),this.child=e,this.transform=t}open(){return this.child.open()}put(e,t,r){return this.child.put(this.transform.convert(e),t,r)}get(e,t){return this.child.get(this.transform.convert(e),t)}has(e,t){return this.child.has(this.transform.convert(e),t)}delete(e,t){return this.child.delete(this.transform.convert(e),t)}batch(){const e=this.child.batch();return{put:(t,r)=>{e.put(this.transform.convert(t),r)},delete:t=>{e.delete(this.transform.convert(t))},commit:t=>e.commit(t)}}query(e,t){return n(this.child.query(e,t),({key:e,value:t})=>({key:this.transform.invert(e),value:t}))}queryKeys(e,t){return n(this.child.queryKeys(e,t),e=>this.transform.invert(e))}close(){return this.child.close()}}e.exports=i},"6f8e":function(e,t,r){"use strict";(function(e){t.fromCallback=function(e){if(void 0===e){var t=new Promise((function(t,r){e=function(e,s){e?r(e):t(s)}}));e.promise=t}return e},t.fromPromise=function(t,r){if(void 0===r)return t;t.then((function(t){e.nextTick(r,null,t)})).catch((function(t){e.nextTick(r,t)}))}}).call(this,r("4362"))},7022:function(e,t,r){"use strict";const s=r("312c"),n=r("5d98"),i=r("0e80"),o=r("c449"),a=r("fa4e"),c=r("f3bf"),u=r("d46b"),l=42;function d(e){return"string"===typeof e?e=new o(e).bytes:o.isCID(e)&&(e=e.bytes),new s.Tagged(l,c([u("00","base16"),e],1+e.length))}function h(e){let t;try{t=a(e)}catch(s){t=!1}if(t)throw new Error("The object passed has circular references");function r(e){if(!e||e instanceof Uint8Array||"string"===typeof e)return e;if(Array.isArray(e))return e.map(r);if(o.isCID(e))return d(e);const t=Object.keys(e);if(t.length>0){const s={};return t.forEach(t=>{"object"===typeof e[t]?s[t]=r(e[t]):s[t]=e[t]}),s}return e}return r(e)}const p=n.DAG_CBOR,f=n.SHA2_256,y={[l]:e=>(e=e.slice(1),new o(e))},g=65536;let b=g;const m=67108864;let w=m,_=null;function E(e){let t=y;e?("number"===typeof e.size&&(b=e.size),"number"===typeof e.maxSize&&(w=e.maxSize),e.tags&&(t=Object.assign({},y,e&&e.tags))):(b=g,w=m);const r={tags:t,size:b};_=new s.Decoder(r),b=r.size}function v(e){const t=h(e),r=s.encode(t);return r}function S(e){if(e.length>b&&e.length<=w&&E({size:e.length}),e.length>b)throw new Error("Data is too large to deserialize with current decoder");const t=_.decodeAll(e);if(1!==t.length)throw new Error("Extraneous CBOR data found beyond initial top-level object");return t[0]}async function I(e,t){const r={cidVersion:1,hashAlg:f},s=Object.assign(r,t),a=await i(e,s.hashAlg),c=n.getNameFromCode(p),u=new o(s.cidVersion,c,a);return u}E(),e.exports={codec:p,defaultHashAlg:f,configureDecoder:E,serialize:v,deserialize:S,cid:I}},7039:function(e,t,r){"use strict";const s=r("c537"),n=r("c82b"),i=r("e8ff");class o{constructor({dns:e,ipns:t,ipld:r,peerId:o,isOnline:a,keychain:c,options:u}){this.publish=s({ipns:t,ipld:r,peerId:o,isOnline:a,keychain:c}),this.resolve=n({dns:e,ipns:t,peerId:o,isOnline:a,options:u}),this.pubsub=new i({ipns:t,options:u})}}e.exports=o},"707c":function(e,t,r){"use strict";const s=r("637e").Entry;e.exports=class{constructor(e,t,r,n,i){this.entry=new s(e,t,r),this.cancel=Boolean(n),this.sendDontHave=Boolean(i)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){const e=this.cid.toString("base58btc");return`BitswapMessageEntry ${e} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}},"70eb":function(e,t,r){"use strict";const s=r("eddf"),{Key:n,Errors:i}=r("1304"),o=r("b6aa"),a=r("34eb"),c=Object.assign(a("ipfs:ipns:publisher"),{error:a("ipfs:ipns:publisher:error")}),u=r("9b62"),l=r("5aab"),d=r("6ef9"),h=i.notFoundError().code,p=36e5;class f{constructor(e,t){this._routing=e,this._datastore=t}async publishWithEOL(e,t,r){if(!e||!e.bytes)throw o(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");const n=await s.createFromPrivKey(e.bytes),i=await this._updateOrCreateRecord(e,t,r,n);return this._putRecordToRouting(i,n)}publish(e,t){return this.publishWithEOL(e,t,p)}async _putRecordToRouting(e,t){if(!s.isPeerId(t)){const e="peerId received is not valid";throw c.error(e),o(new Error(e),"ERR_INVALID_PEER_ID")}const r=t._pubKey,n=await d.embedPublicKey(r,e),i=d.getIdKeys(t.toBytes());return await this._publishEntry(i.routingKey,n||e),await this._publishPublicKey(i.routingPubKey,r),n||e}async _publishEntry(e,t){if(!n.isKey(e)){const e="datastore key does not have a valid format";throw c.error(e),o(new Error(e),"ERR_INVALID_DATASTORE_KEY")}let r;try{r=d.marshal(t)}catch(s){throw c.error(s),s}try{const t=await this._routing.put(e.uint8Array(),r);return c(`ipns record for ${u(e.uint8Array(),"base64")} was stored in the routing`),t}catch(s){const t=`ipns record for ${u(e.uint8Array(),"base64")} could not be stored in the routing`;throw c.error(t),c.error(s),o(new Error(t),"ERR_PUTTING_TO_ROUTING")}}async _publishPublicKey(e,t){if(!n.isKey(e)){const e="datastore key does not have a valid format";throw c.error(e),o(new Error(e),"ERR_INVALID_DATASTORE_KEY")}if(!t||!t.bytes){const e="one or more of the provided parameters are not defined";throw c.error(e),o(new Error(e),"ERR_UNDEFINED_PARAMETER")}try{const r=await this._routing.put(e.uint8Array(),t.bytes);return c(`public key for ${u(e.uint8Array(),"base64")} was stored in the routing`),r}catch(r){const t=`public key for ${u(e.uint8Array(),"base64")} could not be stored in the routing`;throw c.error(t),c.error(r),o(new Error(t),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,t={}){if(!s.isPeerId(e)){const e="peerId received is not valid";throw c.error(e),o(new Error(e),"ERR_INVALID_PEER_ID")}const r=!1!==t.checkRouting;try{const t=await this._datastore.get(d.getLocalKey(e.id));return this._unmarshalData(t)}catch(n){if(n.code!==h){const t=`unexpected error getting the ipns record ${e.id} from datastore`;throw c.error(t),o(new Error(t),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!r)throw o(n,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{const t=d.getIdKeys(e.toBytes()),r=await this._routing.get(t.routingKey.uint8Array());return this._unmarshalData(r)}catch(n){throw c.error(n),n}}}_unmarshalData(e){try{return d.unmarshal(e)}catch(t){throw o(t,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,t,r,n){if(!s.isPeerId(n)){const e="peerId received is not valid";throw c.error(e),o(new Error(e),"ERR_INVALID_PEER_ID")}const i={checkRouting:!0};let a;try{a=await this._getPublished(n,i)}catch(y){if(y.code!==h){const e=`unexpected error when determining the last published IPNS record for ${n.id} ${y.stack}`;throw c.error(e),o(new Error(e),"ERR_DETERMINING_PUBLISHED_RECORD")}}let p,f=0n;a&&void 0!==a.sequence&&(f=l(a.value,t)?BigInt(a.sequence):BigInt(a.sequence)+1n);try{p=await d.create(e,t,f,r)}catch(y){const e=`ipns record for ${t} could not be created`;throw c.error(y),o(new Error(e),"ERR_CREATING_IPNS_RECORD")}try{const e=d.marshal(p);return await this._datastore.put(d.getLocalKey(n.id),e),c(`ipns record for ${u(t,"base32")} was stored in the datastore`),p}catch(y){const e=`ipns record for ${t} could not be stored in the datastore`;throw c.error(e),o(new Error(e),"ERR_STORING_IN_DATASTORE")}}}f.defaultRecordLifetime=p,e.exports=f},7102:function(e,t,r){"use strict";const s=r("eddf"),{RPC:n}=r("9aaa"),i=r("f3bf"),o=r("d46b"),a=o("libp2p-pubsub:");async function c(e,t){const r=i([a,n.Message.encode(t).finish()]),s=await e.privKey.sign(r);return{...t,signature:s,key:e.pubKey.bytes}}async function u(e){if(!e.signature)throw new Error("Message must contain a signature to be verified");const t=i([a,n.Message.encode({...e,from:s.createFromCID(e.from).toBytes(),signature:void 0,key:void 0}).finish()]),r=await l(e);return r.verify(t,e.signature)}async function l(e){if(!e.from)throw new Error("Could not get the public key from the originator id");const t=s.createFromCID(e.from);if(e.key){const r=await s.createFromPubKey(e.key);if(r.equals(t))return r.pubKey;throw new Error("Public Key does not match the originator")}if(t.pubKey)return t.pubKey;throw new Error("Could not get the public key from the originator id")}e.exports={messagePublicKey:l,signMessage:c,SignPrefix:a,verifySignature:u}},"713e":function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:identify"),{error:s("libp2p:identify:err")}),i=r("b6aa"),o=r("bbbe"),{pipe:a}=r("66f2"),{collect:c,take:u,consume:l}=r("8b55"),d=r("d46b"),h=r("eddf"),{Multiaddr:p}=r("2054"),{toBuffer:f}=r("6bec"),y=r("0c5f"),g=r("7cb6"),b=r("54b0"),{MULTICODEC_IDENTIFY:m,MULTICODEC_IDENTIFY_PUSH:w,PROTOCOL_VERSION:_}=r("4c82"),{codes:E}=r("b73a");class v{constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this),this._host={protocolVersion:_,...e._options.host},this.peerStore.metadataBook.set(this.peerId,"AgentVersion",d(this._host.agentVersion)),this.peerStore.metadataBook.set(this.peerId,"ProtocolVersion",d(this._host.protocolVersion)),this.connectionManager.on("peer:connect",e=>{this.identify(e).catch(n.error)}),this.peerStore.on("change:multiaddrs",({peerId:e})=>{e.toString()===this.peerId.toString()&&this.pushToPeerStore()}),this.peerStore.on("change:protocols",({peerId:e})=>{e.toString()===this.peerId.toString()&&this.pushToPeerStore()})}async push(e){const t=await this.peerStore.addressBook.getRawEnvelope(this.peerId),r=this._libp2p.multiaddrs.map(e=>e.bytes),s=this.peerStore.protoBook.get(this.peerId)||[],i=e.map(async e=>{try{const{stream:n}=await e.newStream(w);await a([y.Identify.encode({listenAddrs:r,signedPeerRecord:t,protocols:s}).finish()],o.encode(),n,l)}catch(i){n.error("could not push identify update to peer",i)}});return Promise.all(i)}pushToPeerStore(){if(!this._libp2p.isStarted())return;const e=[];let t;for(const r of this.peerStore.peers.values())r.protocols.includes(w)&&(t=this.connectionManager.get(r.id))&&e.push(t);this.push(e)}async identify(e){const{stream:t}=await e.newStream(m),[r]=await a([],t,o.decode(),u(1),f,c);if(!r)throw i(new Error("No data could be retrieved"),E.ERR_CONNECTION_ENDED);let s;try{s=y.Identify.decode(r)}catch(T){throw i(T,E.ERR_INVALID_MESSAGE)}const{publicKey:l,listenAddrs:w,protocols:_,observedAddr:S,signedPeerRecord:I}=s,A=await h.createFromPubKey(l);if(e.remotePeer.toB58String()!==A.toB58String())throw i(new Error("identified peer does not match the expected peer"),E.ERR_INVALID_PEER);const R=v.getCleanMultiaddr(S);try{const e=await g.openAndCertify(I,b.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(e))return this.peerStore.protoBook.set(A,_),this.peerStore.metadataBook.set(A,"AgentVersion",d(s.agentVersion)),void this.peerStore.metadataBook.set(A,"ProtocolVersion",d(s.protocolVersion))}catch(T){n("received invalid envelope, discard it and fallback to listenAddrs is available",T)}try{this.peerStore.addressBook.set(A,w.map(e=>new p(e)))}catch(T){n.error("received invalid addrs",T)}this.peerStore.protoBook.set(A,_),this.peerStore.metadataBook.set(A,"AgentVersion",d(s.agentVersion)),this.peerStore.metadataBook.set(A,"ProtocolVersion",d(s.protocolVersion)),n("received observed address of %s",R)}handleMessage({connection:e,stream:t,protocol:r}){switch(r){case m:return this._handleIdentify({connection:e,stream:t});case w:return this._handlePush({connection:e,stream:t});default:n.error("cannot handle unknown protocol %s",r)}}async _handleIdentify({connection:e,stream:t}){let r=new Uint8Array(0);this.peerId.pubKey&&(r=this.peerId.pubKey.bytes);const s=await this.peerStore.addressBook.getRawEnvelope(this.peerId),i=this.peerStore.protoBook.get(this.peerId)||[],c=y.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:r,listenAddrs:this._libp2p.multiaddrs.map(e=>e.bytes),signedPeerRecord:s,observedAddr:e.remoteAddr.bytes,protocols:i}).finish();try{await a([c],o.encode(),t,l)}catch(u){n.error("could not respond to identify request",u)}}async _handlePush({connection:e,stream:t}){let r;try{const[e]=await a([],t,o.decode(),u(1),f,c);r=y.Identify.decode(e)}catch(i){return n.error("received invalid message",i)}const s=e.remotePeer;try{const e=await g.openAndCertify(r.signedPeerRecord,b.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(e))return void this.peerStore.protoBook.set(s,r.protocols)}catch(i){n("received invalid envelope, discard it and fallback to listenAddrs is available",i)}try{this.peerStore.addressBook.set(s,r.listenAddrs.map(e=>new p(e)))}catch(i){n.error("received invalid addrs",i)}this.peerStore.protoBook.set(s,r.protocols)}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new p(e)}catch(t){return null}return null}}const S={IDENTIFY:m,IDENTIFY_PUSH:w};v.multicodecs=S,v.Messsage=y,e.exports=v},"73df":function(e,t,r){"use strict";const s=r("6512");e.exports=({path:e,repoOwner:t})=>s(e,{singleProcess:!1!==t})},"73fb":function(e,t,r){"use strict";const s=r("eddf"),{Multiaddr:n}=r("2054"),{Record:i}=r("92b9"),o=r("1583"),a=o.Message.MessageType,c=o.Message.ConnectionType;class u{constructor(e,t,r){if(t&&!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this._clusterLevelRaw=r,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){const e=this._clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this._clusterLevelRaw=e}serialize(){const e={key:this.key,type:this.type,clusterLevelRaw:this._clusterLevelRaw,closerPeers:this.closerPeers.map(l),providerPeers:this.providerPeers.map(l),record:void 0};return this.record&&(this.record instanceof Uint8Array?e.record=this.record:e.record=this.record.serialize()),o.Message.encode(e).finish()}static deserialize(e){const t=o.Message.decode(e),r=new u(t.type,t.key,t.clusterLevelRaw);return r.closerPeers=t.closerPeers.map(d),r.providerPeers=t.providerPeers.map(d),t.record&&t.record.length&&(r.record=i.deserialize(t.record)),r}}function l(e){const t={id:e.id.id,addrs:(e.multiaddrs||[]).map(e=>e.bytes),connection:c.CONNECTED};return t}function d(e){return{id:new s(e.id),multiaddrs:(e.addrs||[]).map(e=>new n(e))}}u.TYPES=a,u.CONNECTION_TYPES=c,e.exports=u},7444:function(e,t,r){"use strict";const{mergeOptions:s}=r("4d04"),{isTest:n}=r("2984"),i=r("34eb")("ipfs"),o=r("b6aa"),{DAGNode:a}=r("8141"),{UnixFS:c}=r("9fd0"),u=r("8c6a"),{AlreadyInitializedError:l}=r("fabb"),d=r("d46b"),h=r("5061"),p=r("936e"),f=r("3d15"),y=r("7e2f"),g=r("75df"),b=r("2791"),m=r("cccb"),w=r("7039"),_=r("3971"),E=r("bfea"),v=r("d5ac"),S=r("e1a0"),I=r("91b9"),A=r("355c"),R=r("bb9f"),T=r("b2ec"),k=r("2e6e"),P=r("be0e"),O=r("d507"),N=r("a642"),D=r("519e"),C=r("4881"),x=r("112d"),L=r("20a0"),M=r("62a1"),B=r("a3fd"),U=r("f4d3"),j=r("27da"),F=r("2712"),V=r("6e86"),z=r("910b"),K=r("fd90"),q=r("73df"),G=r("5cfd"),H=r("3a9b"),$=r("429c");class W{constructor({print:e,storage:t,options:r}){const{peerId:s,repo:n,keychain:i}=t,a=z.create(V),c=N(r.preload),u=new U(t.repo),l=j({blockService:u,options:r.ipld}),d=q({path:n.path,repoOwner:r.repoOwner}),F=f(),W=y({network:a}),Y=new m(r),Q=new w({dns:F,ipns:Y,ipld:l,peerId:s,isOnline:W,keychain:i,options:r}),X=g({ipld:l,name:Q}),J=new O({repo:n,ipld:l}),Z=new b({gcLock:d,pinManager:J,ipld:l}),ee=new I({blockService:u,preload:c,gcLock:d,pinManager:J,pin:Z}),te=new P({ipld:l,preload:c,gcLock:d,pin:Z}),re=Object.assign(_({ipld:l,resolve:X,preload:c}),{local:E({repo:t.repo})}),{add:se,addAll:ne,cat:ie,get:oe,ls:ae}=new A({gcLock:d,preload:c,pin:Z,block:ee,ipld:l,options:r.EXPERIMENTAL}),ce=C({ipld:l,block:ee,blockService:u,repo:n,preload:c,options:r}),ue=D({files:ce,preload:c,options:r.preload});this.preload=c,this.name=Q,this.ipld=l,this.ipns=Y,this.pin=Z,this.resolve=X,this.block=ee,this.refs=re,this.start=h({network:a,peerId:s,repo:n,blockService:u,preload:c,ipns:Y,mfsPreload:ue,print:e,keychain:i,options:r}),this.stop=p({network:a,preload:c,mfsPreload:ue,blockService:u,ipns:Y,repo:n}),this.dht=H({network:a,repo:n}),this.pubsub=$({network:a,config:r.config}),this.dns=F,this.isOnline=W,this.id=T({network:a,peerId:s}),this.version=R({repo:n}),this.bitswap=new v({network:a}),this.bootstrap=new S({repo:n}),this.config=k({repo:n}),this.ping=G({network:a}),this.add=se,this.addAll=ne,this.cat=ie,this.get=oe,this.ls=ae,this.dag=te,this.files=ce,this.key=new x({keychain:i}),this.object=new L({ipld:l,preload:c,gcLock:d}),this.repo=new M({gcLock:d,pin:Z,repo:n,refs:re}),this.stats=new B({repo:n,network:a}),this.swarm=new K({network:a}),Object.defineProperty(this,"libp2p",{get(){const e=a.try();return e?e.libp2p:void 0}});const le=()=>Promise.reject(o(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),de=async function*(){throw o(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=le,this.diag={cmds:le,net:le,sys:le},this.log={level:le,ls:le,tail:de},this.mount=le}async init(){throw new l}static async create(e={}){e=s(Q(),e);const t=e.init||{},r=e.silent?i:console.log,n=await F.start(r,e),o=await n.repo.config.getAll(),a=new W({storage:n,print:r,options:{...e,config:o}});if(await a.preload.start(),a.ipns.startOffline(n),n.isNew&&!t.emptyRepo){const e=await Y(a);i("adding default assets"),await u({addAll:a.addAll,print:r}),i("initializing IPNS keyspace"),await a.ipns.initializeKeyspace(n.peerId.privKey,d("/ipfs/"+e))}return!1!==e.start&&await a.start(),a}}e.exports=W;const Y=async e=>{const t=new a(new c({type:"directory"}).marshal()),r=await e.dag.put(t,{version:0,format:"dag-pb",hashAlg:"sha2-256",preload:!1});return await e.pin.add(r),r},Q=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!n,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}})},"74aa":function(e,t,r){"use strict";function s(e){if(e.length<=1)return e;const t=()=>Math.floor(Math.random()*Math.floor(e.length));for(let r=0;r<e.length;r++){const s=t(),n=e[r];e[r]=e[s],e[s]=n}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.shuffle=void 0,t.shuffle=s},"74fd":function(e,t,r){const{AbortController:s}=r("c181");function n(e){const t=new s;function r(){t.abort();for(const t of e)t&&t.removeEventListener&&t.removeEventListener("abort",r)}for(const s of e)if(s&&s.addEventListener){if(s.aborted){r();break}s.addEventListener("abort",r)}return t.signal}e.exports=n,e.exports.anySignal=n},"75df":function(e,t,r){"use strict";const s=r("b306"),n=r("c449"),{cidToString:i}=r("a2b5"),o=r("a29d");e.exports=({ipld:e,name:t})=>{async function r(r,o={}){if(!s.path(r))throw new Error("invalid argument "+r);if(s.ipnsPath(r)){if(!t)throw new Error("failed to resolve IPNS path: name API unavailable");for await(const e of t.resolve(r,o))r=e}const[,,a,...c]=r.split("/"),u=new n(a);if(0===c.length)return"/ipfs/"+i(u,{base:o.cidBase});r=c.join("/");const l=e.resolve(u,r);let d=u,h=r;for await(const e of l)n.isCID(e.value)&&(d=e.value,h=e.remainderPath);return`/ipfs/${i(d,{base:o.cidBase})}${h?"/"+h:""}`}return o(r)}},7670:function(e,t,r){"use strict";const s=r("b6aa"),n=r("e66e"),i=r("7704"),o=r("a978"),a=r("73fb"),c=r("b664"),u=r("a9f4");e.exports=e=>{const t=async(t,r)=>{const s=new a(a.TYPES.GET_PROVIDERS,r.bytes,0);return e.network.sendRequest(t,s)};return{async provide(t){e._log("provide: "+t);const r=[];await e.providers.addProvider(t,e.peerId);const n=e.libp2p?e.libp2p.multiaddrs:[],i=new a(a.TYPES.ADD_PROVIDER,t.bytes,0);async function o(s){e._log(`putProvider ${t} to ${s.toB58String()}`);try{await e.network.sendMessage(s,i)}catch(n){r.push(n)}}if(i.providerPeers=[{id:e.peerId,multiaddrs:n}],await u.mapParallel(e.getClosestPeers(t.bytes),o),r.length)throw s(new Error(`Failed to provide to ${r.length} of ${e.kBucketSize} peers`),"ERR_SOME_PROVIDES_FAILED",{errors:r})},async*findProviders(r,s={timeout:6e4,maxNumProviders:5}){const a=s.timeout||i.minute,l=s.maxNumProviders||i.K;e._log("findProviders "+r);const d=new o(l),h=await e.providers.getProviders(r);if(h.forEach(t=>{const r=e.peerStore.get(t);r?d.push({id:r.id,multiaddrs:r.addresses.map(e=>e.multiaddr)}):d.push({id:t,multiaddrs:[]})}),d.length>=l){for(const e of d.toArray())yield e;return}const p=[];function f(s,n){const i=u.pathSize(l-d.length,n),a=new o(i);async function c(s){const n=await t(s,r),o=n.providerPeers;return e._log(`Found ${o.length} provider entries for ${r}`),o.forEach(e=>{a.push({...e})}),a.length>=i?{pathComplete:!0}:{closerPeers:n.closerPeers}}return p.push(a),c}const y=new c(e,r.bytes,f),g=e.routingTable.closestPeers(r.bytes,e.kBucketSize);try{await n(y.run(g),a)}catch(b){if(b.name!==n.TimeoutError.name)throw b}finally{y.stop()}p.forEach(e=>{e.toArray().forEach(e=>{d.push(e)})});for(const e of d.toArray())yield e}}}},"769c":function(e,t,r){"use strict";const s=r("2ce1"),n=r("cdc4");e.exports=async(e,t={})=>{const{concurrency:r=1/0}=t,i=n(r);return Promise.all(e.map(e=>e&&"function"===typeof e.then?s(e):s("function"===typeof e?i(()=>e()):Promise.resolve(e))))}},"76a02":function(e,t,r){"use strict";const{Key:s,Adapter:n}=r("1304"),{encodeBase32:i,keyToTopic:o,topicToKey:a}=r("f139"),c=r("5aab"),u=r("b6aa"),l=r("34eb"),d=Object.assign(l("datastore-pubsub:publisher"),{error:l("datastore-pubsub:publisher:error")});class h extends n{constructor(e,t,r,s,n){if(super(),!s)throw u(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if("function"!==typeof s.validate)throw u(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if("function"!==typeof s.select)throw u(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(n&&"function"!==typeof n)throw u(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=r,this._validator=s,this._handleSubscriptionKeyFn=n,this._onMessage=this._onMessage.bind(this)}async put(e,t){if(!(e instanceof Uint8Array)){const e="datastore key does not have a valid format";throw d.error(e),u(new Error(e),"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){const e="received value is not a Uint8Array";throw d.error(e),u(new Error(e),"ERR_INVALID_VALUE_RECEIVED")}const r=o(e);d("publish value for topic "+r),await this._pubsub.publish(r,t)}async get(e){if(!(e instanceof Uint8Array)){const e="datastore key does not have a valid format";throw d.error(e),u(new Error(e),"ERR_INVALID_DATASTORE_KEY")}const t=o(e),r=await this._pubsub.getTopics();if(r&&Array.isArray(r)&&r.indexOf(t)>-1)return this._getLocal(e);try{this._pubsub.on(t,this._onMessage),await this._pubsub.subscribe(t)}catch(s){const e="cannot subscribe topic "+t;throw d.error(e),u(new Error(e),"ERR_SUBSCRIBING_TOPIC")}return d("subscribed values for key "+t),this._getLocal(e)}unsubscribe(e){const t=o(e);return this._pubsub.removeListener(t,this._onMessage),this._pubsub.unsubscribe(t)}async _getLocal(e){const t=new s("/"+i(e),!1);let r;try{r=await this._datastore.get(t)}catch(n){if("ERR_NOT_FOUND"!==n.code){const e="unexpected error getting the ipns record for "+t.toString();throw d.error(e),u(new Error(e),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}const e="local record requested was not found for "+t.toString();throw d.error(e),u(new Error(e),"ERR_NOT_FOUND")}if(!(r instanceof Uint8Array)){const e="found record that we couldn't convert to a value";throw d.error(e),u(new Error(e),"ERR_INVALID_RECORD_RECEIVED")}return r}async _onMessage(e){const{data:t,from:r,topicIDs:s}=e;let n;try{n=a(s[0])}catch(i){return void d.error(i)}if(d("message received for topic "+s[0]),r!==this._peerId.toB58String()){if(this._handleSubscriptionKeyFn){let e;try{e=await this._handleSubscriptionKeyFn(n)}catch(i){return void d.error("message discarded by the subscriptionKeyFn")}n=e}try{await this._storeIfSubscriptionIsBetter(n,t)}catch(i){d.error(i)}}else d("message discarded as it is from the same peer")}async _storeIfSubscriptionIsBetter(e,t){let r=!1;try{r=await this._isBetter(e,t)}catch(s){if("ERR_NOT_VALID_RECORD"!==s.code)throw s}r&&await this._storeRecord(e,t)}async _validateRecord(e,t){return this._validator.validate(e,t)}async _selectRecord(e,t){const r=await this._validator.select(e,t);return 0===r}async _isBetter(e,t){try{await this._validateRecord(t,e)}catch(i){const e="record received through pubsub is not valid";throw d.error(e),u(new Error(e),"ERR_NOT_VALID_RECORD")}const r=new s(e);let n;try{n=await this._getLocal(r.uint8Array())}catch(i){return!0}return!c(n,t)&&this._selectRecord(e,[n,t])}async _storeRecord(e,t){const r=new s("/"+i(e),!1);await this._datastore.put(r,t),d(`record for ${o(e)} was stored in the datastore`)}}e.exports=h},7704:function(e,t,r){"use strict";const s=t.second=1e3,n=t.minute=60*s,i=t.hour=60*n;t.MAX_RECORD_AGE=36*i,t.PROTOCOL_DHT="/kad/1.0.0",t.PROVIDERS_KEY_PREFIX="/providers/",t.PROVIDERS_LRU_CACHE_SIZE=256,t.PROVIDERS_VALIDITY=24*i,t.PROVIDERS_CLEANUP_INTERVAL=i,t.READ_MESSAGE_TIMEOUT=10*s,t.GET_MANY_RECORD_COUNT=16,t.K=20,t.ALPHA=3,t.defaultRandomWalk={enabled:!0,queriesPerPeriod:1,interval:5*n,timeout:10*s,delay:10*s}},"777e":function(e,t,r){"use strict";const s=r("c2d2"),n=new Set(["lt","gt","lte","gte"]);function i(e){if(!(this instanceof i))return new i(e);this.opts=e||{},this.encodings=s}e.exports=i,i.prototype._encoding=function(e){return"string"===typeof e&&(e=s[e]),e||(e=s.id),e},i.prototype._keyEncoding=function(e,t){return this._encoding(t&&t.keyEncoding||e&&e.keyEncoding||this.opts.keyEncoding)},i.prototype._valueEncoding=function(e,t){return this._encoding(t&&(t.valueEncoding||t.encoding)||e&&(e.valueEncoding||e.encoding)||this.opts.valueEncoding||this.opts.encoding)},i.prototype.encodeKey=function(e,t,r){return this._keyEncoding(t,r).encode(e)},i.prototype.encodeValue=function(e,t,r){return this._valueEncoding(t,r).encode(e)},i.prototype.decodeKey=function(e,t){return this._keyEncoding(t).decode(e)},i.prototype.decodeValue=function(e,t){return this._valueEncoding(t).decode(e)},i.prototype.encodeBatch=function(e,t){return e.map(e=>{const r={type:e.type,key:this.encodeKey(e.key,t,e)};return this.keyAsBuffer(t,e)&&(r.keyEncoding="binary"),e.prefix&&(r.prefix=e.prefix),"value"in e&&(r.value=this.encodeValue(e.value,t,e),this.valueAsBuffer(t,e)&&(r.valueEncoding="binary")),r})},i.prototype.encodeLtgt=function(e){const t={};for(const r of Object.keys(e)){if("start"===r||"end"===r)throw new Error('Legacy range options ("start" and "end") have been removed');t[r]=n.has(r)?this.encodeKey(e[r],e):e[r]}return t},i.prototype.createStreamDecoder=function(e){return e.keys&&e.values?(t,r)=>({key:this.decodeKey(t,e),value:this.decodeValue(r,e)}):e.keys?t=>this.decodeKey(t,e):e.values?(t,r)=>this.decodeValue(r,e):function(){}},i.prototype.keyAsBuffer=function(e){return this._keyEncoding(e).buffer},i.prototype.valueAsBuffer=function(e){return this._valueEncoding(e).buffer}},"77a6":function(e,t,r){"use strict";const s=r("6ef9"),n=r("9b62");e.exports={encodeBase32:e=>n(e,"base32upper"),validator:{func:(e,t)=>s.validator.validate(t,e)},selector:(e,t)=>s.validator.select(t[0],t[1])}},"78b93":function(e,t,r){"use strict";const{cleanCid:s}=r("7ae0"),n=r("a29d");e.exports=({blockService:e,preload:t})=>{async function r(r,n={}){r=s(r),!1!==n.preload&&t(r);const i=await e.get(r);return{cid:r,size:i.data.length}}return n(r)}},"78c8":function(e,t,r){"use strict";e.exports=r("a132")},"793f":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validatePeerScoreThresholds=t.createPeerScoreThresholds=t.defaultPeerScoreThresholds=void 0;const s=r("4ab6"),n=r("2453");function i(e={}){return Object.assign(Object.assign({},t.defaultPeerScoreThresholds),e)}function o(e){if(e.gossipThreshold>0)throw n(new Error("invalid gossip threshold; it must be <= 0"),s.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(e.publishThreshold>0||e.publishThreshold>e.gossipThreshold)throw n(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),s.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(e.graylistThreshold>0||e.graylistThreshold>e.publishThreshold)throw n(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),s.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(e.acceptPXThreshold<0)throw n(new Error("invalid accept PX threshold; it must be >= 0"),s.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(e.opportunisticGraftThreshold<0)throw n(new Error("invalid opportunistic grafting threshold; it must be >= 0"),s.ERR_INVALID_PEER_SCORE_THRESHOLDS)}t.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20},t.createPeerScoreThresholds=i,t.validatePeerScoreThresholds=o},"794f":function(e,t,r){"use strict";function s(...e){return 0===e.length?".":e.join("/")}e.exports=s},"79d5":function(e,t,r){"use strict";e.exports.toRFC3339=e=>{const t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),s=String(e.getUTCDate()).padStart(2,"0"),n=String(e.getUTCHours()).padStart(2,"0"),i=String(e.getUTCMinutes()).padStart(2,"0"),o=String(e.getUTCSeconds()).padStart(2,"0"),a=e.getUTCMilliseconds(),c=1e3*a*1e3;return`${t}-${r}-${s}T${n}:${i}:${o}.${c}Z`},e.exports.parseRFC3339=e=>{const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(!r)throw new Error("Invalid format");const s=parseInt(r[1],10),n=parseInt(r[2],10)-1,i=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(s,n,i,o,a,c,u))}},"79ff":function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r("4c48"),t),n(r("74aa"),t),n(r("44e9"),t),n(r("9632"),t)},"7a13":function(e,t,r){"use strict";e.exports="This is a repository of IPLD objects. Each IPLD object is in a single file,\nnamed <base32 encoding of cid>.data. Where <base32 encoding of cid> is the\n\"base32\" encoding of the CID (as specified in\nhttps://github.com/multiformats/multibase) without the 'B' prefix.\nAll the object files are placed in a tree of directories, based on a\nfunction of the CID. This is a form of sharding similar to\nthe objects directory in git repositories. Previously, we used\nprefixes, we now use the next-to-last two charters.\n    func NextToLast(base32cid string) {\n      nextToLastLen := 2\n      offset := len(base32cid) - nextToLastLen - 1\n      return str[offset : offset+nextToLastLen]\n    }\nFor example, an object with a base58 CIDv1 of\n    zb2rhYSxw4ZjuzgCnWSt19Q94ERaeFhu9uSqRgjSdx9bsgM6f\nhas a base32 CIDv1 of\n    BAFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA\nand will be placed at\n    SC/AFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA.data\nwith 'SC' being the last-to-next two characters and the 'B' at the\nbeginning of the CIDv1 string is the multibase prefix that is not\nstored in the filename.\n"},"7ae0":function(e,t,r){"use strict";const s=r("c449"),n=r("b6aa");t.cleanCid=e=>{if(s.isCID(e))return e;try{return new s(e)}catch(t){throw n(t,"ERR_INVALID_CID")}}},"7af3":function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["libp2p-record"]||(s.roots["libp2p-record"]={});a.Record=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key=o.newBuffer([]),e.prototype.value=o.newBuffer([]),e.prototype.timeReceived="",e.encode=function(e,t){return t||(t=i.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).bytes(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).bytes(e.value),null!=e.timeReceived&&Object.hasOwnProperty.call(e,"timeReceived")&&t.uint32(42).string(e.timeReceived),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Record;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.key=e.bytes();break;case 2:s.value=e.bytes();break;case 5:s.timeReceived=e.string();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Record)return e;var t=new a.Record;return null!=e.key&&("string"===typeof e.key?o.base64.decode(e.key,t.key=o.newBuffer(o.base64.length(e.key)),0):e.key.length&&(t.key=e.key)),null!=e.value&&("string"===typeof e.value?o.base64.decode(e.value,t.value=o.newBuffer(o.base64.length(e.value)),0):e.value.length&&(t.value=e.value)),null!=e.timeReceived&&(t.timeReceived=String(e.timeReceived)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.key="":(r.key=[],t.bytes!==Array&&(r.key=o.newBuffer(r.key))),t.bytes===String?r.value="":(r.value=[],t.bytes!==Array&&(r.value=o.newBuffer(r.value))),r.timeReceived=""),null!=e.key&&e.hasOwnProperty("key")&&(r.key=t.bytes===String?o.base64.encode(e.key,0,e.key.length):t.bytes===Array?Array.prototype.slice.call(e.key):e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=t.bytes===String?o.base64.encode(e.value,0,e.value.length):t.bytes===Array?Array.prototype.slice.call(e.value):e.value),null!=e.timeReceived&&e.hasOwnProperty("timeReceived")&&(r.timeReceived=e.timeReceived),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.exports=a},"7bf9":function(e,t,r){"use strict";const s=r("36be"),n=r("4fcb"),i=r("b6aa"),o=r("fa3a6"),a=r("b7cd").version;function c({options:e,config:t,datastore:c,keys:u,keychainConfig:l,peerId:d,multiaddrs:h}){const p=()=>{const e=s(t,"Pubsub.Router")||"gossipsub";if(!o[e])throw i(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${e} router.`),"ERR_NOT_SUPPORTED");return o[e]},f={datastore:c,peerId:d,modules:{}},y={modules:{pubsub:p()},config:{peerDiscovery:{mdns:{enabled:s(e,"config.Discovery.MDNS.Enabled",s(t,"Discovery.MDNS.Enabled",!0))},webRTCStar:{enabled:s(e,"config.Discovery.webRTCStar.Enabled",s(t,"Discovery.webRTCStar.Enabled",!0))},bootstrap:{list:s(e,"config.Bootstrap",s(t,"Bootstrap",[]))}},relay:{enabled:s(e,"relay.enabled",s(t,"relay.enabled",!0)),hop:{enabled:s(e,"relay.hop.enabled",s(t,"relay.hop.enabled",!1)),active:s(e,"relay.hop.active",s(t,"relay.hop.active",!1))}},dht:{enabled:"none"!==s(t,"Routing.Type","none"),clientMode:"dhtserver"!==s(t,"Routing.Type","dht"),kBucketSize:s(e,"dht.kBucketSize",20)},pubsub:{enabled:s(e,"config.Pubsub.Enabled",s(t,"Pubsub.Enabled",!0))},nat:{enabled:!s(t,"Swarm.DisableNatPortMap",!1)}},addresses:{listen:h.map(e=>e.toString()),announce:s(e,"addresses.announce",s(t,"Addresses.Announce",[])),noAnnounce:s(e,"addresses.noAnnounce",s(t,"Addresses.NoAnnounce",[]))},connectionManager:s(e,"connectionManager",{maxConnections:s(e,"config.Swarm.ConnMgr.HighWater",s(t,"Swarm.ConnMgr.HighWater")),minConnections:s(e,"config.Swarm.ConnMgr.LowWater",s(t,"Swarm.ConnMgr.LowWater"))}),keychain:{datastore:u,...l},host:{agentVersion:"js-ipfs/"+a}},g=r("28fe");let b=s(e,"libp2p",void 0);"function"===typeof b&&(b=void 0);const m=n(f,g(),y,b),w=s(m,"config.peerDiscovery.bootstrap.list",[]);return w.length>0&&m.modules.peerDiscovery.push(r("e06e")),m}e.exports=({options:e={},peerId:t,multiaddrs:s=[],repo:n,keychainConfig:i={},config:o={}})=>{const{datastore:a,keys:u}=n,l=c({options:e,config:o,datastore:a,keys:u,keychainConfig:i,peerId:t,multiaddrs:s});if("function"===typeof e.libp2p)return e.libp2p({libp2pOptions:l,options:e,config:o,datastore:a,peerId:t});const d=r("3591");return d.create(l)}},"7c84":function(e,t,r){"use strict";const s=r("181b"),n={hasNewInfo(){return!1},merge(){}};class i{constructor(e=n){this._taskMerger=e,this._byPeer=new s([],o.compare)}pushTasks(e,t){let r=this._byPeer.get(e.toB58String());r||(r=new o(e,this._taskMerger)),r.pushTasks(t),this._byPeer.set(e.toB58String(),r)}popTasks(e){const t=this._head();if(void 0===t)return{tasks:[],pendingSize:0};const{tasks:r,pendingSize:s}=t.popTasks(e);if(0===r.length)return{tasks:r,pendingSize:s};const n=t.peerId;return t.isIdle()?this._byPeer.delete(n.toB58String()):this._byPeer.update(0),{peerId:n,tasks:r,pendingSize:s}}_head(){if(0!==this._byPeer.size)for(const[,e]of this._byPeer)return e}remove(e,t){const r=this._byPeer.get(t.toB58String());r&&r.remove(e)}tasksDone(e,t){const r=this._byPeer.get(e.toB58String());if(!r)return;const s=this._byPeer.indexOf(e.toB58String());for(const n of t)r.taskDone(n);this._byPeer.update(s)}}class o{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new a,this._active=new Set}pushTasks(e){for(const t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;const t=this._pending.get(e.topic);if(t)return e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),void this._taskMerger.merge(e,t);this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){const t=[];for(const r of this._active)r.topic===e.topic&&t.push(r);return 0===t.length||this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0;const r=[],s=this._pending.tasks();for(let n=0;n<s.length&&t<e;n++){const e=s[n];r.push(e),t+=e.size,this._pending.delete(e.topic),this._activeTotalSize+=e.size,this._active.add(e)}return{tasks:r,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return 0===this._pending.length&&0===this._active.size}static compare(e,t){return 0===e[1]._pending.length?1:0===t[1]._pending.length?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}}class a{constructor(){this._tasks=new s([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,t)=>e+t.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,t){const r=this._tasks.get(e);if(!r)return;const s=this._tasks.indexOf(e);r.task.priority=t,this._tasks.update(s)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}}e.exports=i},"7ca2":function(e,t,r){"use strict";const s=r("8b37d"),n=r("044b"),i=r("7e11"),o=r("e7aa"),a=Object.prototype.hasOwnProperty,c=["lt","lte","gt","gte"];function u(e){this.status="new",this.supports=s(e,{status:!0})}function l(e,t){const r={};for(const s in t){if(!a.call(t,s))continue;if("start"===s||"end"===s)throw new Error('Legacy range options ("start" and "end") have been removed');let n=t[s];d(s)&&(n=e._serializeKey(n)),r[s]=n}return r}function d(e){return-1!==c.indexOf(e)}u.prototype.open=function(e,t){const r=this.status;if("function"===typeof e&&(t=e),"function"!==typeof t)throw new Error("open() requires a callback argument");"object"===typeof e&&null!==e||(e={}),e.createIfMissing=!1!==e.createIfMissing,e.errorIfExists=!!e.errorIfExists,this.status="opening",this._open(e,e=>{if(e)return this.status=r,t(e);this.status="open",t()})},u.prototype._open=function(e,t){this._nextTick(t)},u.prototype.close=function(e){const t=this.status;if("function"!==typeof e)throw new Error("close() requires a callback argument");this.status="closing",this._close(r=>{if(r)return this.status=t,e(r);this.status="closed",e()})},u.prototype._close=function(e){this._nextTick(e)},u.prototype.get=function(e,t,r){if("function"===typeof t&&(r=t),"function"!==typeof r)throw new Error("get() requires a callback argument");const s=this._checkKey(e);if(s)return this._nextTick(r,s);e=this._serializeKey(e),"object"===typeof t&&null!==t||(t={}),t.asBuffer=!1!==t.asBuffer,this._get(e,t,r)},u.prototype._get=function(e,t,r){this._nextTick((function(){r(new Error("NotFound"))}))},u.prototype.put=function(e,t,r,s){if("function"===typeof r&&(s=r),"function"!==typeof s)throw new Error("put() requires a callback argument");const n=this._checkKey(e)||this._checkValue(t);if(n)return this._nextTick(s,n);e=this._serializeKey(e),t=this._serializeValue(t),"object"===typeof r&&null!==r||(r={}),this._put(e,t,r,s)},u.prototype._put=function(e,t,r,s){this._nextTick(s)},u.prototype.del=function(e,t,r){if("function"===typeof t&&(r=t),"function"!==typeof r)throw new Error("del() requires a callback argument");const s=this._checkKey(e);if(s)return this._nextTick(r,s);e=this._serializeKey(e),"object"===typeof t&&null!==t||(t={}),this._del(e,t,r)},u.prototype._del=function(e,t,r){this._nextTick(r)},u.prototype.batch=function(e,t,r){if(!arguments.length)return this._chainedBatch();if("function"===typeof t&&(r=t),"function"===typeof e&&(r=e),"function"!==typeof r)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(e))return this._nextTick(r,new Error("batch(array) requires an array argument"));if(0===e.length)return this._nextTick(r);"object"===typeof t&&null!==t||(t={});const s=new Array(e.length);for(let n=0;n<e.length;n++){if("object"!==typeof e[n]||null===e[n])return this._nextTick(r,new Error("batch(array) element must be an object and not `null`"));const t=Object.assign({},e[n]);if("put"!==t.type&&"del"!==t.type)return this._nextTick(r,new Error("`type` must be 'put' or 'del'"));const i=this._checkKey(t.key);if(i)return this._nextTick(r,i);if(t.key=this._serializeKey(t.key),"put"===t.type){const e=this._checkValue(t.value);if(e)return this._nextTick(r,e);t.value=this._serializeValue(t.value)}s[n]=t}this._batch(s,t,r)},u.prototype._batch=function(e,t,r){this._nextTick(r)},u.prototype.clear=function(e,t){if("function"===typeof e)t=e;else if("function"!==typeof t)throw new Error("clear() requires a callback argument");e=l(this,e),e.reverse=!!e.reverse,e.limit="limit"in e?e.limit:-1,this._clear(e,t)},u.prototype._clear=function(e,t){e.keys=!0,e.values=!1,e.keyAsBuffer=!0,e.valueAsBuffer=!0;const r=this._iterator(e),s={},n=e=>{if(e)return r.end((function(){t(e)}));r.next((e,i)=>e?n(e):void 0===i?r.end(t):void this._del(i,s,n))};n()},u.prototype._setupIteratorOptions=function(e){return e=l(this,e),e.reverse=!!e.reverse,e.keys=!1!==e.keys,e.values=!1!==e.values,e.limit="limit"in e?e.limit:-1,e.keyAsBuffer=!1!==e.keyAsBuffer,e.valueAsBuffer=!1!==e.valueAsBuffer,e},u.prototype.iterator=function(e){return"object"===typeof e&&null!==e||(e={}),e=this._setupIteratorOptions(e),this._iterator(e)},u.prototype._iterator=function(e){return new i(this)},u.prototype._chainedBatch=function(){return new o(this)},u.prototype._serializeKey=function(e){return e},u.prototype._serializeValue=function(e){return e},u.prototype._checkKey=function(e){return null===e||void 0===e?new Error("key cannot be `null` or `undefined`"):n(e)&&0===e.length?new Error("key cannot be an empty Buffer"):""===e?new Error("key cannot be an empty String"):Array.isArray(e)&&0===e.length?new Error("key cannot be an empty Array"):void 0},u.prototype._checkValue=function(e){if(null===e||void 0===e)return new Error("value cannot be `null` or `undefined`")},u.prototype._nextTick=r("7e01"),e.exports=u},"7cb6":function(e,t,r){"use strict";const s=r("b6aa"),n=r("f3bf"),i=r("d46b"),o=r("034e"),a=r("eddf"),c=r("e760"),u=r("5aab"),{codes:l}=r("b73a"),{Envelope:d}=r("07fc");class h{constructor({peerId:e,payloadType:t,payload:r,signature:s}){this.peerId=e,this.payloadType=t,this.payload=r,this.signature=s,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;const e=o.marshalPublicKey(this.peerId.pubKey);return this._marshal=d.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return u(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&u(this.payloadType,e.payloadType)&&u(this.payload,e.payload)&&u(this.signature,e.signature)}validate(e){const t=p(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(t,this.signature)}}const p=(e,t,r)=>{const s=i(e),o=c.encode(s.byteLength),a=c.encode(t.length),u=c.encode(r.length);return n([new Uint8Array(o),s,new Uint8Array(a),t,new Uint8Array(u),r])};h.createFromProtobuf=async e=>{const t=d.decode(e),r=await a.createFromPubKey(t.publicKey);return new h({peerId:r,payloadType:t.payloadType,payload:t.payload,signature:t.signature})},h.seal=async(e,t)=>{const r=e.domain,s=e.codec,n=e.marshal(),i=p(r,s,n),o=await t.privKey.sign(i);return new h({peerId:t,payloadType:s,payload:n,signature:o})},h.openAndCertify=async(e,t)=>{const r=await h.createFromProtobuf(e),n=await r.validate(t);if(!n)throw s(new Error("envelope signature is not valid for the given domain"),l.ERR_SIGNATURE_NOT_VALID);return r},e.exports=h},"7cc5":function(e,t,r){"use strict";const{Bucket:s,createHAMT:n}=r("d81a"),i=r("0e80"),o=async function(e){const t=await i(e,"murmur3-128"),r=t.slice(2,10),s=r.length,n=new Uint8Array(s);for(let i=0;i<s;i++)n[s-i-1]=r[i];return n},a=(e,t,r)=>Promise.all(e.map(e=>{if(2===e.Name.length){const n=parseInt(e.Name,16);return t._putObjectAt(n,new s({hash:r._options.hash,bits:r._options.bits},t,n))}return r.put(e.Name.substring(2),!0)})),c=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),u=e=>{let t=e.bucket;const r=[];while(t._parent)r.push(t),t=t._parent;return r.push(t),r.reverse()},l=async(e,t,r,s,i)=>{if(!s){const e=n({hashFn:o});s={rootBucket:e,hamtDepth:1,lastBucket:e}}await a(e.Links,s.lastBucket,s.rootBucket);const d=await s.rootBucket._findNewBucketAndPos(t);let h=c(d.pos);const p=u(d);p.length>s.hamtDepth&&(s.lastBucket=p[s.hamtDepth],h=c(s.lastBucket._posAtParent));const f=e.Links.find(e=>{const r=e.Name.substring(0,2),s=e.Name.substring(2);return r===h&&(!s||s===t)});return f?f.Name.substring(2)===t?f.Hash:(s.hamtDepth++,e=await r.get(f.Hash,i),l(e,t,r,s,i)):null};e.exports=l},"7cf7":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("1755"),n=r("b92d"),i=r("ac23");function o(e,t,r,i){return new s.Token(s.Type.negint,-1-n.readUint8(e,t+1,i),2)}function a(e,t,r,i){return new s.Token(s.Type.negint,-1-n.readUint16(e,t+1,i),3)}function c(e,t,r,i){return new s.Token(s.Type.negint,-1-n.readUint32(e,t+1,i),5)}const u=BigInt(-1),l=BigInt(1);function d(e,t,r,o){const a=n.readUint64(e,t+1,o);if("bigint"!==typeof a){const e=-1-a;if(e>=Number.MIN_SAFE_INTEGER)return new s.Token(s.Type.negint,e,9)}if(!0!==o.allowBigInt)throw new Error(i.decodeErrPrefix+" integers outside of the safe integer range are not supported");return new s.Token(s.Type.negint,u-BigInt(a),9)}function h(e,t){const r=t.value,s="bigint"===typeof r?r*u-l:-1*r-1;n.encodeUintValue(e,t.type.majorEncoded,s)}h.encodedSize=function(e){const t=e.value,r="bigint"===typeof t?t*u-l:-1*t-1;return r<n.uintBoundaries[0]?1:r<n.uintBoundaries[1]?2:r<n.uintBoundaries[2]?3:r<n.uintBoundaries[3]?5:9},h.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},t.decodeNegint16=a,t.decodeNegint32=c,t.decodeNegint64=d,t.decodeNegint8=o,t.encodeNegint=h},"7db2":function(e,t,r){"use strict";const s=r("675c"),{Key:n}=r("1304"),i=r("0e80").multihash,o=new n("/local/pins"),a=256,c=8192,u=i.fromB58String("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),l={direct:"direct",recursive:"recursive"};function d(e){return new n("/"+s.encoding("base32upper").encode(e.multihash))}e.exports={PIN_DS_KEY:o,DEFAULT_FANOUT:a,MAX_ITEMS:c,EMPTY_KEY:u,PinTypes:l,cidToKey:d}},"7dcc":function(e,t,r){"use strict";const s=(e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);e.exports=s},"7de6":function(e,t,r){"use strict";const s=r("9975");e.exports=({addAll:e})=>{async function t(t,r={}){const n=await s(e(t,r));if(null==n)throw Error("Failed to add a file, if you see this please report a bug");return n}return t}},"7df1":function(e,t,r){"use strict";e.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[6e4,3e5,9e5],maxOldPeersRetention:50}}},"7e01":function(e,t,r){"use strict";const s=r("8712");e.exports=function(e,...t){0===t.length?s(e):s(()=>e(...t))}},"7e08":function(e,t,r){"use strict";e.exports=function(e,t,r,s,n){if(0===s.limit)return e._nextTick(n);const i=e.db.transaction([t],"readwrite"),o=i.objectStore(t);let a=0;i.oncomplete=function(){n()},i.onabort=function(){n(i.error||new Error("aborted by user"))};const c=o.openKeyCursor?"openKeyCursor":"openCursor",u=s.reverse?"prev":"next";o[c](r,u).onsuccess=function(e){const t=e.target.result;t&&(o.delete(t.key).onsuccess=function(){(s.limit<=0||++a<s.limit)&&t.continue()})}}},"7e11":function(e,t,r){"use strict";function s(e){if("object"!==typeof e||null===e)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=e,this._ended=!1,this._nexting=!1}s.prototype.next=function(e){if("function"!==typeof e)throw new Error("next() requires a callback argument");return this._ended?(this._nextTick(e,new Error("cannot call next() after end()")),this):this._nexting?(this._nextTick(e,new Error("cannot call next() before previous next() has completed")),this):(this._nexting=!0,this._next((t,...r)=>{this._nexting=!1,e(t,...r)}),this)},s.prototype._next=function(e){this._nextTick(e)},s.prototype.seek=function(e){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");e=this.db._serializeKey(e),this._seek(e)},s.prototype._seek=function(e){},s.prototype.end=function(e){if("function"!==typeof e)throw new Error("end() requires a callback argument");if(this._ended)return this._nextTick(e,new Error("end() already called on iterator"));this._ended=!0,this._end(e)},s.prototype._end=function(e){this._nextTick(e)},s.prototype._nextTick=r("7e01"),e.exports=s},"7e2f":function(e,t,r){"use strict";e.exports=({network:e})=>()=>{const t=e.try();return null!=t&&Boolean(t.libp2p.isStarted())}},"7e6e":function(e,t,r){"use strict";const{Adapter:s,Key:n,Errors:i,utils:{sortAll:o,replaceStartWith:a}}=r("1304"),c=r("335d"),u=r("3a1e"),l=r("16e2"),d=r("6f2b");class h extends s{constructor(e){super(),this.mounts=e.slice()}async open(){await Promise.all(this.mounts.map(e=>e.datastore.open()))}_lookup(e){for(const t of this.mounts)if(t.prefix.toString()===e.toString()||t.prefix.isAncestorOf(e)){const r=a(e.toString(),t.prefix.toString());return{datastore:t.datastore,mountpoint:t.prefix,rest:new n(r)}}}put(e,t,r){const s=this._lookup(e);if(null==s)throw i.dbWriteFailedError(new Error("No datastore mounted for this key"));return s.datastore.put(s.rest,t,r)}get(e,t){const r=this._lookup(e);if(null==r)throw i.notFoundError(new Error("No datastore mounted for this key"));return r.datastore.get(r.rest,t)}has(e,t){const r=this._lookup(e);return null==r?Promise.resolve(!1):r.datastore.has(r.rest,t)}delete(e,t){const r=this._lookup(e);if(null==r)throw i.dbDeleteFailedError(new Error("No datastore mounted for this key"));return r.datastore.delete(r.rest,t)}async close(){await Promise.all(this.mounts.map(e=>e.datastore.close()))}batch(){const e={},t=t=>{const r=this._lookup(t);if(null==r)throw new Error("No datastore mounted for this key");const s=r.mountpoint.toString();return null==e[s]&&(e[s]=r.datastore.batch()),{batch:e[s],rest:r.rest}};return{put:(e,r)=>{const s=t(e);s.batch.put(s.rest,r)},delete:e=>{const r=t(e);r.batch.delete(r.rest)},commit:async t=>{await Promise.all(Object.keys(e).map(r=>e[r].commit(t)))}}}query(e,t){const r=this.mounts.map(r=>{const s=new d(r.datastore,{convert:e=>{throw new Error("should never be called")},invert:e=>r.prefix.child(e)});let n;return null!=e.prefix&&(n=a(e.prefix,r.prefix.toString())),s.query({prefix:n,filters:e.filters},t)});let s=l(...r);if(e.filters&&e.filters.forEach(e=>{s=c(s,e)}),e.orders&&e.orders.forEach(e=>{s=o(s,e)}),null!=e.offset){let t=0;s=c(s,()=>t++>=e.offset)}return null!=e.limit&&(s=u(s,e.limit)),s}queryKeys(e,t){const r=this.mounts.map(r=>{const s=new d(r.datastore,{convert:e=>{throw new Error("should never be called")},invert:e=>r.prefix.child(e)});let n;return null!=e.prefix&&(n=a(e.prefix,r.prefix.toString())),s.queryKeys({prefix:n,filters:e.filters},t)});let s=l(...r);if(e.filters&&e.filters.forEach(e=>{s=c(s,e)}),e.orders&&e.orders.forEach(e=>{s=o(s,e)}),null!=e.offset){let t=0;s=c(s,()=>t++>=e.offset)}return null!=e.limit&&(s=u(s,e.limit)),s}}e.exports=h},"7eb4":function(e,t,r){"use strict";const s=r("aef6"),n=r("c449"),i=r("4fcb"),o=r("3ed3"),a=r("8141"),c=r("4e03"),u=r("5d98"),l=r("401e"),{extendIterator:d}=r("3b8e");class h{constructor(e){const t=i(h.defaultOptions,e);if(!t.blockService)throw new Error("Missing blockservice");this.bs=t.blockService,this.resolvers={},"function"!==typeof t.loadFormat?this.loadFormat=e=>{const t=u.getNameFromCode(e);throw new Error(`No resolver found for codec "${t}"`)}:this.loadFormat=t.loadFormat;for(const r of t.formats)this.addFormat(r)}addFormat(e){const t=e.codec;if(this.resolvers[e.codec]){const e=u.getNameFromCode(t);throw new Error(`Resolver already exists for codec "${e}"`)}return this.resolvers[t]=e,this}removeFormat(e){return this.resolvers[e]&&delete this.resolvers[e],this}resolve(e,t,r){if(!n.isCID(e))throw new Error("`cid` argument must be a CID");if("string"!==typeof t)throw new Error("`path` argument must be a string");const s=this,i=async function*(){while(1){const o=await s.getFormat(u.getCodeFromName(e.codec)),a=await s.bs.get(e,r),c=o.resolver.resolve(a.data,t);t=c.remainderPath;let l=c.value;if(1===Object.keys(l).length&&"/"in l)try{l=new n(l["/"])}catch(i){l=null}if(yield{remainderPath:t,value:l},!n.isCID(l))return;e=l}};return d(i())}async get(e,t){const r=await this.bs.get(e,t),s=await this.getFormat(r.cid.codec),n=s.util.deserialize(r.data);return n}getMany(e,t){if(!l.isIterable(e)||"string"===typeof e||e instanceof Uint8Array)throw new Error("`cids` must be an iterable of CIDs");const r=this,s=async function*(){for await(const s of e)yield r.get(s,t)};return d(s())}async put(e,t,r){if(void 0===t)throw new Error("`put` requires a format");if("number"!==typeof t)throw new Error("`format` parameter must be number (multicodec)");const n=await this.getFormat(t),o={hashAlg:n.defaultHashAlg,cidVersion:1,onlyHash:!1},a=i(o,r),c={cidVersion:a.cidVersion,hashAlg:a.hashAlg,onlyHash:a.onlyHash},u=n.util.serialize(e),l=await n.util.cid(u,c);if(!a.onlyHash){const e=new s(u,l);await this.bs.put(e,a)}return l}putMany(e,t,r){if(!l.isIterable(e)||"string"===typeof e||e instanceof Uint8Array)throw new Error("`nodes` must be an iterable");if(void 0===t)throw new Error("`put` requires a format");if("number"!==typeof t)throw new Error("`format` parameter must be number (multicodec)");let s,n;const o=this,a=async function*(){for await(const a of e){if(void 0===s){n=await o.getFormat(t);const e={hashAlg:n.defaultHashAlg,cidVersion:1,onlyHash:!1};s=i(e,r)}yield o.put(a,t,s)}};return d(a())}async remove(e,t){return this.bs.delete(e,t)}removeMany(e,t){if(!l.isIterable(e)||"string"===typeof e||e instanceof Uint8Array)throw new Error("`cids` must be an iterable of CIDs");const r=this,s=async function*(){for await(const s of e)yield r.remove(s,t)};return d(s())}tree(e,t,r){"object"===typeof t&&(r=t,t=void 0),t=t||"";const s={recursive:!1},o=i(s,r),a=async(e,t)=>{const r=await this.getFormat(u.getCodeFromName(e.cid.codec)),s=r.resolver.resolve(e.data,t);if(n.isCID(s.value))return s.value},c=this,l=async function*(){const r=[];let s;const n=[{cid:e,basePath:""}];let i;while(r.length>0||n.length>0){if(0===r.length&&n.length>0){const t=n.shift();if(t){({cid:e,basePath:i}=t);const n=await c.getFormat(u.getCodeFromName(e.codec));s=await c.bs.get(e,o);const a=n.resolver.tree(s.data);r.push(...a)}}const l=r.shift()||"";let d=i+l;if(o.recursive){const e=await a(s,l);null!=e&&n.push({cid:e,basePath:d+"/"})}void 0!==t&&d.startsWith(t)&&d.length>t.length&&(t.length>0&&(d=d.slice(t.length+1)),yield d)}};return d(l())}async getFormat(e){if("string"===typeof e&&(e=u.getCodeFromName(e)),this.resolvers[e])return this.resolvers[e];const t=await this.loadFormat(e);return null!=this.resolvers[e]?this.resolvers[e]:(this.addFormat(t),t)}}h.defaultOptions={formats:[o,a,c]},e.exports=h},"7ee4":function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r("2103"),t),n(r("793f"),t),n(r("4c63"),t)},"7f5a":function(e,t,r){"use strict";const{DAGNode:s}=r("8141"),n=r("a29d");e.exports=({ipld:e,gcLock:t,preload:i})=>{const o=r("69d3")({ipld:e,preload:i}),a=r("5ec0")({ipld:e,gcLock:t,preload:i});async function c(e,t,r={}){const n=await o(e,r);return a(new s(t,n.Links),r)}return n(c)}},"7f97":function(e,t,r){var s=r("d327");r("0069"),r("8272"),r("2cf7"),r("f76f"),r("b1ab"),r("f6a4"),r("4a73"),r("b1d4"),r("51e8");var n=s.asn1,i=e.exports=s.pkcs7=s.pkcs7||{};function o(e){var t={},r=[];if(!n.validate(e,i.asn1.recipientInfoValidator,t,r)){var o=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw o.errors=r,o}return{version:t.version.charCodeAt(0),issuer:s.pki.RDNAttributesAsArray(t.issuer),serialNumber:s.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:n.derToOid(t.encAlgorithm),parameter:t.encParameter.value,content:t.encKey}}}function a(e){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[s.pki.distinguishedNameToAsn1({attributes:e.issuer}),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,s.util.hexToBytes(e.serialNumber))]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.encryptedContent.algorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.encryptedContent.content)])}function c(e){for(var t=[],r=0;r<e.length;++r)t.push(o(e[r]));return t}function u(e){for(var t=[],r=0;r<e.length;++r)t.push(a(e[r]));return t}function l(e){var t=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[s.pki.distinguishedNameToAsn1({attributes:e.issuer}),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,s.util.hexToBytes(e.serialNumber))]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.digestAlgorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.signatureAlgorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])),t.value.push(n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=n.create(n.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<e.unauthenticatedAttributes.length;++i){var o=e.unauthenticatedAttributes[i];r.values.push(h(o))}t.value.push(r)}return t}function d(e){for(var t=[],r=0;r<e.length;++r)t.push(l(e[r]));return t}function h(e){var t;if(e.type===s.pki.oids.contentType)t=n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.value).getBytes());else if(e.type===s.pki.oids.messageDigest)t=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===s.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),o=e.value;if("string"===typeof o){var a=Date.parse(o);o=isNaN(a)?13===o.length?n.utcTimeToDate(o):n.generalizedTimeToDate(o):new Date(a)}t=o>=r&&o<i?n.create(n.Class.UNIVERSAL,n.Type.UTCTIME,!1,n.dateToUtcTime(o)):n.create(n.Class.UNIVERSAL,n.Type.GENERALIZEDTIME,!1,n.dateToGeneralizedTime(o))}return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.type).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[t])])}function p(e){return[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.pki.oids.data).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.algorithm).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.parameter.getBytes())]),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,e.content.getBytes())])]}function f(e,t,r){var i={},o=[];if(!n.validate(t,r,i,o)){var a=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw a.errors=a,a}var c=n.derToOid(i.contentType);if(c!==s.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var u="";if(s.util.isArray(i.encryptedContent))for(var l=0;l<i.encryptedContent.length;++l){if(i.encryptedContent[l].type!==n.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");u+=i.encryptedContent[l].value}else u=i.encryptedContent;e.encryptedContent={algorithm:n.derToOid(i.encAlgorithm),parameter:s.util.createBuffer(i.encParameter.value),content:s.util.createBuffer(u)}}if(i.content){u="";if(s.util.isArray(i.content))for(l=0;l<i.content.length;++l){if(i.content[l].type!==n.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");u+=i.content[l].value}else u=i.content;e.content=s.util.createBuffer(u)}return e.version=i.version.charCodeAt(0),e.rawCapture=i,i}function y(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case s.pki.oids["aes128-CBC"]:case s.pki.oids["aes192-CBC"]:case s.pki.oids["aes256-CBC"]:t=s.aes.createDecryptionCipher(e.encryptedContent.key);break;case s.pki.oids["desCBC"]:case s.pki.oids["des-EDE3-CBC"]:t=s.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}i.messageFromPem=function(e){var t=s.pem.decode(e)[0];if("PKCS7"!==t.type){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var o=n.fromDer(t.body);return i.messageFromAsn1(o)},i.messageToPem=function(e,t){var r={type:"PKCS7",body:n.toDer(e.toAsn1()).getBytes()};return s.pem.encode(r,{maxline:t})},i.messageFromAsn1=function(e){var t={},r=[];if(!n.validate(e,i.asn1.contentInfoValidator,t,r)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw o.errors=r,o}var a,c=n.derToOid(t.contentType);switch(c){case s.pki.oids.envelopedData:a=i.createEnvelopedData();break;case s.pki.oids.encryptedData:a=i.createEncryptedData();break;case s.pki.oids.signedData:a=i.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return a.fromAsn1(t.content.value[0]),a},i.createSignedData=function(){var e=null;return e={type:s.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(f(e,t,i.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var r=e.rawCapture.certificates.value,n=0;n<r.length;++n)e.certificates.push(s.pki.certificateFromAsn1(r[n]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],r=0;r<e.certificates.length;++r)t.push(s.pki.certificateToAsn1(e.certificates[r]));var i=[],o=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&o.value[0].value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,t)),i.length>0&&o.value[0].value.push(n.create(n.Class.CONTEXT_SPECIFIC,1,!0,i)),o.value[0].value.push(n.create(n.Class.UNIVERSAL,n.Type.SET,!0,e.signerInfos)),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.type).getBytes()),o])},addSigner:function(t){var r=t.issuer,n=t.serialNumber;if(t.certificate){var i=t.certificate;"string"===typeof i&&(i=s.pki.certificateFromPem(i)),r=i.issuer.attributes,n=i.serialNumber}var o=t.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"===typeof o&&(o=s.pki.privateKeyFromPem(o));var a=t.digestAlgorithm||s.pki.oids.sha1;switch(a){case s.pki.oids.sha1:case s.pki.oids.sha256:case s.pki.oids.sha384:case s.pki.oids.sha512:case s.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+a)}var c=t.authenticatedAttributes||[];if(c.length>0){for(var u=!1,l=!1,d=0;d<c.length;++d){var h=c[d];if(u||h.type!==s.pki.oids.contentType){if(l||h.type!==s.pki.oids.messageDigest);else if(l=!0,u)break}else if(u=!0,l)break}if(!u||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:o,version:1,issuer:r,serialNumber:n,digestAlgorithm:a,signatureAlgorithm:s.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(i){var o;(i=i||{},"object"!==typeof e.content||null===e.contentInfo)&&(e.contentInfo=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(s.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof s.util.ByteBuffer?o=e.content.bytes():"string"===typeof e.content&&(o=s.util.encodeUtf8(e.content)),i.detached?e.detachedContent=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,o):e.contentInfo.value.push(n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,o)]))));if(0!==e.signers.length){var a=t();r(a)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"===typeof t&&(t=s.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}},e;function t(){for(var t={},r=0;r<e.signers.length;++r){var i=e.signers[r],o=i.digestAlgorithm;o in t||(t[o]=s.md[s.pki.oids[o]].create()),0===i.authenticatedAttributes.length?i.md=t[o]:i.md=s.md[s.pki.oids[o]].create()}for(var o in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(o).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]));return t}function r(t){var r;if(e.detachedContent?r=e.detachedContent:(r=e.contentInfo.value[1],r=r.value[0]),!r)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var i=n.derToOid(e.contentInfo.value[0].value),o=n.toDer(r);for(var a in o.getByte(),n.getBerValueLength(o),o=o.getBytes(),t)t[a].start().update(o);for(var c=new Date,u=0;u<e.signers.length;++u){var l=e.signers[u];if(0===l.authenticatedAttributes.length){if(i!==s.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var p=n.create(n.Class.UNIVERSAL,n.Type.SET,!0,[]),f=0;f<l.authenticatedAttributes.length;++f){var y=l.authenticatedAttributes[f];y.type===s.pki.oids.messageDigest?y.value=t[l.digestAlgorithm].digest():y.type===s.pki.oids.signingTime&&(y.value||(y.value=c)),p.value.push(h(y)),l.authenticatedAttributesAsn1.value.push(h(y))}o=n.toDer(p).getBytes(),l.md.start().update(o)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=d(e.signers)}},i.createEncryptedData=function(){var e=null;return e={type:s.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:s.pki.oids["aes256-CBC"]},fromAsn1:function(t){f(e,t,i.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),y(e)}},e},i.createEnvelopedData=function(){var e=null;return e={type:s.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:s.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=f(e,t,i.asn1.envelopedDataValidator);e.recipients=c(r.recipientInfos.value)},toAsn1:function(){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(e.type).getBytes()),n.create(n.Class.CONTEXT_SPECIFIC,0,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(e.version).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SET,!0,u(e.recipients)),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,p(e.encryptedContent))])])])},findRecipient:function(t){for(var r=t.issuer.attributes,s=0;s<e.recipients.length;++s){var n=e.recipients[s],i=n.issuer;if(n.serialNumber===t.serialNumber&&i.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(i[a].type!==r[a].type||i[a].value!==r[a].value){o=!1;break}if(o)return n}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case s.pki.oids.rsaEncryption:case s.pki.oids.desCBC:var n=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=s.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}y(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:s.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var n,i,o;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case s.pki.oids["aes128-CBC"]:n=16,i=16,o=s.aes.createEncryptionCipher;break;case s.pki.oids["aes192-CBC"]:n=24,i=16,o=s.aes.createEncryptionCipher;break;case s.pki.oids["aes256-CBC"]:n=32,i=16,o=s.aes.createEncryptionCipher;break;case s.pki.oids["des-EDE3-CBC"]:n=24,i=8,o=s.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(void 0===t)t=s.util.createBuffer(s.random.getBytes(n));else if(t.length()!=n)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+n+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=s.util.createBuffer(s.random.getBytes(i));var a=o(t);if(a.start(e.encryptedContent.parameter.copy()),a.update(e.content),!a.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=a.output}for(var c=0;c<e.recipients.length;++c){var u=e.recipients[c];if(void 0===u.encryptedContent.content)switch(u.encryptedContent.algorithm){case s.pki.oids.rsaEncryption:u.encryptedContent.content=u.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm)}}}},e}},"7fbe":function(e,t,r){"use strict";const s=r("b6aa"),n=r("d46b");async function*i(e){for await(const t of e){if(void 0===t.length)throw s(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if("string"===typeof t||t instanceof String)yield n(t.toString());else if(Array.isArray(t))yield Uint8Array.from(t);else{if(!(t instanceof Uint8Array))throw s(new Error("Content was invalid"),"ERR_INVALID_CONTENT");yield t}}}e.exports=i},8141:function(e,t,r){"use strict";const s=r("2cdb"),n=r("85b8"),i=r("0fc0"),o=r("0eff"),a={DAGNode:i,DAGLink:o,resolver:s,util:n,codec:n.codec,defaultHashAlg:n.defaultHashAlg};e.exports=a},8156:function(e,t,r){"use strict";const s=r("c449"),n=r("b6aa"),i=r("a29d");e.exports=({network:e})=>{async function t(t,r={}){const{bitswap:i}=await e.use(r);Array.isArray(t)||(t=[t]);try{t=t.map(e=>new s(e))}catch(o){throw n(o,"ERR_INVALID_CID")}return i.unwant(t)}return i(t)}},"818c":function(e,t){e.exports=function(e,t,r){"use asm";var s=new e.Uint8Array(r);var n=t.pushInt;var i=t.pushInt32;var o=t.pushInt32Neg;var a=t.pushInt64;var c=t.pushInt64Neg;var u=t.pushFloat;var l=t.pushFloatSingle;var d=t.pushFloatDouble;var h=t.pushTrue;var p=t.pushFalse;var f=t.pushUndefined;var y=t.pushNull;var g=t.pushInfinity;var b=t.pushInfinityNeg;var m=t.pushNaN;var w=t.pushNaNNeg;var _=t.pushArrayStart;var E=t.pushArrayStartFixed;var v=t.pushArrayStartFixed32;var S=t.pushArrayStartFixed64;var I=t.pushObjectStart;var A=t.pushObjectStartFixed;var R=t.pushObjectStartFixed32;var T=t.pushObjectStartFixed64;var k=t.pushByteString;var P=t.pushByteStringStart;var O=t.pushUtf8String;var N=t.pushUtf8StringStart;var D=t.pushSimpleUnassigned;var C=t.pushTagStart;var x=t.pushTagStart4;var L=t.pushTagStart8;var M=t.pushTagUnassigned;var B=t.pushBreak;var U=e.Math.pow;var j=0;var F=0;var V=0;function z(e){e=e|0;j=0;F=e;while((j|0)<(F|0)){V=Qe[s[j]&255](s[j]|0)|0;if((V|0)>0){break}}return V|0}function K(e){e=e|0;if(((j|0)+(e|0)|0)<(F|0)){return 0}return 1}function q(e){e=e|0;return s[e|0]<<8|s[e+1|0]|0}function G(e){e=e|0;return s[e|0]<<24|s[e+1|0]<<16|s[e+2|0]<<8|s[e+3|0]|0}function H(e){e=e|0;n(e|0);j=j+1|0;return 0}function $(e){e=e|0;if(K(1)|0){return 1}n(s[j+1|0]|0);j=j+2|0;return 0}function W(e){e=e|0;if(K(2)|0){return 1}n(q(j+1|0)|0);j=j+3|0;return 0}function Y(e){e=e|0;if(K(4)|0){return 1}i(q(j+1|0)|0,q(j+3|0)|0);j=j+5|0;return 0}function Q(e){e=e|0;if(K(8)|0){return 1}a(q(j+1|0)|0,q(j+3|0)|0,q(j+5|0)|0,q(j+7|0)|0);j=j+9|0;return 0}function X(e){e=e|0;n(-1-(e-32|0)|0);j=j+1|0;return 0}function J(e){e=e|0;if(K(1)|0){return 1}n(-1-(s[j+1|0]|0)|0);j=j+2|0;return 0}function Z(e){e=e|0;var t=0;if(K(2)|0){return 1}t=q(j+1|0)|0;n(-1-(t|0)|0);j=j+3|0;return 0}function ee(e){e=e|0;if(K(4)|0){return 1}o(q(j+1|0)|0,q(j+3|0)|0);j=j+5|0;return 0}function te(e){e=e|0;if(K(8)|0){return 1}c(q(j+1|0)|0,q(j+3|0)|0,q(j+5|0)|0,q(j+7|0)|0);j=j+9|0;return 0}function re(e){e=e|0;var t=0;var r=0;var s=0;s=e-64|0;if(K(s|0)|0){return 1}t=j+1|0;r=(j+1|0)+(s|0)|0;k(t|0,r|0);j=r|0;return 0}function se(e){e=e|0;var t=0;var r=0;var n=0;if(K(1)|0){return 1}n=s[j+1|0]|0;t=j+2|0;r=(j+2|0)+(n|0)|0;if(K(n+1|0)|0){return 1}k(t|0,r|0);j=r|0;return 0}function ne(e){e=e|0;var t=0;var r=0;var s=0;if(K(2)|0){return 1}s=q(j+1|0)|0;t=j+3|0;r=(j+3|0)+(s|0)|0;if(K(s+2|0)|0){return 1}k(t|0,r|0);j=r|0;return 0}function ie(e){e=e|0;var t=0;var r=0;var s=0;if(K(4)|0){return 1}s=G(j+1|0)|0;t=j+5|0;r=(j+5|0)+(s|0)|0;if(K(s+4|0)|0){return 1}k(t|0,r|0);j=r|0;return 0}function oe(e){e=e|0;return 1}function ae(e){e=e|0;P();j=j+1|0;return 0}function ce(e){e=e|0;var t=0;var r=0;var s=0;s=e-96|0;if(K(s|0)|0){return 1}t=j+1|0;r=(j+1|0)+(s|0)|0;O(t|0,r|0);j=r|0;return 0}function ue(e){e=e|0;var t=0;var r=0;var n=0;if(K(1)|0){return 1}n=s[j+1|0]|0;t=j+2|0;r=(j+2|0)+(n|0)|0;if(K(n+1|0)|0){return 1}O(t|0,r|0);j=r|0;return 0}function le(e){e=e|0;var t=0;var r=0;var s=0;if(K(2)|0){return 1}s=q(j+1|0)|0;t=j+3|0;r=(j+3|0)+(s|0)|0;if(K(s+2|0)|0){return 1}O(t|0,r|0);j=r|0;return 0}function de(e){e=e|0;var t=0;var r=0;var s=0;if(K(4)|0){return 1}s=G(j+1|0)|0;t=j+5|0;r=(j+5|0)+(s|0)|0;if(K(s+4|0)|0){return 1}O(t|0,r|0);j=r|0;return 0}function he(e){e=e|0;return 1}function pe(e){e=e|0;N();j=j+1|0;return 0}function fe(e){e=e|0;E(e-128|0);j=j+1|0;return 0}function ye(e){e=e|0;if(K(1)|0){return 1}E(s[j+1|0]|0);j=j+2|0;return 0}function ge(e){e=e|0;if(K(2)|0){return 1}E(q(j+1|0)|0);j=j+3|0;return 0}function be(e){e=e|0;if(K(4)|0){return 1}v(q(j+1|0)|0,q(j+3|0)|0);j=j+5|0;return 0}function me(e){e=e|0;if(K(8)|0){return 1}S(q(j+1|0)|0,q(j+3|0)|0,q(j+5|0)|0,q(j+7|0)|0);j=j+9|0;return 0}function we(e){e=e|0;_();j=j+1|0;return 0}function _e(e){e=e|0;var t=0;t=e-160|0;if(K(t|0)|0){return 1}A(t|0);j=j+1|0;return 0}function Ee(e){e=e|0;if(K(1)|0){return 1}A(s[j+1|0]|0);j=j+2|0;return 0}function ve(e){e=e|0;if(K(2)|0){return 1}A(q(j+1|0)|0);j=j+3|0;return 0}function Se(e){e=e|0;if(K(4)|0){return 1}R(q(j+1|0)|0,q(j+3|0)|0);j=j+5|0;return 0}function Ie(e){e=e|0;if(K(8)|0){return 1}T(q(j+1|0)|0,q(j+3|0)|0,q(j+5|0)|0,q(j+7|0)|0);j=j+9|0;return 0}function Ae(e){e=e|0;I();j=j+1|0;return 0}function Re(e){e=e|0;C(e-192|0|0);j=j+1|0;return 0}function Te(e){e|0;C(e|0);j=j+1|0;return 0}function ke(e){e|0;C(e|0);j=j+1|0;return 0}function Pe(e){e|0;C(e|0);j=j+1|0;return 0}function Oe(e){e|0;C(e|0);j=j+1|0;return 0}function Ne(e){e=e|0;C(e-192|0|0);j=j+1|0;return 0}function De(e){e|0;C(e|0);j=j+1|0;return 0}function Ce(e){e|0;C(e|0);j=j+1|0;return 0}function xe(e){e|0;C(e|0);j=j+1|0;return 0}function Le(e){e=e|0;if(K(1)|0){return 1}C(s[j+1|0]|0);j=j+2|0;return 0}function Me(e){e=e|0;if(K(2)|0){return 1}C(q(j+1|0)|0);j=j+3|0;return 0}function Be(e){e=e|0;if(K(4)|0){return 1}x(q(j+1|0)|0,q(j+3|0)|0);j=j+5|0;return 0}function Ue(e){e=e|0;if(K(8)|0){return 1}L(q(j+1|0)|0,q(j+3|0)|0,q(j+5|0)|0,q(j+7|0)|0);j=j+9|0;return 0}function je(e){e=e|0;D((e|0)-224|0);j=j+1|0;return 0}function Fe(e){e=e|0;p();j=j+1|0;return 0}function Ve(e){e=e|0;h();j=j+1|0;return 0}function ze(e){e=e|0;y();j=j+1|0;return 0}function Ke(e){e=e|0;f();j=j+1|0;return 0}function qe(e){e=e|0;if(K(1)|0){return 1}D(s[j+1|0]|0);j=j+2|0;return 0}function Ge(e){e=e|0;var t=0;var r=0;var n=1.0;var i=0.0;var o=0.0;var a=0.0;if(K(2)|0){return 1}t=s[j+1|0]|0;r=s[j+2|0]|0;if((t|0)&0x80){n=-1.0}i=+(((t|0)&0x7C)>>2);o=+(((t|0)&0x03)<<8|r);if(+i==0.0){u(+(+n*+5.9604644775390625e-8*+o))}else if(+i==31.0){if(+n==1.0){if(+o>0.0){m()}else{g()}}else{if(+o>0.0){w()}else{b()}}}else{u(+(+n*U(+2,+(+i-25.0))*+(1024.0+o)))}j=j+3|0;return 0}function He(e){e=e|0;if(K(4)|0){return 1}l(s[j+1|0]|0,s[j+2|0]|0,s[j+3|0]|0,s[j+4|0]|0);j=j+5|0;return 0}function $e(e){e=e|0;if(K(8)|0){return 1}d(s[j+1|0]|0,s[j+2|0]|0,s[j+3|0]|0,s[j+4|0]|0,s[j+5|0]|0,s[j+6|0]|0,s[j+7|0]|0,s[j+8|0]|0);j=j+9|0;return 0}function We(e){e=e|0;return 1}function Ye(e){e=e|0;B();j=j+1|0;return 0}var Qe=[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,$,W,Y,Q,We,We,We,We,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,J,Z,ee,te,We,We,We,We,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,se,ne,ie,oe,We,We,We,ae,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ue,le,de,he,We,We,We,pe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,ye,ge,be,me,We,We,We,we,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,Ee,ve,Se,Ie,We,We,We,Ae,Re,Re,Re,Re,Re,Re,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Le,Me,Be,Ue,We,We,We,We,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,Fe,Ve,ze,Ke,qe,Ge,He,$e,We,We,We,Ye];return{parse:z}}},8385:function(e,t,r){"use strict";const s=r("a9f4"),n=r("b6aa");e.exports=e=>{const t=s.logger(e.peerId,"rpc:put-value");async function r(r,i){const o=i.key;t("key: %b",o);const a=i.record;if(!a){const e="Empty record from: "+r.toB58String();throw t.error(e),n(new Error(e),"ERR_EMPTY_RECORD")}await e._verifyRecordLocally(a),a.timeReceived=new Date;const c=s.bufferToKey(a.key);return await e.datastore.put(c,a.serialize()),e.onPut(a,r),i}return r}},"83ec":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("1755"),n=r("ac23"),i=r("b92d"),o=r("a4cc"),a=r("3ef0");function c(e,t,r,i){const o=r+i;return n.assertEnoughData(e,t,o),new s.Token(s.Type.string,a.toString(e,t+r,t+o),o)}function u(e,t,r,s){return c(e,t,1,r)}function l(e,t,r,s){return c(e,t,2,i.readUint8(e,t+1,s))}function d(e,t,r,s){return c(e,t,3,i.readUint16(e,t+1,s))}function h(e,t,r,s){return c(e,t,5,i.readUint32(e,t+1,s))}function p(e,t,r,s){const o=i.readUint64(e,t+1,s);if("bigint"===typeof o)throw new Error(n.decodeErrPrefix+" 64-bit integer string lengths not supported");return c(e,t,9,o)}const f=o.encodeBytes;t.decodeString16=d,t.decodeString32=h,t.decodeString64=p,t.decodeString8=l,t.decodeStringCompact=u,t.encodeString=f},8431:function(e,t,r){"use strict";(function(t){const{Buffer:s}=r("1c35"),n=r("9152"),i=r("901e").BigNumber,o=r("818c"),a=r("5ee5"),c=r("85be"),u=r("5076"),l=r("22b4"),{URL:d}=r("16af");class h{constructor(e){e=e||{},!e.size||e.size<65536?e.size=65536:e.size=a.nextPowerOf2(e.size),this._heap=new ArrayBuffer(e.size),this._heap8=new Uint8Array(this._heap),this._buffer=s.from(this._heap),this._reset(),this._knownTags=Object.assign({0:e=>new Date(e),1:e=>new Date(1e3*e),2:e=>a.arrayBufferToBignumber(e),3:e=>c.NEG_ONE.minus(a.arrayBufferToBignumber(e)),4:e=>c.TEN.pow(e[0]).times(e[1]),5:e=>c.TWO.pow(e[0]).times(e[1]),32:e=>new d(e),35:e=>new RegExp(e)},e.tags),this.parser=o(t,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){const e=this._parents.pop();if(e.length>0)throw new Error(`Missing ${e.length} elements`);switch(e.type){case c.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case c.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case c.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case c.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case c.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case c.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length));break;default:break}this._currentParent&&this._currentParent.type===c.PARENT.TAG&&this._dec()}_dec(){const e=this._currentParent;e.length<0||(e.length--,0===e.length&&this._closeParent())}_push(e,t){const r=this._currentParent;switch(r.values++,r.type){case c.PARENT.ARRAY:case c.PARENT.BYTE_STRING:case c.PARENT.UTF8_STRING:r.length>-1?this._ref[this._ref.length-r.length]=e:this._ref.push(e),this._dec();break;case c.PARENT.OBJECT:null!=r.tmpKey?(this._ref[r.tmpKey]=e,r.tmpKey=null,this._dec()):(r.tmpKey=e,"string"!==typeof r.tmpKey&&(r.type=c.PARENT.MAP,r.ref=a.buildMap(r.ref)));break;case c.PARENT.MAP:null!=r.tmpKey?(this._ref.set(r.tmpKey,e),r.tmpKey=null,this._dec()):r.tmpKey=e;break;case c.PARENT.TAG:this._ref.push(e),t||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(e,t,r){this._parents[this._depth]={type:t,length:r,ref:e,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:c.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(e,t){const r=this._knownTags[e];return r?r(t):new l(e,t)}createMap(e,t){return e}createObject(e,t){return e}createArray(e,t){return e}createByteString(e,t){return s.concat(e)}createByteStringFromHeap(e,t){return e===t?s.alloc(0):s.from(this._heap.slice(e,t))}createInt(e){return e}createInt32(e,t){return a.buildInt32(e,t)}createInt64(e,t,r,s){return a.buildInt64(e,t,r,s)}createFloat(e){return e}createFloatSingle(e,t,r,s){return n.read([e,t,r,s],0,!1,23,4)}createFloatDouble(e,t,r,s,i,o,a,c){return n.read([e,t,r,s,i,o,a,c],0,!1,52,8)}createInt32Neg(e,t){return-1-a.buildInt32(e,t)}createInt64Neg(e,t,r,s){const n=a.buildInt32(e,t),o=a.buildInt32(r,s);return n>c.MAX_SAFE_HIGH?c.NEG_ONE.minus(new i(n).times(c.SHIFT32).plus(o)):-1-(n*c.SHIFT32+o)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(e,t){return e.join("")}createUtf8StringFromHeap(e,t){return e===t?"":this._buffer.toString("utf8",e,t)}createSimpleUnassigned(e){return new u(e)}pushInt(e){this._push(this.createInt(e))}pushInt32(e,t){this._push(this.createInt32(e,t))}pushInt64(e,t,r,s){this._push(this.createInt64(e,t,r,s))}pushFloat(e){this._push(this.createFloat(e))}pushFloatSingle(e,t,r,s){this._push(this.createFloatSingle(e,t,r,s))}pushFloatDouble(e,t,r,s,n,i,o,a){this._push(this.createFloatDouble(e,t,r,s,n,i,o,a))}pushInt32Neg(e,t){this._push(this.createInt32Neg(e,t))}pushInt64Neg(e,t,r,s){this._push(this.createInt64Neg(e,t,r,s))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],c.PARENT.ARRAY,-1)}pushArrayStartFixed(e){this._createArrayStartFixed(e)}pushArrayStartFixed32(e,t){const r=a.buildInt32(e,t);this._createArrayStartFixed(r)}pushArrayStartFixed64(e,t,r,s){const n=a.buildInt64(e,t,r,s);this._createArrayStartFixed(n)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(e){this._createObjectStartFixed(e)}pushObjectStartFixed32(e,t){const r=a.buildInt32(e,t);this._createObjectStartFixed(r)}pushObjectStartFixed64(e,t,r,s){const n=a.buildInt64(e,t,r,s);this._createObjectStartFixed(n)}pushByteStringStart(){this._parents[this._depth]={type:c.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(e,t){this._push(this.createByteStringFromHeap(e,t))}pushUtf8StringStart(){this._parents[this._depth]={type:c.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(e,t){this._push(this.createUtf8StringFromHeap(e,t))}pushSimpleUnassigned(e){this._push(this.createSimpleUnassigned(e))}pushTagStart(e){this._parents[this._depth]={type:c.PARENT.TAG,length:1,ref:[e]}}pushTagStart4(e,t){this.pushTagStart(a.buildInt32(e,t))}pushTagStart8(e,t,r,s){this.pushTagStart(a.buildInt64(e,t,r,s))}pushTagUnassigned(e){this._push(this.createTag(e))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(e){0!==e?this._createParent({},c.PARENT.OBJECT,e):this._push(this.createObject({}))}_createArrayStartFixed(e){0!==e?this._createParent(new Array(e),c.PARENT.ARRAY,e):this._push(this.createArray([]))}_decode(e){if(0===e.byteLength)throw new Error("Input too short");this._reset(),this._heap8.set(e);const t=this.parser.parse(e.byteLength);if(this._depth>1){while(0===this._currentParent.length)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(t>0)throw new Error("Failed to parse");if(0===this._res.length)throw new Error("No valid result")}decodeFirst(e){return this._decode(e),this._res[0]}decodeAll(e){return this._decode(e),this._res}static decode(e,t){"string"===typeof e&&(e=s.from(e,t||"hex"));const r=new h({size:e.length});return r.decodeFirst(e)}static decodeAll(e,t){"string"===typeof e&&(e=s.from(e,t||"hex"));const r=new h({size:e.length});return r.decodeAll(e)}}h.decodeFirst=h.decode,e.exports=h}).call(this,r("c8ba"))},"84a2":function(e,t,r){(function(t){var r="Expected a function",s=NaN,n="[object Symbol]",i=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt,l="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,h=l||d||Function("return this")(),p=Object.prototype,f=p.toString,y=Math.max,g=Math.min,b=function(){return h.Date.now()};function m(e,t,s){var n,i,o,a,c,u,l=0,d=!1,h=!1,p=!0;if("function"!=typeof e)throw new TypeError(r);function f(t){var r=n,s=i;return n=i=void 0,l=t,a=e.apply(s,r),a}function m(e){return l=e,c=setTimeout(v,t),d?f(e):a}function w(e){var r=e-u,s=e-l,n=t-r;return h?g(n,o-s):n}function E(e){var r=e-u,s=e-l;return void 0===u||r>=t||r<0||h&&s>=o}function v(){var e=b();if(E(e))return I(e);c=setTimeout(v,w(e))}function I(e){return c=void 0,p&&n?f(e):(n=i=void 0,a)}function A(){void 0!==c&&clearTimeout(c),l=0,n=u=i=c=void 0}function R(){return void 0===c?a:I(b())}function T(){var e=b(),r=E(e);if(n=arguments,i=this,u=e,r){if(void 0===c)return m(u);if(h)return c=setTimeout(v,t),f(u)}return void 0===c&&(c=setTimeout(v,t)),a}return t=S(t)||0,_(s)&&(d=!!s.leading,h="maxWait"in s,o=h?y(S(s.maxWait)||0,t):o,p="trailing"in s?!!s.trailing:p),T.cancel=A,T.flush=R,T}function w(e,t,s){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError(r);return _(s)&&(n="leading"in s?!!s.leading:n,i="trailing"in s?!!s.trailing:i),m(e,t,{leading:n,maxWait:t,trailing:i})}function _(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function E(e){return!!e&&"object"==typeof e}function v(e){return"symbol"==typeof e||E(e)&&f.call(e)==n}function S(e){if("number"==typeof e)return e;if(v(e))return s;if(_(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=_(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var r=a.test(e);return r||c.test(e)?u(e.slice(2),r?2:8):o.test(e)?s:+e}e.exports=w}).call(this,r("c8ba"))},"84fa":function(e,t,r){"use strict";const s=r("0b90"),n=Symbol("none");e.exports=function(e){const t=s.lowerBound(e,n),r=s.upperBound(e,n),i=s.lowerBoundExclusive(e,n),o=s.upperBoundExclusive(e,n);return t!==n&&r!==n?IDBKeyRange.bound(t,r,i,o):t!==n?IDBKeyRange.lowerBound(t,i):r!==n?IDBKeyRange.upperBound(r,o):null}},"85b8":function(e,t,r){"use strict";const{PBNode:s}=r("892c"),n=r("0eff"),i=r("0fc0"),{serializeDAGNode:o,serializeDAGNodeLike:a}=r("f140"),c=r("94bf"),u=(e,t)=>c.cid(e,t),l=e=>e instanceof i?o(e):a(e.Data,e.Links),d=e=>{const t=s.decode(e),r=s.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),o=r.Links.map(e=>new n(e.Name,e.Tsize,e.Hash)),a=null==r.Data?new Uint8Array(0):r.Data;return new i(a,o,e.byteLength)};e.exports={codec:c.codec,defaultHashAlg:c.defaultHashAlg,serialize:l,deserialize:d,cid:u}},"85be":function(e,t,r){"use strict";const s=r("901e").BigNumber;t.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},t.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36},t.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},t.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},t.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")},t.SHIFT32=Math.pow(2,32),t.SHIFT16=Math.pow(2,16),t.MAX_SAFE_HIGH=2097151,t.NEG_ONE=new s(-1),t.TEN=new s(10),t.TWO=new s(2),t.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5}},8618:function(e,t){e.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}},8623:function(e,t,r){"use strict";e.exports={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}}},"86b2":function(e,t,r){"use strict";const s=r("84a2");function n(e){if(!(this instanceof n))return new n(e);e=e||{};const t=e.validity||30,r=new Map,o=s(()=>{r.forEach((e,s)=>{const n=e.validity||t,o=i(e.timestamp);o>n&&r.delete(s)})},200);this.put=(e,t,s)=>{this.has(e)||r.set(e,{value:t,timestamp:new Date,validity:s}),o()},this.get=e=>{if(r.has(e))return r.get(e).value;throw new Error("key does not exist")},this.has=e=>r.has(e)}function i(e){const t=new Date,r=t.getTime()-e.getTime();return Math.floor(r/1e3)}e.exports=n},"86d2":function(e,t,r){"use strict";const s=r("c61d"),n=r("8a37");class i extends Error{}const o=(e,t)=>new n((r,n,o)=>{const{count:a,filter:c=(()=>!0)}=t;if(!Number.isFinite(a))return void n(new TypeError("Expected a finite number, got "+typeof t.count));const u=[],l=[];let d=0,h=!1;const p=new Set,f=()=>(u.length===a&&(r(u),h=!0),d-l.length<a&&(n(new s(l)),h=!0),h),y=()=>{for(const t of e)p.has(t)||"function"!==typeof t.cancel||t.cancel()};o(y);for(const t of e)d++,(async()=>{try{const e=await t;if(h)return;if(!c(e))throw new i("Value does not satisfy filter");u.push(e)}catch(e){l.push(e)}finally{p.add(t),!h&&f()&&y()}})();a>d&&(n(new RangeError(`Expected input to contain at least ${t.count} items, but contains ${d} items`)),y())});e.exports=o,e.exports.AggregateError=s,e.exports.FilterError=i},8724:function(e,t,r){"use strict";const{nanoid:s}=r("e1bd"),n=r("9b62"),i=r("d46b"),o=Symbol.for("@ipfs/interface-datastore/key"),a="/",c=(new TextEncoder).encode(a),u=c[0];class l{constructor(e,t){if("string"===typeof e)this._buf=i(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==u)throw new Error("Invalid key")}toString(e="utf8"){return n(this._buf,e)}uint8Array(){return this._buf}get[o](){return!0}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new l(e.join(a))}static random(){return new l(s().replace(/-/g,""))}clean(){if(this._buf&&0!==this._buf.byteLength||(this._buf=c),this._buf[0]!==u){const e=new Uint8Array(this._buf.byteLength+1);e.fill(u,0,1),e.set(this._buf,1),this._buf=e}while(this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===u)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),r=e.list();for(let s=0;s<t.length;s++){if(r.length<s+1)return!1;const e=t[s],n=r[s];if(e<n)return!0;if(e>n)return!1}return t.length<r.length}reverse(){return l.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(a).slice(1)}type(){return d(this.baseNamespace())}name(){return h(this.baseNamespace())}instance(e){return new l(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(a)||(e+=a),e+=this.type(),new l(e)}parent(){const e=this.list();return 1===e.length?new l(a):new l(e.slice(0,-1).join(a))}child(e){return this.toString()===a?e:e.toString()===a?this:new l(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return l.withNamespaces([...this.namespaces(),...p(e.map(e=>e.namespaces()))])}static isKey(e){return e instanceof l||Boolean(e&&e[o])}}function d(e){const t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function h(e){const t=e.split(":");return t[t.length-1]}function p(e){return[].concat(...e)}e.exports=l},"873a":function(e,t,r){"use strict";const s="[a-fA-F\\d:]",n=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${s})|(?<=${s})(?=\\s|$))`:"",i="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",o="[a-fA-F\\d]{1,4}",a=`\n(?:\n(?:${o}:){7}(?:${o}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${o}:){6}(?:${i}|:${o}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${o}:){5}(?::${i}|(?::${o}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${o}:){4}(?:(?::${o}){0,1}:${i}|(?::${o}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${o}:){3}(?:(?::${o}){0,2}:${i}|(?::${o}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${o}:){2}(?:(?::${o}){0,3}:${i}|(?::${o}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${o}:){1}(?:(?::${o}){0,4}:${i}|(?::${o}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${o}){0,5}:${i}|(?::${o}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),c=new RegExp(`(?:^${i}$)|(?:^${a}$)`),u=new RegExp(`^${i}$`),l=new RegExp(`^${a}$`),d=e=>e&&e.exact?c:new RegExp(`(?:${n(e)}${i}${n(e)})|(?:${n(e)}${a}${n(e)})`,"g");d.v4=e=>e&&e.exact?u:new RegExp(`${n(e)}${i}${n(e)}`,"g"),d.v6=e=>e&&e.exact?l:new RegExp(`${n(e)}${a}${n(e)}`,"g"),e.exports=d},8786:function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=(s.util,s.roots["default"]||(s.roots["default"]={}));o.ipfs=function(){var e={};return e.pin=function(){var e={};return e.Set=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.version=0,e.prototype.fanout=0,e.prototype.seed=0,e.encode=function(e,t){return t||(t=i.create()),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(8).uint32(e.version),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(16).uint32(e.fanout),null!=e.seed&&Object.hasOwnProperty.call(e,"seed")&&t.uint32(29).fixed32(e.seed),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new o.ipfs.pin.Set;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.version=e.uint32();break;case 2:s.fanout=e.uint32();break;case 3:s.seed=e.fixed32();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof o.ipfs.pin.Set)return e;var t=new o.ipfs.pin.Set;return null!=e.version&&(t.version=e.version>>>0),null!=e.fanout&&(t.fanout=e.fanout>>>0),null!=e.seed&&(t.seed=e.seed>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.version=0,r.fanout=0,r.seed=0),null!=e.version&&e.hasOwnProperty("version")&&(r.version=e.version),null!=e.fanout&&e.hasOwnProperty("fanout")&&(r.fanout=e.fanout),null!=e.seed&&e.hasOwnProperty("seed")&&(r.seed=e.seed),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e}(),e}(),e.exports=o},8801:function(e,t,r){"use strict";var s=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n)return n;throw new Error("unable to locate global object")},n=s();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},8874:function(e,t,r){"use strict";const s=r("34eb")("ipfs:repo:migrator:repo:init"),{CONFIG_KEY:n,VERSION_KEY:i,createStore:o}=r("d268"),{MissingRepoOptionsError:a}=r("d9a8");async function c(e,t){if(!t)throw new a("Please pass repo options when trying to open a repo");let r;try{r=o(e,"root",t),await r.open();const a=await r.has(i),c=await r.has(n);return!(!a||!c)||(s("Version entry present: "+a),s("Config entry present: "+c),!1)}catch(c){return s("While checking if repo is initialized error was thrown: "+c.message),!1}finally{void 0!==r&&await r.close()}}e.exports={isRepoInitialized:c}},"888a":function(e,t,r){"use strict";const s=r("eef9"),n=r("34eb"),i=r("b6aa"),o=r("d63e"),a=r("f248"),c=r("794f"),u=r("4fcb"),l=r("3b27"),d=r("a78f"),h=r("9ef1"),p=r("9075"),f=r("043f"),y=r("5d14"),g=r("f105"),b=r("3128"),m=r("505b"),w=r("8623"),_=r("0d05"),E=n("ipfs:repo"),v=Number.MAX_SAFE_INTEGER,S="repoAutoMigrate",I={memory:r("ac64"),fs:r("ac64")};class A{constructor(e,t={}){if("string"!==typeof e)throw new Error("missing repoPath");this.options=u(m,t),this.closed=!0,this.path=e,this._locker=this._getLocker(),this.root=d.create("root",this.path,this.options),this.datastore=d.create("datastore",c(this.path,"datastore"),this.options),this.keys=d.create("keys",c(this.path,"keys"),this.options),this.pins=d.create("pins",c(this.path,"pins"),this.options);const r=d.create("blocks",c(this.path,"blocks"),this.options),s=g(r,this.options.storageBackendOptions.blocks);this.blocks=b(s),this.version=h(this.root),this.config=p(this.root),this.spec=f(this.root),this.apiAddr=y(this.root)}async init(e){E("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(T(e)),await this.spec.set(k(e)),await this.version.set(l.repoVersion)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(e){return!1}}async open(){if(!this.closed)throw i(new Error("repo is already open"),_.ERR_REPO_ALREADY_OPEN);E("opening at: %s",this.path);try{await this._openRoot(),await this._checkInitialized(),this.lockfile=await this._openLock(this.path),E("acquired repo.lock");const e=await this.version.check(l.repoVersion);if(!e){if(!await this._isAutoMigrationEnabled())throw new _.InvalidRepoVersionError("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");await this._migrate(l.repoVersion)}E("creating datastore"),await this.datastore.open(),E("creating blocks"),this.blocks.open(),E("creating keystore"),await this.keys.open(),E("creating pins"),await this.pins.open(),this.closed=!1,E("all opened")}catch(e){if(this.lockfile)try{await this._closeLock(),this.lockfile=null}catch(t){E("error removing lock",t)}throw e}}_getLocker(){if("string"===typeof this.options.lock){if(!I[this.options.lock])throw new Error("Unknown lock type: "+this.options.lock);return I[this.options.lock]}if(!this.options.lock)throw new Error("No lock provided");return this.options.lock}async _openRoot(){try{await this.root.open()}catch(e){if("Already open"!==e.message)throw e}}async _openLock(e){const t=await this._locker.lock(e);if("function"!==typeof t.close)throw i(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return t}_closeLock(){return this.lockfile&&this.lockfile.close()}async _checkInitialized(){let e;E("init check");try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(t){if("ERR_NOT_FOUND"===t.code)throw i(new Error("repo is not initialized yet"),_.ERR_REPO_NOT_INITIALIZED,{path:this.path});throw t}if(!e)throw i(new Error("repo is not initialized yet"),_.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async close(){if(this.closed)throw i(new Error("repo is already closed"),_.ERR_REPO_ALREADY_CLOSED);E("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==_.ERR_REPO_NOT_INITIALIZED&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins].map(e=>e&&e.close())),E("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){const[e,t,r,s,n]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),R(this.datastore),R(this.keys)]),i=t.size+s+n;return{repoPath:this.path,storageMax:e,version:r,numObjects:t.count,repoSize:i}}throw i(new Error("repo is not initialized yet"),_.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async _isAutoMigrationEnabled(){if(void 0!==this.options.autoMigrate)return this.options.autoMigrate;let e;try{e=await this.config.get(S)}catch(t){if(t.code!==_.NotFoundError.code)throw t;e=!0}return e}async _migrate(e){const t=await this.version.get();return t>e?(E("reverting to version "+e),o.revert(this.path,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(E("migrating to version "+e),o.migrate(this.path,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{const e=await this.config.get("Datastore.StorageMax");return BigInt(a(e))}catch(e){return BigInt(v)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(const r of this.blocks.query({})){const s=r;e+=BigInt(1),t+=BigInt(s.data.byteLength),t+=BigInt(s.cid.bytes.byteLength)}return{count:e,size:t}}}async function R(e){let t=BigInt(0);for await(const r of e.query({}))t+=BigInt(r.value.byteLength),t+=BigInt(r.key.uint8Array().byteLength);return t}function T(e){return e.Datastore=Object.assign({},w,s(e,"datastore")),e}function k(e){const t={...w.Spec,...s(e,"Datastore.Spec")};return{type:t.type,mounts:t.mounts.map(e=>({mountpoint:e.mountpoint,type:e.child.type,path:e.child.path,shardFunc:e.child.shardFunc}))}}e.exports=A,e.exports.utils={blockstore:r("109b")},e.exports.repoVersion=l.repoVersion,e.exports.errors=_},"88ae":function(e,t,r){"use strict";const s=r("8dd2"),n=r("a9f4"),i=3e4;class o{constructor(e,t){if(this.run=e,this.queryFunc=n.withTimeout(t,i),!this.queryFunc)throw new Error("Path requires a `queryFn` to be specified");if("function"!==typeof this.queryFunc)throw new Error("Path expected `queryFn` to be a function. Got "+typeof this.queryFunc);this.initialPeers=[],this.peersToQuery=null,this.res=null}addInitialPeer(e){this.initialPeers.push(e)}async execute(){const e=await s.fromKey(this.run.query.key);this.peersToQuery=e,await Promise.all(this.initialPeers.map(e=>this.addPeerToQuery(e))),await this.run.workerQueue(this)}async addPeerToQuery(e){this.run.query.dht._isSelf(e)||this.run.peersSeen.has(e.toB58String())||this.peersToQuery&&await this.peersToQuery.enqueue(e)}}e.exports=o},"88b3":function(e,t,r){"use strict";t.encode=r("a6e2"),t.decode=r("cc9a")},"892c":function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["default"]||(s.roots["default"]={});a.PBLink=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Hash=o.newBuffer([]),e.prototype.Name="",e.prototype.Tsize=o.Long?o.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=i.create()),null!=e.Hash&&Object.hasOwnProperty.call(e,"Hash")&&t.uint32(10).bytes(e.Hash),null!=e.Name&&Object.hasOwnProperty.call(e,"Name")&&t.uint32(18).string(e.Name),null!=e.Tsize&&Object.hasOwnProperty.call(e,"Tsize")&&t.uint32(24).uint64(e.Tsize),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.PBLink;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.Hash=e.bytes();break;case 2:s.Name=e.string();break;case 3:s.Tsize=e.uint64();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.PBLink)return e;var t=new a.PBLink;return null!=e.Hash&&("string"===typeof e.Hash?o.base64.decode(e.Hash,t.Hash=o.newBuffer(o.base64.length(e.Hash)),0):e.Hash.length&&(t.Hash=e.Hash)),null!=e.Name&&(t.Name=String(e.Name)),null!=e.Tsize&&(o.Long?(t.Tsize=o.Long.fromValue(e.Tsize)).unsigned=!0:"string"===typeof e.Tsize?t.Tsize=parseInt(e.Tsize,10):"number"===typeof e.Tsize?t.Tsize=e.Tsize:"object"===typeof e.Tsize&&(t.Tsize=new o.LongBits(e.Tsize.low>>>0,e.Tsize.high>>>0).toNumber(!0))),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults)if(t.bytes===String?r.Hash="":(r.Hash=[],t.bytes!==Array&&(r.Hash=o.newBuffer(r.Hash))),r.Name="",o.Long){var s=new o.Long(0,0,!0);r.Tsize=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else r.Tsize=t.longs===String?"0":0;return null!=e.Hash&&e.hasOwnProperty("Hash")&&(r.Hash=t.bytes===String?o.base64.encode(e.Hash,0,e.Hash.length):t.bytes===Array?Array.prototype.slice.call(e.Hash):e.Hash),null!=e.Name&&e.hasOwnProperty("Name")&&(r.Name=e.Name),null!=e.Tsize&&e.hasOwnProperty("Tsize")&&("number"===typeof e.Tsize?r.Tsize=t.longs===String?String(e.Tsize):e.Tsize:r.Tsize=t.longs===String?o.Long.prototype.toString.call(e.Tsize):t.longs===Number?new o.LongBits(e.Tsize.low>>>0,e.Tsize.high>>>0).toNumber(!0):e.Tsize),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),a.PBNode=function(){function e(e){if(this.Links=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Links=o.emptyArray,e.prototype.Data=o.newBuffer([]),e.encode=function(e,t){if(t||(t=i.create()),null!=e.Data&&Object.hasOwnProperty.call(e,"Data")&&t.uint32(10).bytes(e.Data),null!=e.Links&&e.Links.length)for(var r=0;r<e.Links.length;++r)a.PBLink.encode(e.Links[r],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.PBNode;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 2:s.Links&&s.Links.length||(s.Links=[]),s.Links.push(a.PBLink.decode(e,e.uint32()));break;case 1:s.Data=e.bytes();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.PBNode)return e;var t=new a.PBNode;if(e.Links){if(!Array.isArray(e.Links))throw TypeError(".PBNode.Links: array expected");t.Links=[];for(var r=0;r<e.Links.length;++r){if("object"!==typeof e.Links[r])throw TypeError(".PBNode.Links: object expected");t.Links[r]=a.PBLink.fromObject(e.Links[r])}}return null!=e.Data&&("string"===typeof e.Data?o.base64.decode(e.Data,t.Data=o.newBuffer(o.base64.length(e.Data)),0):e.Data.length&&(t.Data=e.Data)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.Links=[]),t.defaults&&(t.bytes===String?r.Data="":(r.Data=[],t.bytes!==Array&&(r.Data=o.newBuffer(r.Data)))),null!=e.Data&&e.hasOwnProperty("Data")&&(r.Data=t.bytes===String?o.base64.encode(e.Data,0,e.Data.length):t.bytes===Array?Array.prototype.slice.call(e.Data):e.Data),e.Links&&e.Links.length){r.Links=[];for(var s=0;s<e.Links.length;++s)r.Links[s]=a.PBLink.toObject(e.Links[s],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.exports=a},8992:function(e,t,r){"use strict";const s=r("65a5");e.exports=async function(e,t,r){const o=new i(r.layerRepeat);let a=0,c=1,u=o;for await(const i of s(e,r.maxChildrenPerNode))u.isFull()&&(u!==o&&o.addChild(await u.reduce(t)),a&&a%r.layerRepeat===0&&c++,u=new n(c,r.layerRepeat,a),a++),u.append(i);return u&&u!==o&&o.addChild(await u.reduce(t)),o.reduce(t)};class n{constructor(e,t,r=0){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=r,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;const e=this._findParent(this.node,this.currentDepth);return!e||(this._addNextNodeToParent(e),!1)}_addNextNodeToParent(e){this.parent=e;const t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,t){let r=[];return e.children.length&&(r=await Promise.all(e.children.filter(e=>e.data).map(e=>this._reduce(e,t)))),t((e.data||[]).concat(r))}_findParent(e,t){const r=e.parent;if(r&&0!==r.depth)return r.children.length!==r.maxChildren&&r.maxChildren?r:this._findParent(r,t)}}class i extends n{constructor(e){super(0,e),this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}},"89d9":function(e,t,r){"use strict";(function(t){const s=r("63a6"),n="object"===typeof window&&"object"===typeof document&&9===document.nodeType,i=s(),o=n&&!i,a=i&&!n,c=i&&n,u="undefined"!==typeof t&&"undefined"!==typeof t.release&&"node"===t.release.name&&!i,l="function"===typeof importScripts&&"undefined"!==typeof self&&"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,d="undefined"!==typeof t&&!1;e.exports={isTest:d,isElectron:i,isElectronMain:a,isElectronRenderer:c,isNode:u,isBrowser:o,isWebWorker:l,isEnvWithDom:n}}).call(this,r("4362"))},"8a37":function(e,t,r){"use strict";class s extends Error{constructor(e){super(e||"Promise was canceled"),this.name="CancelError"}get isCanceled(){return!0}}class n{static fn(e){return(...t)=>new n((r,s,n)=>{t.push(n),e(...t).then(r,s)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((t,r)=>{this._reject=r;const s=e=>{this._isCanceled&&i.shouldReject||(this._isPending=!1,t(e))},n=e=>{this._isPending=!1,r(e)},i=e=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(e)};return Object.defineProperties(i,{shouldReject:{get:()=>this._rejectOnCancel,set:e=>{this._rejectOnCancel=e}}}),e(s,n,i)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(this._isPending&&!this._isCanceled){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(const e of this._cancelHandlers)e()}catch(t){return void this._reject(t)}this._rejectOnCancel&&this._reject(new s(e))}}get isCanceled(){return this._isCanceled}}Object.setPrototypeOf(n.prototype,Promise.prototype),e.exports=n,e.exports.CancelError=s},"8b37d":function(e,t,r){"use strict";e.exports=function(...e){const t=e.reduce((e,t)=>Object.assign(e,t),{});return Object.assign(t,{bufferKeys:t.bufferKeys||!1,snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,openCallback:t.openCallback||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:t.encodings||!1,additionalMethods:Object.assign({},t.additionalMethods)})}},"8b55":function(e,t,r){"use strict";async function*s(e,t){let r=[];for await(const s of t)r.push(s),r.length===e&&(yield r,r=[]);r.length>0&&(yield r)}function*n(e,t){let r=[];for(const s of t)r.push(s),r.length===e&&(yield r,r=[]);r.length>0&&(yield r)}function i(e,t){return void 0===t?t=>i(e,t):t[Symbol.asyncIterator]?s(e,t):n(e,t)}function o(e){if("function"===typeof e.next)return e;if("function"===typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"===typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function a(){let e,t;const r=new Promise((r,s)=>{t=r,e=s});return{promise:r,reject:e,resolve:t}}function c(e,t){const r=o(t),s=[],n=[];let i=!1,c=!1;function u(){while(n.length>0&&s.length>0){const e=n.shift(),{error:t,value:r}=s.shift();t?e.reject(t):e.resolve({done:!1,value:r})}while(n.length>0&&c){const{resolve:e}=n.shift();e({done:!0,value:void 0})}}async function l(){if(!c&&!i&&!(s.length>=e)){i=!0;try{const{done:e,value:t}=await r.next();e?c=!0:s.push({value:t})}catch(t){c=!0,s.push({error:t})}u(),i=!1,l()}}async function d(){if(s.length>0){const{error:e,value:t}=s.shift();if(e)throw e;return l(),{done:!1,value:t}}if(c)return{done:!0,value:void 0};const e=a();return n.push(e),l(),e.promise}const h={next:d,[Symbol.asyncIterator]:()=>h};return h}function*u(e,t){const r=[];let s;try{for(const s of t)r.push(s),r.length<=e||(yield r.shift())}catch(n){s=n}for(const i of r)yield i;if(s)throw s}function l(e,t){return void 0===t?t=>l(e,t):0===e?t:t[Symbol.asyncIterator]?c(e,t):u(e,t)}async function d(e){const t=[];for await(const r of e)t.push(r);return t}function h(e){return e[Symbol.asyncIterator]?d(e):Array.from(e)}async function*p(e){for await(const t of e)yield*t}function*f(e){for(const t of e)yield*t}function y(...e){const t=e.find(e=>void 0!==e[Symbol.asyncIterator]);return t?p(e):f(e)}async function g(e){for await(const t of e);}function b(e){if(e[Symbol.asyncIterator])return g(e);for(const t of e);}async function*m(e,t){for await(const r of t)await e(r)&&(yield r)}function w(e,t){return void 0===t?t=>m(e,t):m(e,t)}async function*_(e){for await(const t of e)t&&"string"!==typeof t&&(t[Symbol.iterator]||t[Symbol.asyncIterator])?yield*_(t):yield t}async function*E(e,t){for await(const r of t)yield await e(r)}function v(e,t){return void 0===t?t=>E(e,t):E(e,t)}function S(e,t){return void 0===t?t=>S(e,t):w(e=>void 0!==e&&null!==e,_(v(e,t)))}function I(e,t,r){const s=o(r),n=[],i=[];let c=!1,u=!1,l=0,d=null;function h(){while(i.length>0&&n.length>0){const{resolve:e}=i.shift(),t=n.shift();e({done:!1,value:t})}while(i.length>0&&0===l&&c){const{resolve:e,reject:t}=i.shift();d?(t(d),d=null):e({done:!0,value:void 0})}}async function p(){if(c)h();else if(!u&&!(l+n.length>=e)){u=!0,l++;try{const{done:e,value:t}=await s.next();e?(c=!0,l--,h()):f(t)}catch(t){c=!0,l--,d=t,h()}u=!1,p()}}async function f(e){try{const r=await t(e);if(r&&r[Symbol.asyncIterator])for await(const e of r)n.push(e);else n.push(r)}catch(r){c=!0,d=r}l--,h(),p()}async function y(){if(0===n.length){const e=a();return i.push(e),p(),e.promise}const e=n.shift();return p(),{done:!1,value:e}}const g={next:y,[Symbol.asyncIterator]:()=>g};return g}function A(e,t,r){return void 0===t?(t,r)=>r?A(e,t,r):A(e,t):void 0===r?r=>A(e,t,r):w(e=>void 0!==e&&null!==e,_(I(e,t,r)))}async function R(e){return new Promise(t=>{e.once("readable",()=>{t()})})}async function*T(e){while(1){const t=e.read();if(null===t){if(e._readableState.ended)break;await R(e)}else yield t}}function k(e){return"function"===typeof e[Symbol.asyncIterator]?e:T(e)}async function*P(...e){const t=new Set(e.map(o));while(t.size>0)for(const e of t){const r=await e.next();r.done?t.delete(e):yield r.value}}function O(e,...t){let r=e();for(const s of t)r=s(r);return r}async function*N(e,t,r){let s=null;const n=e=>({value:t(e)}),i=async function*(e){for await(const t of e){if(s)return;yield t}},a=O(()=>r,l(1),i,v(n),l(e-1)),c=o(a);while(1){const{value:e,done:t}=await c.next();if(t)break;try{const t=await e.value;s||(yield t)}catch(u){s=u}}if(s)throw s}function D(e,t,r){return void 0===t?(t,r)=>D(e,t,r):void 0===r?r=>D(e,t,r):1===e?v(t,r):N(e,t,r)}function C(e,t,r){return void 0===t?(t,r)=>r?C(e,t,r):C(e,t):void 0===r?r=>C(e,t,r):w(e=>void 0!==e&&null!==e,_(D(e,t,r)))}async function*x(...e){const t=e.map(o),r=new Set,s=new Map;let n=null,i=null,a=null;const c=e=>{n=e,i&&i(e)},u=e=>{a&&a(e)},l=()=>new Promise((e,t)=>{if(n&&t(n),s.size>0)return e();a=e,i=t}),d=e=>{const t=Promise.resolve(e.next()).then(async({done:n,value:i})=>{n||s.set(e,i),r.delete(t)});r.add(t),t.then(u,c)};for(const o of t)d(o);while(1){if(0===r.size&&0===s.size)return;await l();for(const[e,t]of s)s.delete(e),yield t,d(e)}}async function L(e,t,r){let s=t;for await(const n of r)s=await e(s,n);return s}function M(e,t,r){return void 0===t?(t,r)=>r?L(e,t,r):M(e,t):void 0===r?r=>M(e,t,r):L(e,t,r)}async function*B(e,t){let r=0;for await(const s of t)if(yield await s,r++,r>=e)break}function*U(e,t){let r=0;for(const s of t)if(yield s,r++,r>=e)break}function j(e,t){return void 0===t?t=>j(e,t):t[Symbol.asyncIterator]?B(e,t):U(e,t)}async function*F(e,t){for await(const r of t)await e(r),yield r}function V(e,t){return void 0===t?t=>F(e,t):F(e,t)}function z(e,t){let r=e[0]+t[0],s=e[1]+t[1];if(s>=1e9){const e=s%1e9;r+=(s-e)/1e9,s=e}return[r,s]}async function*K(e,t){const r=t[Symbol.asyncIterator]();let s=[0,0];while(1){const t=process.hrtime(),{value:n,done:i}=await r.next(),o=process.hrtime(t);if(s=z(s,o),e.progress&&e.progress(o,s),i)return e.total&&e.total(s),n;yield n}}function*q(e,t){const r=t[Symbol.iterator]();let s=[0,0];while(1){const t=process.hrtime(),{value:n,done:i}=r.next(),o=process.hrtime(t);if(s=z(s,o),e.progress&&e.progress(o,s),i)return e.total&&e.total(s),n;yield n}}function G(e={},t){return void 0===t?t=>G(e,t):void 0!==t[Symbol.asyncIterator]?K(e,t):q(e,t)}function H(e,t,r){const s=o(r),n=[],i=[];let c=!1,u=!1,l=0,d=null;function h(){while(i.length>0&&n.length>0){const{resolve:e}=i.shift(),t=n.shift();e({done:!1,value:t})}while(i.length>0&&0===l&&c){const{resolve:e,reject:t}=i.shift();d?(t(d),d=null):e({done:!0,value:void 0})}}async function p(){if(c)h();else if(!u&&!(l+n.length>=e)){u=!0,l++;try{const{done:e,value:t}=await s.next();e?(c=!0,l--,h()):f(t)}catch(t){c=!0,l--,d=t,h()}u=!1,p()}}async function f(e){try{const r=await t(e);n.push(r)}catch(r){c=!0,d=r}l--,h(),p()}async function y(){if(0===n.length){const e=a();return i.push(e),p(),e.promise}const e=n.shift();return p(),{done:!1,value:e}}const g={next:y,[Symbol.asyncIterator]:()=>g};return g}function $(e,t,r){return void 0===t?(t,r)=>r?$(e,t,r):$(e,t):void 0===r?r=>$(e,t,r):H(e,t,r)}async function W(e,t){let r=null,s=null,n=null;const i=e=>{r=e,s&&s(e)},o=()=>{n&&n()},a=()=>{e.removeListener("error",i),e.removeListener("drain",o)};e.once("error",i);const c=()=>new Promise((t,i)=>{if(r)return i(r);e.once("drain",o),n=t,s=i});for await(const u of t)if(!1===e.write(u)&&await c(),r)break;if(a(),r)throw r}function Y(e,t){return void 0===t?t=>W(e,t):W(e,t)}r.r(t),r.d(t,"batch",(function(){return i})),r.d(t,"buffer",(function(){return l})),r.d(t,"collect",(function(){return h})),r.d(t,"concat",(function(){return y})),r.d(t,"consume",(function(){return b})),r.d(t,"filter",(function(){return w})),r.d(t,"flatMap",(function(){return S})),r.d(t,"flatTransform",(function(){return A})),r.d(t,"flatten",(function(){return _})),r.d(t,"fromStream",(function(){return k})),r.d(t,"getIterator",(function(){return o})),r.d(t,"map",(function(){return v})),r.d(t,"merge",(function(){return P})),r.d(t,"parallelFlatMap",(function(){return C})),r.d(t,"parallelMap",(function(){return D})),r.d(t,"parallelMerge",(function(){return x})),r.d(t,"pipeline",(function(){return O})),r.d(t,"reduce",(function(){return M})),r.d(t,"take",(function(){return j})),r.d(t,"tap",(function(){return V})),r.d(t,"time",(function(){return G})),r.d(t,"transform",(function(){return $})),r.d(t,"writeToStream",(function(){return Y}))},"8b75":function(e,t,r){"use strict";const s=r("796b"),n=r("34eb")("it-multistream-select:ls"),i=r("5b1e"),o=r("4e8e"),a=r("bbbe"),c=r("66f2");e.exports=async e=>{const{reader:t,writer:r,rest:u,stream:l}=o(e);n('write "ls"'),i.write(r,"ls"),u();const d=await i.read(t),h=s([d]),p=[];return await c(h,a.decode(),async e=>{for await(const t of e)p.push(t.shallowSlice(0,-1).toString())}),{stream:l,protocols:p}}},"8b8b":function(e,t){e.exports=o;var r=128,s=127,n=~s,i=Math.pow(2,31);function o(e,t,s){if(Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw o.bytes=0,new RangeError("Could not encode varint");t=t||[],s=s||0;var a=s;while(e>=i)t[s++]=255&e|r,e/=128;while(e&n)t[s++]=255&e|r,e>>>=7;return t[s]=0|e,o.bytes=s-a+1,t}},"8bb9":function(e,t,r){"use strict";const s=r("3fb5"),n=r("5425").AbstractIterator,i=r("84fa"),o=r("642a"),a=function(){};function c(e,t,r){if(n.call(this,e),this._limit=r.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=r.keys,this._values=r.values,this._keyAsBuffer=r.keyAsBuffer,this._valueAsBuffer=r.valueAsBuffer,0===this._limit)return void(this._completed=!0);let s;try{s=i(r)}catch(o){return void(this._completed=!0)}this.createIterator(t,s,r.reverse)}e.exports=c,s(c,n),c.prototype.createIterator=function(e,t,r){const s=this.db.db.transaction([e],"readonly"),n=s.objectStore(e),i=n.openCursor(t,r?"prev":"next");i.onsuccess=e=>{const t=e.target.result;t&&this.onItem(t)},this._transaction=s,s.onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},s.oncomplete=()=>{this.onComplete()}},c.prototype.onItem=function(e){this._cache.push(e.key,e.value),(this._limit<=0||++this._count<this._limit)&&e.continue(),this.maybeNext()},c.prototype.onAbort=function(e){this._aborted=!0,this._error=e,this.maybeNext()},c.prototype.onComplete=function(){this._completed=!0,this.maybeNext()},c.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)},c.prototype._next=function(e){if(this._aborted){const t=this._error;this._error=null,this._nextTick(e,t)}else if(this._cache.length>0){let t=this._cache.shift(),r=this._cache.shift();t=this._keys&&void 0!==t?this._deserializeKey(t,this._keyAsBuffer):void 0,r=this._values&&void 0!==r?this._deserializeValue(r,this._valueAsBuffer):void 0,this._nextTick(e,null,t,r)}else this._completed?this._nextTick(e):this._callback=e},c.prototype._deserializeKey=o,c.prototype._deserializeValue=o,c.prototype._end=function(e){if(this._aborted||this._completed)return this._nextTick(e,this._error);this.onItem=a,this.onAbort=e,this.onComplete=e}},"8c6a":function(e,t,r){"use strict";e.exports=()=>{}},"8cbc":function(e,t,r){"use strict";function s(e,t,r,s){let n=0;Object.entries(t.topics).forEach(([e,t])=>{const s=r.topics[e];if(!s)return;let i=0;if(t.inMesh){let e=t.meshTime/s.timeInMeshQuantum;e>s.timeInMeshCap&&(e=s.timeInMeshCap),i+=e*s.timeInMeshWeight}const o=t.firstMessageDeliveries;if(i+=o*s.firstMessageDeliveriesWeight,t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<s.meshMessageDeliveriesThreshold){const e=s.meshMessageDeliveriesThreshold-t.meshMessageDeliveries,r=e*e;i+=r*s.meshMessageDeliveriesWeight}const a=t.meshFailurePenalty;i+=a*s.meshFailurePenaltyWeight;const c=t.invalidMessageDeliveries*t.invalidMessageDeliveries;i+=c*s.invalidMessageDeliveriesWeight,n+=i*s.topicWeight}),r.topicScoreCap>0&&n>r.topicScoreCap&&(n=r.topicScoreCap);const i=r.appSpecificScore(e);n+=i*r.appSpecificWeight,t.ips.forEach(e=>{if(r.IPColocationFactorWhitelist.has(e))return;const t=s.get(e),i=t?t.size:0;if(i>r.IPColocationFactorThreshold){const e=i-r.IPColocationFactorThreshold,t=e*e;n+=t*r.IPColocationFactorWeight}});const o=t.behaviourPenalty*t.behaviourPenalty;return n+=o*r.behaviourPenaltyWeight,n}Object.defineProperty(t,"__esModule",{value:!0}),t.computeScore=void 0,t.computeScore=s},"8cd7":function(e,t,r){"use strict";const s=r("faa1").EventEmitter,n=r("eed9").inherits,i=r("3c8d"),o=r("38f3"),a=r("ada8"),c=r("df7a"),u=r("07d5"),l=r("6f8e"),d=r("afc5").getCallback,h=r("afc5").getOptions,p=r("b11a"),f=c.WriteError,y=c.ReadError,g=c.NotFoundError,b=c.OpenError,m=c.InitializationError;function w(e,t,r){if(!(this instanceof w))return new w(e,t,r);let n;if(s.call(this),this.setMaxListeners(1/0),"function"===typeof t&&(r=t,t={}),t=t||{},!e||"object"!==typeof e){if(n=new m("First argument must be an abstract-leveldown compliant store"),"function"===typeof r)return p(r,n);throw n}if("string"!==typeof e.status)throw new Error(".status required, old abstract-leveldown");this.options=h(t),this._db=e,this.db=new i(e),this.open(r||(e=>{e&&this.emit("error",e)})),this.supports=u(this.db.supports,{status:!1,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(const s of Object.keys(this.supports.additionalMethods))null==this[s]&&(this[s]=function(...e){return this.db[s](...e)})}function _(e,t){if(!e._isOpening()&&!e.isOpen())return p(t,new y("Database is not open")),!0}w.prototype.emit=s.prototype.emit,w.prototype.once=s.prototype.once,n(w,s),w.prototype.open=function(e,t){return"function"===typeof e&&(t=e,e=null),t=l.fromCallback(t),e||(e=this.options),this.isOpen()?(p(t,null,this),t.promise):this._isOpening()?(this.once("open",()=>{t(null,this)}),t.promise):(this.emit("opening"),this.db.open(e,e=>{if(e)return t(new b(e));this.db=this._db,t(null,this),this.emit("open"),this.emit("ready")}),t.promise)},w.prototype.close=function(e){return e=l.fromCallback(e),this.isOpen()?(this.db.close((t,...r)=>{this.emit("closed"),e(t,...r)}),this.emit("closing"),this.db=new i(this._db)):this.isClosed()?p(e):"closing"===this.db.status?this.once("closed",e):this._isOpening()&&this.once("open",()=>{this.close(e)}),e.promise},w.prototype.isOpen=function(){return"open"===this.db.status},w.prototype._isOpening=function(){return"opening"===this.db.status},w.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)},w.prototype.get=function(e,t,r){return r=d(t,r),r=l.fromCallback(r),_(this,r)||(t=h(t),this.db.get(e,t,(function(t,s){if(t)return t=/notfound/i.test(t)||t.notFound?new g("Key not found in database ["+e+"]",t):new y(t),r(t);r(null,s)}))),r.promise},w.prototype.put=function(e,t,r,s){return s=d(r,s),s=l.fromCallback(s),_(this,s)||(r=h(r),this.db.put(e,t,r,r=>{if(r)return s(new f(r));this.emit("put",e,t),s()})),s.promise},w.prototype.del=function(e,t,r){return r=d(t,r),r=l.fromCallback(r),_(this,r)||(t=h(t),this.db.del(e,t,t=>{if(t)return r(new f(t));this.emit("del",e),r()})),r.promise},w.prototype.batch=function(e,t,r){return arguments.length?(r="function"===typeof e?e:d(t,r),r=l.fromCallback(r),_(this,r)||(t=h(t),this.db.batch(e,t,t=>{if(t)return r(new f(t));this.emit("batch",e),r()})),r.promise):new a(this)},w.prototype.iterator=function(e){return this.db.iterator(e)},w.prototype.clear=function(e,t){return t=d(e,t),e=h(e),t=l.fromCallback(t),_(this,t)||this.db.clear(e,r=>{if(r)return t(new f(r));this.emit("clear",e),t()}),t.promise},w.prototype.readStream=w.prototype.createReadStream=function(e){return e=Object.assign({keys:!0,values:!0},e),"number"!==typeof e.limit&&(e.limit=-1),new o(this.db.iterator(e),e)},w.prototype.keyStream=w.prototype.createKeyStream=function(e){return this.createReadStream(Object.assign({},e,{keys:!0,values:!1}))},w.prototype.valueStream=w.prototype.createValueStream=function(e){return this.createReadStream(Object.assign({},e,{keys:!1,values:!0}))},w.prototype.toString=function(){return"LevelUP"},w.prototype.type="levelup",w.errors=c,e.exports=w},"8ce5":function(e,t,r){e.exports=r("276c")(r("590a"))},"8db3":function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:peer-store:proto-book"),{error:s("libp2p:peer-store:proto-book:err")}),i=r("b6aa"),o=r("5aab"),a=r("eddf"),c=r("bd20"),{codes:{ERR_INVALID_PARAMETERS:u}}=r("b73a");class l extends c{constructor(e){super({peerStore:e,eventName:"change:metadata",eventProperty:"metadata"}),this.data=new Map}set(e,t,r){if(!a.isPeerId(e))throw n.error("peerId must be an instance of peer-id to store data"),i(new Error("peerId must be an instance of peer-id"),u);if("string"!==typeof t||!(r instanceof Uint8Array))throw n.error("valid key and value must be provided to store data"),i(new Error("valid key and value must be provided"),u);return this._setValue(e,t,r),this}_setValue(e,t,r,{emit:s=!0}={}){const i=e.toB58String(),a=this.data.get(i)||new Map,c=a.get(t);c&&o(r,c)?n(`the metadata provided to store is equal to the already stored for ${i} on ${t}`):(a.set(t,r),this.data.set(i,a),s&&this._emit(e,t))}get(e){if(!a.isPeerId(e))throw i(new Error("peerId must be an instance of peer-id"),u);return this.data.get(e.toB58String())}getValue(e,t){if(!a.isPeerId(e))throw i(new Error("peerId must be an instance of peer-id"),u);const r=this.data.get(e.toB58String());return r&&r.get(t)}delete(e){if(!a.isPeerId(e))throw i(new Error("peerId must be an instance of peer-id"),u);return!!this.data.delete(e.toB58String())&&(this._emit(e),!0)}deleteValue(e,t){if(!a.isPeerId(e))throw i(new Error("peerId must be an instance of peer-id"),u);const r=this.data.get(e.toB58String());return!(!r||!r.delete(t))&&(this._emit(e,t),!0)}}e.exports=l},"8dd2":function(e,t,r){"use strict";const s=r("175a"),n=r("6896"),i=r("34eb"),o=r("a9f4"),a=i("libp2p:dht:peer-queue");class c{static async fromPeerId(e){const t=await o.convertPeerId(e);return new c(t)}static async fromKey(e){const t=await o.convertBuffer(e);return new c(t)}constructor(e){a("create: %b",e),this.from=e,this.heap=new s(o.xorCompare)}async enqueue(e){a("enqueue %s",e.toB58String());const t=await o.convertPeerId(e),r={id:e,distance:n(this.from,t)};this.heap.push(r)}dequeue(){const e=this.heap.pop();return a("dequeue %s",e.id.toB58String()),e.id}get length(){return this.heap.size()}}e.exports=c},"8e23":function(e,t,r){"use strict";const s=r("637e");class n{constructor(e){this.partner=e,this.wantlist=new s,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesRecv+=e}wants(e,t,r){this.wantlist.add(e,t,r)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.contains(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}e.exports=n},"8e99":function(e,t,r){"use strict";const{Buffer:s}=r("1c35"),n=r("8431"),i=r("5ee5");class o extends n{createTag(e,t){return`${e}(${t})`}createInt(e){return super.createInt(e).toString()}createInt32(e,t){return super.createInt32(e,t).toString()}createInt64(e,t,r,s){return super.createInt64(e,t,r,s).toString()}createInt32Neg(e,t){return super.createInt32Neg(e,t).toString()}createInt64Neg(e,t,r,s){return super.createInt64Neg(e,t,r,s).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(e){const t=super.createFloat(e);return i.isNegativeZero(e)?"-0_1":t+"_1"}createFloatSingle(e,t,r,s){const n=super.createFloatSingle(e,t,r,s);return n+"_2"}createFloatDouble(e,t,r,s,n,i,o,a){const c=super.createFloatDouble(e,t,r,s,n,i,o,a);return c+"_3"}createByteString(e,t){const r=e.join(", ");return-1===t?`(_ ${r})`:"h'"+r}createByteStringFromHeap(e,t){const r=s.from(super.createByteStringFromHeap(e,t)).toString("hex");return`h'${r}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(e){return`simple(${e})`}createArray(e,t){const r=super.createArray(e,t);return-1===t?`[_ ${r.join(", ")}]`:`[${r.join(", ")}]`}createMap(e,t){const r=super.createMap(e),s=Array.from(r.keys()).reduce(a(r),"");return-1===t?`{_ ${s}}`:`{${s}}`}createObject(e,t){const r=super.createObject(e),s=Object.keys(r).reduce(a(r),"");return-1===t?`{_ ${s}}`:`{${s}}`}createUtf8String(e,t){const r=e.join(", ");return-1===t?`(_ ${r})`:`"${r}"`}createUtf8StringFromHeap(e,t){const r=s.from(super.createUtf8StringFromHeap(e,t)).toString("utf8");return`"${r}"`}static diagnose(e,t){"string"===typeof e&&(e=s.from(e,t||"hex"));const r=new o;return r.decodeFirst(e)}}function a(e){return(t,r)=>t?`${t}, ${r}: ${e[r]}`:`${r}: ${e[r]}`}e.exports=o},"901e":function(e,t,r){var s;(function(n){"use strict";var i,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,c=Math.floor,u="[BigNumber Error] ",l=u+"Number primitive has more than 15 significant digits: ",d=1e14,h=14,p=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,g=1e9;function b(e){var t,r,s,n=M.prototype={constructor:M,toString:null,valueOf:null},i=new M(1),A=20,R=4,T=-7,k=21,P=-1e7,O=1e7,N=!1,D=1,C=0,x={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},L="0123456789abcdefghijklmnopqrstuvwxyz";function M(e,t){var n,i,a,u,d,f,y,g,b=this;if(!(b instanceof M))return new M(e,t);if(null==t){if(e&&!0===e._isBigNumber)return b.s=e.s,void(!e.c||e.e>O?b.c=b.e=null:e.e<P?b.c=[b.e=0]:(b.e=e.e,b.c=e.c.slice()));if((f="number"==typeof e)&&0*e==0){if(b.s=1/e<0?(e=-e,-1):1,e===~~e){for(u=0,d=e;d>=10;d/=10,u++);return void(u>O?b.c=b.e=null:(b.e=u,b.c=[e]))}g=String(e)}else{if(!o.test(g=String(e)))return s(b,g,f);b.s=45==g.charCodeAt(0)?(g=g.slice(1),-1):1}(u=g.indexOf("."))>-1&&(g=g.replace(".","")),(d=g.search(/e/i))>0?(u<0&&(u=d),u+=+g.slice(d+1),g=g.substring(0,d)):u<0&&(u=g.length)}else{if(E(t,2,L.length,"Base"),10==t)return b=new M(e),F(b,A+b.e+1,R);if(g=String(e),f="number"==typeof e){if(0*e!=0)return s(b,g,f,t);if(b.s=1/e<0?(g=g.slice(1),-1):1,M.DEBUG&&g.replace(/^0\.0*|\./,"").length>15)throw Error(l+e)}else b.s=45===g.charCodeAt(0)?(g=g.slice(1),-1):1;for(n=L.slice(0,t),u=d=0,y=g.length;d<y;d++)if(n.indexOf(i=g.charAt(d))<0){if("."==i){if(d>u){u=y;continue}}else if(!a&&(g==g.toUpperCase()&&(g=g.toLowerCase())||g==g.toLowerCase()&&(g=g.toUpperCase()))){a=!0,d=-1,u=0;continue}return s(b,String(e),f,t)}f=!1,g=r(g,t,10,b.s),(u=g.indexOf("."))>-1?g=g.replace(".",""):u=g.length}for(d=0;48===g.charCodeAt(d);d++);for(y=g.length;48===g.charCodeAt(--y););if(g=g.slice(d,++y)){if(y-=d,f&&M.DEBUG&&y>15&&(e>p||e!==c(e)))throw Error(l+b.s*e);if((u=u-d-1)>O)b.c=b.e=null;else if(u<P)b.c=[b.e=0];else{if(b.e=u,b.c=[],d=(u+1)%h,u<0&&(d+=h),d<y){for(d&&b.c.push(+g.slice(0,d)),y-=h;d<y;)b.c.push(+g.slice(d,d+=h));d=h-(g=g.slice(d)).length}else d-=y;for(;d--;g+="0");b.c.push(+g)}}else b.c=[b.e=0]}function B(e,t,r,s){var n,i,o,a,c;if(null==r?r=R:E(r,0,8),!e.c)return e.toString();if(n=e.c[0],o=e.e,null==t)c=w(e.c),c=1==s||2==s&&(o<=T||o>=k)?S(c,o):I(c,o,"0");else if(e=F(new M(e),t,r),i=e.e,c=w(e.c),a=c.length,1==s||2==s&&(t<=i||i<=T)){for(;a<t;c+="0",a++);c=S(c,i)}else if(t-=o,c=I(c,i,"0"),i+1>a){if(--t>0)for(c+=".";t--;c+="0");}else if(t+=i-a,t>0)for(i+1==a&&(c+=".");t--;c+="0");return e.s<0&&n?"-"+c:c}function U(e,t){for(var r,s=1,n=new M(e[0]);s<e.length;s++){if(r=new M(e[s]),!r.s){n=r;break}t.call(n,r)&&(n=r)}return n}function j(e,t,r){for(var s=1,n=t.length;!t[--n];t.pop());for(n=t[0];n>=10;n/=10,s++);return(r=s+r*h-1)>O?e.c=e.e=null:r<P?e.c=[e.e=0]:(e.e=r,e.c=t),e}function F(e,t,r,s){var n,i,o,u,l,p,y,g=e.c,b=f;if(g){e:{for(n=1,u=g[0];u>=10;u/=10,n++);if(i=t-n,i<0)i+=h,o=t,l=g[p=0],y=l/b[n-o-1]%10|0;else if(p=a((i+1)/h),p>=g.length){if(!s)break e;for(;g.length<=p;g.push(0));l=y=0,n=1,i%=h,o=i-h+1}else{for(l=u=g[p],n=1;u>=10;u/=10,n++);i%=h,o=i-h+n,y=o<0?0:l/b[n-o-1]%10|0}if(s=s||t<0||null!=g[p+1]||(o<0?l:l%b[n-o-1]),s=r<4?(y||s)&&(0==r||r==(e.s<0?3:2)):y>5||5==y&&(4==r||s||6==r&&(i>0?o>0?l/b[n-o]:0:g[p-1])%10&1||r==(e.s<0?8:7)),t<1||!g[0])return g.length=0,s?(t-=e.e+1,g[0]=b[(h-t%h)%h],e.e=-t||0):g[0]=e.e=0,e;if(0==i?(g.length=p,u=1,p--):(g.length=p+1,u=b[h-i],g[p]=o>0?c(l/b[n-o]%b[o])*u:0),s)for(;;){if(0==p){for(i=1,o=g[0];o>=10;o/=10,i++);for(o=g[0]+=u,u=1;o>=10;o/=10,u++);i!=u&&(e.e++,g[0]==d&&(g[0]=1));break}if(g[p]+=u,g[p]!=d)break;g[p--]=0,u=1}for(i=g.length;0===g[--i];g.pop());}e.e>O?e.c=e.e=null:e.e<P&&(e.c=[e.e=0])}return e}function V(e){var t,r=e.e;return null===r?e.toString():(t=w(e.c),t=r<=T||r>=k?S(t,r):I(t,r,"0"),e.s<0?"-"+t:t)}return M.clone=b,M.ROUND_UP=0,M.ROUND_DOWN=1,M.ROUND_CEIL=2,M.ROUND_FLOOR=3,M.ROUND_HALF_UP=4,M.ROUND_HALF_DOWN=5,M.ROUND_HALF_EVEN=6,M.ROUND_HALF_CEIL=7,M.ROUND_HALF_FLOOR=8,M.EUCLID=9,M.config=M.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(u+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(r=e[t],E(r,0,g,t),A=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(r=e[t],E(r,0,8,t),R=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&(r=e[t],r&&r.pop?(E(r[0],-g,0,t),E(r[1],0,g,t),T=r[0],k=r[1]):(E(r,-g,g,t),T=-(k=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if(r=e[t],r&&r.pop)E(r[0],-g,-1,t),E(r[1],1,g,t),P=r[0],O=r[1];else{if(E(r,-g,g,t),!r)throw Error(u+t+" cannot be zero: "+r);P=-(O=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if(r=e[t],r!==!!r)throw Error(u+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw N=!r,Error(u+"crypto unavailable");N=r}else N=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(r=e[t],E(r,0,9,t),D=r),e.hasOwnProperty(t="POW_PRECISION")&&(r=e[t],E(r,0,g,t),C=r),e.hasOwnProperty(t="FORMAT")){if(r=e[t],"object"!=typeof r)throw Error(u+t+" not an object: "+r);x=r}if(e.hasOwnProperty(t="ALPHABET")){if(r=e[t],"string"!=typeof r||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(u+t+" invalid: "+r);L=r}}return{DECIMAL_PLACES:A,ROUNDING_MODE:R,EXPONENTIAL_AT:[T,k],RANGE:[P,O],CRYPTO:N,MODULO_MODE:D,POW_PRECISION:C,FORMAT:x,ALPHABET:L}},M.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!M.DEBUG)return!0;var t,r,s=e.c,n=e.e,i=e.s;e:if("[object Array]"=={}.toString.call(s)){if((1===i||-1===i)&&n>=-g&&n<=g&&n===c(n)){if(0===s[0]){if(0===n&&1===s.length)return!0;break e}if(t=(n+1)%h,t<1&&(t+=h),String(s[0]).length==t){for(t=0;t<s.length;t++)if(r=s[t],r<0||r>=d||r!==c(r))break e;if(0!==r)return!0}}}else if(null===s&&null===n&&(null===i||1===i||-1===i))return!0;throw Error(u+"Invalid BigNumber: "+e)},M.maximum=M.max=function(){return U(arguments,n.lt)},M.minimum=M.min=function(){return U(arguments,n.gt)},M.random=function(){var e=9007199254740992,t=Math.random()*e&2097151?function(){return c(Math.random()*e)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(e){var r,s,n,o,l,d=0,p=[],y=new M(i);if(null==e?e=A:E(e,0,g),o=a(e/h),N)if(crypto.getRandomValues){for(r=crypto.getRandomValues(new Uint32Array(o*=2));d<o;)l=131072*r[d]+(r[d+1]>>>11),l>=9e15?(s=crypto.getRandomValues(new Uint32Array(2)),r[d]=s[0],r[d+1]=s[1]):(p.push(l%1e14),d+=2);d=o/2}else{if(!crypto.randomBytes)throw N=!1,Error(u+"crypto unavailable");for(r=crypto.randomBytes(o*=7);d<o;)l=281474976710656*(31&r[d])+1099511627776*r[d+1]+4294967296*r[d+2]+16777216*r[d+3]+(r[d+4]<<16)+(r[d+5]<<8)+r[d+6],l>=9e15?crypto.randomBytes(7).copy(r,d):(p.push(l%1e14),d+=7);d=o/7}if(!N)for(;d<o;)l=t(),l<9e15&&(p[d++]=l%1e14);for(o=p[--d],e%=h,o&&e&&(l=f[h-e],p[d]=c(o/l)*l);0===p[d];p.pop(),d--);if(d<0)p=[n=0];else{for(n=-1;0===p[0];p.splice(0,1),n-=h);for(d=1,l=p[0];l>=10;l/=10,d++);d<h&&(n-=h-d)}return y.e=n,y.c=p,y}}(),M.sum=function(){for(var e=1,t=arguments,r=new M(t[0]);e<t.length;)r=r.plus(t[e++]);return r},r=function(){var e="0123456789";function r(e,t,r,s){for(var n,i,o=[0],a=0,c=e.length;a<c;){for(i=o.length;i--;o[i]*=t);for(o[0]+=s.indexOf(e.charAt(a++)),n=0;n<o.length;n++)o[n]>r-1&&(null==o[n+1]&&(o[n+1]=0),o[n+1]+=o[n]/r|0,o[n]%=r)}return o.reverse()}return function(s,n,i,o,a){var c,u,l,d,h,p,f,y,g=s.indexOf("."),b=A,m=R;for(g>=0&&(d=C,C=0,s=s.replace(".",""),y=new M(n),p=y.pow(s.length-g),C=d,y.c=r(I(w(p.c),p.e,"0"),10,i,e),y.e=y.c.length),f=r(s,n,i,a?(c=L,e):(c=e,L)),l=d=f.length;0==f[--d];f.pop());if(!f[0])return c.charAt(0);if(g<0?--l:(p.c=f,p.e=l,p.s=o,p=t(p,y,b,m,i),f=p.c,h=p.r,l=p.e),u=l+b+1,g=f[u],d=i/2,h=h||u<0||null!=f[u+1],h=m<4?(null!=g||h)&&(0==m||m==(p.s<0?3:2)):g>d||g==d&&(4==m||h||6==m&&1&f[u-1]||m==(p.s<0?8:7)),u<1||!f[0])s=h?I(c.charAt(1),-b,c.charAt(0)):c.charAt(0);else{if(f.length=u,h)for(--i;++f[--u]>i;)f[u]=0,u||(++l,f=[1].concat(f));for(d=f.length;!f[--d];);for(g=0,s="";g<=d;s+=c.charAt(f[g++]));s=I(s,l,c.charAt(0))}return s}}(),t=function(){function e(e,t,r){var s,n,i,o,a=0,c=e.length,u=t%y,l=t/y|0;for(e=e.slice();c--;)i=e[c]%y,o=e[c]/y|0,s=l*i+o*u,n=u*i+s%y*y+a,a=(n/r|0)+(s/y|0)+l*o,e[c]=n%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,s){var n,i;if(r!=s)i=r>s?1:-1;else for(n=i=0;n<r;n++)if(e[n]!=t[n]){i=e[n]>t[n]?1:-1;break}return i}function r(e,t,r,s){for(var n=0;r--;)e[r]-=n,n=e[r]<t[r]?1:0,e[r]=n*s+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(s,n,i,o,a){var u,l,p,f,y,g,b,w,_,E,v,S,I,A,R,T,k,P=s.s==n.s?1:-1,O=s.c,N=n.c;if(!O||!O[0]||!N||!N[0])return new M(s.s&&n.s&&(O?!N||O[0]!=N[0]:N)?O&&0==O[0]||!N?0*P:P/0:NaN);for(w=new M(P),_=w.c=[],l=s.e-n.e,P=i+l+1,a||(a=d,l=m(s.e/h)-m(n.e/h),P=P/h|0),p=0;N[p]==(O[p]||0);p++);if(N[p]>(O[p]||0)&&l--,P<0)_.push(1),f=!0;else{for(A=O.length,T=N.length,p=0,P+=2,y=c(a/(N[0]+1)),y>1&&(N=e(N,y,a),O=e(O,y,a),T=N.length,A=O.length),I=T,E=O.slice(0,T),v=E.length;v<T;E[v++]=0);k=N.slice(),k=[0].concat(k),R=N[0],N[1]>=a/2&&R++;do{if(y=0,u=t(N,E,T,v),u<0){if(S=E[0],T!=v&&(S=S*a+(E[1]||0)),y=c(S/R),y>1){y>=a&&(y=a-1),g=e(N,y,a),b=g.length,v=E.length;while(1==t(g,E,b,v))y--,r(g,T<b?k:N,b,a),b=g.length,u=1}else 0==y&&(u=y=1),g=N.slice(),b=g.length;if(b<v&&(g=[0].concat(g)),r(E,g,v,a),v=E.length,-1==u)while(t(N,E,T,v)<1)y++,r(E,T<v?k:N,v,a),v=E.length}else 0===u&&(y++,E=[0]);_[p++]=y,E[0]?E[v++]=O[I]||0:(E=[O[I]],v=1)}while((I++<A||null!=E[0])&&P--);f=null!=E[0],_[0]||_.splice(0,1)}if(a==d){for(p=1,P=_[0];P>=10;P/=10,p++);F(w,i+(w.e=p+l*h-1)+1,o,f)}else w.e=l,w.r=+f;return w}}(),s=function(){var e=/^(-?)0([xbo])(?=\w[\w.]*$)/i,t=/^([^.]+)\.$/,r=/^\.([^.]+)$/,s=/^-?(Infinity|NaN)$/,n=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(i,o,a,c){var l,d=a?o:o.replace(n,"");if(s.test(d))i.s=isNaN(d)?null:d<0?-1:1;else{if(!a&&(d=d.replace(e,(function(e,t,r){return l="x"==(r=r.toLowerCase())?16:"b"==r?2:8,c&&c!=l?e:t})),c&&(l=c,d=d.replace(t,"$1").replace(r,"0.$1")),o!=d))return new M(d,l);if(M.DEBUG)throw Error(u+"Not a"+(c?" base "+c:"")+" number: "+o);i.s=null}i.c=i.e=null}}(),n.absoluteValue=n.abs=function(){var e=new M(this);return e.s<0&&(e.s=1),e},n.comparedTo=function(e,t){return _(this,new M(e,t))},n.decimalPlaces=n.dp=function(e,t){var r,s,n,i=this;if(null!=e)return E(e,0,g),null==t?t=R:E(t,0,8),F(new M(i),e+i.e+1,t);if(!(r=i.c))return null;if(s=((n=r.length-1)-m(this.e/h))*h,n=r[n])for(;n%10==0;n/=10,s--);return s<0&&(s=0),s},n.dividedBy=n.div=function(e,r){return t(this,new M(e,r),A,R)},n.dividedToIntegerBy=n.idiv=function(e,r){return t(this,new M(e,r),0,1)},n.exponentiatedBy=n.pow=function(e,t){var r,s,n,o,l,d,p,f,y,g=this;if(e=new M(e),e.c&&!e.isInteger())throw Error(u+"Exponent not an integer: "+V(e));if(null!=t&&(t=new M(t)),d=e.e>14,!g.c||!g.c[0]||1==g.c[0]&&!g.e&&1==g.c.length||!e.c||!e.c[0])return y=new M(Math.pow(+V(g),d?2-v(e):+V(e))),t?y.mod(t):y;if(p=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new M(NaN);s=!p&&g.isInteger()&&t.isInteger(),s&&(g=g.mod(t))}else{if(e.e>9&&(g.e>0||g.e<-1||(0==g.e?g.c[0]>1||d&&g.c[1]>=24e7:g.c[0]<8e13||d&&g.c[0]<=9999975e7)))return o=g.s<0&&v(e)?-0:0,g.e>-1&&(o=1/o),new M(p?1/o:o);C&&(o=a(C/h+2))}for(d?(r=new M(.5),p&&(e.s=1),f=v(e)):(n=Math.abs(+V(e)),f=n%2),y=new M(i);;){if(f){if(y=y.times(g),!y.c)break;o?y.c.length>o&&(y.c.length=o):s&&(y=y.mod(t))}if(n){if(n=c(n/2),0===n)break;f=n%2}else if(e=e.times(r),F(e,e.e+1,1),e.e>14)f=v(e);else{if(n=+V(e),0===n)break;f=n%2}g=g.times(g),o?g.c&&g.c.length>o&&(g.c.length=o):s&&(g=g.mod(t))}return s?y:(p&&(y=i.div(y)),t?y.mod(t):o?F(y,C,R,l):y)},n.integerValue=function(e){var t=new M(this);return null==e?e=R:E(e,0,8),F(t,t.e+1,e)},n.isEqualTo=n.eq=function(e,t){return 0===_(this,new M(e,t))},n.isFinite=function(){return!!this.c},n.isGreaterThan=n.gt=function(e,t){return _(this,new M(e,t))>0},n.isGreaterThanOrEqualTo=n.gte=function(e,t){return 1===(t=_(this,new M(e,t)))||0===t},n.isInteger=function(){return!!this.c&&m(this.e/h)>this.c.length-2},n.isLessThan=n.lt=function(e,t){return _(this,new M(e,t))<0},n.isLessThanOrEqualTo=n.lte=function(e,t){return-1===(t=_(this,new M(e,t)))||0===t},n.isNaN=function(){return!this.s},n.isNegative=function(){return this.s<0},n.isPositive=function(){return this.s>0},n.isZero=function(){return!!this.c&&0==this.c[0]},n.minus=function(e,t){var r,s,n,i,o=this,a=o.s;if(e=new M(e,t),t=e.s,!a||!t)return new M(NaN);if(a!=t)return e.s=-t,o.plus(e);var c=o.e/h,u=e.e/h,l=o.c,p=e.c;if(!c||!u){if(!l||!p)return l?(e.s=-t,e):new M(p?o:NaN);if(!l[0]||!p[0])return p[0]?(e.s=-t,e):new M(l[0]?o:3==R?-0:0)}if(c=m(c),u=m(u),l=l.slice(),a=c-u){for((i=a<0)?(a=-a,n=l):(u=c,n=p),n.reverse(),t=a;t--;n.push(0));n.reverse()}else for(s=(i=(a=l.length)<(t=p.length))?a:t,a=t=0;t<s;t++)if(l[t]!=p[t]){i=l[t]<p[t];break}if(i&&(n=l,l=p,p=n,e.s=-e.s),t=(s=p.length)-(r=l.length),t>0)for(;t--;l[r++]=0);for(t=d-1;s>a;){if(l[--s]<p[s]){for(r=s;r&&!l[--r];l[r]=t);--l[r],l[s]+=d}l[s]-=p[s]}for(;0==l[0];l.splice(0,1),--u);return l[0]?j(e,l,u):(e.s=3==R?-1:1,e.c=[e.e=0],e)},n.modulo=n.mod=function(e,r){var s,n,i=this;return e=new M(e,r),!i.c||!e.s||e.c&&!e.c[0]?new M(NaN):!e.c||i.c&&!i.c[0]?new M(i):(9==D?(n=e.s,e.s=1,s=t(i,e,0,3),e.s=n,s.s*=n):s=t(i,e,0,D),e=i.minus(s.times(e)),e.c[0]||1!=D||(e.s=i.s),e)},n.multipliedBy=n.times=function(e,t){var r,s,n,i,o,a,c,u,l,p,f,g,b,w,_,E=this,v=E.c,S=(e=new M(e,t)).c;if(!v||!S||!v[0]||!S[0])return!E.s||!e.s||v&&!v[0]&&!S||S&&!S[0]&&!v?e.c=e.e=e.s=null:(e.s*=E.s,v&&S?(e.c=[0],e.e=0):e.c=e.e=null),e;for(s=m(E.e/h)+m(e.e/h),e.s*=E.s,c=v.length,p=S.length,c<p&&(b=v,v=S,S=b,n=c,c=p,p=n),n=c+p,b=[];n--;b.push(0));for(w=d,_=y,n=p;--n>=0;){for(r=0,f=S[n]%_,g=S[n]/_|0,o=c,i=n+o;i>n;)u=v[--o]%_,l=v[o]/_|0,a=g*u+l*f,u=f*u+a%_*_+b[i]+r,r=(u/w|0)+(a/_|0)+g*l,b[i--]=u%w;b[i]=r}return r?++s:b.splice(0,1),j(e,b,s)},n.negated=function(){var e=new M(this);return e.s=-e.s||null,e},n.plus=function(e,t){var r,s=this,n=s.s;if(e=new M(e,t),t=e.s,!n||!t)return new M(NaN);if(n!=t)return e.s=-t,s.minus(e);var i=s.e/h,o=e.e/h,a=s.c,c=e.c;if(!i||!o){if(!a||!c)return new M(n/0);if(!a[0]||!c[0])return c[0]?e:new M(a[0]?s:0*n)}if(i=m(i),o=m(o),a=a.slice(),n=i-o){for(n>0?(o=i,r=c):(n=-n,r=a),r.reverse();n--;r.push(0));r.reverse()}for(n=a.length,t=c.length,n-t<0&&(r=c,c=a,a=r,t=n),n=0;t;)n=(a[--t]=a[t]+c[t]+n)/d|0,a[t]=d===a[t]?0:a[t]%d;return n&&(a=[n].concat(a),++o),j(e,a,o)},n.precision=n.sd=function(e,t){var r,s,n,i=this;if(null!=e&&e!==!!e)return E(e,1,g),null==t?t=R:E(t,0,8),F(new M(i),e,t);if(!(r=i.c))return null;if(n=r.length-1,s=n*h+1,n=r[n]){for(;n%10==0;n/=10,s--);for(n=r[0];n>=10;n/=10,s++);}return e&&i.e+1>s&&(s=i.e+1),s},n.shiftedBy=function(e){return E(e,-p,p),this.times("1e"+e)},n.squareRoot=n.sqrt=function(){var e,r,s,n,i,o=this,a=o.c,c=o.s,u=o.e,l=A+4,d=new M("0.5");if(1!==c||!a||!a[0])return new M(!c||c<0&&(!a||a[0])?NaN:a?o:1/0);if(c=Math.sqrt(+V(o)),0==c||c==1/0?(r=w(a),(r.length+u)%2==0&&(r+="0"),c=Math.sqrt(+r),u=m((u+1)/2)-(u<0||u%2),c==1/0?r="5e"+u:(r=c.toExponential(),r=r.slice(0,r.indexOf("e")+1)+u),s=new M(r)):s=new M(c+""),s.c[0])for(u=s.e,c=u+l,c<3&&(c=0);;)if(i=s,s=d.times(i.plus(t(o,i,l,1))),w(i.c).slice(0,c)===(r=w(s.c)).slice(0,c)){if(s.e<u&&--c,r=r.slice(c-3,c+1),"9999"!=r&&(n||"4999"!=r)){+r&&(+r.slice(1)||"5"!=r.charAt(0))||(F(s,s.e+A+2,1),e=!s.times(s).eq(o));break}if(!n&&(F(i,i.e+A+2,0),i.times(i).eq(o))){s=i;break}l+=4,c+=4,n=1}return F(s,s.e+A+1,R,e)},n.toExponential=function(e,t){return null!=e&&(E(e,0,g),e++),B(this,e,t,1)},n.toFixed=function(e,t){return null!=e&&(E(e,0,g),e=e+this.e+1),B(this,e,t)},n.toFormat=function(e,t,r){var s,n=this;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=x;else if("object"!=typeof r)throw Error(u+"Argument not an object: "+r);if(s=n.toFixed(e,t),n.c){var i,o=s.split("."),a=+r.groupSize,c=+r.secondaryGroupSize,l=r.groupSeparator||"",d=o[0],h=o[1],p=n.s<0,f=p?d.slice(1):d,y=f.length;if(c&&(i=a,a=c,c=i,y-=i),a>0&&y>0){for(i=y%a||a,d=f.substr(0,i);i<y;i+=a)d+=l+f.substr(i,a);c>0&&(d+=l+f.slice(i)),p&&(d="-"+d)}s=h?d+(r.decimalSeparator||"")+((c=+r.fractionGroupSize)?h.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):h):d}return(r.prefix||"")+s+(r.suffix||"")},n.toFraction=function(e){var r,s,n,o,a,c,l,d,p,y,g,b,m=this,_=m.c;if(null!=e&&(l=new M(e),!l.isInteger()&&(l.c||1!==l.s)||l.lt(i)))throw Error(u+"Argument "+(l.isInteger()?"out of range: ":"not an integer: ")+V(l));if(!_)return new M(m);for(r=new M(i),p=s=new M(i),n=d=new M(i),b=w(_),a=r.e=b.length-m.e-1,r.c[0]=f[(c=a%h)<0?h+c:c],e=!e||l.comparedTo(r)>0?a>0?r:p:l,c=O,O=1/0,l=new M(b),d.c[0]=0;;){if(y=t(l,r,0,1),o=s.plus(y.times(n)),1==o.comparedTo(e))break;s=n,n=o,p=d.plus(y.times(o=p)),d=o,r=l.minus(y.times(o=r)),l=o}return o=t(e.minus(s),n,0,1),d=d.plus(o.times(p)),s=s.plus(o.times(n)),d.s=p.s=m.s,a*=2,g=t(p,n,a,R).minus(m).abs().comparedTo(t(d,s,a,R).minus(m).abs())<1?[p,n]:[d,s],O=c,g},n.toNumber=function(){return+V(this)},n.toPrecision=function(e,t){return null!=e&&E(e,1,g),B(this,e,t,2)},n.toString=function(e){var t,s=this,n=s.s,i=s.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(null==e?t=i<=T||i>=k?S(w(s.c),i):I(w(s.c),i,"0"):10===e?(s=F(new M(s),A+i+1,R),t=I(w(s.c),s.e,"0")):(E(e,2,L.length,"Base"),t=r(I(w(s.c),i,"0"),10,e,n,!0)),n<0&&s.c[0]&&(t="-"+t)),t},n.valueOf=n.toJSON=function(){return V(this)},n._isBigNumber=!0,null!=e&&M.set(e),M}function m(e){var t=0|e;return e>0||e===t?t:t-1}function w(e){for(var t,r,s=1,n=e.length,i=e[0]+"";s<n;){for(t=e[s++]+"",r=h-t.length;r--;t="0"+t);i+=t}for(n=i.length;48===i.charCodeAt(--n););return i.slice(0,n+1||1)}function _(e,t){var r,s,n=e.c,i=t.c,o=e.s,a=t.s,c=e.e,u=t.e;if(!o||!a)return null;if(r=n&&!n[0],s=i&&!i[0],r||s)return r?s?0:-a:o;if(o!=a)return o;if(r=o<0,s=c==u,!n||!i)return s?0:!n^r?1:-1;if(!s)return c>u^r?1:-1;for(a=(c=n.length)<(u=i.length)?c:u,o=0;o<a;o++)if(n[o]!=i[o])return n[o]>i[o]^r?1:-1;return c==u?0:c>u^r?1:-1}function E(e,t,r,s){if(e<t||e>r||e!==c(e))throw Error(u+(s||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function v(e){var t=e.c.length-1;return m(e.e/h)==t&&e.c[t]%2!=0}function S(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function I(e,t,r){var s,n;if(t<0){for(n=r+".";++t;n+=r);e=n+e}else if(s=e.length,++t>s){for(n=r,t-=s;--t;n+=r);e+=n}else t<s&&(e=e.slice(0,t)+"."+e.slice(t));return e}i=b(),i["default"]=i.BigNumber=i,s=function(){return i}.call(t,r,t,e),void 0===s||(e.exports=s)})()},9075:function(e,t,r){"use strict";const{Key:s}=r("1304"),{default:n}=r("987e"),i=r("eef9"),o=r("64f9"),a=r("b6aa"),c=r("0d05"),u=r("9b62"),l=r("d46b"),{hasWithFallback:d,getWithFallback:h}=r("d268"),p=new s("config");e.exports=e=>{const t=new n({concurrency:1}),r={async getAll(t={}){const r=await h(p,e.get.bind(e),e.has.bind(e),e,{signal:t.signal});return JSON.parse(u(r))},async get(e,t={}){if(null==e)throw new c.NotFoundError(`Key ${e} does not exist in config`);const r=await this.getAll(t),s=i(r,e);if(void 0===s)throw new c.NotFoundError(`Key ${e} does not exist in config`);return s},set(e,r,n={}){if("string"!==typeof e&&!(e instanceof String))throw a(new Error("Invalid key type: "+typeof e),"ERR_INVALID_KEY");if(void 0===r||r instanceof Uint8Array)throw a(new Error("Invalid value type: "+typeof r),"ERR_INVALID_VALUE");return t.add(()=>s({key:e,value:r},n.signal))},replace(e,r={}){if(!e||e instanceof Uint8Array)throw a(new Error("Invalid value type: "+typeof e),"ERR_INVALID_VALUE");return t.add(()=>s({key:void 0,value:e},r.signal))},async exists(){return d(p,e.has.bind(e),e)}};return r;async function s(e,t){if(t&&t.aborted)return;const s=e.key,n=e.value;if(s){const e=await r.getAll();return"object"===typeof e&&null!==e&&o(e,s,n),f(e)}return f(n)}function f(t){const r=l(JSON.stringify(t,null,2));return e.put(p,r)}}},"910b":function(e,t,r){"use strict";const{NotStartedError:s,AlreadyStartingError:n,AlreadyStartedError:i}=r("fabb"),{withTimeout:o}=r("4d04");class a{static create({start:e,stop:t}){return new a(e,t)}static async start(e,t){const{state:r,activate:s}=e;switch(r.status){case"stopped":try{const r=s(t);e.state={status:"starting",ready:r};const n=await r;return e.state={status:"started",value:n},n}catch(o){throw e.state={status:"stopped"},o}case"starting":throw new n;case"started":throw new i;case"stopping":return await r.ready,await a.start(e,t);default:return a.panic(e)}}static async stop(e){const{state:t,deactivate:r}=e;switch(t.status){case"stopped":break;case"starting":try{await t.ready}catch(s){}return await a.stop(e);case"stopping":return await t.ready;case"started":r&&await r(t.value),e.state={status:"stopped"};break;default:a.panic(t)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},t){switch(e.status){case"started":return e.value;case"starting":return await o(e.ready,t);default:throw new s}}static panic({state:e}){const t=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${t}, should never happen if you see this please report a bug`)}constructor(e,t){this.activate=e,this.deactivate=t,this.state={status:"stopped"}}async use(e){return await a.use(this,e)}try(){return a.try(this)}}e.exports=a},9198:function(e,t,r){"use strict";const s=r("5aab"),n=r("73fb"),i=r("a9f4");e.exports=e=>{const t=i.logger(e.peerId,"rpc:find-node");async function r(r,i){let o;t("start"),o=s(i.key,e.peerId.id)?[{id:e.peerId,multiaddrs:e.libp2p.multiaddrs}]:await e._betterPeersToQuery(i,r);const a=new n(i.type,new Uint8Array(0),i.clusterLevel);return o.length>0?a.closerPeers=o:t("handle FindNode %s: could not find anything",r.toB58String()),a}return r}},"91b9":function(e,t,r){"use strict";const s=r("d277"),n=r("191e"),i=r("f7ff"),o=r("78b93");class a{constructor({blockService:e,preload:t,gcLock:r,pinManager:a,pin:c}){this.get=s({blockService:e,preload:t}),this.put=n({blockService:e,preload:t,gcLock:r,pin:c}),this.rm=i({blockService:e,gcLock:r,pinManager:a}),this.stat=o({blockService:e,preload:t})}}e.exports=a},"91cd":function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:keychain"),{error:s("libp2p:keychain:err")}),i=r("d9a5"),o=r("4fcb"),a=r("ff5f"),{Key:c}=r("1304"),u=r("f9b9"),l=r("b6aa"),d=r("9b62"),h=r("d46b");r("531e");const p="/pkcs8/",f="/info/",y=new WeakMap,g={minKeyLength:14,minSaltLength:16,minIterationCount:1e3},b={dek:{keyLength:64,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function m(e){return!!e&&("string"===typeof e&&e===i(e.trim()))}async function w(e){const t=200,r=1e3,s=Math.random()*(r-t)+t;throw await new Promise(e=>setTimeout(e,s)),e}function _(e){return new c(p+e)}function E(e){return new c(f+e)}class v{constructor(e,t){if(!e)throw new Error("store is required");if(this.store=e,this.opts=o(b,t),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<g.minKeyLength)throw new Error(`dek.keyLength must be least ${g.minKeyLength} bytes`);if(this.opts.dek.salt.length<g.minSaltLength)throw new Error(`dek.saltLength must be least ${g.minSaltLength} bytes`);if(this.opts.dek.iterationCount<g.minIterationCount)throw new Error("dek.iterationCount must be least "+g.minIterationCount);const r=this.opts.pass?a.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";y.set(this,{dek:r})}get cms(){return new u(this,y.get(this).dek)}static generateOptions(){const e=Object.assign({},b),t=3*Math.ceil(g.minSaltLength/3);return e.dek.salt=d(a.randomBytes(t),"base64"),e}static get options(){return b}async createKey(e,t,r=2048){const s=this;if(!m(e)||"self"===e)return w(l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if("string"!==typeof t)return w(l(new Error(`Invalid key type '${t}'`),"ERR_INVALID_KEY_TYPE"));const n=_(e),i=await s.store.has(n);if(i)return w(l(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));switch(t.toLowerCase()){case"rsa":if(!Number.isSafeInteger(r)||r<2048)return w(l(new Error("Invalid RSA key size "+r),"ERR_INVALID_KEY_SIZE"));break;default:break}let o;try{const i=await a.keys.generateKeyPair(t,r),c=await i.id(),u=y.get(this).dek,l=await i.export(u);o={name:e,id:c};const d=s.store.batch();d.put(n,h(l)),d.put(E(e),h(JSON.stringify(o))),await d.commit()}catch(c){return w(c)}return o}async listKeys(){const e=this,t={prefix:f},r=[];for await(const s of e.store.query(t))r.push(JSON.parse(d(s.value)));return r}async findKeyById(e){try{const t=await this.listKeys();return t.find(t=>t.id===e)}catch(t){return w(t)}}async findKeyByName(e){if(!m(e))return w(l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));const t=E(e);try{const e=await this.store.get(t);return JSON.parse(d(e))}catch(r){return w(l(new Error(`Key '${e}' does not exist. ${r.message}`),"ERR_KEY_NOT_FOUND"))}}async removeKey(e){const t=this;if(!m(e)||"self"===e)return w(l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));const r=_(e),s=await t.findKeyByName(e),n=t.store.batch();return n.delete(r),n.delete(E(e)),await n.commit(),s}async renameKey(e,t){const r=this;if(!m(e)||"self"===e)return w(l(new Error(`Invalid old key name '${e}'`),"ERR_OLD_KEY_NAME_INVALID"));if(!m(t)||"self"===t)return w(l(new Error(`Invalid new key name '${t}'`),"ERR_NEW_KEY_NAME_INVALID"));const s=_(e),n=_(t),i=E(e),o=E(t),a=await r.store.has(n);if(a)return w(l(new Error(`Key '${t}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{const e=await r.store.get(s),a=await r.store.get(i),c=JSON.parse(d(a));c.name=t;const u=r.store.batch();return u.put(n,e),u.put(o,h(JSON.stringify(c))),u.delete(s),u.delete(i),await u.commit(),c}catch(c){return w(c)}}async exportKey(e,t){if(!m(e))return w(l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t)return w(l(new Error("Password is required"),"ERR_PASSWORD_REQUIRED"));const r=_(e);try{const e=await this.store.get(r),s=d(e),n=y.get(this).dek,i=await a.keys.import(s,n);return i.export(t)}catch(s){return w(s)}}async importKey(e,t,r){const s=this;if(!m(e)||"self"===e)return w(l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t)return w(l(new Error("PEM encoded key is required"),"ERR_PEM_REQUIRED"));const n=_(e),i=await s.store.has(n);if(i)return w(l(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));let o,c;try{o=await a.keys.import(t,r)}catch(p){return w(l(new Error("Cannot read the key, most likely the password is wrong"),"ERR_CANNOT_READ_KEY"))}try{c=await o.id();const e=y.get(this).dek;t=await o.export(e)}catch(p){return w(p)}const u={name:e,id:c},d=s.store.batch();return d.put(n,h(t)),d.put(E(e),h(JSON.stringify(u))),await d.commit(),u}async importPeer(e,t){const r=this;if(!m(e))return w(l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t||!t.privKey)return w(l(new Error("Peer.privKey is required"),"ERR_MISSING_PRIVATE_KEY"));const s=t.privKey,n=_(e),i=await r.store.has(n);if(i)return w(l(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{const t=await s.id(),i=y.get(this).dek,o=await s.export(i),a={name:e,id:t},c=r.store.batch();return c.put(n,h(o)),c.put(E(e),h(JSON.stringify(a))),await c.commit(),a}catch(o){return w(o)}}async _getPrivateKey(e){if(!m(e))return w(l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));try{const t=_(e),r=await this.store.get(t);return d(r)}catch(t){return w(l(new Error(`Key '${e}' does not exist. ${t.message}`),"ERR_KEY_NOT_FOUND"))}}async rotateKeychainPass(e,t){if("string"!==typeof e)return w(l(new Error(`Invalid old pass type '${typeof e}'`),"ERR_INVALID_OLD_PASS_TYPE"));if("string"!==typeof t)return w(l(new Error(`Invalid new pass type '${typeof t}'`),"ERR_INVALID_NEW_PASS_TYPE"));if(t.length<20)return w(l(new Error("Invalid pass length "+t.length),"ERR_INVALID_PASS_LENGTH"));n("recreating keychain");const r=y.get(this).dek;this.opts.pass=t;const s=t?a.pbkdf2(t,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";y.set(this,{dek:s});const i=await this.listKeys();for(const n of i){const e=await this.store.get(_(n.name)),t=d(e),i=await a.keys.import(t,r),o=s.toString(),c=await i.export(o),u=this.store.batch(),l={name:n.name,id:n.id};u.put(_(n.name),h(c)),u.put(E(n.name),h(JSON.stringify(l))),await u.commit()}n("keychain reconstructed")}}e.exports=v},"91d3":function(e,t,r){"use strict";const{AbortController:s,AbortSignal:n}="undefined"!==typeof self?self:"undefined"!==typeof window?window:void 0;e.exports=s,e.exports.AbortSignal=n,e.exports.default=s},"92b9":function(e,t,r){"use strict";e.exports={Record:r("d4c1"),validator:r("65d4"),selection:r("653e")}},"92dc":function(e,t,r){"use strict";const s=r("bbbe"),{pipe:n}=r("66f2"),i=r("c31e"),o=r("c597"),a=r("2a9c"),c=r("ce74").logger,u="/ipfs/bitswap/1.0.0",l="/ipfs/bitswap/1.1.0",d="/ipfs/bitswap/1.2.0";class h{constructor(e,t,r,s={}){this._log=c(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[u],s.b100Only||(this._protocols.unshift(l),this._protocols.unshift(d)),this._stats=r,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this)}start(){this._running=!0,this._libp2p.handle(this._protocols,this._onConnection);const e=new i({multicodecs:this._protocols,handlers:{onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect}});this._registrarId=this._libp2p.registrar.register(e);for(const t of this._libp2p.peerStore.peers.values()){const e=this._libp2p.connectionManager.get(t.id);e&&this._onPeerConnect(e.remotePeer)}}stop(){this._running=!1,this._libp2p.unhandle(this._protocols),null!=this._registrarId&&this._libp2p.registrar.unregister(this._registrarId)}async _onConnection({protocol:e,stream:t,connection:r}){if(this._running){this._log("incoming new bitswap %s connection from %s",e,r.remotePeer.toB58String());try{await n(t,s.decode(),async e=>{for await(const s of e)try{const e=await o.deserialize(s.slice());await this._bitswap._receiveMessage(r.remotePeer,e)}catch(t){this._bitswap._receiveError(t);break}})}catch(i){this._log(i)}}}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t,r={}){return this._libp2p.contentRouting.findProviders(e,{maxTimeout:a.providerRequestTimeout,maxNumProviders:t,signal:r.signal})}async findAndConnect(e,t){const r=[];for await(const s of this.findProviders(e,a.maxProvidersPerRequest,t))this._log("connecting to provider "+s.id),r.push(this.connectTo(s.id,t).catch(e=>{this._log.error(e)}));await Promise.all(r)}async provide(e,t){await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t){if(!this._running)throw new Error("network isn't running");const r=e.toB58String();this._log("sendMessage to %s",r,t);const s=await this._libp2p.dial(e),{stream:n,protocol:i}=await s.newStream([d,l,u]);let o;switch(i){case u:o=t.serializeToBitswap100();break;case l:case d:o=t.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+i)}p(n,o,this._log),this._updateSentStats(e,t.blocks)}async connectTo(e,t){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,t)}_updateSentStats(e,t){const r=e.toB58String();this._stats&&(t.forEach(e=>this._stats.push(r,"dataSent",e.data.length)),this._stats.push(r,"blocksSent",t.size))}}async function p(e,t,r){try{await n([t],s.encode(),e)}catch(i){r(i)}}e.exports=h},"936e":function(e,t,r){"use strict";const s=r("910b");e.exports=({network:e,preload:t,blockService:r,ipns:n,repo:i,mfsPreload:o})=>{const a=async()=>{r.unsetExchange(),await Promise.all([t.stop(),n.stop(),o.stop(),s.stop(e),i.close()])};return a}},"93cf":function(e,t,r){"use strict";const{exporter:s}=r("d6d7"),n=r("4fcb").bind({ignoreUndefined:!0}),i=r("aaf7"),o=r("b6aa"),a=r("a29d"),c={offset:0,length:1/0};e.exports=e=>{function t(t,r={}){return r=n(c,r),{[Symbol.asyncIterator]:async function*(){const n=await i(e,t,r),a=await s(n.mfsPath,e.ipld);if("file"!==a.type)throw o(new Error(t+" was not a file"),"ERR_NOT_FILE");if(!a.content)throw o(new Error("Could not load content stream from "+t),"ERR_NO_CONTENT");for await(const e of a.content({offset:r.offset,length:r.length}))yield e}}}return a(t)}},"93e7":function(e,t,r){"use strict";const s=r("ea84"),{default:n}=r("987e"),i=r("670b"),o=new s(1e3),a=6e4,c=new n({concurrency:4}),u=e=>{if(e.Path)return e.Path;throw new Error(e.Message)};e.exports=async(e,t)=>{const r=async(e,t={})=>{const r=new URLSearchParams(t);r.set("arg",e);const s=r.toString();if(!t.nocache&&o.has(s)){const e=o.get(s);return u(e)}const n=await c.add(async()=>{const e=await i.get("https://ipfs.io/api/v0/dns",{searchParams:r}),t=new URL(e.url).search.slice(1),s=await e.json();return o.set(t,s,a),s});return u(n)};return r(e,t)}},"93ff":function(e,t,r){"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?e.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:e.exports={default:r("d7b4").default,Headers:r("d7b4").Headers,Request:r("d7b4").Request,Response:r("d7b4").Response}},9410:function(e,t,r){"use strict";const s=async e=>{for await(const t of e)return t};e.exports=s},9495:function(e,t,r){"use strict";const s=r("e4e2"),n=r("31a1");async function*i(e,t,i={}){const o=n(i);let a,c,u;a="function"===typeof i.dagBuilder?i.dagBuilder:r("499b"),c="function"===typeof i.treeBuilder?i.treeBuilder:r("0f6c"),u=Symbol.asyncIterator in e||Symbol.iterator in e?e:[e];for await(const r of c(s(a(u,t,o),o.fileImportConcurrency),t,o))yield{cid:r.cid,path:r.path,unixfs:r.unixfs,size:r.size}}e.exports={importer:i}},"94bf":function(e,t,r){"use strict";const s=r("c449"),n=r("5d98"),i=r("0e80"),{multihash:o}=i,a=n.DAG_PB,c=o.names["sha2-256"],u=async(e,t={})=>{const r={cidVersion:null==t.cidVersion?1:t.cidVersion,hashAlg:null==t.hashAlg?c:t.hashAlg},u=o.codes[r.hashAlg],l=await i(e,u),d=n.getNameFromCode(a),h=new s(r.cidVersion,d,l);return h};e.exports={codec:a,defaultHashAlg:c,cid:u}},"94df":function(e,t,r){"use strict";const s=r("86d2"),n=r("8a37");e.exports=(e,t)=>{const r=s(e,{...t,count:1});return n.fn(async e=>{e(()=>{r.cancel()});const[t]=await r;return t})()},e.exports.AggregateError=s.AggregateError},"95ed8":function(e,t,r){"use strict";const s=r("a29d");e.exports=({keychain:e})=>{const t=(t,r)=>e.exportKey(t,r);return s(t)}},9632:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messageIdToString=void 0;const s=r("9b62");function n(e){return s(e,"base64")}t.messageIdToString=n},9640:function(e,t,r){"use strict";const s=r("9975");e.exports=({rmAll:e})=>(t,r={})=>s(e([{path:t,...r}],r))},"977f":function(e,t){e.exports=o;var r=128,s=127,n=~s,i=Math.pow(2,31);function o(e,t,s){if(Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw o.bytes=0,new RangeError("Could not encode varint");t=t||[],s=s||0;var a=s;while(e>=i)t[s++]=255&e|r,e/=128;while(e&n)t[s++]=255&e|r,e>>>=7;return t[s]=0|e,o.bytes=s-a+1,t}},"97da":function(e,t,r){"use strict";const s=r("b6aa"),n=r("d46b"),i=r("bac1"),o=r("c020"),a=r("a127"),c=r("41c5"),u=r("5d6d"),{isBytes:l,isReadableStream:d,isBlob:h}=r("abb1");async function*p(e){if(l(e))yield f(e);else if("string"===typeof e||e instanceof String)yield f(e.toString());else{if(!h(e)){if(d(e)&&(e=i(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=a(e),{value:r,done:s}=await t.peek();if(s)return void(yield*[]);if(t.push(r),Number.isInteger(r))return void(yield Uint8Array.from(await c(t)));if(l(r)||"string"===typeof r||r instanceof String)return void(yield*u(t,f))}throw s(new Error("Unexpected input: "+e),"ERR_UNEXPECTED_INPUT")}yield*o(e)}}function f(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Array.isArray(e)?Uint8Array.from(e):n(e.toString())}e.exports=p},9832:function(e,t,r){"use strict";e.exports={pk:r("3ade")}},9860:function(e,t,r){"use strict";e.exports={pk:r("388e")}},9888:function(e,t,r){"use strict";const s=r("4fcb").bind({ignoreUndefined:!0}),n=r("aaf7"),{exporter:i}=r("d6d7"),o=r("34eb")("ipfs:mfs:stat"),a=r("b6aa"),c=r("a29d"),u={withLocal:!1};e.exports=e=>{async function t(t,r={}){r=s(u,r),o("Fetching stats for "+t);const{type:c,cid:d,mfsPath:h}=await n(e,t,r),p="ipfs"===c&&d?d:h;let f;try{f=await i(p,e.ipld)}catch(y){if("ERR_NOT_FOUND"===y.code)throw a(new Error(t+" does not exist"),"ERR_NOT_FOUND");throw y}if(!l[f.type])throw new Error("Cannot stat codec "+f.cid.codec);return l[f.type](f)}return c(t)};const l={raw:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:e=>{const t={cid:e.cid,type:"file",size:e.unixfs.fileSize(),cumulativeSize:e.node.size,blocks:e.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:e.unixfs.mode};return e.unixfs.mtime&&(t.mtime=e.unixfs.mtime),t},directory:e=>{const t={cid:e.cid,type:"directory",size:0,cumulativeSize:e.node.size,blocks:e.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:e.unixfs.mode};return e.unixfs.mtime&&(t.mtime=e.unixfs.mtime),t},object:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})}},"989e":function(e,t,r){"use strict";const{URLWithLegacySupport:s,format:n,URLSearchParams:i,defaultBase:o}=r("9b7b"),a=r("dc99");e.exports={URL:s,URLSearchParams:i,format:n,relative:a,defaultBase:o}},9937:function(e,t,r){"use strict";const{EventEmitter:s}=r("faa1"),{Multiaddr:n}=r("2054");e.exports=e=>{const t=new Map;async function r(r){const s=String(r).split("/p2p-circuit").find(e=>""!==e),i=await e.dial(new n(s)),a=i.remoteAddr.encapsulate("/p2p-circuit");t.set(i.remotePeer.toB58String(),a),o.emit("listening")}function i(){const e=[];for(const r of t.values())e.push(r);return e}const o=Object.assign(new s,{close:()=>Promise.resolve(),listen:r,getAddrs:i});return e.connectionManager.on("peer:disconnect",e=>{const r=t.delete(e.remotePeer.toB58String());r&&o.emit("close")}),o}},9970:function(e,t,r){const s=r("faa1").EventEmitter,{nanoid:n}=r("e1bd"),{WORKER_REQUEST_READ_LOCK:i,WORKER_RELEASE_READ_LOCK:o,MASTER_GRANT_READ_LOCK:a,WORKER_REQUEST_WRITE_LOCK:c,WORKER_RELEASE_WRITE_LOCK:u,MASTER_GRANT_WRITE_LOCK:l}=r("8618"),d=r("2775"),h=(e,t,r,s,n)=>(i,o)=>{if(!o||!o.data||o.data.type!==r)return;const a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};e.emit(t,a.name,()=>(i.postMessage({type:n,name:a.name,identifier:a.identifier}),new Promise(e=>{const t=r=>{if(!r||!r.data)return;const n={type:r.data.type,name:r.data.name,identifier:r.data.identifier};n&&n.type===s&&n.identifier===a.identifier&&(i.removeEventListener("message",t),e())};i.addEventListener("message",t)})))},p=(e,t,r,s)=>()=>{const i=n();return globalThis.postMessage({type:t,identifier:i,name:e}),new Promise(t=>{const n=o=>{if(!o||!o.data)return;const a={type:o.data.type,identifier:o.data.identifier};a&&a.type===r&&a.identifier===i&&(globalThis.removeEventListener("message",n),t(()=>{globalThis.postMessage({type:s,identifier:i,name:e})}))};globalThis.addEventListener("message",n)})},f={singleProcess:!1};e.exports=e=>{e=Object.assign({},f,e);const t=!!globalThis.document||e.singleProcess;if(t){const e=new s;return d.addEventListener("message",h(e,"requestReadLock",i,o,a)),d.addEventListener("message",h(e,"requestWriteLock",c,u,l)),e}return{isWorker:!0,readLock:e=>p(e,i,a,o),writeLock:e=>p(e,c,l,u)}}},9975:function(e,t,r){"use strict";const s=async e=>{let t;for await(const r of e)t=r;return t};e.exports=s},"9aaa":function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["libp2p-pubsub-rpc"]||(s.roots["libp2p-pubsub-rpc"]={});a.RPC=function(){function e(e){if(this.subscriptions=[],this.msgs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.subscriptions=o.emptyArray,e.prototype.msgs=o.emptyArray,e.encode=function(e,t){if(t||(t=i.create()),null!=e.subscriptions&&e.subscriptions.length)for(var r=0;r<e.subscriptions.length;++r)a.RPC.SubOpts.encode(e.subscriptions[r],t.uint32(10).fork()).ldelim();if(null!=e.msgs&&e.msgs.length)for(r=0;r<e.msgs.length;++r)a.RPC.Message.encode(e.msgs[r],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.RPC;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(a.RPC.SubOpts.decode(e,e.uint32()));break;case 2:s.msgs&&s.msgs.length||(s.msgs=[]),s.msgs.push(a.RPC.Message.decode(e,e.uint32()));break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.RPC)return e;var t=new a.RPC;if(e.subscriptions){if(!Array.isArray(e.subscriptions))throw TypeError(".RPC.subscriptions: array expected");t.subscriptions=[];for(var r=0;r<e.subscriptions.length;++r){if("object"!==typeof e.subscriptions[r])throw TypeError(".RPC.subscriptions: object expected");t.subscriptions[r]=a.RPC.SubOpts.fromObject(e.subscriptions[r])}}if(e.msgs){if(!Array.isArray(e.msgs))throw TypeError(".RPC.msgs: array expected");t.msgs=[];for(r=0;r<e.msgs.length;++r){if("object"!==typeof e.msgs[r])throw TypeError(".RPC.msgs: object expected");t.msgs[r]=a.RPC.Message.fromObject(e.msgs[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.subscriptions=[],r.msgs=[]),e.subscriptions&&e.subscriptions.length){r.subscriptions=[];for(var s=0;s<e.subscriptions.length;++s)r.subscriptions[s]=a.RPC.SubOpts.toObject(e.subscriptions[s],t)}if(e.msgs&&e.msgs.length){r.msgs=[];for(s=0;s<e.msgs.length;++s)r.msgs[s]=a.RPC.Message.toObject(e.msgs[s],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.SubOpts=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.subscribe=!1,e.prototype.topicID="",e.encode=function(e,t){return t||(t=i.create()),null!=e.subscribe&&Object.hasOwnProperty.call(e,"subscribe")&&t.uint32(8).bool(e.subscribe),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(18).string(e.topicID),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.RPC.SubOpts;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.subscribe=e.bool();break;case 2:s.topicID=e.string();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.RPC.SubOpts)return e;var t=new a.RPC.SubOpts;return null!=e.subscribe&&(t.subscribe=Boolean(e.subscribe)),null!=e.topicID&&(t.topicID=String(e.topicID)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.subscribe=!1,r.topicID=""),null!=e.subscribe&&e.hasOwnProperty("subscribe")&&(r.subscribe=e.subscribe),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.Message=function(){function e(e){if(this.topicIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.from=o.newBuffer([]),e.prototype.data=o.newBuffer([]),e.prototype.seqno=o.newBuffer([]),e.prototype.topicIDs=o.emptyArray,e.prototype.signature=o.newBuffer([]),e.prototype.key=o.newBuffer([]),e.encode=function(e,t){if(t||(t=i.create()),null!=e.from&&Object.hasOwnProperty.call(e,"from")&&t.uint32(10).bytes(e.from),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),null!=e.seqno&&Object.hasOwnProperty.call(e,"seqno")&&t.uint32(26).bytes(e.seqno),null!=e.topicIDs&&e.topicIDs.length)for(var r=0;r<e.topicIDs.length;++r)t.uint32(34).string(e.topicIDs[r]);return null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(50).bytes(e.key),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.RPC.Message;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.from=e.bytes();break;case 2:s.data=e.bytes();break;case 3:s.seqno=e.bytes();break;case 4:s.topicIDs&&s.topicIDs.length||(s.topicIDs=[]),s.topicIDs.push(e.string());break;case 5:s.signature=e.bytes();break;case 6:s.key=e.bytes();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.RPC.Message)return e;var t=new a.RPC.Message;if(null!=e.from&&("string"===typeof e.from?o.base64.decode(e.from,t.from=o.newBuffer(o.base64.length(e.from)),0):e.from.length&&(t.from=e.from)),null!=e.data&&("string"===typeof e.data?o.base64.decode(e.data,t.data=o.newBuffer(o.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.seqno&&("string"===typeof e.seqno?o.base64.decode(e.seqno,t.seqno=o.newBuffer(o.base64.length(e.seqno)),0):e.seqno.length&&(t.seqno=e.seqno)),e.topicIDs){if(!Array.isArray(e.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");t.topicIDs=[];for(var r=0;r<e.topicIDs.length;++r)t.topicIDs[r]=String(e.topicIDs[r])}return null!=e.signature&&("string"===typeof e.signature?o.base64.decode(e.signature,t.signature=o.newBuffer(o.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),null!=e.key&&("string"===typeof e.key?o.base64.decode(e.key,t.key=o.newBuffer(o.base64.length(e.key)),0):e.key.length&&(t.key=e.key)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.topicIDs=[]),t.defaults&&(t.bytes===String?r.from="":(r.from=[],t.bytes!==Array&&(r.from=o.newBuffer(r.from))),t.bytes===String?r.data="":(r.data=[],t.bytes!==Array&&(r.data=o.newBuffer(r.data))),t.bytes===String?r.seqno="":(r.seqno=[],t.bytes!==Array&&(r.seqno=o.newBuffer(r.seqno))),t.bytes===String?r.signature="":(r.signature=[],t.bytes!==Array&&(r.signature=o.newBuffer(r.signature))),t.bytes===String?r.key="":(r.key=[],t.bytes!==Array&&(r.key=o.newBuffer(r.key)))),null!=e.from&&e.hasOwnProperty("from")&&(r.from=t.bytes===String?o.base64.encode(e.from,0,e.from.length):t.bytes===Array?Array.prototype.slice.call(e.from):e.from),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?o.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),null!=e.seqno&&e.hasOwnProperty("seqno")&&(r.seqno=t.bytes===String?o.base64.encode(e.seqno,0,e.seqno.length):t.bytes===Array?Array.prototype.slice.call(e.seqno):e.seqno),e.topicIDs&&e.topicIDs.length){r.topicIDs=[];for(var s=0;s<e.topicIDs.length;++s)r.topicIDs[s]=e.topicIDs[s]}return null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?o.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature),null!=e.key&&e.hasOwnProperty("key")&&(r.key=t.bytes===String?o.base64.encode(e.key,0,e.key.length):t.bytes===Array?Array.prototype.slice.call(e.key):e.key),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e}(),e.exports=a},"9b0c":function(e,t,r){"use strict";const s=r("0f68"),n=r("a29d"),{Multiaddr:i}=r("2054");e.exports=({repo:e})=>{async function t(t={}){const r=await e.config.getAll(t);return r.Bootstrap=s().Bootstrap,await e.config.replace(r),{Peers:s().Bootstrap.map(e=>new i(e))}}return n(t)}},"9b56":function(e,t,r){"use strict";e.exports={...r("2786")}},"9b62f":function(e,t,r){"use strict";const s=r("c449"),n=r("c597"),i=n.WantType,o=r("637e"),a=r("8e23"),c=r("7c84"),u=r("26f6"),{logger:l}=r("ce74"),d=16384,h=1024;class p{constructor(e,t,r,s,n={}){this._log=l(e,"engine"),this.blockstore=t,this.network=r,this._stats=s,this._opts=this._processOpts(n),this.ledgerMap=new Map,this._running=!1,this._requestQueue=new c(u)}_processOpts(e){return{maxSizeReplaceHasWithBlock:h,targetMessageSize:d,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;const{peerId:e,tasks:t,pendingSize:r}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(0===t.length)return;const i=new n(!1);i.setPendingBytes(r);const o=[],a=new Map;for(const n of t){const e=new s(n.topic);n.data.haveBlock?n.data.isWantBlock?(o.push(e),a.set(n.topic,n.data)):i.addHave(e):i.addDontHave(e)}const c=await this._getBlocks(o);for(const[n,l]of a){const e=c.get(n);if(e)i.addBlock(e);else if(l.sendDontHave){const e=new s(n);i.addDontHave(e)}}if(i.empty)return e&&this._requestQueue.tasksDone(e,t),void this._scheduleProcessTasks();try{e&&await this.network.sendMessage(e,i);for(const t of c.values())e&&this.messageSent(e,t)}catch(u){this._log.error(u)}e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){const t=e.toB58String(),r=this.ledgerMap.get(t);return r?r.wantlist.sortedEntries():new Map}ledgerForPeer(e){const t=e.toB58String(),r=this.ledgerMap.get(t);return r?{peer:r.partner.toPrint(),value:r.debtRatio(),sent:r.accounting.bytesSent,recv:r.accounting.bytesRecv,exchanged:r.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){e.length&&(this.ledgerMap.forEach(t=>{e.forEach(e=>{const r=t.wantlistContains(e.cid);if(!r)return;const s=e.data.length,i=this._sendAsBlock(r.wantType,s);let o=s;i||(o=n.blockPresenceSize(r.cid)),this._requestQueue.pushTasks(t.partner,[{topic:r.cid.toString(),priority:r.priority,size:o,data:{blockSize:s,isWantBlock:i,haveBlock:!0,sendDontHave:!1}}])})}),this._scheduleProcessTasks())}async messageReceived(e,t){const r=this._findOrCreate(e);if(t.empty)return;if(t.full&&(r.wantlist=new o),this._updateBlockAccounting(t.blocks,r),0===t.wantlist.size)return void this._scheduleProcessTasks();const s=[],n=[];t.wantlist.forEach(e=>{e.cancel?(r.cancelWant(e.cid),s.push(e.cid)):(r.wants(e.cid,e.priority,e.wantType),n.push(e))}),this._cancelWants(e,s),await this._addWants(e,n),this._scheduleProcessTasks()}_cancelWants(e,t){for(const r of t)this._requestQueue.remove(r.toString(),e)}async _addWants(e,t){const r=await this._getBlockSizes(t.map(e=>e.cid)),s=[];for(const o of t){const t=o.cid.toString(),a=r.get(t);if(null==a)o.sendDontHave&&s.push({topic:t,priority:o.priority,size:n.blockPresenceSize(o.cid),data:{isWantBlock:o.wantType===i.Block,blockSize:0,haveBlock:!1,sendDontHave:o.sendDontHave}});else{const e=this._sendAsBlock(o.wantType,a);let r=a;e||(r=n.blockPresenceSize(o.cid)),s.push({topic:t,priority:o.priority,size:r,data:{isWantBlock:e,blockSize:a,haveBlock:!0,sendDontHave:o.sendDontHave}})}this._requestQueue.pushTasks(e,s)}}_sendAsBlock(e,t){return e===i.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){const t=await this._getBlocks(e);return new Map([...t].map(([e,t])=>[e,t.data.length]))}async _getBlocks(e){const t=new Map;return await Promise.all(e.map(async e=>{try{const r=await this.blockstore.get(e);t.set(e.toString(),r)}catch(r){"ERR_NOT_FOUND"!==r.code&&this._log.error("failed to query blockstore for %s: %s",e,r)}})),t}_updateBlockAccounting(e,t){e.forEach(e=>{this._log("got block (%s bytes)",e.data.length),t.receivedBytes(e.data.length)})}messageSent(e,t){const r=this._findOrCreate(e);r.sentBytes(t?t.data.length:0),t&&t.cid&&r.wantlist.remove(t.cid)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){}_findOrCreate(e){const t=e.toB58String(),r=this.ledgerMap.get(t);if(r)return r;const s=new a(e);return this.ledgerMap.set(t,s),this._stats&&this._stats.push(t,"peerCount",1),s}start(){this._running=!0}stop(){this._running=!1}}e.exports=p},"9b7b":function(e,t,r){"use strict";const s=self.location?self.location.protocol+"//"+self.location.host:"",n=self.URL;class i{constructor(e="",t=s){this.super=new n(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set origin(e){this.super.origin=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set searchParams(e){this.super.searchParams=e}set username(e){this.super.username=e}createObjectURL(e){return this.super.createObjectURL(e)}revokeObjectURL(e){this.super.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}}function o(e){if("string"===typeof e){const t=new n(e);return t.toString()}if(!(e instanceof n)){const t=e.username&&e.password?`${e.username}:${e.password}@`:"",r=e.auth?e.auth+"@":"",s=e.port?":"+e.port:"",n=e.protocol?e.protocol+"//":"",i=e.host||"",o=e.hostname||"",a=e.search||(e.query?"?"+e.query:""),c=e.hash||"",u=e.pathname||"",l=e.path||u+a;return`${n}${t||r}${i||o+s}${l}${c}`}}e.exports={URLWithLegacySupport:i,URLSearchParams:self.URLSearchParams,defaultBase:s,format:o}},"9c22":function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:dialer"),{error:s("libp2p:dialer:err")}),i=r("b6aa"),{Multiaddr:o}=r("2054"),a=r("41c6"),{AbortError:c}=r("72af"),{anySignal:u}=r("74fd"),l=r("dbaa"),{publicAddressesFirst:d}=r("b0c7"),h=r("08c7"),{codes:p}=r("b73a"),{DIAL_TIMEOUT:f,MAX_PARALLEL_DIALS:y,MAX_PER_PEER_DIALS:g}=r("7df1");class b{constructor({transportManager:e,peerStore:t,addressSorter:r=d,maxParallelDials:s=y,dialTimeout:n=f,maxDialsPerPeer:i=g,resolvers:a={}}){this.transportManager=e,this.peerStore=t,this.addressSorter=r,this.maxParallelDials=s,this.timeout=n,this.maxDialsPerPeer=i,this.tokens=[...new Array(s)].map((e,t)=>t),this._pendingDials=new Map,this._pendingDialTargets=new Map;for(const[c,u]of Object.entries(a))o.resolvers.set(c,u)}destroy(){for(const t of this._pendingDials.values())try{t.controller.abort()}catch(e){n.error(e)}this._pendingDials.clear();for(const t of this._pendingDialTargets.values())t.reject(new c("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,t={}){const r=await this._createCancellableDialTarget(e);if(!r.addrs.length)throw i(new Error("The dial request has no valid addresses"),p.ERR_NO_VALID_ADDRESSES);const s=this._pendingDials.get(r.id)||this._createPendingDial(r,t);try{const e=await s.promise;return n("dial succeeded to %s",r.id),e}catch(o){throw s.controller.signal.aborted&&(o.code=p.ERR_TIMEOUT),n.error(o),o}finally{s.destroy()}}async _createCancellableDialTarget(e){const t=""+(parseInt(String(1e9*Math.random()),10).toString()+Date.now()),r=new Promise((e,r)=>{this._pendingDialTargets.set(t,{resolve:e,reject:r})}),s=await Promise.race([this._createDialTarget(e),r]);return this._pendingDialTargets.delete(t),s}async _createDialTarget(e){const{id:t,multiaddrs:r}=h(e);r&&this.peerStore.addressBook.add(t,r);let s=this.peerStore.addressBook.getMultiaddrsForPeer(t,this.addressSorter)||[];o.isMultiaddr(e)&&(s=s.filter(t=>!e.equals(t)),s.unshift(e));const n=[];for(const o of s){const e=await this._resolve(o);e.forEach(e=>n.push(e))}const i=n.filter(e=>this.transportManager.transportForMultiaddr(e));return{id:t.toB58String(),addrs:i}}_createPendingDial(e,t={}){const r=(e,t)=>{if(t.signal.aborted)throw i(new Error("already aborted"),p.ERR_ALREADY_ABORTED);return this.transportManager.dial(e,t)},s=new l({addrs:e.addrs,dialAction:r,dialer:this}),n=new a(this.timeout),o=[n.signal];t.signal&&o.push(t.signal);const c=u(o),d={dialRequest:s,controller:n,promise:s.run({...t,signal:c}),destroy:()=>{n.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,d),d}getTokens(e){const t=Math.min(e,this.maxDialsPerPeer,this.tokens.length),r=this.tokens.splice(0,t);return n("%d tokens request, returning %d, %d remaining",e,t,this.tokens.length),r}releaseToken(e){this.tokens.indexOf(e)>-1||(n("token %d released",e),this.tokens.push(e))}async _resolve(e){const t=e.protoNames().includes("dnsaddr");if(!t)return[e];const r=await this._resolveRecord(e),s=await Promise.all(r.map(e=>this._resolve(e))),n=s.flat();return n.reduce((e,t)=>(e.find(e=>e.equals(t))||e.push(t),e),[])}async _resolveRecord(e){try{e=new o(e.toString());const t=await e.resolve();return t}catch(t){return n.error(`multiaddr ${e} could not be resolved`),[]}}}e.exports=b},"9d4c":function(e,t,r){"use strict";const s=r("34eb")("mss:select"),n=r("b6aa"),i=r("5b1e"),o=r("4e8e");e.exports=async(e,t,r)=>{t=Array.isArray(t)?[...t]:[t];const{reader:a,writer:c,rest:u,stream:l}=o(e),d=t.shift();r?(s('select: write ["%s", "%s"]',r,d),i.writeAll(c,[r,d])):(s('select: write "%s"',d),i.write(c,d));let h=(await i.read(a)).toString();if(s('select: read "%s"',h),h===r&&(h=(await i.read(a)).toString(),s('select: read "%s"',h)),h===d)return u(),{stream:l,protocol:d};for(const n of t){s('select: write "%s"',n),i.write(c,n);const e=(await i.read(a)).toString();if(s('select: read "%s" for "%s"',e,n),e===n)return u(),{stream:l,protocol:n}}throw u(),n(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}},"9dd0":function(e,t,r){"use strict";r("51e8");const s=r("d327"),n=s.pki,i=(e,t)=>{const r=n.setRsaPublicKey(t.n,t.e),s=n.createCertificate();s.publicKey=r,s.serialNumber="01",s.validity.notBefore=new Date,s.validity.notAfter=new Date,s.validity.notAfter.setFullYear(s.validity.notBefore.getFullYear()+10);const i=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:e.id}];return s.setSubject(i),s.setIssuer(i),s.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),s.sign(t),s};async function o(e,t){const r=e.map(t),s=await Promise.all(r),n=s.findIndex(e=>e);return e[n]}e.exports={certificateForKey:i,findAsync:o}},"9e58":function(e,t,r){"use strict";const s=r("11dc"),{EventEmitter:n}=r("faa1");function i(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0,s=e.length;r<s;++r)if(e[r]!==t[r])return!1;return!0}function o(){return{contacts:[],dontSplit:!1,left:null,right:null}}function a(e,t){if(!(t instanceof Uint8Array))throw new TypeError(e+" is not a Uint8Array")}class c extends n{constructor(e={}){super(),this.localNodeId=e.localNodeId||s(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||c.distance,this.arbiter=e.arbiter||c.arbiter,this.metadata=Object.assign({},e.metadata),a("option.localNodeId as parameter 1",this.localNodeId),this.root=o()}static arbiter(e,t){return e.vectorClock>t.vectorClock?e:t}static distance(e,t){let r=0,s=0;const n=Math.min(e.length,t.length),i=Math.max(e.length,t.length);for(;s<n;++s)r=256*r+(e[s]^t[s]);for(;s<i;++s)r=256*r+255;return r}add(e){a("contact.id",(e||{}).id);let t=0,r=this.root;while(null===r.contacts)r=this._determineNode(r,e.id,t++);const s=this._indexOf(r,e.id);return s>=0?(this._update(r,s,e),this):r.contacts.length<this.numberOfNodesPerKBucket?(r.contacts.push(e),this.emit("added",e),this):r.dontSplit?(this.emit("ping",r.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(r,t),this.add(e))}closest(e,t=1/0){if(a("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let r=[];for(let s=[this.root],n=0;s.length>0&&r.length<t;){const t=s.pop();if(null===t.contacts){const r=this._determineNode(t,e,n++);s.push(t.left===r?t.right:t.left),s.push(r)}else r=r.concat(t.contacts)}return r.map(t=>[this.distance(t.id,e),t]).sort((e,t)=>e[0]-t[0]).slice(0,t).map(e=>e[1])}count(){let e=0;for(const t=[this.root];t.length>0;){const r=t.pop();null===r.contacts?t.push(r.right,r.left):e+=r.contacts.length}return e}_determineNode(e,t,r){const s=r>>3,n=r%8;if(t.length<=s&&0!==n)return e.left;const i=t[s];return i&1<<7-n?e.right:e.left}get(e){a("id",e);let t=0,r=this.root;while(null===r.contacts)r=this._determineNode(r,e,t++);const s=this._indexOf(r,e);return s>=0?r.contacts[s]:null}_indexOf(e,t){for(let r=0;r<e.contacts.length;++r)if(i(e.contacts[r].id,t))return r;return-1}remove(e){a("the id as parameter 1",e);let t=0,r=this.root;while(null===r.contacts)r=this._determineNode(r,e,t++);const s=this._indexOf(r,e);if(s>=0){const e=r.contacts.splice(s,1)[0];this.emit("removed",e)}return this}_split(e,t){e.left=o(),e.right=o();for(const n of e.contacts)this._determineNode(e,n.id,t).contacts.push(n);e.contacts=null;const r=this._determineNode(e,this.localNodeId,t),s=e.left===r?e.right:e.left;s.dontSplit=!0}toArray(){let e=[];for(const t=[this.root];t.length>0;){const r=t.pop();null===r.contacts?t.push(r.right,r.left):e=e.concat(r.contacts)}return e}*toIterable(){for(const e=[this.root];e.length>0;){const t=e.pop();null===t.contacts?e.push(t.right,t.left):yield*t.contacts}}_update(e,t,r){if(!i(e.contacts[t].id,r.id))throw new Error("wrong index for _update");const s=e.contacts[t],n=this.arbiter(s,r);n===s&&s!==r||(e.contacts.splice(t,1),e.contacts.push(n),this.emit("updated",s,n))}}e.exports=c},"9edf":function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:transports"),{error:s("libp2p:transports:err")}),i=r("769c"),{codes:o}=r("b73a"),a=r("b6aa"),{updateSelfPeerRecord:c}=r("3eaf");class u{constructor({libp2p:e,upgrader:t,faultTolerance:r=l.FATAL_ALL}){this.libp2p=e,this.upgrader=t,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=r}add(e,t,r={}){if(n("adding %s",e),!e)throw a(new Error(`Transport must have a valid key, was given '${e}'`),o.ERR_INVALID_KEY);if(this._transports.has(e))throw a(new Error("There is already a transport with this key"),o.ERR_DUPLICATE_TRANSPORT);const s=new t({...r,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,s),this._listenerOptions.set(e,r.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){const e=[];for(const[t,r]of this._listeners){n("closing listeners for %s",t);while(r.length){const t=r.pop();t.removeAllListeners("listening"),t.removeAllListeners("close"),e.push(t.close())}}await Promise.all(e),n("all listeners closed");for(const t of this._listeners.keys())this._listeners.set(t,[])}async dial(e,t){const r=this.transportForMultiaddr(e);if(!r)throw a(new Error("No transport available for address "+String(e)),o.ERR_TRANSPORT_UNAVAILABLE);try{return await r.dial(e,t)}catch(s){throw s.code||(s.code=o.ERR_TRANSPORT_DIAL_FAILED),s}}getAddrs(){let e=[];for(const t of this._listeners.values())for(const r of t)e=[...e,...r.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(const t of this._transports.values()){const r=t.filter([e]);if(r.length)return t}return null}async listen(e){if(!e||0===e.length)return void n("no addresses were provided for listening, this node is dial only");const t=[];for(const[r,s]of this._transports.entries()){const u=s.filter(e),d=[];for(const e of u){n("creating listener for %s on %s",r,e);const t=s.createListener(this._listenerOptions.get(r));this._listeners.get(r).push(t),t.on("listening",()=>c(this.libp2p)),t.on("close",()=>c(this.libp2p)),d.push(t.listen(e))}if(0===d.length){t.push(r);continue}const h=await i(d),p=h.find(e=>!0===e.isFulfilled);if(!p&&this.faultTolerance!==l.NO_FATAL)throw a(new Error(`Transport (${r}) could not listen on any available address`),o.ERR_NO_VALID_ADDRESSES)}if(t.length===this._transports.size){const e=`no valid addresses were provided for transports [${t}]`;if(this.faultTolerance===l.FATAL_ALL)throw a(new Error(e),o.ERR_NO_VALID_ADDRESSES);n("libp2p in dial mode only: "+e)}}async remove(e){if(n("removing %s",e),this._listeners.has(e))for(const t of this._listeners.get(e))t.removeAllListeners("listening"),t.removeAllListeners("close"),await t.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){const e=[];for(const t of this._transports.keys())e.push(this.remove(t));await Promise.all(e)}}const l={FATAL_ALL:0,NO_FATAL:1};u.FaultTolerance=l,e.exports=u},"9ef1":function(e,t,r){"use strict";const s=r("1304").Key,n=r("34eb"),i=n("ipfs:repo:version"),o=r("9b62"),a=r("d46b"),{hasWithFallback:c,getWithFallback:u}=r("d268"),l=new s("version");e.exports=e=>({async exists(){return c(l,e.has.bind(e),e)},async get(){const t=await u(l,e.get.bind(e),e.has.bind(e),e);return parseInt(o(t),10)},set(t){return e.put(l,a(String(t)))},async check(e){const t=await this.get();i("comparing version: %s and %s",t,e);const r=6===t&&7===e||6===e&&7===t;return t===e||r}})},"9f09":function(e,t,r){"use strict";const{EventEmitter:s}=r("faa1"),{BigNumber:n}=r("901e"),i=r("55ab"),o=r("4c0c");class a extends s{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={dataReceived:n(0),dataSent:n(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);const r=this._options.movingAverageIntervals;for(let s=0;s<e.length;s++){const t=e[s];this._stats[t]=n(0),this._movingAverages[t]={};for(let e=0;e<r.length;e++){const s=r[e],n=this._movingAverages[t][s]=i(s);n.push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){const e=this.snapshot,t=this.movingAverages,r={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},s=Object.keys(t);for(const n of s){r.movingAverages[n]={};for(const e of Object.keys(t[n]))r.movingAverages[n][e]=t[n][e].movingAverage()}return r}push(e,t){this._queue.push([e,t,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=o(this._update,this._nextTimeout())}_nextTimeout(){const e=this._queue.length/this._options.computeThrottleMaxQueueSize,t=Math.max(this._options.computeThrottleTimeout*(1-e),0);return t}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){const t=e-this._frequencyLastTime;Object.keys(this._stats).forEach(r=>{this._updateFrequencyFor(r,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,r){const s=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;const n=t||1,o=s/n*1e3;let a=this._movingAverages[e];a||(a=this._movingAverages[e]={});const c=this._options.movingAverageIntervals;for(let u=0;u<c.length;u++){const e=c[u];let t=a[e];t||(t=a[e]=i(e)),t.push(r,o)}}_applyOp(e){const t=e[0],r=e[1];if("number"!==typeof r)throw new Error("invalid increment number: "+r);let s;s=Object.prototype.hasOwnProperty.call(this._stats,t)?this._stats[t]:this._stats[t]=n(0),this._stats[t]=s.plus(r),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=r}}e.exports=a},"9fd0":function(e,t,r){"use strict";const{Data:s}=r("c2f9"),n=r("b6aa"),i=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],o=["directory","hamt-sharded-directory"],a=parseInt("0644",8),c=parseInt("0755",8);function u(e){if(null!=e)return"number"===typeof e?4095&e:(e=e.toString(),"0"===e.substring(0,1)?4095&parseInt(e,8):4095&parseInt(e,10))}function l(e){if(null==e)return;let t;if(null!=e.secs&&(t={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const r=e.getTime(),s=Math.floor(r/1e3);t={secs:s,nsecs:1e3*(r-1e3*s)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t&&null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw n(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}class d{static unmarshal(e){const t=s.decode(e),r=s.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new d({type:i[r.Type],data:r.Data,blockSizes:r.blocksizes,mode:r.mode,mtime:r.mtime?{secs:r.mtime.Seconds,nsecs:r.mtime.FractionalNanoseconds}:void 0});return n._originalMode=r.mode||0,n}constructor(e={type:"file"}){const{type:t,data:r,blockSizes:s,hashType:o,fanout:a,mtime:c,mode:d}=e;if(t&&!i.includes(t))throw n(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t||"file",this.data=r,this.hashType=o,this.fanout=a,this.blockSizes=s||[],this._originalMode=0,this.mode=u(d),c&&(this.mtime=l(c),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?c:a;const t=u(e);void 0!==t&&(this._mode=t)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&o.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(t=>{e+=t}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=s.DataType.Raw;break;case"directory":e=s.DataType.Directory;break;case"file":e=s.DataType.File;break;case"metadata":e=s.DataType.Metadata;break;case"symlink":e=s.DataType.Symlink;break;case"hamt-sharded-directory":e=s.DataType.HAMTShard;break;default:throw n(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let t,r,i=this.data;if(this.data&&this.data.length||(i=void 0),null!=this.mode&&(t=4294963200&this._originalMode|(u(this.mode)||0),t!==a||this.isDirectory()||(t=void 0),t===c&&this.isDirectory()&&(t=void 0)),null!=this.mtime){const e=l(this.mtime);e&&(r={Seconds:e.secs,FractionalNanoseconds:e.nsecs},0===r.FractionalNanoseconds&&delete r.FractionalNanoseconds)}const o={Type:e,Data:i,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:t,mtime:r};return s.encode(o).finish()}}e.exports={UnixFS:d,parseMode:u,parseMtime:l}},a067:function(e,t,r){"use strict";class s{constructor(){this.list=[]}push(e){return!this.has(e.id)&&(this.list.push(e),!0)}has(e){const t=this.list.find(t=>t.id.equals(e));return Boolean(t)}toArray(){return this.list.slice()}pop(){return this.list.pop()}get length(){return this.list.length}}e.exports=s},a127:function(e,t,r){"use strict";function s(e){const[t,r]=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],s=[];return{peek:()=>t.next(),push:e=>{s.push(e)},next:()=>s.length?{done:!1,value:s.shift()}:t.next(),[r](){return this}}}e.exports=s},a132:function(e,t,r){const s=r("1f20").Netmask,n=r("873a"),i=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],o=i.map(e=>new s(e));function a(e){for(let t of o)if(t.contains(e))return!0;return!1}function c(e){return/^::$/.test(e)||/^::1$/.test(e)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(e)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(e)||/^ff([0-9a-fA-F]{2,2}):/i.test(e)}e.exports=e=>n.v6().test(e)?c(e):!(!n().test(e)&&!e.startsWith("0"))&&a(e)},a19c:function(e,t,r){"use strict";const s=r("b6aa"),n=r("e66e"),i=r("eddf"),o=r("ff5f"),a=r("9b62"),c=r("7704"),u=r("73fb"),l=r("b664"),d=r("a9f4");e.exports=e=>{const t=async t=>{e._log("findPeerLocal "+t.toB58String());const r=await e.routingTable.find(t),s=r&&e.peerStore.get(r);if(s)return{id:s.id,multiaddrs:s.addresses.map(e=>e.multiaddr)}},r=async(t,r)=>{const s=new u(u.TYPES.GET_VALUE,r,0);return e.network.sendRequest(t,s)},h=async(t,r)=>{e._log(`closerPeersSingle ${a(t,"base32")} from ${r.toB58String()}`);const s=await e.peerRouting._findPeerSingle(r,new i(t));return s.closerPeers.filter(t=>!e._isSelf(t.id)).map(t=>(e.peerStore.addressBook.add(t.id,t.multiaddrs),t))},p=async e=>{const t=d.keyForPublicKey(e),n=await r(e,t);if(!n.record||!n.record.value)throw s(new Error("Node not responding with its public key: "+e.toB58String()),"ERR_INVALID_RECORD");const o=await i.createFromPubKey(n.record.value);if(!o.equals(e))throw s(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");return o.pubKey};return{async _findPeerSingle(t,r){e._log("findPeerSingle %s",t.toB58String());const s=new u(u.TYPES.FIND_NODE,r.id,0);return e.network.sendRequest(t,s)},async findPeer(r,i={timeout:6e4}){i.timeout=i.timeout||c.minute,e._log("findPeer %s",r.toB58String());const o=await t(r);if(null!=o)return e._log("found local"),o;const a=await d.convertPeerId(r),u=e.routingTable.closestPeers(a,e.kBucketSize);if(0===u.length)throw s(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED");const h=u.find(e=>e.isEqual(r));if(h){const t=e.peerStore.get(r);if(t)return e._log("found in peerStore"),{id:t.id,multiaddrs:t.addresses.map(e=>e.multiaddr)}}const p=new l(e,r.id,()=>{const e=async e=>{const t=await this._findPeerSingle(e,r),s=t.closerPeers.find(e=>e.id.isEqual(r));return s?{peer:s,queryComplete:!0}:{closerPeers:t.closerPeers}};return e});let f;try{f=await n(p.run(u),i.timeout)}finally{p.stop()}let y=!1;if(f.paths.forEach(t=>{t.success&&t.peer&&(y=!0,e.peerStore.addressBook.add(t.peer.id,t.peer.multiaddrs))}),e._log("findPeer %s: %s",r.toB58String(),y),!y)throw s(new Error("No peer found"),"ERR_NOT_FOUND");const g=e.peerStore.get(r);if(!g)throw s(new Error("No peer found in peer store"),"ERR_NOT_FOUND");return{id:g.id,multiaddrs:g.addresses.map(e=>e.multiaddr)}},async*getClosestPeers(t,r={shallow:!1}){e._log("getClosestPeers to %b",t);const s=await d.convertBuffer(t),n=e.routingTable.closestPeers(s,e.kBucketSize),i=new l(e,t,()=>async e=>{const s=await h(t,e);return{closerPeers:s,pathComplete:!!r.shallow||void 0}}),o=await i.run(n);if(!o||!o.finalSet)return[];const a=await d.sortClosestPeers(Array.from(o.finalSet),s);for(const c of a.slice(0,e.kBucketSize))yield c},async getPublicKey(t){e._log("getPublicKey %s",t.toB58String());const r=e.peerStore.get(t);if(r&&r.id.pubKey)return e._log("getPublicKey: found local copy"),r.id.pubKey;let s;try{s=await p(t)}catch(c){const r=d.keyForPublicKey(t),n=await e.get(r);s=o.keys.unmarshalPublicKey(n)}const n=new i(t.id,void 0,s),a=(r&&r.addresses||[]).map(e=>e.multiaddr);return e.peerStore.addressBook.add(n,a),e.peerStore.keyBook.set(n,s),s}}}},a1c8:function(e,t,r){"use strict";(function(t){const{Buffer:s}=r("1c35"),n=r("9152"),i=r("901e").BigNumber,o=r("cd1e"),a=r("ac25"),c=r("f0a5"),u=r("5be1"),l=r("0bac"),{URL:d}=r("989e");class h{constructor(e){e=e||{},!e.size||e.size<65536?e.size=65536:e.size=a.nextPowerOf2(e.size),this._heap=new ArrayBuffer(e.size),this._heap8=new Uint8Array(this._heap),this._buffer=s.from(this._heap),this._reset(),this._knownTags=Object.assign({0:e=>new Date(e),1:e=>new Date(1e3*e),2:e=>a.arrayBufferToBignumber(e),3:e=>c.NEG_ONE.minus(a.arrayBufferToBignumber(e)),4:e=>c.TEN.pow(e[0]).times(e[1]),5:e=>c.TWO.pow(e[0]).times(e[1]),32:e=>new d(e),35:e=>new RegExp(e)},e.tags),this.parser=o(t,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var e=this._parents.pop();if(e.length>0)throw new Error(`Missing ${e.length} elements`);switch(e.type){case c.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case c.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case c.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case c.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case c.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case c.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length));break;default:break}this._currentParent&&this._currentParent.type===c.PARENT.TAG&&this._dec()}_dec(){const e=this._currentParent;e.length<0||(e.length--,0===e.length&&this._closeParent())}_push(e,t){const r=this._currentParent;switch(r.values++,r.type){case c.PARENT.ARRAY:case c.PARENT.BYTE_STRING:case c.PARENT.UTF8_STRING:r.length>-1?this._ref[this._ref.length-r.length]=e:this._ref.push(e),this._dec();break;case c.PARENT.OBJECT:null!=r.tmpKey?(this._ref[r.tmpKey]=e,r.tmpKey=null,this._dec()):(r.tmpKey=e,"string"!==typeof r.tmpKey&&(r.type=c.PARENT.MAP,r.ref=a.buildMap(r.ref)));break;case c.PARENT.MAP:null!=r.tmpKey?(this._ref.set(r.tmpKey,e),r.tmpKey=null,this._dec()):r.tmpKey=e;break;case c.PARENT.TAG:this._ref.push(e),t||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(e,t,r){this._parents[this._depth]={type:t,length:r,ref:e,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:c.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(e,t){const r=this._knownTags[e];return r?r(t):new l(e,t)}createMap(e,t){return e}createObject(e,t){return e}createArray(e,t){return e}createByteString(e,t){return s.concat(e)}createByteStringFromHeap(e,t){return e===t?s.alloc(0):s.from(this._heap.slice(e,t))}createInt(e){return e}createInt32(e,t){return a.buildInt32(e,t)}createInt64(e,t,r,s){return a.buildInt64(e,t,r,s)}createFloat(e){return e}createFloatSingle(e,t,r,s){return n.read([e,t,r,s],0,!1,23,4)}createFloatDouble(e,t,r,s,i,o,a,c){return n.read([e,t,r,s,i,o,a,c],0,!1,52,8)}createInt32Neg(e,t){return-1-a.buildInt32(e,t)}createInt64Neg(e,t,r,s){const n=a.buildInt32(e,t),o=a.buildInt32(r,s);return n>c.MAX_SAFE_HIGH?c.NEG_ONE.minus(new i(n).times(c.SHIFT32).plus(o)):-1-(n*c.SHIFT32+o)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(e,t){return e.join("")}createUtf8StringFromHeap(e,t){return e===t?"":this._buffer.toString("utf8",e,t)}createSimpleUnassigned(e){return new u(e)}pushInt(e){this._push(this.createInt(e))}pushInt32(e,t){this._push(this.createInt32(e,t))}pushInt64(e,t,r,s){this._push(this.createInt64(e,t,r,s))}pushFloat(e){this._push(this.createFloat(e))}pushFloatSingle(e,t,r,s){this._push(this.createFloatSingle(e,t,r,s))}pushFloatDouble(e,t,r,s,n,i,o,a){this._push(this.createFloatDouble(e,t,r,s,n,i,o,a))}pushInt32Neg(e,t){this._push(this.createInt32Neg(e,t))}pushInt64Neg(e,t,r,s){this._push(this.createInt64Neg(e,t,r,s))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],c.PARENT.ARRAY,-1)}pushArrayStartFixed(e){this._createArrayStartFixed(e)}pushArrayStartFixed32(e,t){const r=a.buildInt32(e,t);this._createArrayStartFixed(r)}pushArrayStartFixed64(e,t,r,s){const n=a.buildInt64(e,t,r,s);this._createArrayStartFixed(n)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(e){this._createObjectStartFixed(e)}pushObjectStartFixed32(e,t){const r=a.buildInt32(e,t);this._createObjectStartFixed(r)}pushObjectStartFixed64(e,t,r,s){const n=a.buildInt64(e,t,r,s);this._createObjectStartFixed(n)}pushByteStringStart(){this._parents[this._depth]={type:c.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(e,t){this._push(this.createByteStringFromHeap(e,t))}pushUtf8StringStart(){this._parents[this._depth]={type:c.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(e,t){this._push(this.createUtf8StringFromHeap(e,t))}pushSimpleUnassigned(e){this._push(this.createSimpleUnassigned(e))}pushTagStart(e){this._parents[this._depth]={type:c.PARENT.TAG,length:1,ref:[e]}}pushTagStart4(e,t){this.pushTagStart(a.buildInt32(e,t))}pushTagStart8(e,t,r,s){this.pushTagStart(a.buildInt64(e,t,r,s))}pushTagUnassigned(e){this._push(this.createTag(e))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(e){0!==e?this._createParent({},c.PARENT.OBJECT,e):this._push(this.createObject({}))}_createArrayStartFixed(e){0!==e?this._createParent(new Array(e),c.PARENT.ARRAY,e):this._push(this.createArray([]))}_decode(e){if(0===e.byteLength)throw new Error("Input too short");this._reset(),this._heap8.set(e);const t=this.parser.parse(e.byteLength);if(this._depth>1){while(0===this._currentParent.length)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(t>0)throw new Error("Failed to parse");if(0===this._res.length)throw new Error("No valid result")}decodeFirst(e){return this._decode(e),this._res[0]}decodeAll(e){return this._decode(e),this._res}static decode(e,t){"string"===typeof e&&(e=s.from(e,t||"hex"));const r=new h({size:e.length});return r.decodeFirst(e)}static decodeAll(e,t){"string"===typeof e&&(e=s.from(e,t||"hex"));const r=new h({size:e.length});return r.decodeAll(e)}}h.decodeFirst=h.decode,e.exports=h}).call(this,r("c8ba"))},a29d:function(e,t,r){"use strict";const s=r("41c6"),{anySignal:n}=r("74fd"),{default:i}=r("3cb9"),{TimeoutError:o}=r("c8fc");function a(e,t){return(...r)=>{const a=r[null==t?r.length-1:t];if(!a||!a.timeout)return e(...r);const c="string"===typeof a.timeout?i(a.timeout):a.timeout,u=new s(c);a.signal=n([a.signal,u.signal]);const l=e(...r),d=new Promise((e,t)=>{u.signal.addEventListener("abort",()=>{t(new o)})}),h=Date.now(),p=()=>{if(u.signal.aborted)throw new o;const e=Date.now()-h;if(e>c)throw u.abort(),new o};return l[Symbol.asyncIterator]?async function*(){const e=l[Symbol.asyncIterator]();try{while(1){const{value:t,done:r}=await Promise.race([e.next(),d]);if(r)break;p(),yield t}}catch(t){throw p(),t}finally{u.clear(),e.return&&e.return()}}():(async()=>{try{const e=await Promise.race([l,d]);return p(),e}catch(e){throw p(),e}finally{u.clear()}})()}}e.exports=a},a2b5:function(e,t,r){"use strict";const s=r("c449");t.cidToString=(e,t={})=>{const r=!1!==t.upgrade;let n=s.isCID(e)?e:new s(e);if(0===n.version&&t.base&&"base58btc"!==t.base){if(!r)return n.toString();n=n.toV1()}return n.toBaseEncodedString(t.base)}},a32a:function(e,t,r){"use strict";const{DAGNode:s}=r("8141"),n=r("a29d"),i=r("f3bf");e.exports=({ipld:e,gcLock:t,preload:o})=>{const a=r("69d3")({ipld:e,preload:o}),c=r("5ec0")({ipld:e,gcLock:t,preload:o});async function u(e,t,r={}){const n=await a(e,r),o=i([n.Data,t]);return c(new s(o,n.Links),r)}return n(u)}},a3fd:function(e,t,r){"use strict";const s=r("f7c6"),n=r("f24f"),i=r("6cdb");class o{constructor({repo:e,network:t}){this.repo=n({repo:e}),this.bw=s({network:t}),this.bitswap=i({network:t})}}e.exports=o},a496:function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["libp2p-peer-record"]||(s.roots["libp2p-peer-record"]={});a.PeerRecord=function(){function e(e){if(this.addresses=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.peerId=o.newBuffer([]),e.prototype.seq=o.Long?o.Long.fromBits(0,0,!0):0,e.prototype.addresses=o.emptyArray,e.encode=function(e,t){if(t||(t=i.create()),null!=e.peerId&&Object.hasOwnProperty.call(e,"peerId")&&t.uint32(10).bytes(e.peerId),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(16).uint64(e.seq),null!=e.addresses&&e.addresses.length)for(var r=0;r<e.addresses.length;++r)a.PeerRecord.AddressInfo.encode(e.addresses[r],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.PeerRecord;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.peerId=e.bytes();break;case 2:s.seq=e.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(a.PeerRecord.AddressInfo.decode(e,e.uint32()));break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.PeerRecord)return e;var t=new a.PeerRecord;if(null!=e.peerId&&("string"===typeof e.peerId?o.base64.decode(e.peerId,t.peerId=o.newBuffer(o.base64.length(e.peerId)),0):e.peerId.length&&(t.peerId=e.peerId)),null!=e.seq&&(o.Long?(t.seq=o.Long.fromValue(e.seq)).unsigned=!0:"string"===typeof e.seq?t.seq=parseInt(e.seq,10):"number"===typeof e.seq?t.seq=e.seq:"object"===typeof e.seq&&(t.seq=new o.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.addresses){if(!Array.isArray(e.addresses))throw TypeError(".PeerRecord.addresses: array expected");t.addresses=[];for(var r=0;r<e.addresses.length;++r){if("object"!==typeof e.addresses[r])throw TypeError(".PeerRecord.addresses: object expected");t.addresses[r]=a.PeerRecord.AddressInfo.fromObject(e.addresses[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addresses=[]),t.defaults)if(t.bytes===String?r.peerId="":(r.peerId=[],t.bytes!==Array&&(r.peerId=o.newBuffer(r.peerId))),o.Long){var s=new o.Long(0,0,!0);r.seq=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else r.seq=t.longs===String?"0":0;if(null!=e.peerId&&e.hasOwnProperty("peerId")&&(r.peerId=t.bytes===String?o.base64.encode(e.peerId,0,e.peerId.length):t.bytes===Array?Array.prototype.slice.call(e.peerId):e.peerId),null!=e.seq&&e.hasOwnProperty("seq")&&("number"===typeof e.seq?r.seq=t.longs===String?String(e.seq):e.seq:r.seq=t.longs===String?o.Long.prototype.toString.call(e.seq):t.longs===Number?new o.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.addresses&&e.addresses.length){r.addresses=[];for(var n=0;n<e.addresses.length;++n)r.addresses[n]=a.PeerRecord.AddressInfo.toObject(e.addresses[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.AddressInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.multiaddr=o.newBuffer([]),e.encode=function(e,t){return t||(t=i.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.PeerRecord.AddressInfo;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.multiaddr=e.bytes();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.PeerRecord.AddressInfo)return e;var t=new a.PeerRecord.AddressInfo;return null!=e.multiaddr&&("string"===typeof e.multiaddr?o.base64.decode(e.multiaddr,t.multiaddr=o.newBuffer(o.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.multiaddr="":(r.multiaddr=[],t.bytes!==Array&&(r.multiaddr=o.newBuffer(r.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(r.multiaddr=t.bytes===String?o.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e}(),e.exports=a},a4ad:function(e,t,r){"use strict";t.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"}},a4cc:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("1755"),n=r("ac23"),i=r("b92d"),o=r("3ef0");function a(e,t,r,i){n.assertEnoughData(e,t,r+i);const a=o.slice(e,t+r,t+r+i);return new s.Token(s.Type.bytes,a,r+i)}function c(e,t,r,s){return a(e,t,1,r)}function u(e,t,r,s){return a(e,t,2,i.readUint8(e,t+1,s))}function l(e,t,r,s){return a(e,t,3,i.readUint16(e,t+1,s))}function d(e,t,r,s){return a(e,t,5,i.readUint32(e,t+1,s))}function h(e,t,r,s){const o=i.readUint64(e,t+1,s);if("bigint"===typeof o)throw new Error(n.decodeErrPrefix+" 64-bit integer bytes lengths not supported");return a(e,t,9,o)}function p(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===s.Type.string?o.fromString(e.value):e.value),e.encodedBytes}function f(e,t){const r=p(t);i.encodeUintValue(e,t.type.majorEncoded,r.length),e.push(r)}function y(e,t){return e.length<t.length?-1:e.length>t.length?1:o.compare(e,t)}f.encodedSize=function(e){const t=p(e);return i.encodeUintValue.encodedSize(t.length)+t.length},f.compareTokens=function(e,t){return y(p(e),p(t))},t.compareBytes=y,t.decodeBytes16=l,t.decodeBytes32=d,t.decodeBytes64=h,t.decodeBytes8=u,t.decodeBytesCompact=c,t.encodeBytes=f},a55b:function(e,t,r){"use strict";const s=r("a29d"),n=r("9410"),i=r("9975");e.exports=({ipld:e,preload:t})=>{const r=async function(r,s={}){if(!1!==s.preload&&t(r),s.path){const t=s.localResolve?await n(e.resolve(r,s.path)):await i(e.resolve(r,s.path)),o=t;return o}return{value:await e.get(r,s),remainderPath:""}};return s(r)}},a56b:function(e,t){e.exports=o;var r=128,s=127,n=~s,i=Math.pow(2,31);function o(e,t,s){if(Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw o.bytes=0,new RangeError("Could not encode varint");t=t||[],s=s||0;var a=s;while(e>=i)t[s++]=255&e|r,e/=128;while(e&n)t[s++]=255&e|r,e>>>=7;return t[s]=0|e,o.bytes=s-a+1,t}},a5f8:function(e){e.exports=JSON.parse('{"name":"ipld-block","version":"0.11.1","description":"JavaScript Implementation of IPLD Block","leadMaintainer":"Volker Mische <volker.mische@gmail.com>","main":"src/index.js","types":"dist/src/index.d.ts","scripts":{"lint":"aegir lint","check":"tsc --noEmit --noErrorTruncation","test":"aegir test","test:node":"aegir test --target node","test:browser":"aegir test --target browser","release":"aegir release --docs","release-minor":"aegir release --type minor --docs","release-major":"aegir release --type major --docs","coverage":"aegir coverage","coverage-publish":"aegir coverage --provider coveralls","docs":"aegir docs","prepare":"aegir build --no-bundle","prepublishOnly":"aegir build"},"pre-push":["lint","test"],"repository":{"type":"git","url":"git+https://github.com/ipld/js-ipld-block.git"},"keywords":["IPLD"],"license":"MIT","bugs":{"url":"https://github.com/ipld/js-ipld-block/issues"},"homepage":"https://github.com/ipld/js-ipld-block#readme","devDependencies":{"aegir":"^31.0.4","uint8arrays":"^2.1.3"},"dependencies":{"cids":"^1.0.0"},"engines":{"node":">=6.0.0","npm":">=3.0.0"},"contributors":["David Dias <daviddias.p@gmail.com>","Volker Mische <volker.mische@gmail.com>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Irakli Gozalishvili <contact@gozala.io>","achingbrain <alex@achingbrain.net>","ᴠɪᴄᴛᴏʀ ʙᴊᴇʟᴋʜᴏʟᴍ <victorbjelkholm@gmail.com>","Alan Shaw <alan.shaw@protocol.ai>","Charlie <the_charlie_daly@hotmail.co.uk>","Diogo Silva <fsdiogo@gmail.com>","Hugo Dias <hugomrdias@gmail.com>","Mikeal Rogers <mikeal.rogers@gmail.com>","Richard Littauer <richard.littauer@gmail.com>","Richard Schneider <makaretu@gmail.com>","Xmader <xmader@outlook.com>"]}')},a621:function(e,t){var r=Math.pow(2,7),s=Math.pow(2,14),n=Math.pow(2,21),i=Math.pow(2,28),o=Math.pow(2,35),a=Math.pow(2,42),c=Math.pow(2,49),u=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<r?1:e<s?2:e<n?3:e<i?4:e<o?5:e<a?6:e<c?7:e<u?8:e<l?9:10}},a642:function(e,t,r){"use strict";const s=r("ff0e"),n=r("34eb"),i=r("f0fd"),{AbortController:o}=r("c181"),a=r("b9e5"),c=r("b789"),u=Object.assign(n("ipfs:preload"),{error:n("ipfs:preload:error")}),l=(e={})=>{if(e.enabled=Boolean(e.enabled),e.addresses=e.addresses||[],e.cache=e.cache||1e3,!e.enabled||!e.addresses.length){u("preload disabled");const e=()=>{};return Object.assign(e,{start:()=>{},stop:()=>{}})}let t=!0,r=[];const n=e.addresses.map(s),l=c(e.cache),d=async e=>{try{if(t)throw new Error(`preload ${e} but preloader is not started`);const c=e.toString();if(l.has(c))return;l.set(c,!0);const d=i(n);let h=!1;const p=Date.now();for(const e of d){if(t)throw new Error("preload aborted for "+c);let n;try{n=new o,r=r.concat(n),await a(`${e}/api/v0/refs?r=true&arg=${encodeURIComponent(c)}`,{signal:n.signal}),h=!0}catch(s){"aborted"!==s.type&&u.error(s)}finally{r=r.filter(e=>e!==n)}if(h)break}u(`${h?"":"un"}successfully preloaded ${c} in ${Date.now()-p}ms`)}catch(s){u.error(s)}};return d.start=()=>{t=!1},d.stop=()=>{t=!0,u(`aborting ${r.length} pending preload request(s)`),r.forEach(e=>e.abort()),r=[]},d};e.exports=l},a6ce:function(e,t,r){"use strict";const{UnixFS:s}=r("9fd0"),n=r("3ba3"),{DAGNode:i}=r("8141"),o=async(e,t,r)=>{const o=new s({type:"directory",mtime:e.mtime,mode:e.mode}),a=new i(o.marshal()).serialize(),c=await n(a,t,r),u=e.path;return{cid:c,path:u,unixfs:o,size:a.length}};e.exports=o},a6e2:function(e,t,r){"use strict";const s=r("6469"),n=r("3301"),i=10240;class o{constructor(){this._pool=new Uint8Array(i),this._poolOffset=0}write(e){const t=this._pool;let r=this._poolOffset;s.encode(e.id<<3|e.type,t,r),r+=s.encode.bytes,s.encode(e.data?e.data.length:0,t,r),r+=s.encode.bytes;const n=t.subarray(this._poolOffset,r);return i-r<100?(this._pool=new Uint8Array(i),this._poolOffset=0):this._poolOffset=r,e.data?[n,e.data]:n}}const a=new o;e.exports=e=>async function*(){for await(const t of e)Array.isArray(t)?yield new n(t.map(e=>a.write(e))):yield new n(a.write(t))}()},a771:function(e,t,r){"use strict";t.ERR_IPNS_EXPIRED_RECORD="ERR_IPNS_EXPIRED_RECORD",t.ERR_UNRECOGNIZED_VALIDITY="ERR_UNRECOGNIZED_VALIDITY",t.ERR_SIGNATURE_CREATION="ERR_SIGNATURE_CREATION",t.ERR_SIGNATURE_VERIFICATION="ERR_SIGNATURE_VERIFICATION",t.ERR_UNRECOGNIZED_FORMAT="ERR_UNRECOGNIZED_FORMAT",t.ERR_PEER_ID_FROM_PUBLIC_KEY="ERR_PEER_ID_FROM_PUBLIC_KEY",t.ERR_PUBLIC_KEY_FROM_ID="ERR_PUBLIC_KEY_FROM_ID",t.ERR_UNDEFINED_PARAMETER="ERR_UNDEFINED_PARAMETER",t.ERR_INVALID_RECORD_DATA="ERR_INVALID_RECORD_DATA"},a78f:function(e,t,r){"use strict";function s(e,t,r){const s=r.storageBackends[e],n=Object.assign({},r.storageBackendOptions[e]||{});return new s(t,n)}e.exports={create:s}},a866:function(e,t,r){"use strict";const s=r("dcd8"),n=r("b6aa");t.getPubsubRouting=(e,t)=>{if(!e||!t||!t.ipnsPubsub)throw n(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(e.routing instanceof s)return e.routing;const r=(e.routing.stores||[]).find(e=>e instanceof s);if(!r)throw n(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return r}},a96e:function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:peer-store:proto-book"),{error:s("libp2p:peer-store:proto-book:err")}),i=r("b6aa"),o=r("eddf"),a=r("bd20"),{codes:{ERR_INVALID_PARAMETERS:c}}=r("b73a");class u extends a{constructor(e){super({peerStore:e,eventName:"change:protocols",eventProperty:"protocols",eventTransformer:e=>Array.from(e)}),this.data=new Map}set(e,t){if(!o.isPeerId(e))throw n.error("peerId must be an instance of peer-id to store data"),i(new Error("peerId must be an instance of peer-id"),c);if(!t)throw n.error("protocols must be provided to store data"),i(new Error("protocols must be provided"),c);const r=e.toB58String(),s=this.data.get(r),a=new Set(t),u=(e,t)=>e.size===t.size&&[...e].every(e=>t.has(e));return s&&u(s,a)?(n("the protocols provided to store are equal to the already stored for "+r),this):(this._setData(e,a),n("stored provided protocols for "+r),this)}add(e,t){if(!o.isPeerId(e))throw n.error("peerId must be an instance of peer-id to store data"),i(new Error("peerId must be an instance of peer-id"),c);if(!t)throw n.error("protocols must be provided to store data"),i(new Error("protocols must be provided"),c);const r=e.toB58String(),s=this.data.get(r)||new Set,a=new Set([...s,...t]);return s.size===a.size?(n("the protocols provided to store are already stored for "+r),this):(this._setData(e,a),n("added provided protocols for "+r),this)}remove(e,t){if(!o.isPeerId(e))throw n.error("peerId must be an instance of peer-id to store data"),i(new Error("peerId must be an instance of peer-id"),c);if(!t)throw n.error("protocols must be provided to store data"),i(new Error("protocols must be provided"),c);const r=e.toB58String(),s=this.data.get(r);if(s){const i=new Set([...s].filter(e=>!t.includes(e)));if(s.size===i.size)return this;this._setData(e,i),n("removed provided protocols for "+r)}return this}}e.exports=u},a978:function(e,t,r){"use strict";const s=r("a067");class n extends s{constructor(e){super(),this.limit=e}push(e){return this.length<this.limit&&super.push(e)}}e.exports=n},a9f4:function(e,t,r){"use strict";const s=r("34eb"),n=r("0e80"),i=n.multihash,{Key:o}=r("1304"),a=r("6896"),c=r("76a0"),{Record:u}=r("92b9"),l=r("eddf"),d=r("b6aa"),h=r("f3bf"),p=r("d46b"),f=r("9b62");t.convertBuffer=e=>n.digest(e,"sha2-256"),t.convertPeerId=e=>n.digest(e.id,"sha2-256"),t.bufferToKey=e=>new o("/"+t.encodeBase32(e),!1),t.keyForPublicKey=e=>h([p("/pk/"),e.id]),t.isPublicKeyKey=e=>"/pk/"===f(e.slice(0,4)),t.fromPublicKeyKey=e=>new l(e.slice(4)),t.now=()=>Date.now(),t.encodeBase32=e=>f(e,"base32"),t.decodeBase32=e=>p(e,"base32"),t.sortClosestPeers=async(e,r)=>{const s=await c(e,async e=>{const s=await t.convertPeerId(e);return{peer:e,distance:a(s,r)}});return s.sort(t.xorCompare).map(e=>e.peer)},t.xorCompare=(e,t)=>a.compare(e.distance,t.distance),t.pathSize=(e,t)=>Math.ceil(e/t),t.createPutRecord=(e,t)=>{const r=new Date,s=new u(e,t,r);return s.serialize()},t.logger=(e,t)=>{const r=["libp2p","dht"];t&&r.push(t),e&&r.push(""+e.toB58String().slice(0,8)),s.formatters.b=e=>i.toB58String(e);const n=Object.assign(s(r.join(":")),{error:s(r.concat(["error"]).join(":"))});return n},t.TimeoutError=class extends Error{get code(){return"ETIMEDOUT"}},t.withTimeout=(e,t)=>{function r(...r){return Promise.race([e(...r),new Promise((e,r)=>{setTimeout(()=>{r(d(new Error("Async function did not complete before timeout"),"ETIMEDOUT"))},t)})])}return r},t.mapParallel=async function(e,t){const r=[];for await(const s of e)r.push(t(s));return Promise.all(r)}},aa14:function(e,t,r){"use strict";const s=r("b6aa"),n=r("335d"),i=r("5d6d"),o=r("6bd5");function a(e,t){return i(e,e=>(t.addressBook.add(e.id,e.multiaddrs),e))}function c(e){const t=new Set;return n(e,e=>!t.has(e.id.toString())&&(t.add(e.id.toString()),!0))}async function*u(e,t=1){let r=0;for await(const s of e)r++,yield s;if(r<t)throw s(new Error("not found"),"NOT_FOUND")}function l(e,t){return t?o(e,t):e}e.exports={storeAddresses:a,uniquePeers:c,requirePeers:u,maybeLimitSource:l}},aaf7:function(e,t,r){"use strict";const s=r("070a"),n=r("57be"),{exporter:i}=r("d6d7"),o=r("b6aa"),a=r("c449"),c="ipfs",u=async(e,t,r)=>{const u=await s(e,r);let l={entryType:"file"};if(a.isCID(t)&&(t="/ipfs/"+t),t=(t||"").trim(),t=t.replace(/(\/\/+)/g,"/"),t.endsWith("/")&&t.length>1&&(t=t.substring(0,t.length-1)),!t)throw o(new Error("paths must not be empty"),"ERR_NO_PATH");if("/"!==t.substring(0,1))throw o(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");"/"===t.substring(t.length-1)&&(t=t.substring(0,t.length-1));const d=n(t);if(d[0]===c){let e;e=2===d.length?"/"+d.join("/"):"/"+d.slice(0,d.length-1).join("/"),l={type:"ipfs",depth:d.length-2,entryType:"file",mfsPath:"/"+d.join("/"),mfsDirectory:e,parts:d,path:"/"+d.join("/"),name:d[d.length-1]}}else{const e=`/${c}/${u}${d.length?"/"+d.join("/"):""}`,t=`/${c}/${u}/${d.slice(0,d.length-1).join("/")}`;l={type:"mfs",depth:d.length,entryType:"file",mfsDirectory:t,mfsPath:e,parts:d,path:"/"+d.join("/"),name:d[d.length-1]}}const h="mfs"===l.type?l.mfsPath:l.path;try{const t=await i(h,e.ipld);l.cid=t.cid,l.mfsPath="/ipfs/"+t.path,l.entryType=t.type,l.content=t.content,"file"!==l.entryType&&"directory"!==l.entryType||"file"!==t.type&&"directory"!==t.type||(l.unixfs=t.unixfs)}catch(p){if("ERR_NOT_FOUND"!==p.code)throw p}return l.exists=Boolean(l.cid),l};e.exports=u},ab3e:function(e,t){e.exports=n;var r=128,s=127;function n(e,t){var i,o=0,a=(t=t||0,0),c=t,u=e.length;do{if(c>=u||a>49)throw n.bytes=0,new RangeError("Could not decode varint");i=e[c++],o+=a<28?(i&s)<<a:(i&s)*Math.pow(2,a),a+=7}while(i>=r);return n.bytes=c-t,o}},ab71:function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["libp2p-proto-book"]||(s.roots["libp2p-proto-book"]={});a.Protocols=function(){function e(e){if(this.protocols=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.protocols=o.emptyArray,e.encode=function(e,t){if(t||(t=i.create()),null!=e.protocols&&e.protocols.length)for(var r=0;r<e.protocols.length;++r)t.uint32(10).string(e.protocols[r]);return t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Protocols;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(e.string());break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Protocols)return e;var t=new a.Protocols;if(e.protocols){if(!Array.isArray(e.protocols))throw TypeError(".Protocols.protocols: array expected");t.protocols=[];for(var r=0;r<e.protocols.length;++r)t.protocols[r]=String(e.protocols[r])}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.protocols=[]),e.protocols&&e.protocols.length){r.protocols=[];for(var s=0;s<e.protocols.length;++s)r.protocols[s]=e.protocols[s]}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.exports=a},abb1:function(e,t,r){"use strict";const{Blob:s}=globalThis;function n(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function i(e){return"undefined"!==typeof s&&e instanceof s}function o(e){return"object"===typeof e&&(e.path||e.content)}const a=e=>e&&"function"===typeof e.getReader;e.exports={isBytes:n,isBlob:i,isFileObject:o,isReadableStream:a}},ac23:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s="CBOR decode error:",n="CBOR encode error:",i=[];function o(e,t,r){if(e.length-t<r)throw new Error(s+" not enough data for type")}i[23]=1,i[24]=2,i[25]=3,i[26]=5,i[27]=9,t.assertEnoughData=o,t.decodeErrPrefix=s,t.encodeErrPrefix=n,t.uintMinorPrefixBytes=i},ac25:function(e,t,r){"use strict";const{Buffer:s}=r("1c35"),n=r("901e").BigNumber,i=r("f0a5"),o=i.SHIFT32,a=i.SHIFT16,c=2097151;function u(e){return e<16?"0"+e.toString(16):e.toString(16)}t.parseHalf=function(e){var t,r,s;return s=128&e[0]?-1:1,t=(124&e[0])>>2,r=(3&e[0])<<8|e[1],t?31===t?s*(r?NaN:Infinity):s*Math.pow(2,t-25)*(1024+r):5.960464477539063e-8*s*r},t.arrayBufferToBignumber=function(e){const t=e.byteLength;let r="";for(let s=0;s<t;s++)r+=u(e[s]);return new n(r,16)},t.buildMap=e=>{const t=new Map,r=Object.keys(e),s=r.length;for(let n=0;n<s;n++)t.set(r[n],e[r[n]]);return t},t.buildInt32=(e,t)=>e*a+t,t.buildInt64=(e,r,s,i)=>{const a=t.buildInt32(e,r),u=t.buildInt32(s,i);return a>c?new n(a).times(o).plus(u):a*o+u},t.writeHalf=function(e,t){const r=s.allocUnsafe(4);r.writeFloatBE(t,0);const n=r.readUInt32BE(0);if(0!==(8191&n))return!1;var i=n>>16&32768;const o=n>>23&255,a=8388607&n;if(o>=113&&o<=142)i+=(o-112<<10)+(a>>13);else{if(!(o>=103&&o<113))return!1;if(a&(1<<126-o)-1)return!1;i+=a+8388608>>126-o}return e.writeUInt16BE(i,0),!0},t.keySorter=function(e,t){var r=e[0].byteLength,s=t[0].byteLength;return r>s?1:s>r?-1:e[0].compare(t[0])},t.isNegativeZero=e=>0===e&&1/e<0,t.nextPowerOf2=e=>{let t=0;if(e&&!(e&e-1))return e;while(0!==e)e>>=1,t+=1;return 1<<t}},ac55:function(e,t,r){"use strict";const s=r("9457").IPFS.matches;t.isValidMultiaddr=e=>{try{return s(e)}catch(t){return!1}}},ac57:function(e,t,r){"use strict";const{EventEmitter:s}=r("faa1"),n=r("34eb")("latency-monitor:VisibilityChangeEmitter");class i extends s{constructor(){super(),"undefined"!==typeof document?(this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()):n('This is not a browser, no "document" found. Stopping.')}_initializeVisibilityVarNames(){let e,t;"undefined"!==typeof document.hidden?(e="hidden",t="visibilitychange"):"undefined"!==typeof document.mozHidden?(e="mozHidden",t="mozvisibilitychange"):"undefined"!==typeof document.msHidden?(e="msHidden",t="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=t}_addVisibilityChangeListener(){"undefined"===typeof document.addEventListener||"undefined"===typeof document[this._hidden]?n("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(void 0!==this._hidden&&void 0!==document[this._hidden])return!document[this._hidden]}_handleVisibilityChange(){const e=!document[this._hidden];n(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}}e.exports=i},ac64:function(e,t,r){"use strict";const s=r("0d05"),n=r("34eb"),i=n("ipfs:repo:lock"),o="repo.lock",a={};t.lock=async e=>{const t=e+"/"+o;if(i("locking %s",t),!0===a[t])throw new s.LockExistsError("Lock already being held for file: "+t);a[t]=!0;const r={async close(){a[t]&&delete a[t]}};return r},t.locked=async e=>{const t=e+"/"+o;return i("checking lock: "+t),Boolean(a[t])}},ac70:function(e,t,r){"use strict";const s=r("a29d");e.exports=({network:e})=>{async function t(t,r={}){const{libp2p:s}=await e.use(r);await s.dial(t,r)}return s(t)}},acea:function(e,t,r){"use strict";const{EventEmitter:s}=r("faa1"),n=r("aef6"),i=r("5aab"),o=r("9b62"),a=r("2a9c"),c=r("ce74").logger,u=e=>"unwant:"+o(e.multihash,"base64"),l=e=>"block:"+o(e.multihash,"base64");class d extends s{constructor(e){super(),this.setMaxListeners(a.maxListeners),this._log=c(e,"notif")}hasBlock(e){const t=l(e.cid);this._log(t),this.emit(t,e)}wantBlock(e,t={}){if(!e)throw new Error("Not a valid cid");const r=l(e),s=u(e);return this._log("wantBlock:"+e),new Promise((o,a)=>{const c=()=>{this.removeListener(r,u),a(new Error(`Block for ${e} unwanted`))},u=t=>{if(this.removeListener(s,c),!i(e.multihash,t.cid.multihash))return a(new Error("Incorrect block received for "+e));e.version===t.cid.version&&e.codec===t.cid.codec||(t=new n(t.data,e)),o(t)};this.once(s,c),this.once(r,u),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.removeListener(r,u),this.removeListener(s,c),a(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){const t=u(e);this._log(t),this.emit(t)}}e.exports=d},ad75:function(e,t,r){"use strict";function s(e,t){t=t||{};this._head=0,this._tail=0,this._capacity=t.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(e)&&this._fromArray(e)}s.prototype.peekAt=function(e){var t=e;if(t===(0|t)){var r=this.size();if(!(t>=r||t<-r))return t<0&&(t+=r),t=this._head+t&this._capacityMask,this._list[t]}},s.prototype.get=function(e){return this.peekAt(e)},s.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},s.prototype.peekFront=function(){return this.peek()},s.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(s.prototype,"length",{get:function(){return this.size()}}),s.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},s.prototype.unshift=function(e){if(void 0===e)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},s.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}},s.prototype.push=function(e){if(void 0===e)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},s.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var r=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),r}},s.prototype.removeOne=function(e){var t=e;if(t===(0|t)&&this._head!==this._tail){var r=this.size(),s=this._list.length;if(!(t>=r||t<-r)){t<0&&(t+=r),t=this._head+t&this._capacityMask;var n,i=this._list[t];if(e<r/2){for(n=e;n>0;n--)this._list[t]=this._list[t=t-1+s&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+s&this._capacityMask}else{for(n=r-1-e;n>0;n--)this._list[t]=this._list[t=t+1+s&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+s&this._capacityMask}return i}}},s.prototype.remove=function(e,t){var r,s=e,n=t;if(s===(0|s)&&this._head!==this._tail){var i=this.size(),o=this._list.length;if(!(s>=i||s<-i||t<1)){if(s<0&&(s+=i),1===t||!t)return r=new Array(1),r[0]=this.removeOne(s),r;if(0===s&&s+t>=i)return r=this.toArray(),this.clear(),r;var a;for(s+t>i&&(t=i-s),r=new Array(t),a=0;a<t;a++)r[a]=this._list[this._head+s+a&this._capacityMask];if(s=this._head+s&this._capacityMask,e+t===i){for(this._tail=this._tail-t+o&this._capacityMask,a=t;a>0;a--)this._list[s=s+1+o&this._capacityMask]=void 0;return r}if(0===e){for(this._head=this._head+t+o&this._capacityMask,a=t-1;a>0;a--)this._list[s=s+1+o&this._capacityMask]=void 0;return r}if(s<i/2){for(this._head=this._head+e+t+o&this._capacityMask,a=e;a>0;a--)this.unshift(this._list[s=s-1+o&this._capacityMask]);s=this._head-1+o&this._capacityMask;while(n>0)this._list[s=s-1+o&this._capacityMask]=void 0,n--;e<0&&(this._tail=s)}else{for(this._tail=s,s=s+t+o&this._capacityMask,a=i-(t+e);a>0;a--)this.push(this._list[s++]);s=this._tail;while(n>0)this._list[s=s+1+o&this._capacityMask]=void 0,n--}return this._head<2&&this._tail>1e4&&this._tail<=o>>>2&&this._shrinkArray(),r}}},s.prototype.splice=function(e,t){var r=e;if(r===(0|r)){var s=this.size();if(r<0&&(r+=s),!(r>s)){if(arguments.length>2){var n,i,o,a=arguments.length,c=this._list.length,u=2;if(!s||r<s/2){for(i=new Array(r),n=0;n<r;n++)i[n]=this._list[this._head+n&this._capacityMask];0===t?(o=[],r>0&&(this._head=this._head+r+c&this._capacityMask)):(o=this.remove(r,t),this._head=this._head+r+c&this._capacityMask);while(a>u)this.unshift(arguments[--a]);for(n=r;n>0;n--)this.unshift(i[n-1])}else{i=new Array(s-(r+t));var l=i.length;for(n=0;n<l;n++)i[n]=this._list[this._head+r+t+n&this._capacityMask];0===t?(o=[],r!=s&&(this._tail=this._head+r+c&this._capacityMask)):(o=this.remove(r,t),this._tail=this._tail-l+c&this._capacityMask);while(u<a)this.push(arguments[u++]);for(n=0;n<l;n++)this.push(i[n])}return o}return this.remove(r,t)}}},s.prototype.clear=function(){this._head=0,this._tail=0},s.prototype.isEmpty=function(){return this._head===this._tail},s.prototype.toArray=function(){return this._copyArray(!1)},s.prototype._fromArray=function(e){for(var t=0;t<e.length;t++)this.push(e[t])},s.prototype._copyArray=function(e){var t,r=[],s=this._list,n=s.length;if(e||this._head>this._tail){for(t=this._head;t<n;t++)r.push(s[t]);for(t=0;t<this._tail;t++)r.push(s[t])}else for(t=this._head;t<this._tail;t++)r.push(s[t]);return r},s.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length*=2,this._capacityMask=this._capacityMask<<1|1},s.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},e.exports=s},ada8:function(e,t,r){"use strict";const s=r("df7a").WriteError,n=r("6f8e"),i=r("afc5").getCallback,o=r("afc5").getOptions;function a(e){this.db=e,this.batch=e.db.batch(),this.ops=[],this.length=0}a.prototype.put=function(e,t,r){try{this.batch.put(e,t,r)}catch(n){throw new s(n)}return this.ops.push({...r,type:"put",key:e,value:t}),this.length++,this},a.prototype.del=function(e,t){try{this.batch.del(e,t)}catch(r){throw new s(r)}return this.ops.push({...t,type:"del",key:e}),this.length++,this},a.prototype.clear=function(){try{this.batch.clear()}catch(e){throw new s(e)}return this.ops=[],this.length=0,this},a.prototype.write=function(e,t){const r=this.db,a=this.ops;t=i(e,t),t=n.fromCallback(t),e=o(e);try{this.batch.write(e,(function(e){if(e)return t(new s(e));r.emit("batch",a),t()}))}catch(c){throw new s(c)}return t.promise},e.exports=a},adf6:function(e,t,r){"use strict";const s=r("0eff"),n=r("94bf"),i=async(e,t={})=>{const r=e.serialize(),i=await n.cid(r,t);return new s(t.name||"",e.size,i)};e.exports=i},adf8:function(e,t,r){"use strict";const s=r("ff5f"),n=r("0e80"),i=r("eddf"),{AbortController:o}=r("91d3"),a=r("b6aa"),c=r("c003"),u=r("7704"),{logger:l}=r("a9f4");class d{constructor(e,t){if(!e)throw new Error("Random Walk needs an instance of the Kademlia DHT");this._kadDHT=e,this._options={...u.defaultRandomWalk,...t},this.log=l(e.peerId,"random-walk"),this._timeoutId=void 0}start(){!this._timeoutId&&this._options.enabled&&(this._timeoutId=setTimeout(()=>{this._runPeriodically()},this._options.delay))}stop(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=void 0),this._controller&&this._controller.abort()}async _runPeriodically(){while(this._timeoutId){try{await this._walk(this._options.queriesPerPeriod,this._options.timeout)}catch(e){this._kadDHT._log.error("random-walk:error",e)}await new Promise(e=>{this._timeoutId=setTimeout(e,this._options.interval)})}}async _walk(e,t){this.log("start"),this._controller=new o;try{await c(e,async e=>{this.log("running query %d",e);try{const e=await this._randomPeerId();if(!this._controller)return;await this._query(e,{timeout:t,signal:this._controller.signal})}catch(r){if(r&&"ETIMEDOUT"!==r.code)throw this.log.error("query %d finished with error",e,r),r}this.log("finished query %d",e)})}finally{this._controller=null,this.log("finished queries")}}async _query(e,t){let r;this.log("query:%s",e.toB58String());try{r=await this._kadDHT.findPeer(e,t)}catch(s){if(s&&"ERR_NOT_FOUND"===s.code)return;throw s}throw this.log("query:found",r),a(new Error(`random-walk: ACTUALLY FOUND PEER: ${r}, ${e.toB58String()}`),"ERR_FOUND_RANDOM_PEER")}async _randomPeerId(){const e=await n(s.randomBytes(16),"sha2-256");return new i(e)}}e.exports=d},aef6:function(e,t,r){"use strict";const s=r("c449"),{version:n}=r("a5f8"),i=Symbol.for("@ipld/js-ipld-block/block"),o={writable:!1,configurable:!1,enumerable:!0};class a{constructor(e,t){if(!e||!(e instanceof Uint8Array))throw new Error("first argument  must be a Uint8Array");if(!t||!s.isCID(t))throw new Error("second argument must be a CID");this.data=e,this.cid=t,Object.defineProperties(this,{data:o,cid:o})}get _data(){return l(),this.data}get _cid(){return u(),this.cid}get[Symbol.toStringTag](){return"Block"}get[i](){return!0}static isBlock(e){return Boolean(e&&e[i])}}const c=(e,t)=>{let r=!1;return()=>{if(!e.test(n))throw new Error(t);r||(r=!0,console.warn(t))}},u=c(/^0\.10|^0\.11/,"block._cid is deprecated and will be removed in 0.12 release. Please use block.cid instead"),l=c(/^0\.10|^0.11/,"block._data is deprecated and will be removed in 0.12 release. Please use block.data instead");e.exports=a},aefb:function(e,t,r){e.exports={encode:r("c3a3"),decode:r("bee7"),encodingLength:r("a621")}},aefd:function(e,t,r){"use strict";function s(e){return e>=55296&&e<=56319}function n(e){return e>=56320&&e<=57343}e.exports=function(e,t,r){if("string"!==typeof t)throw new Error("Input must be string");for(var i,o,a=t.length,c=0,u=0;u<a;u+=1){if(i=t.charCodeAt(u),o=t[u],s(i)&&n(t.charCodeAt(u+1))&&(u+=1,o+=t[u]),c+=e(o),c===r)return t.slice(0,u+1);if(c>r)return t.slice(0,u-o.length+1)}return t}},af50:function(e,t,r){"use strict";const s=r("6558"),n=r("faa1"),i=r("88ae"),o=r("1d4f"),a=r("a9f4");class c extends n{constructor(e){super(),this.query=e,this.running=!1,this.workers=[],this.peersSeen=new Set,this.errors=[],this.peersQueried=null}stop(){if(this.running){this.running=!1;for(const e of this.workers)e.stop()}}async execute(e){const t=[],r=Math.min(this.query.dht.disjointPaths,e.length);for(let n=0;n<r;n++)t.push(new i(this,this.query.makePath(n,r)));e.forEach((e,s)=>{t[s%r].addInitialPeer(e)}),await this.executePaths(t);const s={finalSet:new Set(this.peersQueried&&this.peersQueried.peers),paths:[]};for(const n of t)n.res&&(n.res.pathComplete||n.res.queryComplete)&&(n.res.success=!0,s.paths.push(n.res));return s}async executePaths(e){this.running=!0,this.emit("start");try{await Promise.all(e.map(e=>e.execute()))}finally{this.stop(),this.emit("complete")}if(this.errors.length===this.peersSeen.size)throw this.errors[0]}async workerQueue(e){await this.init(),await this.startWorker(e)}async startWorker(e){const t=new o(this.query.dht,this,e,this.query._log);this.workers.push(t),await t.execute()}async init(){this.peersQueried||(this.peersQueriedPromise?await this.peersQueriedPromise:(this.peersQueriedPromise=(async()=>{const e=await a.convertBuffer(this.query.key);this.peersQueried=new s(e,this.query.dht.kBucketSize)})(),await this.peersQueriedPromise,delete this.peersQueriedPromise))}async continueQuerying(e){if(this.peersQueried&&this.peersQueried.length<this.peersQueried.capacity)return!0;const t=Array.from(e.queuedPeerIds),r=this.peersQueried&&await this.peersQueried.anyCloser(t);return!!r}}e.exports=c},af60:function(e,t,r){"use strict";const{UnixFS:s}=r("9fd0"),n=r("3ba3"),{DAGNode:i}=r("8141");async function*o(e,t,r){for await(let o of e.content)yield async()=>{let a;r.progress(o.length,e.path);const c={codec:"dag-pb",cidVersion:r.cidVersion,hashAlg:r.hashAlg,onlyHash:r.onlyHash};return r.rawLeaves?(c.codec="raw",c.cidVersion=1):(a=new s({type:r.leafType,data:o,mtime:e.mtime,mode:e.mode}),o=new i(a.marshal()).serialize()),{cid:await n(o,t,c),unixfs:a,size:o.length}}}e.exports=o},afc5:function(e,t,r){"use strict";t.getCallback=function(e,t){return"function"===typeof e?e:t},t.getOptions=function(e){return"object"===typeof e&&null!==e?e:{}}},b0c7:function(e,t,r){"use strict";const s=r("636f");function n(e,t){const r=s(e.multiaddr),n=s(t.multiaddr);return r&&!n?1:!r&&n||e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}function i(e){return[...e].sort(n)}e.exports.publicAddressesFirst=i},b0ea:function(e,t,r){"use strict";const s=r("6f2b"),n=r("c2d6"),i=r("7e6e"),o=r("131d"),a=r("f3d7"),c=r("07be");e.exports={KeytransformDatastore:s,ShardingDatastore:n,MountDatastore:i,TieredDatastore:o,NamespaceDatastore:a,shard:c}},b0fc:function(e,t,r){"use strict";const s=r("b789");e.exports=e=>{const t=s(e);return t.delete=t.remove,t}},b11a:function(e,t,r){"use strict";const s=r("8712");e.exports=function(e,...t){0===t.length?s(e):s(()=>e(...t))}},b1bf:function(e,t,r){"use strict";const{EventEmitter:s}=r("faa1"),n=r("b6aa"),i=r("92b9"),{MemoryDatastore:o}=r("1304"),a=r("5aab"),c=r("9b62"),u=r("cc13"),l=r("a9f4"),d=r("7704"),h=r("b488"),p=r("0acf"),f=r("7670"),y=r("a19c"),g=r("73fb"),b=r("4aa2"),m=r("adf8"),w=r("4f17"),_=i.Record;class E extends s{constructor({libp2p:e,dialer:t,peerId:r,peerStore:s,registrar:n,protocolPrefix:a="/ipfs",forceProtocolLegacy:c=!1,datastore:g=new o,kBucketSize:_=d.K,clientMode:E=!1,concurrency:v=d.ALPHA,validators:S={},selectors:I={},randomWalk:A={enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:3e4,delay:1e4},onPut:R=(()=>{}),onRemove:T=(()=>{})}){if(super(),!t)throw new Error("libp2p-kad-dht requires an instance of Dialer");this.libp2p=e,this.dialer=t,this.peerId=r,this.peerStore=s,this.registrar=n,this.protocol=a+(c?"":d.PROTOCOL_DHT),this.kBucketSize=_,this._clientMode=E,this.concurrency=v,this.disjointPaths=Math.ceil(this.kBucketSize/2),this.routingTable=new u(this.peerId,this.kBucketSize),this.datastore=g,this.providers=new b(this.datastore,this.peerId),this.validators={pk:i.validator.validators.pk,...S},this.selectors={pk:i.selection.selectors.pk,...I},this.network=new h(this),this._log=l.logger(this.peerId),this.randomWalk=new m(this,A),this._queryManager=new w,this._running=!1,this.contentFetching=p(this),this.contentRouting=f(this),this.peerRouting=y(this),this.onPut=R,this.onRemove=T}get isStarted(){return this._running}async start(){this._running=!0,this.providers.start(),this._queryManager.start(),await this.network.start(),this.randomWalk.start()}stop(){return this._running=!1,this.randomWalk.stop(),this.providers.stop(),this._queryManager.stop(),this.network.stop()}async put(e,t,r={}){return this.contentFetching.put(e,t,r)}async get(e,t={}){return this.contentFetching.get(e,t)}async getMany(e,t,r={}){return this.contentFetching.getMany(e,t,r)}async removeLocal(e){this._log("removeLocal: "+c(e,"base32"));const t=l.bufferToKey(e);try{await this.datastore.delete(t)}catch(r){if("ERR_NOT_FOUND"===r.code)return;throw r}}async _putLocal(e,t){this._log("_putLocal: "+c(e,"base32"));const r=l.bufferToKey(e);await this.datastore.put(r,t)}async provide(e){return this.contentRouting.provide(e)}async*findProviders(e,t={timeout:6e3,maxNumProviders:5}){for await(const r of this.contentRouting.findProviders(e,t))yield r}async findPeer(e,t={timeout:6e4}){return this.peerRouting.findPeer(e,t)}async*getClosestPeers(e,t={shallow:!1}){yield*this.peerRouting.getClosestPeers(e,t)}getPublicKey(e){return this.peerRouting.getPublicKey(e)}_peerDiscovered(e,t){this.emit("peer",{id:e,multiaddrs:t})}async _nearestPeersToQuery(e){const t=await l.convertBuffer(e.key),r=this.routingTable.closestPeers(t,this.kBucketSize);return r.map(e=>{const t=this.peerStore.get(e);return{id:e,multiaddrs:t?t.addresses.map(e=>e.multiaddr):[]}})}async _betterPeersToQuery(e,t){this._log("betterPeersToQuery");const r=await this._nearestPeersToQuery(e);return r.filter(e=>this._isSelf(e.id)?(this._log.error("trying to return self as closer"),!1):!e.id.isEqual(t))}async _checkLocalDatastore(e){this._log(`checkLocalDatastore: ${c(e)} %b`,e);const t=l.bufferToKey(e);let r;try{r=await this.datastore.get(t)}catch(i){if("ERR_NOT_FOUND"===i.code)return;throw i}const s=_.deserialize(r);if(!s)throw n(new Error("Invalid record"),"ERR_INVALID_RECORD");return null==s.timeReceived||l.now()-s.timeReceived.getTime()>d.MAX_RECORD_AGE?(await this.datastore.delete(t),void this.onRemove(s)):s}async _add(e){await this.routingTable.add(e)}async _verifyRecordLocally(e){this._log("verifyRecordLocally"),await i.validator.verifyRecord(this.validators,e)}_isSelf(e){return e&&a(this.peerId.id,e.id)}async _putValueToPeer(e,t,r){const s=new g(g.TYPES.PUT_VALUE,e,0);s.record=_.deserialize(t);const i=await this.network.sendRequest(r,s);if(i.record&&!a(i.record.value,_.deserialize(t).value))throw n(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")}async _getValueOrPeers(e,t){const r=await this._getValueSingle(e,t),s=r.closerPeers,i=r.record;if(i){try{await this._verifyRecordOnline(i)}catch(o){const e="invalid record received, discarded";throw this._log(e),n(new Error(e),"ERR_INVALID_RECORD")}return{record:i,peers:s}}if(s.length>0)return{peers:s};throw n(new Error("Not found"),"ERR_NOT_FOUND")}async _getValueSingle(e,t){const r=new g(g.TYPES.GET_VALUE,t,0);return this.network.sendRequest(e,r)}async _verifyRecordOnline(e){await i.validator.verifyRecord(this.validators,e)}}e.exports=E,e.exports.multicodec="/ipfs"+d.PROTOCOL_DHT},b2a9:function(e,t,r){"use strict";e.exports=function(e,t,r,s){const n=e.length,i=t+n;return r>=i||s<t?new Uint8Array(0):(s>=t&&s<i&&(e=e.slice(0,s-t)),r>=t&&r<i&&(e=e.slice(r-t)),e)}},b2ec:function(e,t,r){"use strict";const s=r("b7cd").version,{Multiaddr:n}=r("2054"),i=r("a29d"),o=r("9b62"),a=r("eddf"),{NotStartedError:c}=r("fabb");e.exports=({peerId:e,network:t})=>{async function r(r={}){r.peerId===e.toB58String()&&delete r.peerId;const i=t.try();if(!i){if(r.peerId)throw new c;const t=e.toB58String();return{id:t,publicKey:o(e.pubKey.bytes,"base64pad"),addresses:[],agentVersion:"js-ipfs/"+s,protocolVersion:"9000",protocols:[]}}const u=r.peerId?a.createFromB58String(r.peerId.toString()):e,{libp2p:l}=i,d=r.peerId?l.peerStore.keyBook.get(u):u.pubKey,h=r.peerId?l.peerStore.addressBook.getMultiaddrsForPeer(u):l.multiaddrs,p=r.peerId?l.peerStore.protoBook.get(u):Array.from(l.upgrader.protocols.keys()),f=o(l.peerStore.metadataBook.getValue(u,"AgentVersion")||new Uint8Array),y=o(l.peerStore.metadataBook.getValue(u,"ProtocolVersion")||new Uint8Array),g=u.toB58String();return{id:g,publicKey:o(d.bytes,"base64pad"),addresses:(h||[]).map(e=>{const t=e.toString();return t.endsWith("/p2p/"+g)?t:`${t}/p2p/${g}`}).sort().map(e=>new n(e)),agentVersion:f,protocolVersion:y,protocols:(p||[]).sort()}}return i(r)}},b306:function(e,t,r){"use strict";const s=r("354e"),n=r("675c"),{Multiaddr:i}=r("2054"),o=r("9457"),a=r("c449"),{URL:c}=r("16af"),u=r("9b62"),l=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,d=/^\/(ip[fn]s)\/([^/?#]+)/,h=1,p=2,f=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,y=1,g=2,b=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function m(e){const t=R(e);try{return s.decode(n.decode("z"+t)),!0}catch(r){return!1}}function w(e){try{return n.isEncoded(e)}catch(t){return!1}}function _(e){try{return new a(e),!0}catch(t){return!1}}function E(e){if(!e)return!1;if(i.isMultiaddr(e))return!0;try{return new i(e),!0}catch(t){return!1}}function v(e){return E(e)&&o.P2P.matches(e)}function S(e,t,r=h,s=p){const n=R(e);if(!n)return!1;const i=n.match(t);if(!i)return!1;if("ipfs"!==i[r])return!1;let o=i[s];return o&&t===f&&(o=o.toLowerCase()),_(o)}function I(e,t,r=h,s=p){const n=R(e);if(!n)return!1;const i=n.match(t);if(!i)return!1;if("ipns"!==i[r])return!1;let o=i[s];if(o&&t===f){if(o=o.toLowerCase(),_(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));const{hostname:e}=new c("http://"+o);return b.test(e)}catch(a){return!1}}return!0}function A(e){return"string"===typeof e}function R(e){return e instanceof Uint8Array?u(e,"base58btc"):!!A(e)&&e}const T=e=>S(e,f,g,y),k=e=>I(e,f,g,y),P=e=>T(e)||k(e),O=e=>S(e,l)||T(e),N=e=>I(e,l)||k(e),D=e=>O(e)||N(e)||P(e),C=e=>S(e,d)||I(e,d);e.exports={multihash:m,multiaddr:E,peerMultiaddr:v,cid:_,base32cid:e=>"base32"===w(e)&&_(e),ipfsSubdomain:T,ipnsSubdomain:k,subdomain:P,subdomainGatewayPattern:f,ipfsUrl:O,ipnsUrl:N,url:D,pathGatewayPattern:l,ipfsPath:e=>S(e,d),ipnsPath:e=>I(e,d),path:C,pathPattern:d,urlOrPath:e=>D(e)||C(e),cidPath:e=>A(e)&&!_(e)&&S("/ipfs/"+e,d)}},b380:function(e,t,r){var s=r("d327");r("4a73"),r("b1d4");var n=e.exports=s.pss=s.pss||{};n.create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,n=e.mgf,i=r.digestLength,o=e.salt||null;if("string"===typeof o&&(o=s.util.createBuffer(o)),"saltLength"in e)t=e.saltLength;else{if(null===o)throw new Error("Salt length not specified or specific salt not given.");t=o.length()}if(null!==o&&o.length()!==t)throw new Error("Given salt length does not match length of given salt.");var a=e.prng||s.random,c={encode:function(e,c){var u,l,d=c-1,h=Math.ceil(d/8),p=e.digest().getBytes();if(h<i+t+2)throw new Error("Message is too long to encrypt.");l=null===o?a.getBytesSync(t):o.bytes();var f=new s.util.ByteBuffer;f.fillWithByte(0,8),f.putBytes(p),f.putBytes(l),r.start(),r.update(f.getBytes());var y=r.digest().getBytes(),g=new s.util.ByteBuffer;g.fillWithByte(0,h-t-i-2),g.putByte(1),g.putBytes(l);var b=g.getBytes(),m=h-i-1,w=n.generate(y,m),_="";for(u=0;u<m;u++)_+=String.fromCharCode(b.charCodeAt(u)^w.charCodeAt(u));var E=65280>>8*h-d&255;return _=String.fromCharCode(_.charCodeAt(0)&~E)+_.substr(1),_+y+String.fromCharCode(188)},verify:function(e,o,a){var c,u=a-1,l=Math.ceil(u/8);if(o=o.substr(-l),l<i+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==o.charCodeAt(l-1))throw new Error("Encoded message does not end in 0xBC.");var d=l-i-1,h=o.substr(0,d),p=o.substr(d,i),f=65280>>8*l-u&255;if(0!==(h.charCodeAt(0)&f))throw new Error("Bits beyond keysize not zero as expected.");var y=n.generate(p,d),g="";for(c=0;c<d;c++)g+=String.fromCharCode(h.charCodeAt(c)^y.charCodeAt(c));g=String.fromCharCode(g.charCodeAt(0)&~f)+g.substr(1);var b=l-i-t-2;for(c=0;c<b;c++)if(0!==g.charCodeAt(c))throw new Error("Leftmost octets not zero as expected");if(1!==g.charCodeAt(b))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var m=g.substr(-t),w=new s.util.ByteBuffer;w.fillWithByte(0,8),w.putBytes(e),w.putBytes(m),r.start(),r.update(w.getBytes());var _=r.digest().getBytes();return p===_}};return c}},b405:function(e,t,r){"use strict";const s=r("6512");let n;e.exports=(e=!1)=>{if(n)return n;const t=s({singleProcess:e});return n={readLock:e=>async(...r)=>{const s=await t.readLock();try{return await e.apply(null,r)}finally{s()}},writeLock:e=>async(...r)=>{const s=await t.writeLock();try{return await e.apply(null,r)}finally{s()}}},n}},b488:function(e,t,r){"use strict";const s=r("b6aa"),{pipe:n}=r("66f2"),i=r("bbbe"),o=r("e66e"),{consume:a}=r("8b55"),c=r("9410"),u=r("c31e"),l=r("01f9"),d=r("7704"),h=r("73fb"),p=r("a9f4");class f{constructor(e){this.dht=e,this.readMessageTimeout=d.READ_MESSAGE_TIMEOUT,this._log=p.logger(this.dht.peerId,"net"),this._rpc=l(this.dht),this._onPeerConnected=this._onPeerConnected.bind(this),this._running=!1}async start(){if(this._running)return;if(!this.dht.isStarted)throw s(new Error("Can not start network"),"ERR_CANNOT_START_NETWORK");this._running=!0,!1===this.dht._clientMode&&this.dht.registrar.handle(this.dht.protocol,this._rpc);const e=new u({multicodecs:[this.dht.protocol],handlers:{onConnect:this._onPeerConnected,onDisconnect:()=>{}}});this._registrarId=await this.dht.registrar.register(e)}async stop(){(this.dht.isStarted||this.isStarted)&&(this._running=!1,this._registrarId&&await this.dht.registrar.unregister(this._registrarId))}get isStarted(){return this._running}get isConnected(){return this.dht.isStarted&&this.isStarted}async _onPeerConnected(e){await this.dht._add(e),this._log("added to the routing table: %s",e.toB58String())}async sendRequest(e,t){if(!this.isConnected)throw s(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");const r=e.toB58String();this._log("sending to: %s",r);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));const{stream:i}=await n.newStream(this.dht.protocol);return this._writeReadMessage(i,t.serialize())}async sendMessage(e,t){if(!this.isConnected)throw s(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");const r=e.toB58String();this._log("sending to: %s",r);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));const{stream:i}=await n.newStream(this.dht.protocol);return this._writeMessage(i,t.serialize())}async _writeReadMessage(e,t){return o(y(e,t),this.readMessageTimeout)}_writeMessage(e,t){return n([t],i.encode(),e,a)}}async function y(e,t){const r=await n([t],i.encode(),e,i.decode(),async e=>{const t=await c(e);if(t)return t.slice()});if(0===r.length)throw s(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED");return h.deserialize(r)}e.exports=f},b5c5:function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:relay"),{error:s("libp2p:relay:err")}),{setDelayedInterval:i,clearDelayedInterval:o}=r("63ee"),a=r("f27c"),{namespaceToCid:c}=r("1a4e"),{RELAY_RENDEZVOUS_NS:u}=r("076b");class l{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new a({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){const e=this._options.hop.enabled;e&&this._options.advertise.enabled&&(this._timeout=i(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){o(this._timeout)}async _advertiseService(){try{const e=await c(u);await this._libp2p.contentRouting.provide(e)}catch(e){"NO_ROUTERS_AVAILABLE"===e.code?(n.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):n.error(e)}}}e.exports=l},b605:function(e,t,r){"use strict";const{sortAll:s}=r("59c5"),n=r("5268"),i=r("335d"),o=r("3a1e");class a{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:r,value:s}of e)await this.put(r,s,t),yield{key:r,value:s}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(t,r){e.push({key:t,value:r})},delete(e){t.push(e)},commit:async r=>{await n(this.putMany(e,r)),e=[],await n(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(null!=e.prefix&&(r=i(r,t=>t.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(r=e.filters.reduce((e,t)=>i(e,t),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((e,t)=>s(e,t),r)),null!=e.offset){let t=0;r=i(r,()=>t++>=e.offset)}return null!=e.limit&&(r=o(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(null!=e.prefix&&(r=i(r,t=>t.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(r=e.filters.reduce((e,t)=>i(e,t),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((e,t)=>s(e,t),r)),null!=e.offset){let t=0;r=i(r,()=>t++>=e.offset)}return null!=e.limit&&(r=o(r,e.limit)),r}}e.exports=a},b623:function(e,t,r){"use strict";const s=r("0111"),n=r("5d98"),i=r("0e80"),{multihash:o}=i,a=r("c449"),c=r("fa4e"),u=r("f3bf"),l=r("d46b"),d=42;function h(e){let t;if("string"===typeof e)t=new a(e).bytes;else{if(!a.isCID(e))throw new Error("Could not tag CID - was not string or CID");t=e.bytes}return new s.Tagged(d,u([l("00","base16"),t],1+t.length))}function p(e){let t;try{t=c(e)}catch(s){t=!1}if(t)throw new Error("The object passed has circular references");function r(e){if(!e||e instanceof Uint8Array||"string"===typeof e)return e;if(Array.isArray(e))return e.map(r);if(a.isCID(e))return h(e);const t=Object.keys(e);if(t.length>0){const s={};return t.forEach(t=>{"object"===typeof e[t]?s[t]=r(e[t]):s[t]=e[t]}),s}return e}return r(e)}const f=n.DAG_CBOR,y=o.names["sha2-256"],g={[d]:e=>(e=e.slice(1),new a(e))},b=65536;let m=b;const w=67108864;let _,E=w;function v(e){let t=g;e?("number"===typeof e.size&&(m=e.size),"number"===typeof e.maxSize&&(E=e.maxSize),e.tags&&(t=Object.assign({},g,e&&e.tags))):(m=b,E=w);const r={tags:t,size:m};_=new s.Decoder(r),m=r.size}function S(e){const t=p(e),r=s.encode(t);return r}function I(e){if(e.length>m&&e.length<=E&&v({size:e.length}),e.length>m)throw new Error("Data is too large to deserialize with current decoder");const t=_.decodeAll(e);if(1!==t.length)throw new Error("Extraneous CBOR data found beyond initial top-level object");return t[0]}async function A(t,r={}){const s={cidVersion:null==r.cidVersion?1:r.cidVersion,hashAlg:null==r.hashAlg?e.exports.defaultHashAlg:r.hashAlg},c=o.codes[s.hashAlg],u=await i(t,c),l=n.getNameFromCode(e.exports.codec),d=new a(s.cidVersion,l,u);return d}v(),e.exports={codec:f,defaultHashAlg:y,configureDecoder:v,serialize:S,deserialize:I,cid:A}},b664:function(e,t,r){"use strict";const s=r("0e80").multihash,n=r("a9f4"),i=r("af50");class o{constructor(e,t,r){this.dht=e,this.key=t,this.makePath=r,this._log=n.logger(this.dht.peerId,"query:"+s.toB58String(t)),this.running=!1,this._onStart=this._onStart.bind(this),this._onComplete=this._onComplete.bind(this)}async run(e){return this.dht._queryManager.running?0===e.length?(this._log.error("Running query with no peers"),{finalSet:new Set,paths:[]}):(this._run=new i(this),this._log(`query running with K=${this.dht.kBucketSize}, A=${this.dht.concurrency}, D=${Math.min(this.dht.disjointPaths,e.length)}`),this._run.once("start",this._onStart),this._run.once("complete",this._onComplete),this._run.execute(e)):(this._log.error("Attempt to run query after shutdown"),{finalSet:new Set,paths:[]})}_onStart(){this.running=!0,this._startTime=Date.now(),this._log("query:start"),this.dht._queryManager.queryStarted(this)}_onComplete(){this.stop()}stop(){this._log(`query:done in ${Date.now()-(this._startTime||0)}ms`),this._run&&this._log(`${this._run.errors.length} of ${this._run.peersSeen.size} peers errored (${this._run.errors.length/this._run.peersSeen.size*100}% fail rate)`),this.running&&(this.running=!1,this._run&&(this._run.removeListener("start",this._onStart),this._run.removeListener("complete",this._onComplete),this._run.stop()),this.dht._queryManager.queryCompleted(this))}}e.exports=o},b6c5:function(e,t,r){"use strict";const s=r("888a");e.exports=(e,t)=>{const r=t.path||"ipfs";return new s(r,{autoMigrate:t.autoMigrate,onMigrationProgress:t.onMigrationProgress||e})}},b726:function(e,t,r){"use strict";const s=r("a29d"),{Multiaddr:n}=r("2054");e.exports=({repo:e})=>{async function t(t={}){const r=await e.config.get("Bootstrap",t);return{Peers:(r||[]).map(e=>new n(e))}}return s(t)}},b7268:function(e,t,r){"use strict";function s(e){return e>=55296&&e<=56319}function n(e){return e>=56320&&e<=57343}e.exports=function(e){if("string"!==typeof e)throw new Error("Input must be string");for(var t=e.length,r=0,i=null,o=null,a=0;a<t;a++)i=e.charCodeAt(a),n(i)?null!=o&&s(o)?r+=1:r+=3:i<=127?r+=1:i>=128&&i<=2047?r+=2:i>=2048&&i<=65535&&(r+=3),o=i;return r}},b73a:function(e,t,r){"use strict";t.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required"},t.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"}},b74e:function(e,t,r){"use strict";(function(t){const s=r("b6aa"),n=r("34eb")("ipfs:mfs:utils:to-async-iterator"),{MFS_MAX_CHUNK_SIZE:i}=r("4d04"),o=r("d46b"),a=e=>{if(!e)throw s(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if(("string"===typeof e||e instanceof String)&&(n("Content was a string"),e=o(e.toString())),e.length)return n("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield e}};if(e[Symbol.asyncIterator])return n("Content was an async iterator"),e;if(e[Symbol.iterator])return n("Content was an iterator"),e;if(t.Blob&&e instanceof t.Blob){n("Content was an HTML5 Blob");let r=0;const s={next:()=>r>e.size?{done:!0}:new Promise((s,n)=>{const o=e.slice(r,i);r+=i;const a=new t.FileReader,c=e=>{if(a.removeEventListener("loadend",c,!1),e.error)return n(e.error);s({done:!1,value:new Uint8Array(a.result)})};a.addEventListener("loadend",c),a.readAsArrayBuffer(o)})};return{[Symbol.asyncIterator]:()=>s}}throw s(new Error(`Don't know how to convert ${e} into an async iterator`),"ERR_INVALID_PARAMS")};e.exports=a}).call(this,r("c8ba"))},b789:function(e,t){e.exports=function(e){if(!e)throw Error("hashlru must have a max value, of type number, greater than 0");var t=0,r=Object.create(null),s=Object.create(null);function n(n,i){r[n]=i,t++,t>=e&&(t=0,s=r,r=Object.create(null))}return{has:function(e){return void 0!==r[e]||void 0!==s[e]},remove:function(e){void 0!==r[e]&&(r[e]=void 0),void 0!==s[e]&&(s[e]=void 0)},get:function(e){var t=r[e];return void 0!==t?t:void 0!==(t=s[e])?(n(e,t),t):void 0},set:function(e,t){void 0!==r[e]?r[e]=t:n(e,t)},clear:function(){r=Object.create(null),s=Object.create(null)}}}},b7cd:function(e){e.exports=JSON.parse('{"name":"ipfs-core","version":"0.8.0","description":"JavaScript implementation of the IPFS specification","keywords":["IPFS"],"homepage":"https://github.com/ipfs/js-ipfs/tree/master/packages/ipfs-core#readme","bugs":"https://github.com/ipfs/js-ipfs/issues","license":"(Apache-2.0 OR MIT)","leadMaintainer":"Alex Potsides <alex@achingbrain.net>","main":"src/index.js","types":"dist/src/index.d.ts","files":["src","dist","!dist/*.tsbuildinfo"],"browser":{"./src/runtime/init-assets-nodejs.js":"./src/runtime/init-assets-browser.js","./src/runtime/config-nodejs.js":"./src/runtime/config-browser.js","./src/runtime/dns-nodejs.js":"./src/runtime/dns-browser.js","./src/runtime/libp2p-nodejs.js":"./src/runtime/libp2p-browser.js","./src/runtime/libp2p-pubsub-routers-nodejs.js":"./src/runtime/libp2p-pubsub-routers-browser.js","./src/runtime/preload-nodejs.js":"./src/runtime/preload-browser.js","./src/runtime/repo-nodejs.js":"./src/runtime/repo-browser.js","./test/utils/create-repo-nodejs.js":"./test/utils/create-repo-browser.js","ipfs-utils/src/files/glob-source":false},"typesVersions":{"*":{"src/*":["dist/src/*","dist/src/*/index"],"src/":["dist/src/index"]}},"repository":{"type":"git","url":"git+https://github.com/ipfs/js-ipfs.git"},"scripts":{"build":"aegir build","lint":"aegir lint","test":"aegir test","test:node":"aegir test -t node","test:browser":"aegir test -t browser","test:webworker":"aegir test -t webworker","test:electron-main":"aegir test -t electron-main","test:electron-renderer":"aegir test -t electron-renderer","test:bootstrapers":"IPFS_TEST=bootstrapers aegir test -t browser -f test/bootstrapers.js","coverage":"nyc --reporter=text --reporter=lcov npm run test:node","clean":"rimraf ./dist","dep-check":"aegir dep-check -i interface-ipfs-core -i ipfs-core-types -i abort-controller"},"dependencies":{"abort-controller":"^3.0.0","array-shuffle":"^2.0.0","cborg":"^1.2.1","cids":"^1.1.6","dag-cbor-links":"^2.0.0","datastore-core":"^4.0.0","datastore-pubsub":"^0.6.1","debug":"^4.1.1","dlv":"^1.1.3","err-code":"^3.0.1","hamt-sharding":"^2.0.0","hashlru":"^2.3.0","interface-datastore":"^4.0.0","ipfs-bitswap":"^5.0.3","ipfs-block-service":"^0.19.0","ipfs-core-types":"^0.5.2","ipfs-core-utils":"^0.8.3","ipfs-repo":"^9.1.6","ipfs-unixfs":"^4.0.3","ipfs-unixfs-exporter":"^5.0.3","ipfs-unixfs-importer":"^7.0.3","ipfs-utils":"^8.1.2","ipld":"^0.30.0","ipld-block":"^0.11.0","ipld-dag-cbor":"^1.0.0","ipld-dag-pb":"^0.22.1","ipld-raw":"^7.0.0","ipns":"^0.12.0","is-domain-name":"^1.0.1","is-ipfs":"^5.0.0","it-all":"^1.0.4","it-drain":"^1.0.3","it-first":"^1.0.4","it-last":"^1.0.4","it-map":"^1.0.4","it-pipe":"^1.1.0","just-safe-set":"^2.2.1","libp2p":"^0.31.6","libp2p-bootstrap":"^0.12.3","libp2p-crypto":"^0.19.3","libp2p-floodsub":"^0.25.1","libp2p-gossipsub":"^0.9.2","libp2p-kad-dht":"^0.22.0","libp2p-mdns":"^0.16.0","libp2p-mplex":"^0.10.2","libp2p-noise":"^3.1.0","libp2p-record":"^0.10.3","libp2p-tcp":"^0.15.4","libp2p-webrtc-star":"^0.22.2","libp2p-websockets":"^0.15.6","mafmt":"^9.0.0","merge-options":"^3.0.4","mortice":"^2.0.0","multiaddr":"^9.0.1","multiaddr-to-uri":"^7.0.0","multibase":"^4.0.2","multicodec":"^3.0.1","multihashing-async":"^2.1.2","native-abort-controller":"^1.0.3","p-queue":"^6.6.1","parse-duration":"^1.0.0","peer-id":"^0.14.1","streaming-iterables":"^5.0.2","uint8arrays":"^2.1.3"},"devDependencies":{"@types/dlv":"^1.1.2","aegir":"^33.0.0","delay":"^5.0.0","go-ipfs":"0.8.0","interface-ipfs-core":"^0.147.0","ipfsd-ctl":"^8.0.1","ipld-git":"^0.6.1","iso-url":"^1.0.0","nanoid":"^3.1.12","p-defer":"^3.0.0","rimraf":"^3.0.2","sinon":"^10.0.1"},"gitHead":"81f944163f5a78ef15fdc23b2c488ba7f44af0be"}')},b7df:function(e,t,r){"use strict";const s={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};e.exports=s},b846:function(e,t,r){"use strict";const s=r("b6aa"),n=(e,t,r)=>{if(t||(t=0),t<0)throw s(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(t>e)throw s(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(r||0===r||(r=e-t),r<0)throw s(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return t+r>e&&(r=e-t),{offset:t,length:r}};e.exports=n},b84f:function(e,t,r){"use strict";const s=r("a29d");e.exports=({network:e})=>{async function t(t={}){const{bitswap:r}=await e.use(t),s=r.getWantlist();return Array.from(s).map(e=>e[1].cid)}return s(t)}},b92d:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("1755"),n=r("ac23");const i=[24,256,65536,4294967296,BigInt("18446744073709551616")];function o(e,t,r){n.assertEnoughData(e,t,1);const s=e[t];if(!0===r.strict&&s<i[0])throw new Error(n.decodeErrPrefix+" integer encoded in more bytes than necessary (strict decode)");return s}function a(e,t,r){n.assertEnoughData(e,t,2);const s=e[t]<<8|e[t+1];if(!0===r.strict&&s<i[1])throw new Error(n.decodeErrPrefix+" integer encoded in more bytes than necessary (strict decode)");return s}function c(e,t,r){n.assertEnoughData(e,t,4);const s=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===r.strict&&s<i[2])throw new Error(n.decodeErrPrefix+" integer encoded in more bytes than necessary (strict decode)");return s}function u(e,t,r){n.assertEnoughData(e,t,8);const s=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],a=(BigInt(s)<<BigInt(32))+BigInt(o);if(!0===r.strict&&a<i[3])throw new Error(n.decodeErrPrefix+" integer encoded in more bytes than necessary (strict decode)");if(a<=Number.MAX_SAFE_INTEGER)return Number(a);if(!0===r.allowBigInt)return a;throw new Error(n.decodeErrPrefix+" integers outside of the safe integer range are not supported")}function l(e,t,r,n){return new s.Token(s.Type.uint,o(e,t+1,n),2)}function d(e,t,r,n){return new s.Token(s.Type.uint,a(e,t+1,n),3)}function h(e,t,r,n){return new s.Token(s.Type.uint,c(e,t+1,n),5)}function p(e,t,r,n){return new s.Token(s.Type.uint,u(e,t+1,n),9)}function f(e,t){return y(e,0,t.value)}function y(e,t,r){if(r<i[0]){const s=Number(r);e.push([t|s])}else if(r<i[1]){const s=Number(r);e.push([24|t,s])}else if(r<i[2]){const s=Number(r);e.push([25|t,s>>>8,255&s])}else if(r<i[3]){const s=Number(r);e.push([26|t,s>>>24&255,s>>>16&255,s>>>8&255,255&s])}else{const s=BigInt(r);if(!(s<i[4]))throw new Error(n.decodeErrPrefix+" encountered BigInt larger than allowable range");{const r=[27|t,0,0,0,0,0,0,0];let n=Number(s&BigInt(4294967295)),i=Number(s>>BigInt(32)&BigInt(4294967295));r[8]=255&n,n>>=8,r[7]=255&n,n>>=8,r[6]=255&n,n>>=8,r[5]=255&n,r[4]=255&i,i>>=8,r[3]=255&i,i>>=8,r[2]=255&i,i>>=8,r[1]=255&i,e.push(r)}}}f.encodedSize=function(e){return y.encodedSize(e.value)},y.encodedSize=function(e){return e<i[0]?1:e<i[1]?2:e<i[2]?3:e<i[3]?5:9},f.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0},t.decodeUint16=d,t.decodeUint32=h,t.decodeUint64=p,t.decodeUint8=l,t.encodeUint=f,t.encodeUintValue=y,t.readUint16=a,t.readUint32=c,t.readUint64=u,t.readUint8=o,t.uintBoundaries=i},b97b:function(e,t,r){"use strict";const s=r(30),n=r("34eb"),{promisify:i}=r("0321"),{Multiaddr:o}=r("2054"),a=Object.assign(n("libp2p:nat"),{error:n("libp2p:nat:err")}),{isBrowser:c}=r("89d9"),u=r("559d"),l=r("78c8"),d=r("38425"),h=r("b6aa"),{codes:{ERR_INVALID_PARAMETERS:p}}=r("b73a"),f=r("0910"),y=7200;function g(e=1024,t=65535){return Math.floor(Math.random()*(t-e+1)+e)}class b{constructor({peerId:e,addressManager:t,transportManager:r,...s}){if(this._peerId=e,this._addressManager=t,this._transportManager=r,this._enabled=s.enabled,this._externalIp=s.externalIp,this._options={description:s.description||`${d.name}@${d.version} ${this._peerId}`,ttl:s.ttl||y,autoUpdate:s.keepAlive||!0,gateway:s.gateway,enablePMP:Boolean(s.pmp&&s.pmp.enabled)},this._options.ttl<y)throw h(new Error(`NatManager ttl should be at least ${y} seconds`),p)}start(){!c&&this._enabled&&this._start().catch(e=>{a.error(e)})}async _start(){const e=this._transportManager.getAddrs();for(const t of e){const{family:e,host:r,port:s,transport:n}=t.toOptions();if(!t.isThinWaistAddress()||"tcp"!==n)continue;if(f(t))continue;if(4!==e)continue;const i=this._getClient(),c=this._externalIp||await i.externalIp();if(l(c))throw new Error(c+" is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT");const u=g();a(`opening uPnP connection from ${c}:${u} to ${r}:${s}`),await i.map({publicPort:u,privatePort:s,protocol:n.toUpperCase()}),this._addressManager.addObservedAddr(o.fromNodeAddress({family:4,address:c,port:u},n))}}_getClient(){if(this._client)return this._client;const e=new s(this._options),t=i(e.map.bind(e)),r=i(e.destroy.bind(e)),n=i(e.externalIp.bind(e));return this._client={map:(...e)=>u(()=>t(...e),{onFailedAttempt:a.error,unref:!0}),destroy:(...e)=>u(()=>r(...e),{onFailedAttempt:a.error,unref:!0}),externalIp:(...e)=>u(()=>n(...e),{onFailedAttempt:a.error,unref:!0})},this._client}async stop(){if(!c&&this._client)try{await this._client.destroy(),this._client=null}catch(e){a.error(e)}}}e.exports=b},b98d:function(e,t){var r=Math.pow(2,7),s=Math.pow(2,14),n=Math.pow(2,21),i=Math.pow(2,28),o=Math.pow(2,35),a=Math.pow(2,42),c=Math.pow(2,49),u=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<r?1:e<s?2:e<n?3:e<i?4:e<o?5:e<a?6:e<c?7:e<u?8:e<l?9:10}},b9e5:function(e,t,r){"use strict";const{default:s}=r("987e"),n=r("670b"),i=r("34eb"),o=Object.assign(i("ipfs:preload"),{error:i("ipfs:preload:error")}),a=new s({concurrency:4});e.exports=function(e,t={}){return o(e),a.add(async()=>{const r=await n.post(e,{signal:t.signal}),s=r.body.getReader();try{while(1){const{done:e}=await s.read();if(e)return}}finally{s.releaseLock()}})}},b9fa:function(e,t,r){"use strict";t.util=r("7022"),t.resolver=r("eeba"),t.codec=t.util.codec,t.defaultHashAlg=t.util.defaultHashAlg},ba11:function(e,t,r){"use strict";function s(e,t){return e.length===t.length&&t.sort()&&e.sort().every((e,r)=>t[r].equals(e))}e.exports=s},baa5:function(e,t,r){"use strict";const s=r("4fcb"),{pipe:n}=r("66f2"),{tap:i}=r("8b55"),o=r("b0fc"),{METRICS:a}=r("7df1"),c=r("9f09"),u=["dataReceived","dataSent"],l={in:"dataReceived",out:"dataSent"};class d{constructor(e){this._options=s(a,e),this._globalStats=new c(u,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=o(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._connectionManager=e.connectionManager,this._connectionManager.on("peer:disconnect",e=>{this.onPeerDisconnected(e.remotePeer)})}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(const e of this._peerStats.values())e.stop();for(const e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}forPeer(e){const t=e.toB58String();return this._peerStats.get(t)||this._oldPeers.get(t)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){const t=e.toB58String(),r=this._peerStats.get(t);r&&(r.stop(),this._peerStats.delete(t),this._oldPeers.set(t,r))}_onMessage({remotePeer:e,protocol:t,direction:r,dataLength:s}){if(!this._running)return;const n=l[r];let i=this.forPeer(e);if(i||(i=new c(u,this._options),this._peerStats.set(e.toB58String(),i)),i.push(n,s),this._globalStats.push(n,s),t){let e=this.forProtocol(t);e||(e=new c(u,this._options),this._protocolStats.set(t,e)),e.push(n,s)}}updatePlaceholder(e,t){if(!this._running)return;const r=this.forPeer(e),s=t.toB58String(),n=this.forPeer(t);let i=r;n&&(i=d.mergeStats(n,i),this._oldPeers.delete(s)),this._peerStats.delete(e.toB58String()),this._peerStats.set(s,i),i.start()}trackStream({stream:e,remotePeer:t,protocol:r}){const s=this,o=e.source;e.source=i(e=>s._onMessage({remotePeer:t,protocol:r,direction:"in",dataLength:e.length}))(o);const a=e.sink;return e.sink=e=>n(e,i(e=>s._onMessage({remotePeer:t,protocol:r,direction:"out",dataLength:e.length})),a),e}static mergeStats(e,t){return e.stop(),t.stop(),e._queue=[...e._queue,...t._queue],e}}e.exports=d},bac1:function(e,t,r){"use strict";async function*s(e,t={}){const r=e.getReader();try{while(1){const e=await r.read();if(e.done)return;yield e.value}}finally{!0!==t.preventCancel&&r.cancel(),r.releaseLock()}}e.exports=s},bb8f:function(e,t,r){"use strict";const s=r("3642");e.exports=(e,t={})=>{if(!s(e)&&!Array.isArray(e))throw new TypeError("Expected a plain object or array");const{deep:r}=t,n=[],i=[],o=e=>{const t=n.indexOf(e);if(-1!==t)return i[t];const r=[];return n.push(e),i.push(r),r.push(...e.map(e=>Array.isArray(e)?o(e):s(e)?a(e):e)),r},a=e=>{const c=n.indexOf(e);if(-1!==c)return i[c];const u={},l=Object.keys(e).sort(t.compare);n.push(e),i.push(u);for(const t of l){const n=e[t];let i;i=r&&Array.isArray(n)?o(n):r&&s(n)?a(n):n,Object.defineProperty(u,t,{...Object.getOwnPropertyDescriptor(e,t),value:i})}return u};return Array.isArray(e)?r?o(e):e.slice():a(e)}},bb9f:function(e,t,r){"use strict";const s=r("b7cd"),n=r("a29d");e.exports=({repo:e})=>{async function t(t={}){const r=await e.version.get();return{version:s.version,repo:""+r,commit:s.gitHead||"","interface-ipfs-core":s.devDependencies["interface-ipfs-core"]}}return n(t)}},bc82:function(e,t,r){"use strict";const{DAGLink:s,DAGNode:n}=r("8141"),{UnixFS:i}=r("9fd0"),o=r("0bb1"),a=r("3ba3"),{createHAMT:c,Bucket:u}=r("d81a");class l extends o{constructor(e,t){super(e,t),this._bucket=c({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){for await(const t of d(this._bucket,e,this,this.options))yield{...t,path:this.path}}}async function*d(e,t,r,o){const c=e._children,l=[];let h=0;for(let n=0;n<c.length;n++){const e=c.get(n);if(!e)continue;const r=n.toString(16).toUpperCase().padStart(2,"0");if(e instanceof u){let n;for await(const r of await d(e,t,null,o))n=r;if(!n)throw new Error("Could not flush sharded directory, no subshard found");l.push(new s(r,n.size,n.cid)),h+=n.size}else if("function"===typeof e.value.flush){const n=e.value;let i;for await(const e of n.flush(t))i=e,yield i;const o=r+e.key;l.push(new s(o,i.size,i.cid)),h+=i.size}else{const t=e.value;if(!t.cid)continue;const n=r+e.key,i=t.size;l.push(new s(n,i,t.cid)),h+=i}}const p=Uint8Array.from(c.bitField().reverse()),f=new i({type:"hamt-sharded-directory",data:p,fanout:e.tableSize(),hashType:o.hamtHashCode,mtime:r&&r.mtime,mode:r&&r.mode}),y=new n(f.marshal(),l),g=y.serialize(),b=await a(g,t,o),m=g.length+h;yield{cid:b,unixfs:f,size:m}}e.exports=l},bd20:function(e,t,r){"use strict";const s=r("b6aa"),n=r("eddf"),{codes:{ERR_INVALID_PARAMETERS:i}}=r("b73a"),o=e=>e;class a{constructor({peerStore:e,eventName:t,eventProperty:r,eventTransformer:s=o}){this._ps=e,this.eventName=t,this.eventProperty=r,this.eventTransformer=s,this.data=new Map}set(e,t){throw s(new Error("set must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}_setData(e,t,{emit:r=!0}={}){const s=e.toB58String();this.data.set(s,t),r&&this._emit(e,t)}_emit(e,t){this._ps.emit(this.eventName,{peerId:e,[this.eventProperty]:this.eventTransformer(t)})}get(e){if(!n.isPeerId(e))throw s(new Error("peerId must be an instance of peer-id"),i);const t=this.data.get(e.toB58String());return t?[...t]:void 0}delete(e){if(!n.isPeerId(e))throw s(new Error("peerId must be an instance of peer-id"),i);return!!this.data.delete(e.toB58String())&&(this._emit(e,[]),!0)}}e.exports=a},bd3b:function(e,t,r){"use strict";const s=r("4fcb"),{dnsaddrResolver:n}=r("bd64"),i=r("7df1"),{AGENT_VERSION:o}=r("4c82"),a=r("076b"),{publicAddressesFirst:c}=r("b0c7"),{FaultTolerance:u}=r("9edf"),l={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:e=>e},connectionManager:{minConnections:25},transportManager:{faultTolerance:u.FATAL_ALL},dialer:{maxParallelDials:i.MAX_PARALLEL_DIALS,maxDialsPerPeer:i.MAX_PER_PEER_DIALS,dialTimeout:i.DIAL_TIMEOUT,resolvers:{dnsaddr:n},addressSorter:c},host:{agentVersion:o},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{dht:{enabled:!1,kBucketSize:20,randomWalk:{enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:a.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:a.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};e.exports.validate=e=>{const t=s(l,e);if(t.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return t}},bd64:function(e,t,r){"use strict";const s=r("956c"),{code:n}=s("dnsaddr");async function i(e){const t=r("4d9b"),s=new t,i=e.getPeerId(),[,o]=e.stringTuples().find(([e])=>e===n)||[],a=await s.resolveTxt("_dnsaddr."+o);let c=a.flat().map(e=>e.split("=")[1]);return i&&(c=c.filter(e=>e.includes(i))),c}e.exports={dnsaddrResolver:i}},be0e:function(e,t,r){"use strict";const s=r("a55b"),n=r("266c"),i=r("4ee3"),o=r("e3f0");class a{constructor({ipld:e,pin:t,preload:r,gcLock:a}){this.get=s({ipld:e,preload:r}),this.resolve=n({ipld:e,preload:r}),this.tree=i({ipld:e,preload:r}),this.put=o({ipld:e,preload:r,pin:t,gcLock:a})}}e.exports=a},be58:function(e,t,r){"use strict";const s=r("b6aa"),{UnixFS:n}=r("9fd0"),i=r("7cc5"),o=(e,t)=>{const r=e.Links.find(e=>e.Name===t);return r&&r.Hash},a={raw:r("509b"),file:r("509b"),directory:r("684e"),"hamt-sharded-directory":r("ca58"),metadata:(e,t,r,s,n,i,o)=>()=>[],symlink:(e,t,r,s,n,i,o)=>()=>[]},c=async(e,t,r,c,u,l,d,h)=>{const p=await d.get(e,h);let f,y;t||(t=e.toString());try{f=n.unmarshal(p.Data)}catch(g){throw s(g,"ERR_NOT_UNIXFS")}if(r||(r=t),c.length){let e;if(e=f&&"hamt-sharded-directory"===f.type?await i(p,c[0],d):o(p,c[0]),!e)throw s(new Error("file does not exist"),"ERR_NOT_FOUND");const t=c.shift(),n=`${r}/${t}`;y={cid:e,toResolve:c,name:t||"",path:n}}return{entry:{type:f.isDirectory()?"directory":"file",name:t,path:r,cid:e,content:a[f.type](e,p,f,r,u,l,d),unixfs:f,depth:l,node:p,size:f.fileSize()},next:y}};e.exports=c},bee7:function(e,t){e.exports=n;var r=128,s=127;function n(e,t){var i,o=0,a=(t=t||0,0),c=t,u=e.length;do{if(c>=u||a>49)throw n.bytes=0,new RangeError("Could not decode varint");i=e[c++],o+=a<28?(i&s)<<a:(i&s)*Math.pow(2,a),a+=7}while(i>=r);return n.bytes=c-t,o}},bf15:function(e,t,r){"use strict";const s=r("0eff");function n(e){return new s(e.Name||e.name||"",e.Tsize||e.Size||e.size||0,e.Hash||e.hash||e.multihash||e.cid)}e.exports={createDagLinkFromB58EncodedHash:n}},bf4e:function(e,t){function r(e){for(var t=r.BASE,s=0,n=e.length;s<n;s++)t^=e.charCodeAt(s),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}r.BASE=2166136261,e.exports=r},bfcd:function(e,t,r){"use strict";const s=r("5c63"),n=r("92dc"),i=r("9b62f"),o=r("acea"),a=r("ce74").logger,c=r("0c5c"),{AbortController:u}=r("c181"),{anySignal:l}=r("74fd"),d={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},h=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"];class p{constructor(e,t,r={}){this._libp2p=e,this._log=a(this.peerId),this._options=Object.assign({},d,r),this._stats=new c(h,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new n(e,this,this._stats),this.blockstore=t,this.engine=new i(this.peerId,t,this.network,this._stats),this.wm=new s(this.peerId,this.network,this._stats),this.notifications=new o(this.peerId)}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch(n){this._log("failed to receive message",t)}if(0===t.blocks.size)return;const r=Array.from(t.blocks.values()),s=r.filter(e=>this.wm.wantlist.contains(e.cid)).map(e=>e.cid);this.wm.cancelWants(s),await Promise.all(r.map(async t=>{const r=s.includes(t.cid);await this._handleReceivedBlock(e,t,r)}))}async _handleReceivedBlock(e,t,r){this._log("received block");const s=await this.blockstore.has(t.cid);this._updateReceiveCounters(e.toB58String(),t,s),r&&await this.put(t)}_updateReceiveCounters(e,t,r){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",t.data.length),r&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",t.data.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,t={}){const r=(e,t)=>(this.wm.wantBlocks([e],t),this.notifications.wantBlock(e,t));let s=!1;const n=async(e,t)=>{try{const r=await this.blockstore.get(e,t);return r}catch(n){if("ERR_NOT_FOUND"!==n.code)throw n;return s||(s=!0,this.network.findAndConnect(e).catch(e=>this._log.error(e))),r(e,t)}},i=new u,o=t.signal?l([t.signal,i.signal]):i.signal,a=await Promise.race([this.notifications.wantBlock(e,{signal:o}),n(e,{signal:o})]);return i.abort(),a}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}unwant(e){const t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach(e=>this.notifications.unwantBlock(e))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t){await this.blockstore.put(e),this._sendHaveBlockNotifications(e)}async*putMany(e){for await(const t of this.blockstore.putMany(e))this._sendHaveBlockNotifications(t),yield t}_sendHaveBlockNotifications(e){this.notifications.hasBlock(e),this.engine.receivedBlocks([e]),this.network.provide(e.cid).catch(e=>{this._log.error("Failed to provide: %s",e.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}start(){this.wm.start(),this.network.start(),this.engine.start()}stop(){this._stats.stop(),this.wm.stop(),this.network.stop(),this.engine.stop()}}e.exports=p},bfea:function(e,t,r){"use strict";const s=r("a29d");e.exports=function({repo:e}){async function*t(t={}){for await(const r of e.blocks.queryKeys({},{signal:t.signal}))yield{ref:r.toString()}}return s(t)}},c003:function(e,t,r){"use strict";const s=r("76a0"),n=async(e,t,r)=>s(new Array(e).fill(),(e,r)=>t(r),r);e.exports=n,e.exports.default=n},c020:function(e,t,r){"use strict";const s=r("cfa2");function n(e){return"function"===typeof e.stream?s(e.stream()):s(new Response(e).body)}e.exports=n},c09e:function(e,t,r){"use strict";const{isElectronMain:s}=r("2984");e.exports=r(s?28:"93ff")},c0f4:function(e,t,r){"use strict";const s=r("b6aa"),n=r("b2a9"),i=r("b846"),o=r("0e80").multihash,a=e=>{async function*t(t={}){const{offset:r,length:s}=i(e.length,t.offset,t.length);yield n(e,0,r,r+s)}return t},c=async(e,t,r,n,i,c,u,l)=>{if(n.length)throw s(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");const d=await o.decode(e.multihash);return{entry:{type:"identity",name:t,path:r,cid:e,content:a(d.digest),depth:c,size:d.length,node:d.digest}}};e.exports=c},c129:function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:peer-store:address-book"),{error:s("libp2p:peer-store:address-book:err")}),i=r("b6aa"),{Multiaddr:o}=r("2054"),a=r("eddf"),c=r("bd20"),u=r("54b0"),{codes:{ERR_INVALID_PARAMETERS:l}}=r("b73a"),d=r("7cb6");class h extends c{constructor(e){super({peerStore:e,eventName:"change:multiaddrs",eventProperty:"multiaddrs",eventTransformer:e=>e.addresses?e.addresses.map(e=>e.multiaddr):[]}),this.data=new Map}consumePeerRecord(e){let t;try{t=u.createFromProtobuf(e.payload)}catch(c){return n.error("invalid peer record received"),!1}if(!t.peerId.equals(e.peerId))return n("signing key does not match PeerId in the PeerRecord"),!1;if(!t.multiaddrs||!t.multiaddrs.length)return!1;const r=t.peerId,s=r.toB58String(),i=this.data.get(s)||{record:void 0},o=i.record;if(o&&o.seqNumber>=t.seqNumber)return!1;const a=this._toAddresses(t.multiaddrs,!0);return this._setData(r,{addresses:a,record:{raw:e.marshal(),seqNumber:t.seqNumber}}),n("stored provided peer record for "+s),!0}getRawEnvelope(e){const t=this.data.get(e.toB58String());if(t&&t.record&&t.record.raw)return t.record.raw}getPeerRecord(e){const t=this.getRawEnvelope(e);if(t)return d.createFromProtobuf(t)}set(e,t){if(!a.isPeerId(e))throw n.error("peerId must be an instance of peer-id to store data"),i(new Error("peerId must be an instance of peer-id"),l);const r=this._toAddresses(t);if(!r.length)return this;const s=e.toB58String(),o=this.data.get(s);if(o&&o.addresses&&o.addresses.length===r.length){const e=o.addresses.filter(e=>r.some(t=>e.multiaddr.equals(t.multiaddr)));if(e.length===o.addresses.length)return n("the addresses provided to store are equal to the already stored for "+s),this}return this._setData(e,{addresses:r,record:o&&o.record}),n("stored provided multiaddrs for "+s),o||this._ps.emit("peer",e),this}add(e,t){if(!a.isPeerId(e))throw n.error("peerId must be an instance of peer-id to store data"),i(new Error("peerId must be an instance of peer-id"),l);const r=this._toAddresses(t),s=e.toB58String();if(!r.length)return this;const o=this.data.get(s);return o&&o.addresses&&(o.addresses.forEach(e=>{r.find(t=>t.multiaddr.equals(e.multiaddr))||r.push(e)}),o.addresses.length===r.length)?(n("the addresses provided to store are already stored for "+s),this):(this._setData(e,{addresses:r,record:o&&o.record}),n("added provided multiaddrs for "+s),o&&o.addresses||this._ps.emit("peer",e),this)}get(e){if(!a.isPeerId(e))throw i(new Error("peerId must be an instance of peer-id"),l);const t=this.data.get(e.toB58String());return t&&t.addresses?[...t.addresses]:void 0}_toAddresses(e,t=!1){if(!e)throw n.error("multiaddrs must be provided to store data"),i(new Error("multiaddrs must be provided"),l);const r=[];return e.forEach(e=>{if(!o.isMultiaddr(e))throw n.error(`multiaddr ${e} must be an instance of multiaddr`),i(new Error(`multiaddr ${e} must be an instance of multiaddr`),l);r.find(t=>t.multiaddr.equals(e))||r.push({multiaddr:e,isCertified:t})}),r}getMultiaddrsForPeer(e,t=(e=>e)){if(!a.isPeerId(e))throw i(new Error("peerId must be an instance of peer-id"),l);const r=this.data.get(e.toB58String());if(r&&r.addresses)return t(r.addresses||[]).map(t=>{const r=t.multiaddr,s=r.getPeerId();return s&&s===e.toB58String()?r:r.encapsulate("/p2p/"+e.toB58String())})}}e.exports=h},c181:function(e,t,r){"use strict";let s;s=globalThis.AbortController&&globalThis.AbortSignal?globalThis:r("91d3"),e.exports={AbortController:s.AbortController,AbortSignal:s.AbortSignal}},c1c8:function(e,t,r){(function(t){const s=r("faa1").EventEmitter,{nanoid:n}=r("e1bd"),{WORKER_REQUEST_READ_LOCK:i,WORKER_RELEASE_READ_LOCK:o,MASTER_GRANT_READ_LOCK:a,WORKER_REQUEST_WRITE_LOCK:c,WORKER_RELEASE_WRITE_LOCK:u,MASTER_GRANT_WRITE_LOCK:l}=r("8618");let d;const h=(e,t,r,s,n)=>(i,o)=>{o&&o.type===r&&e.emit(t,o.name,()=>(i.send({type:n,name:o.name,identifier:o.identifier}),new Promise(e=>{const t=r=>{r&&r.type===s&&r.identifier===o.identifier&&(i.removeListener("message",t),e())};i.on("message",t)})))},p=(e,r,s,i)=>()=>{const o=n();return t.send({type:r,identifier:o,name:e}),new Promise(r=>{const n=a=>{a&&a.type===s&&a.identifier===o&&(t.removeListener("message",n),r(()=>{t.send({type:i,identifier:o,name:e})}))};t.on("message",n)})};e.exports=e=>{try{if(d=r(29),!Object.keys(d).length)return}catch(t){return}if(d.isMaster||e.singleProcess){const e=new s;return d.on("message",h(e,"requestReadLock",i,o,a)),d.on("message",h(e,"requestWriteLock",c,u,l)),e}return{isWorker:!0,readLock:e=>p(e,i,a,o),writeLock:e=>p(e,c,l,u)}}}).call(this,r("4362"))},c2a4:function(e,t,r){"use strict";const s=r("a29d");e.exports=({ipld:e,gcLock:t,preload:n})=>{const i=r("69d3")({ipld:e,preload:n}),o=r("5ec0")({ipld:e,gcLock:t,preload:n});async function a(e,t,r={}){const s=await i(e,r);return s.rmLink(t.Name||t.name||t),o(s,r)}return s(a)}},c2d2:function(e,t,r){"use strict";const{Buffer:s}=r("1c35");t.utf8=t["utf-8"]={encode:function(e){return o(e)?e:String(e)},decode:i,buffer:!1,type:"utf8"},t.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"},t.binary={encode:function(e){return o(e)?e:s.from(e)},decode:i,buffer:!0,type:"binary"},t.none={encode:i,decode:i,buffer:!1,type:"id"},t.id=t.none;const n=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(const a of n)t[a]={encode:function(e){return o(e)?e:s.from(e,a)},decode:function(e){return e.toString(a)},buffer:!0,type:a};function i(e){return e}function o(e){return void 0===e||null===e||s.isBuffer(e)}},c2d6:function(e,t,r){"use strict";const{Adapter:s,Key:n,Errors:i}=r("1304"),o=r("07be"),a=r("6f2b"),c=new n(o.SHARDING_FN),u=new n(o.README_FN);class l extends s{constructor(e,t){super(),this.child=new a(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=t}async open(){await this.child.open(),this.shard=await l.create(this.child,this.shard)}_convertKey(e){const t=e.toString();if(t===c.toString()||t===u.toString())return e;const r=new n(this.shard.fun(t));return r.child(e)}_invertKey(e){const t=e.toString();return t===c.toString()||t===u.toString()?e:n.withNamespaces(e.list().slice(1))}static async createOrOpen(e,t){try{await l.create(e,t)}catch(r){if(r&&"datastore exists"!==r.message)throw r}return l.open(e)}static async open(e){const t=await o.readShardFun("/",e);return new l(e,t)}static async create(e,t){const r=await e.has(c);if(!r&&!t)throw i.dbOpenFailedError(Error("Shard is required when datastore doesn't have a shard key already."));if(!r){const r="function"===typeof e.putRaw?e.putRaw.bind(e):e.put.bind(e);return await Promise.all([r(c,(new TextEncoder).encode(t.toString()+"\n")),r(u,(new TextEncoder).encode(o.readme))]),t}const s=await o.readShardFun("/",e),n=(s||"").toString(),a=t.toString();if(n!==a)throw new Error(`specified fun ${a} does not match repo shard fun ${n}`);return s}put(e,t,r){return this.child.put(e,t,r)}get(e,t){return this.child.get(e,t)}has(e,t){return this.child.has(e,t)}delete(e,t){return this.child.delete(e,t)}batch(){return this.child.batch()}query(e,t){const r={offset:e.offset,limit:e.limit,orders:[],filters:[e=>e.key.toString()!==c.toString(),e=>e.key.toString()!==u.toString()]},{prefix:s}=e;if(null!=s&&r.filters.push(e=>this._invertKey(e.key).toString().startsWith(s)),null!=e.filters){const t=e.filters.map(e=>{const t=({key:t,value:r})=>e({key:this._invertKey(t),value:r});return t});r.filters=r.filters.concat(t)}return null!=e.orders&&(r.orders=e.orders.map(e=>{const t=(t,r)=>e({key:this._invertKey(t.key),value:t.value},{key:this._invertKey(r.key),value:r.value});return t})),this.child.query(r,t)}queryKeys(e,t){const r={offset:e.offset,limit:e.limit,orders:[],filters:[e=>e.toString()!==c.toString(),e=>e.toString()!==u.toString()]},{prefix:s}=e;if(null!=s&&r.filters.push(e=>this._invertKey(e).toString().startsWith(s)),null!=e.filters){const t=e.filters.map(e=>{const t=t=>e(this._invertKey(t));return t});r.filters=r.filters.concat(t)}return null!=e.orders&&(r.orders=e.orders.map(e=>{const t=(t,r)=>e(this._invertKey(t),this._invertKey(r));return t})),this.child.queryKeys(r,t)}close(){return this.child.close()}}e.exports=l},c2de:function(e,t){class r{constructor(e,t=12,r=8192,s=32768,n=64,i){this.bits=t,this.min=r,this.max=s,this.asModule=e,this.rabin=new e.Rabin(t,r,s,n,i),this.polynomial=i}fingerprint(e){const{__retain:t,__release:r,__allocArray:s,__getInt32Array:n,Int32Array_ID:i,Uint8Array_ID:o}=this.asModule,a=new Int32Array(Math.ceil(e.length/this.min)),c=t(s(i,a)),u=t(s(o,e)),l=this.rabin.fingerprint(u,c),d=n(l);r(u),r(c);const h=d.indexOf(0);return h>=0?d.subarray(0,h):d}}e.exports=r},c2f9:function(e,t,r){"use strict";var s=r("543b"),n=s.Reader,i=s.Writer,o=s.util,a=s.roots["ipfs-unixfs"]||(s.roots["ipfs-unixfs"]={});a.Data=function(){function e(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Type=0,e.prototype.Data=o.newBuffer([]),e.prototype.filesize=o.Long?o.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=o.emptyArray,e.prototype.hashType=o.Long?o.Long.fromBits(0,0,!0):0,e.prototype.fanout=o.Long?o.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(e,t){if(t||(t=i.create()),t.uint32(8).int32(e.Type),null!=e.Data&&Object.hasOwnProperty.call(e,"Data")&&t.uint32(18).bytes(e.Data),null!=e.filesize&&Object.hasOwnProperty.call(e,"filesize")&&t.uint32(24).uint64(e.filesize),null!=e.blocksizes&&e.blocksizes.length)for(var r=0;r<e.blocksizes.length;++r)t.uint32(32).uint64(e.blocksizes[r]);return null!=e.hashType&&Object.hasOwnProperty.call(e,"hashType")&&t.uint32(40).uint64(e.hashType),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(48).uint64(e.fanout),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(56).uint32(e.mode),null!=e.mtime&&Object.hasOwnProperty.call(e,"mtime")&&a.UnixTime.encode(e.mtime,t.uint32(66).fork()).ldelim(),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Data;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.Type=e.int32();break;case 2:s.Data=e.bytes();break;case 3:s.filesize=e.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),2===(7&i)){var c=e.uint32()+e.pos;while(e.pos<c)s.blocksizes.push(e.uint64())}else s.blocksizes.push(e.uint64());break;case 5:s.hashType=e.uint64();break;case 6:s.fanout=e.uint64();break;case 7:s.mode=e.uint32();break;case 8:s.mtime=a.UnixTime.decode(e,e.uint32());break;default:e.skipType(7&i);break}}if(!s.hasOwnProperty("Type"))throw o.ProtocolError("missing required 'Type'",{instance:s});return s},e.fromObject=function(e){if(e instanceof a.Data)return e;var t=new a.Data;switch(e.Type){case"Raw":case 0:t.Type=0;break;case"Directory":case 1:t.Type=1;break;case"File":case 2:t.Type=2;break;case"Metadata":case 3:t.Type=3;break;case"Symlink":case 4:t.Type=4;break;case"HAMTShard":case 5:t.Type=5;break}if(null!=e.Data&&("string"===typeof e.Data?o.base64.decode(e.Data,t.Data=o.newBuffer(o.base64.length(e.Data)),0):e.Data.length&&(t.Data=e.Data)),null!=e.filesize&&(o.Long?(t.filesize=o.Long.fromValue(e.filesize)).unsigned=!0:"string"===typeof e.filesize?t.filesize=parseInt(e.filesize,10):"number"===typeof e.filesize?t.filesize=e.filesize:"object"===typeof e.filesize&&(t.filesize=new o.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0))),e.blocksizes){if(!Array.isArray(e.blocksizes))throw TypeError(".Data.blocksizes: array expected");t.blocksizes=[];for(var r=0;r<e.blocksizes.length;++r)o.Long?(t.blocksizes[r]=o.Long.fromValue(e.blocksizes[r])).unsigned=!0:"string"===typeof e.blocksizes[r]?t.blocksizes[r]=parseInt(e.blocksizes[r],10):"number"===typeof e.blocksizes[r]?t.blocksizes[r]=e.blocksizes[r]:"object"===typeof e.blocksizes[r]&&(t.blocksizes[r]=new o.LongBits(e.blocksizes[r].low>>>0,e.blocksizes[r].high>>>0).toNumber(!0))}if(null!=e.hashType&&(o.Long?(t.hashType=o.Long.fromValue(e.hashType)).unsigned=!0:"string"===typeof e.hashType?t.hashType=parseInt(e.hashType,10):"number"===typeof e.hashType?t.hashType=e.hashType:"object"===typeof e.hashType&&(t.hashType=new o.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0))),null!=e.fanout&&(o.Long?(t.fanout=o.Long.fromValue(e.fanout)).unsigned=!0:"string"===typeof e.fanout?t.fanout=parseInt(e.fanout,10):"number"===typeof e.fanout?t.fanout=e.fanout:"object"===typeof e.fanout&&(t.fanout=new o.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0))),null!=e.mode&&(t.mode=e.mode>>>0),null!=e.mtime){if("object"!==typeof e.mtime)throw TypeError(".Data.mtime: object expected");t.mtime=a.UnixTime.fromObject(e.mtime)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.blocksizes=[]),t.defaults){if(r.Type=t.enums===String?"Raw":0,t.bytes===String?r.Data="":(r.Data=[],t.bytes!==Array&&(r.Data=o.newBuffer(r.Data))),o.Long){var s=new o.Long(0,0,!0);r.filesize=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else r.filesize=t.longs===String?"0":0;if(o.Long){s=new o.Long(0,0,!0);r.hashType=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else r.hashType=t.longs===String?"0":0;if(o.Long){s=new o.Long(0,0,!0);r.fanout=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else r.fanout=t.longs===String?"0":0;r.mode=0,r.mtime=null}if(null!=e.Type&&e.hasOwnProperty("Type")&&(r.Type=t.enums===String?a.Data.DataType[e.Type]:e.Type),null!=e.Data&&e.hasOwnProperty("Data")&&(r.Data=t.bytes===String?o.base64.encode(e.Data,0,e.Data.length):t.bytes===Array?Array.prototype.slice.call(e.Data):e.Data),null!=e.filesize&&e.hasOwnProperty("filesize")&&("number"===typeof e.filesize?r.filesize=t.longs===String?String(e.filesize):e.filesize:r.filesize=t.longs===String?o.Long.prototype.toString.call(e.filesize):t.longs===Number?new o.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0):e.filesize),e.blocksizes&&e.blocksizes.length){r.blocksizes=[];for(var n=0;n<e.blocksizes.length;++n)"number"===typeof e.blocksizes[n]?r.blocksizes[n]=t.longs===String?String(e.blocksizes[n]):e.blocksizes[n]:r.blocksizes[n]=t.longs===String?o.Long.prototype.toString.call(e.blocksizes[n]):t.longs===Number?new o.LongBits(e.blocksizes[n].low>>>0,e.blocksizes[n].high>>>0).toNumber(!0):e.blocksizes[n]}return null!=e.hashType&&e.hasOwnProperty("hashType")&&("number"===typeof e.hashType?r.hashType=t.longs===String?String(e.hashType):e.hashType:r.hashType=t.longs===String?o.Long.prototype.toString.call(e.hashType):t.longs===Number?new o.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0):e.hashType),null!=e.fanout&&e.hasOwnProperty("fanout")&&("number"===typeof e.fanout?r.fanout=t.longs===String?String(e.fanout):e.fanout:r.fanout=t.longs===String?o.Long.prototype.toString.call(e.fanout):t.longs===Number?new o.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0):e.fanout),null!=e.mode&&e.hasOwnProperty("mode")&&(r.mode=e.mode),null!=e.mtime&&e.hasOwnProperty("mtime")&&(r.mtime=a.UnixTime.toObject(e.mtime,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.DataType=function(){var e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),e}(),a.UnixTime=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Seconds=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(e,t){return t||(t=i.create()),t.uint32(8).int64(e.Seconds),null!=e.FractionalNanoseconds&&Object.hasOwnProperty.call(e,"FractionalNanoseconds")&&t.uint32(21).fixed32(e.FractionalNanoseconds),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.UnixTime;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.Seconds=e.int64();break;case 2:s.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&i);break}}if(!s.hasOwnProperty("Seconds"))throw o.ProtocolError("missing required 'Seconds'",{instance:s});return s},e.fromObject=function(e){if(e instanceof a.UnixTime)return e;var t=new a.UnixTime;return null!=e.Seconds&&(o.Long?(t.Seconds=o.Long.fromValue(e.Seconds)).unsigned=!1:"string"===typeof e.Seconds?t.Seconds=parseInt(e.Seconds,10):"number"===typeof e.Seconds?t.Seconds=e.Seconds:"object"===typeof e.Seconds&&(t.Seconds=new o.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber())),null!=e.FractionalNanoseconds&&(t.FractionalNanoseconds=e.FractionalNanoseconds>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(o.Long){var s=new o.Long(0,0,!1);r.Seconds=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else r.Seconds=t.longs===String?"0":0;r.FractionalNanoseconds=0}return null!=e.Seconds&&e.hasOwnProperty("Seconds")&&("number"===typeof e.Seconds?r.Seconds=t.longs===String?String(e.Seconds):e.Seconds:r.Seconds=t.longs===String?o.Long.prototype.toString.call(e.Seconds):t.longs===Number?new o.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber():e.Seconds),null!=e.FractionalNanoseconds&&e.hasOwnProperty("FractionalNanoseconds")&&(r.FractionalNanoseconds=e.FractionalNanoseconds),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),a.Metadata=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.MimeType="",e.encode=function(e,t){return t||(t=i.create()),null!=e.MimeType&&Object.hasOwnProperty.call(e,"MimeType")&&t.uint32(10).string(e.MimeType),t},e.decode=function(e,t){e instanceof n||(e=n.create(e));var r=void 0===t?e.len:e.pos+t,s=new a.Metadata;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:s.MimeType=e.string();break;default:e.skipType(7&i);break}}return s},e.fromObject=function(e){if(e instanceof a.Metadata)return e;var t=new a.Metadata;return null!=e.MimeType&&(t.MimeType=String(e.MimeType)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.MimeType=""),null!=e.MimeType&&e.hasOwnProperty("MimeType")&&(r.MimeType=e.MimeType),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.exports=a},c319:function(e,t,r){"use strict";t.PROTOCOL_ID="/multistream/1.0.0"},c31e:function(e,t,r){"use strict";const s=r("1534"),n=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology");class i extends s{constructor({min:e,max:t,multicodecs:r,handlers:s}){if(super({min:e,max:t,handlers:s}),!r)throw new Error("one or more multicodec should be provided");if(!s)throw new Error("the handlers should be provided");if("function"!==typeof s.onConnect)throw new Error("the 'onConnect' handler must be provided");if("function"!==typeof s.onDisconnect)throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(r)?r:[r],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[n](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[n])}set registrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),this._updatePeers(this._registrar.peerStore.peers.values())}_updatePeers(e){for(const{id:t,protocols:r}of e)if(this.multicodecs.filter(e=>r.includes(e)).length){this.peers.add(t.toB58String());const e=this._registrar.getConnection(t);e&&this._onConnect(t,e)}else this.peers.delete(t.toB58String())}_onProtocolChange({peerId:e,protocols:t}){const r=this.peers.has(e.toB58String()),s=t.filter(e=>this.multicodecs.includes(e));r&&0===s.length&&this._onDisconnect(e);for(const n of t)if(this.multicodecs.includes(n)){const t=this._registrar.peerStore.get(e);return void this._updatePeers([t])}}_onPeerConnect(e){const t=e.remotePeer,r=this._registrar.peerStore.protoBook.get(t);r&&this.multicodecs.find(e=>r.includes(e))&&(this.peers.add(t.toB58String()),this._onConnect(t,e))}}e.exports=i},c3a3:function(e,t){e.exports=o;var r=128,s=127,n=~s,i=Math.pow(2,31);function o(e,t,s){if(Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw o.bytes=0,new RangeError("Could not encode varint");t=t||[],s=s||0;var a=s;while(e>=i)t[s++]=255&e|r,e/=128;while(e&n)t[s++]=255&e|r,e>>>=7;return t[s]=0|e,o.bytes=s-a+1,t}},c537:function(e,t,r){"use strict";const s=r("34eb"),{default:n}=r("3cb9"),i=r("ff5f"),o=r("b6aa"),a=r("d46b"),c=r("9b62"),u=Object.assign(s("ipfs:name:publish"),{error:s("ipfs:name:publish:error")}),{OFFLINE_ERROR:l,normalizePath:d}=r("4d04"),h=r("a29d"),{resolvePath:p}=r("24cf");e.exports=({ipns:e,ipld:t,peerId:r,isOnline:s,keychain:f})=>{const y=async e=>{if("self"===e)return r.privKey;try{const t=await f.exportKey(e,"temp"),r=await i.keys.import(t,"temp");return r}catch(t){throw u.error(t),o(t,"ERR_CANNOT_GET_KEY")}};async function g(r,i={}){const h=!(!1===i.resolve),f=i.lifetime||"24h",g=i.key||"self";if(!s())throw o(new Error(l),"OFFLINE_ERROR");try{r=d(r)}catch(E){throw u.error(E),E}let b=0;try{b=n(f)||0,b=parseFloat(b.toFixed(6))}catch(E){throw u.error(E),E}const m=await Promise.all([y(g),h?p({ipns:e,ipld:t},r):Promise.resolve()]),w=a(r),_=await e.publish(m[0],w,b);return{name:_.name,value:c(_.value)}}return h(g)}},c597:function(e,t,r){"use strict";const s=r("aef6"),n=r("c449"),{getName:i}=r("5d98"),o=r("246e"),a=r("0e80"),{isMapEqual:c}=r("ce74"),{Message:u}=r("3824"),l=r("707c");class d{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return 0===this.blocks.size&&0===this.wantlist.size&&0===this.blockPresences.size}addEntry(e,t,r,s,n){null==r&&(r=d.WantType.Block);const i=e.toString("base58btc"),o=this.wantlist.get(i);o?(o.wantType===r&&(o.priority=t),s&&(o.cancel=Boolean(s)),n&&(o.sendDontHave=Boolean(n)),r===d.WantType.Block&&o.wantType===d.WantType.Have&&(o.wantType=r)):this.wantlist.set(i,new l(e,t,r,s,n))}addBlock(e){const t=e.cid.toString("base58btc");this.blocks.set(t,e)}addHave(e){const t=e.toString("base58btc");this.blockPresences.has(t)||this.blockPresences.set(t,d.BlockPresenceType.Have)}addDontHave(e){const t=e.toString("base58btc");this.blockPresences.has(t)||this.blockPresences.set(t,d.BlockPresenceType.DontHave)}cancel(e){const t=e.toString("base58btc");this.wantlist.delete(t),this.addEntry(e,0,d.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map(e=>({block:e.cid.bytes,priority:Number(e.priority),cancel:Boolean(e.cancel)})),full:!!this.full||void 0},blocks:Array.from(this.blocks.values()).map(e=>e.data)};return u.encode(e).finish()}serializeToBitswap110(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map(e=>({block:e.cid.bytes,priority:Number(e.priority),wantType:e.wantType,cancel:Boolean(e.cancel),sendDontHave:Boolean(e.sendDontHave)})),full:!!this.full||void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};this.blocks.forEach(t=>{e.payload.push(new u.Block({prefix:t.cid.prefix,data:t.data}))});for(const[t,r]of this.blockPresences)e.blockPresences.push(new u.BlockPresence({cid:new n(t).bytes,type:r}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),u.encode(e).finish()}equals(e){return!!(this.full===e.full&&this.pendingBytes===e.pendingBytes&&c(this.wantlist,e.wantlist)&&c(this.blocks,e.blocks)&&c(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){const e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}}d.deserialize=async e=>{const t=u.decode(e),r=t.wantlist&&t.wantlist.full||!1,c=new d(r);return t.wantlist&&t.wantlist.entries&&t.wantlist.entries.forEach(e=>{if(!e.block)return;const t=new n(e.block);c.addEntry(t,e.priority||0,e.wantType,Boolean(e.cancel),Boolean(e.sendDontHave))}),t.blockPresences&&t.blockPresences.forEach(e=>{if(!e.cid)return;const t=new n(e.cid);e.type===d.BlockPresenceType.Have?c.addHave(t):c.addDontHave(t)}),t.blocks.length>0?(await Promise.all(t.blocks.map(async e=>{const t=await a(e,"sha2-256"),r=new n(t);c.addBlock(new s(e,r))})),c):t.payload.length>0?(await Promise.all(t.payload.map(async e=>{if(!e.prefix||!e.data)return;const t=o(e.prefix),r=t[0],u=t[1],l=t[2],d=await a(e.data,l),h=new n(r,i(u),d);c.addBlock(new s(e.data,h))})),c.setPendingBytes(t.pendingBytes),c):c},d.blockPresenceSize=e=>e.bytes.length+1,d.Entry=l,d.WantType={Block:u.Wantlist.WantType.Block,Have:u.Wantlist.WantType.Have},d.BlockPresenceType={Have:u.BlockPresenceType.Have,DontHave:u.BlockPresenceType.DontHave},e.exports=d},c5c7:function(e,t){var r=Math.pow(2,7),s=Math.pow(2,14),n=Math.pow(2,21),i=Math.pow(2,28),o=Math.pow(2,35),a=Math.pow(2,42),c=Math.pow(2,49),u=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<r?1:e<s?2:e<n?3:e<i?4:e<o?5:e<a?6:e<c?7:e<u?8:e<l?9:10}},c6bb:function(e,t,r){"use strict";const{repoVersion:s}=r("888a"),n=r("a29d");e.exports=({repo:e})=>{async function t(t={}){try{await e._checkInitialized(t)}catch(r){const e=[/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(e=>e.test(r.message));if(e)return s;throw r}return e.version.get()}return n(t)}},c81a:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("1ad7"),n=r("5144"),i=r("1755");t.encode=s.encode,t.decode=n.decode,t.Token=i.Token,t.Type=i.Type},c82b:function(e,t,r){"use strict";const s=r("34eb"),n=r("b6aa"),{mergeOptions:i}=r("4d04"),o=r("c449"),a=r("24e2"),c=r("9b62"),u=Object.assign(s("ipfs:name:resolve"),{error:s("ipfs:name:resolve:error")}),{OFFLINE_ERROR:l}=r("4d04"),d=r("a29d"),h=(e,t)=>t.length>0?e+"/"+t.join("/"):e;e.exports=({dns:e,ipns:t,peerId:r,isOnline:s,options:{offline:p}})=>{async function*f(d,f={}){if(f=i({nocache:!1,recursive:!0},f),p&&f&&f.nocache)throw n(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");d||(d=r.toB58String()),d.startsWith("/ipns/")||(d="/ipns/"+d);const[y,g,...b]=d.slice(1).split("/");try{new o(g)}catch(w){if(a(g))return void(yield h(await e(g,f),b));throw u.error(w),n(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}if(!s()&&!p)throw n(new Error(l),"OFFLINE_ERROR");const m=await t.resolve(`/${y}/${g}`,f);yield h(m instanceof Uint8Array?c(m):m,b)}return d(f)}},c871:function(e,t,r){"use strict";const s=r("9d4c"),n=r("f9f7"),i=r("8b75"),{PROTOCOL_ID:o}=r("c319");t.PROTOCOL_ID=o;class a{constructor(e){this._stream=e,this._shaken=!1}async _handshake(){if(this._shaken)return;const{stream:e}=await s(this._stream,o);this._stream=e,this._shaken=!0}}class c extends a{select(e){return s(this._stream,e,this._shaken?null:o)}async ls(){await this._handshake();const{stream:e,protocols:t}=await i(this._stream);return this._stream=e,t}}t.Dialer=c;class u extends a{handle(e){return n(this._stream,e)}}t.Listener=u},c872:function(e,t,r){"use strict";const s=r("a29d");e.exports=({network:e})=>{async function t(t={}){const r=[],{libp2p:s}=await e.use(t);for(const[e,n]of s.peerStore.peers.entries())r.push({id:e,addrs:n.addresses.map(e=>e.multiaddr)});return r}return s(t)}},c8fc:function(e,t,r){"use strict";class s extends Error{constructor(e="request timed out"){super(e),this.name="TimeoutError",this.code=s.code}}s.code="ERR_TIMEOUT",t.TimeoutError=s},c9f3:function(e,t){e.exports=n;var r=128,s=127;function n(e,t){var i,o=0,a=(t=t||0,0),c=t,u=e.length;do{if(c>=u||a>49)throw n.bytes=0,new RangeError("Could not decode varint");i=e[c++],o+=a<28?(i&s)<<a:(i&s)*Math.pow(2,a),a+=7}while(i>=r);return n.bytes=c-t,o}},ca58:function(e,t,r){"use strict";const s=(e,t,r,s,i,o,a)=>{function c(e={}){return n(t,s,i,o,a,e)}return c};async function*n(e,t,r,s,i,o){const a=e.Links;for(const c of a){const a=c.Name.substring(2);if(a){const e=await r(c.Hash,a,`${t}/${a}`,[],s+1,i,o);yield e.entry}else{e=await i.get(c.Hash);for await(const a of n(e,t,r,s,i,o))yield a}}}e.exports=s},cc13:function(e,t,r){"use strict";const s=r("9e58"),n=r("a9f4");class i{constructor(e,t){this.self=e,this._onPing=this._onPing.bind(this),this._onInit(t)}async _onInit(e){const t=await n.convertPeerId(this.self);this.kb=new s({localNodeId:t,numberOfNodesPerKBucket:e,numberOfNodesToPing:1}),this.kb.on("ping",this._onPing)}_onPing(e,t){const r=e[0];r&&this.kb.remove(r.id),this.kb.add(t)}get size(){return this.kb.count()}async find(e){const t=await n.convertPeerId(e),r=this.closestPeer(t);if(r&&e.equals(r))return r}closestPeer(e){const t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t){const r=this.kb.closest(e,t);return r.map(e=>e.peer)}async add(e){const t=await n.convertPeerId(e);this.kb.add({id:t,peer:e})}async remove(e){const t=await n.convertPeerId(e);this.kb.remove(t)}}e.exports=i},cc9a:function(e,t,r){"use strict";const s=r("6469"),n=r("3301");e.exports=e=>async function*(){const t=new i;for await(const r of e){const e=t.write(r);e.length&&(yield e)}}();class i{constructor(){this._buffer=new n,this._bufferProxy=new Proxy({},{get:(e,t)=>"l"===t[0]?this._buffer[t]:this._buffer.get(parseInt(t))}),this._headerInfo=null}write(e){if(!e||!e.length)return[];this._buffer.append(e);const t=[];while(1){if(!this._headerInfo)try{this._headerInfo=this._decodeHeader(this._bufferProxy)}catch(r){break}const{id:e,type:s,length:n,offset:i}=this._headerInfo,o=this._buffer.length-i;if(o<n)break;t.push({id:e,type:s,data:this._buffer.shallowSlice(i,i+n)}),this._buffer.consume(i+n),this._headerInfo=null}return t}_decodeHeader(e){const t=s.decode(e);let r=s.decode.bytes;const n=s.decode(e,r);return r+=s.decode.bytes,{id:t>>3,type:7&t,offset:r,length:n}}}},cccb:function(e,t,r){"use strict";const s=r("2b45"),n=r("d6c0"),i=r("6b85"),{NotInitializedError:o,AlreadyInitializedError:a}=r("fabb"),c=r("34eb")("ipfs:components:ipns");class u{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){const e=this.online||this.offline;if(e)return e;throw new o}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:t,keychain:r}){if(null!=this.offline)throw new a;c("initializing IPNS keyspace");const n=new i(e),o=new s(n,e.datastore,t,r,this.options);this.offline=o}async startOnline({libp2p:e,repo:t,peerId:r,keychain:i}){if(null!=this.online)throw new a;const o=n({libp2p:e,repo:t,peerId:r,options:this.options}),c=new s(o,t.datastore,r,i,this.options);await c.republisher.start(),this.online=c}async stop(){const e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,t,r){return this.getIPNS().publish(e,t,r)}resolve(e,t){return this.getIPNS().resolve(e,t)}initializeKeyspace(e,t){return this.getIPNS().initializeKeyspace(e,t)}}e.exports=u},cd1e:function(e,t){e.exports=function(e,t,r){"use asm";var s=new e.Uint8Array(r);var n=t.pushInt;var i=t.pushInt32;var o=t.pushInt32Neg;var a=t.pushInt64;var c=t.pushInt64Neg;var u=t.pushFloat;var l=t.pushFloatSingle;var d=t.pushFloatDouble;var h=t.pushTrue;var p=t.pushFalse;var f=t.pushUndefined;var y=t.pushNull;var g=t.pushInfinity;var b=t.pushInfinityNeg;var m=t.pushNaN;var w=t.pushNaNNeg;var _=t.pushArrayStart;var E=t.pushArrayStartFixed;var v=t.pushArrayStartFixed32;var S=t.pushArrayStartFixed64;var I=t.pushObjectStart;var A=t.pushObjectStartFixed;var R=t.pushObjectStartFixed32;var T=t.pushObjectStartFixed64;var k=t.pushByteString;var P=t.pushByteStringStart;var O=t.pushUtf8String;var N=t.pushUtf8StringStart;var D=t.pushSimpleUnassigned;var C=t.pushTagStart;var x=t.pushTagStart4;var L=t.pushTagStart8;var M=t.pushTagUnassigned;var B=t.pushBreak;var U=e.Math.pow;var j=0;var F=0;var V=0;function z(e){e=e|0;j=0;F=e;while((j|0)<(F|0)){V=Qe[s[j]&255](s[j]|0)|0;if((V|0)>0){break}}return V|0}function K(e){e=e|0;if(((j|0)+(e|0)|0)<(F|0)){return 0}return 1}function q(e){e=e|0;return s[e|0]<<8|s[e+1|0]|0}function G(e){e=e|0;return s[e|0]<<24|s[e+1|0]<<16|s[e+2|0]<<8|s[e+3|0]|0}function H(e){e=e|0;n(e|0);j=j+1|0;return 0}function $(e){e=e|0;if(K(1)|0){return 1}n(s[j+1|0]|0);j=j+2|0;return 0}function W(e){e=e|0;if(K(2)|0){return 1}n(q(j+1|0)|0);j=j+3|0;return 0}function Y(e){e=e|0;if(K(4)|0){return 1}i(q(j+1|0)|0,q(j+3|0)|0);j=j+5|0;return 0}function Q(e){e=e|0;if(K(8)|0){return 1}a(q(j+1|0)|0,q(j+3|0)|0,q(j+5|0)|0,q(j+7|0)|0);j=j+9|0;return 0}function X(e){e=e|0;n(-1-(e-32|0)|0);j=j+1|0;return 0}function J(e){e=e|0;if(K(1)|0){return 1}n(-1-(s[j+1|0]|0)|0);j=j+2|0;return 0}function Z(e){e=e|0;var t=0;if(K(2)|0){return 1}t=q(j+1|0)|0;n(-1-(t|0)|0);j=j+3|0;return 0}function ee(e){e=e|0;if(K(4)|0){return 1}o(q(j+1|0)|0,q(j+3|0)|0);j=j+5|0;return 0}function te(e){e=e|0;if(K(8)|0){return 1}c(q(j+1|0)|0,q(j+3|0)|0,q(j+5|0)|0,q(j+7|0)|0);j=j+9|0;return 0}function re(e){e=e|0;var t=0;var r=0;var s=0;s=e-64|0;if(K(s|0)|0){return 1}t=j+1|0;r=(j+1|0)+(s|0)|0;k(t|0,r|0);j=r|0;return 0}function se(e){e=e|0;var t=0;var r=0;var n=0;if(K(1)|0){return 1}n=s[j+1|0]|0;t=j+2|0;r=(j+2|0)+(n|0)|0;if(K(n+1|0)|0){return 1}k(t|0,r|0);j=r|0;return 0}function ne(e){e=e|0;var t=0;var r=0;var s=0;if(K(2)|0){return 1}s=q(j+1|0)|0;t=j+3|0;r=(j+3|0)+(s|0)|0;if(K(s+2|0)|0){return 1}k(t|0,r|0);j=r|0;return 0}function ie(e){e=e|0;var t=0;var r=0;var s=0;if(K(4)|0){return 1}s=G(j+1|0)|0;t=j+5|0;r=(j+5|0)+(s|0)|0;if(K(s+4|0)|0){return 1}k(t|0,r|0);j=r|0;return 0}function oe(e){e=e|0;return 1}function ae(e){e=e|0;P();j=j+1|0;return 0}function ce(e){e=e|0;var t=0;var r=0;var s=0;s=e-96|0;if(K(s|0)|0){return 1}t=j+1|0;r=(j+1|0)+(s|0)|0;O(t|0,r|0);j=r|0;return 0}function ue(e){e=e|0;var t=0;var r=0;var n=0;if(K(1)|0){return 1}n=s[j+1|0]|0;t=j+2|0;r=(j+2|0)+(n|0)|0;if(K(n+1|0)|0){return 1}O(t|0,r|0);j=r|0;return 0}function le(e){e=e|0;var t=0;var r=0;var s=0;if(K(2)|0){return 1}s=q(j+1|0)|0;t=j+3|0;r=(j+3|0)+(s|0)|0;if(K(s+2|0)|0){return 1}O(t|0,r|0);j=r|0;return 0}function de(e){e=e|0;var t=0;var r=0;var s=0;if(K(4)|0){return 1}s=G(j+1|0)|0;t=j+5|0;r=(j+5|0)+(s|0)|0;if(K(s+4|0)|0){return 1}O(t|0,r|0);j=r|0;return 0}function he(e){e=e|0;return 1}function pe(e){e=e|0;N();j=j+1|0;return 0}function fe(e){e=e|0;E(e-128|0);j=j+1|0;return 0}function ye(e){e=e|0;if(K(1)|0){return 1}E(s[j+1|0]|0);j=j+2|0;return 0}function ge(e){e=e|0;if(K(2)|0){return 1}E(q(j+1|0)|0);j=j+3|0;return 0}function be(e){e=e|0;if(K(4)|0){return 1}v(q(j+1|0)|0,q(j+3|0)|0);j=j+5|0;return 0}function me(e){e=e|0;if(K(8)|0){return 1}S(q(j+1|0)|0,q(j+3|0)|0,q(j+5|0)|0,q(j+7|0)|0);j=j+9|0;return 0}function we(e){e=e|0;_();j=j+1|0;return 0}function _e(e){e=e|0;var t=0;t=e-160|0;if(K(t|0)|0){return 1}A(t|0);j=j+1|0;return 0}function Ee(e){e=e|0;if(K(1)|0){return 1}A(s[j+1|0]|0);j=j+2|0;return 0}function ve(e){e=e|0;if(K(2)|0){return 1}A(q(j+1|0)|0);j=j+3|0;return 0}function Se(e){e=e|0;if(K(4)|0){return 1}R(q(j+1|0)|0,q(j+3|0)|0);j=j+5|0;return 0}function Ie(e){e=e|0;if(K(8)|0){return 1}T(q(j+1|0)|0,q(j+3|0)|0,q(j+5|0)|0,q(j+7|0)|0);j=j+9|0;return 0}function Ae(e){e=e|0;I();j=j+1|0;return 0}function Re(e){e=e|0;C(e-192|0|0);j=j+1|0;return 0}function Te(e){e|0;C(e|0);j=j+1|0;return 0}function ke(e){e|0;C(e|0);j=j+1|0;return 0}function Pe(e){e|0;C(e|0);j=j+1|0;return 0}function Oe(e){e|0;C(e|0);j=j+1|0;return 0}function Ne(e){e=e|0;C(e-192|0|0);j=j+1|0;return 0}function De(e){e|0;C(e|0);j=j+1|0;return 0}function Ce(e){e|0;C(e|0);j=j+1|0;return 0}function xe(e){e|0;C(e|0);j=j+1|0;return 0}function Le(e){e=e|0;if(K(1)|0){return 1}C(s[j+1|0]|0);j=j+2|0;return 0}function Me(e){e=e|0;if(K(2)|0){return 1}C(q(j+1|0)|0);j=j+3|0;return 0}function Be(e){e=e|0;if(K(4)|0){return 1}x(q(j+1|0)|0,q(j+3|0)|0);j=j+5|0;return 0}function Ue(e){e=e|0;if(K(8)|0){return 1}L(q(j+1|0)|0,q(j+3|0)|0,q(j+5|0)|0,q(j+7|0)|0);j=j+9|0;return 0}function je(e){e=e|0;D((e|0)-224|0);j=j+1|0;return 0}function Fe(e){e=e|0;p();j=j+1|0;return 0}function Ve(e){e=e|0;h();j=j+1|0;return 0}function ze(e){e=e|0;y();j=j+1|0;return 0}function Ke(e){e=e|0;f();j=j+1|0;return 0}function qe(e){e=e|0;if(K(1)|0){return 1}D(s[j+1|0]|0);j=j+2|0;return 0}function Ge(e){e=e|0;var t=0;var r=0;var n=1.0;var i=0.0;var o=0.0;var a=0.0;if(K(2)|0){return 1}t=s[j+1|0]|0;r=s[j+2|0]|0;if((t|0)&0x80){n=-1.0}i=+(((t|0)&0x7C)>>2);o=+(((t|0)&0x03)<<8|r);if(+i==0.0){u(+(+n*+5.9604644775390625e-8*+o))}else if(+i==31.0){if(+n==1.0){if(+o>0.0){m()}else{g()}}else{if(+o>0.0){w()}else{b()}}}else{u(+(+n*U(+2,+(+i-25.0))*+(1024.0+o)))}j=j+3|0;return 0}function He(e){e=e|0;if(K(4)|0){return 1}l(s[j+1|0]|0,s[j+2|0]|0,s[j+3|0]|0,s[j+4|0]|0);j=j+5|0;return 0}function $e(e){e=e|0;if(K(8)|0){return 1}d(s[j+1|0]|0,s[j+2|0]|0,s[j+3|0]|0,s[j+4|0]|0,s[j+5|0]|0,s[j+6|0]|0,s[j+7|0]|0,s[j+8|0]|0);j=j+9|0;return 0}function We(e){e=e|0;return 1}function Ye(e){e=e|0;B();j=j+1|0;return 0}var Qe=[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,$,W,Y,Q,We,We,We,We,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,J,Z,ee,te,We,We,We,We,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,se,ne,ie,oe,We,We,We,ae,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ue,le,de,he,We,We,We,pe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,fe,ye,ge,be,me,We,We,We,we,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,_e,Ee,ve,Se,Ie,We,We,We,Ae,Re,Re,Re,Re,Re,Re,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne,Le,Me,Be,Ue,We,We,We,We,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,je,Fe,Ve,ze,Ke,qe,Ge,He,$e,We,We,We,Ye];return{parse:z}}},cd53:function(e,t,r){"use strict";const s=r("a29d");e.exports=({ipld:e,preload:t})=>{const n=r("69d3")({ipld:e,preload:t});async function i(e,t={}){const r=await n(e,t);return r.Data}return s(i)}},cdc4:function(e,t,r){"use strict";const s=r("d835"),n=e=>{if(!Number.isInteger(e)&&e!==1/0||!(e>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));const t=[];let r=0;const n=()=>{r--,t.length>0&&t.shift()()},i=(e,t,...i)=>{r++;const o=s(e,...i);t(o),o.then(n,n)},o=(s,n,...o)=>{r<e?i(s,n,...o):t.push(i.bind(null,s,n,...o))},a=(e,...t)=>new Promise(r=>o(e,r,...t));return Object.defineProperties(a,{activeCount:{get:()=>r},pendingCount:{get:()=>t.length},clearQueue:{value:()=>{t.length=0}}}),a};e.exports=n,e.exports.default=n},ce0f:function(e,t,r){"use strict";const{EventEmitter:s}=r("faa1"),n=r("55ab");class i extends s{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(e=>{this._stats[e]=BigInt(0),this._movingAverages[e]={},this._options.movingAverageIntervals.forEach(t=>{const r=this._movingAverages[e][t]=n(t);r.push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){const e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;while(this._queue.length){const t=e=this._queue.shift();t&&this._applyOp(t)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){const t=e-this._frequencyLastTime;t&&Object.keys(this._stats).forEach(r=>{this._updateFrequencyFor(r,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,r){const s=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;const i=s/t*1e3;let o=this._movingAverages[e];o||(o=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(e=>{let t=o[e];t||(t=o[e]=n(e)),t.push(r,i)})}_applyOp(e){const t=e[0],r=e[1];if("number"!==typeof r)throw new Error("invalid increment number: "+r);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(r),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=r}}e.exports=i},ce74:function(e,t,r){"use strict";const s=r("34eb"),n=r("5aab"),i=(e,t)=>{const r=["bitswap"];return t&&r.push(t),e&&r.push(""+e.toB58String().slice(0,8)),Object.assign(s(r.join(":")),{error:s(r.concat(["error"]).join(":"))})},o=(e,t,r)=>{let s=0;const n=r.length;while(s<n){if(e(t,r[s]))return!0;s+=1}return!1},a=(e,t)=>{let r=0;const s=t.length,n=[];let i;while(r<s)i=t[r],o(e,i,n)||(n[n.length]=i),r+=1;return n},c=(e,t)=>t.reduce((t,r)=>{const s=e(r);return t[s]?t[s].push(r):t[s]=[r],t},{}),u=(e,t,r)=>t.filter(t=>!o(e,t,r)),l=(e,t)=>Array.prototype.slice.call(t,0).sort((t,r)=>{const s=e(t),n=e(r);return s<n?-1:s>n?1:0}),d=(e,t)=>{if(e.size!==t.size)return!1;for(const[r,s]of e){const e=t.get(r);if(void 0===e)return!1;if("function"===typeof s.equals&&!s.equals(e))return!1;if(s.data&&(!e.data||!n(s.data,e.data)))return!1}return!0};e.exports={logger:i,includesWith:o,uniqWith:a,groupBy:c,pullAllWith:u,sortBy:l,isMapEqual:d}},ce8a:function(e,t,r){"use strict";const s=r("b6aa"),n=r("bac1"),i=r("a127"),o=r("5d6d"),{isBytes:a,isBlob:c,isReadableStream:u,isFileObject:l}=r("abb1"),{parseMtime:d,parseMode:h}=r("9fd0");async function p(e,t){const{path:r,mode:s,mtime:n,content:i}=e,o={path:r||"",mode:h(s),mtime:d(n)};return i?o.content=await t(i):r||(o.content=await t(e)),o}e.exports=async function*(e,t){if(null!==e&&void 0!==e)if("string"===typeof e||e instanceof String)yield p(e.toString(),t);else if(a(e)||c(e))yield p(e,t);else{if(u(e)&&(e=n(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=i(e),{value:s,done:n}=await r.peek();if(n)return void(yield*[]);if(r.push(s),Number.isInteger(s)||a(s))return void(yield p(r,t));if(l(s)||c(s)||"string"===typeof s||s instanceof String)return void(yield*o(r,e=>p(e,t)));if(s[Symbol.iterator]||s[Symbol.asyncIterator]||u(s))return void(yield*o(r,e=>p(e,t)))}if(!l(e))throw s(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT");yield p(e,t)}}},cee7:function(e,t,r){"use strict";const s=r("5d98"),n=s.getName(s.LIBP2P_PEER_RECORD)||"libp2p-peer-record",i=Uint8Array.from([3,1]);e.exports={ENVELOPE_DOMAIN_PEER_RECORD:n,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:i}},cfa2:function(e,t,r){"use strict";async function*s(e,t={}){const r=e.getReader();try{while(1){const e=await r.read();if(e.done)return;yield e.value}}finally{!0!==t.preventCancel&&r.cancel(),r.releaseLock()}}e.exports=s},d04a:function(e,t,r){"use strict";const s=r("b6aa"),{EventEmitter:n}=r("faa1"),i=r("eddf"),o=r("c129"),a=r("2e15"),c=r("8db3"),u=r("a96e"),{codes:{ERR_INVALID_PARAMETERS:l}}=r("b73a");class d extends n{constructor({peerId:e}){super(),this._peerId=e,this.addressBook=new o(this),this.keyBook=new a(this),this.metadataBook=new c(this),this.protoBook=new u(this)}start(){}stop(){}get peers(){const e=new Set([...this.addressBook.data.keys(),...this.keyBook.data.keys(),...this.protoBook.data.keys(),...this.metadataBook.data.keys()]);this._peerId&&e.delete(this._peerId.toB58String());const t=new Map;return e.forEach(e=>{t.set(e,this.get(i.createFromCID(e)))}),t}delete(e){const t=this.addressBook.delete(e),r=this.keyBook.delete(e),s=this.protoBook.delete(e),n=this.metadataBook.delete(e);return t||r||s||n}get(e){if(!i.isPeerId(e))throw s(new Error("peerId must be an instance of peer-id"),l);const t=this.keyBook.data.get(e.toB58String()),r=this.addressBook.get(e),n=this.metadataBook.get(e),o=this.protoBook.get(e);if(t||r||n||o)return{id:t||e,addresses:r||[],protocols:o||[],metadata:n}}}e.exports=d},d06b:function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:registrar"),{error:s("libp2p:registrar:err")}),i=r("b6aa"),{codes:{ERR_INVALID_PARAMETERS:o}}=r("b73a"),a=r("1534");class c{constructor({peerStore:e,connectionManager:t}){this.peerStore=e,this.connectionManager=t,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}register(e){if(!a.isTopology(e))throw n.error("topology must be an instance of interfaces/topology"),i(new Error("topology must be an instance of interfaces/topology"),o);const t=(1e9*Math.random()).toString(36)+Date.now();return this.topologies.set(t,e),e.registrar=this,t}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(const[,t]of this.topologies)t.disconnect(e.remotePeer)}}e.exports=c},d078:function(e,t,r){const s=r("c2de"),n=r("ea9a"),i=async(e,t,r,i,o)=>{const a=await n();return new s(a,e,t,r,i,o)};e.exports={Rabin:s,create:i}},d086:function(e,t,r){"use strict";var s;e.exports.timeout=function(e,t){var r,n=new s;return Promise.race([e,new Promise((function(e,s){r=setTimeout((function(){s(n)}),t)}))]).then((function(e){return clearTimeout(r),e}),(function(e){throw clearTimeout(r),e}))};s=e.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"},s.prototype=Object.create(Error.prototype),s.prototype.name="TimeoutError"},d08c:function(e,t,r){"use strict";const{source:s}=r("72af"),n=r("34eb"),i=n("libp2p:stream:converter");function o({stream:e,remoteAddr:t,localAddr:r},n={}){const{sink:o,source:a}=e,c={async sink(e){n.signal&&(e=s(e,n.signal));try{await o(e)}catch(t){"aborted"!==t.type&&i(t)}u()},source:n.signal?s(a,n.signal):a,conn:e,localAddr:r,remoteAddr:t,timeline:{open:Date.now(),close:void 0},close(){return o(new Uint8Array(0)),u()}};function u(){return c.timeline.close||(c.timeline.close=Date.now()),Promise.resolve()}return c}e.exports=o},d268:function(e,t,r){"use strict";const{Key:s,Errors:n}=r("1304"),i=r("b0ea"),o=i.ShardingDatastore,a=new s("/config"),c=new s("/version");function u(e,t){if(!t||!t.storageBackends)throw new Error("Please pass storage backend definitions");if(!t.storageBackends[e])throw new Error(`Storage backend '${e}' not defined in config`);const r=t.storageBackends[e];let s={};return void 0!==t.storageBackendOptions&&void 0!==t.storageBackendOptions[e]&&(s=t.storageBackendOptions[e]),{StorageBackend:r,storageOptions:s}}function l(e){let t=e;while(t.db||t.child)if(t=t.db||t.child,"level-js"===t.type||"Level"===t.constructor.name)return t}async function d(e,t,r){const s=await t(e);if(s)return s;const n=l(r);return!!n&&new Promise((t,r)=>{const s=n.store("readonly").get(e.toString());s.transaction.onabort=()=>{r(s.transaction.error)},s.transaction.oncomplete=()=>{t(Boolean(s.result))}})}async function h(e,t,r,s){if(await r(e))return t(e);const i=l(s);if(!i)throw n.notFoundError();return new Promise((t,r)=>{const s=i.store("readonly").get(e.toString());s.transaction.onabort=()=>{r(s.transaction.error)},s.transaction.oncomplete=()=>{if(s.result)return t(s.result);r(n.notFoundError())}})}function p(e,t,r){const{StorageBackend:s,storageOptions:n}=u(t,r);"root"!==t&&(e=`${e}/${t}`);let a=new s(e,n);n.sharding&&(a=new o(a,new i.shard.NextToLast(2)));const c=a.get.bind(a),l=a.has.bind(a);return a.get=e=>h(e,c,l,a),a.has=e=>d(e,l,a),a}e.exports={createStore:p,hasWithFallback:d,getWithFallback:h,findLevelJs:l,CONFIG_KEY:a,VERSION_KEY:c}},d277:function(e,t,r){"use strict";const{cleanCid:s}=r("7ae0"),n=r("a29d");e.exports=({blockService:e,preload:t})=>{async function r(r,n={}){return r=s(r),!1!==n.preload&&t(r),e.get(r,n)}return n(r)}},d292:function(e,t,r){"use strict";const s=r("a29d");e.exports=({keychain:e})=>{const t=t=>e.findKeyByName(t);return s(t)}},d2aa:function(e,t,r){"use strict";class s extends Error{constructor(e="Request timed out"){super(e),this.name="TimeoutError"}}t.TimeoutError=s;class n extends Error{constructor(e="The operation was aborted."){super(e),this.name="AbortError"}}t.AbortError=n;class i extends Error{constructor(e){super(e.statusText),this.name="HTTPError",this.response=e}}t.HTTPError=i},d32a:function(e,t,r){"use strict";const s=r("b6aa"),n=r("e53b"),i=r("57e0"),o=r("12ca"),a=r("aaf7"),c=r("1eaa"),u=r("a29d"),l=r("4fcb").bind({ignoreUndefined:!0}),d={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};e.exports=e=>{async function t(t,r={}){const n=l(d,r);Array.isArray(t)||(t=[t]);const i=await Promise.all(t.map(t=>a(e,t,n)));if(!i.length)throw s(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");i.forEach(e=>{if("/"===e.path)throw s(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(const s of i)await h(e,s.path,n)}return u(t)};const h=async(e,t,r)=>{const u=await a(e,t,r),l=await c(e,u.mfsPath),d=l[l.length-1];l.pop();const h=l[l.length-1];if(!h)throw s(new Error(t+" does not exist"),"ERR_NOT_FOUND");if("directory"===d.type&&!r.recursive)throw s(new Error(t+" is a directory, use -r to remove directories"),"ERR_WAS_DIR");const{cid:p}=await o(e,{parentCid:h.cid,name:d.name,hashAlg:r.hashAlg,cidVersion:r.cidVersion,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold});h.cid=p;const f=await n(e,l,r);await i(e,f,r)}},d3c6:function(e,t,r){"use strict";const s=r("4fcb").bind({ignoreUndefined:!0}),n=r("aaf7"),i=r("34eb")("ipfs:mfs:touch"),o=r("b6aa"),{UnixFS:a}=r("9fd0"),c=r("1eaa"),u=r("5688"),l=r("e53b"),d=r("57e0"),{DAGNode:h}=r("8141"),p=r("5d98"),f=r("0e80").multihash,y=r("a29d"),g={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};e.exports=e=>{async function t(t,r={}){const y=s(g,r);y.mtime=y.mtime||new Date,i(`Touching ${t} mtime: ${y.mtime}`);const{cid:b,mfsDirectory:m,name:w,exists:_}=await n(e,t,y);let E,v,S=y.cidVersion;if(_){if("dag-pb"!==b.codec)throw o(new Error(t+" was not a UnixFS node"),"ERR_NOT_UNIXFS");S=b.version,E=await e.ipld.get(b);const r=a.unmarshal(E.Data);r.mtime=y.mtime,E=new h(r.marshal(),E.Links),v=await e.ipld.put(E,p.DAG_PB,{cidVersion:b.version,hashAlg:f.names["sha2-256"],onlyHash:!y.flush})}else{const t=new a({type:"file",mtime:y.mtime});E=new h(t.marshal()),v=await e.ipld.put(E,p.DAG_PB,{cidVersion:y.cidVersion,hashAlg:f.names["sha2-256"],onlyHash:!y.flush})}const I=await c(e,m),A=I[I.length-1],R=await e.ipld.get(A.cid),T=await u(e,{parent:R,name:w,cid:v,size:E.serialize().length,flush:y.flush,shardSplitThreshold:y.shardSplitThreshold,hashAlg:"sha2-256",cidVersion:S});A.cid=T.cid;const k=await l(e,I,y);await d(e,k,y)}return y(t)}},d496:function(e,t,r){"use strict";e.exports=a;var s=r("1468"),n=a.prototype,i=new Date%1e9;function o(){return(1e9*Math.random()>>>0)+i++}function a(e){e=e||{},this.id=e.id||o(),this.max=e.max||1/0,this.items=e.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(e.lastModified||new Date);for(var t,r,s=this.items.length;s--;)t=this.items[s],r=new Date(t.expires)-new Date,this._lookup[t.key]=t,r>0?this.expire(t.key,r):r<=0&&this.delete(t.key)}n.has=function(e){return e in this._lookup},n.get=function(e){if(!this.has(e))return null;var t=this._lookup[e];return t.refresh&&this.expire(e,t.refresh),this.items.splice(this.items.indexOf(t),1),this.items.push(t),t.value},n.meta=function(e){if(!this.has(e))return null;var t=this._lookup[e];return"meta"in t?t.meta:null},n.set=function(e,t,r){var s=this._lookup[e],n=this._lookup[e]={key:e,value:t};return this.lastModified=new Date,s?(clearTimeout(s.timeout),this.items.splice(this.items.indexOf(s),1,n)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(n),this.size++),r&&("ttl"in r&&this.expire(e,r.ttl),"meta"in r&&(n.meta=r.meta),r.refresh&&(n.refresh=r.ttl)),this},n.delete=function(e){var t=this._lookup[e];return!!t&&(this.lastModified=new Date,this.items.splice(this.items.indexOf(t),1),clearTimeout(t.timeout),delete this._lookup[e],this.size--,this)},n.expire=function(e,t){var r=t||0,n=this._lookup[e];if(!n)return this;if("string"===typeof r&&(r=s(t)),"number"!==typeof r)throw new TypeError("Expiration time must be a string or number.");return clearTimeout(n.timeout),n.timeout=setTimeout(this.delete.bind(this,n.key),r),n.expires=Number(new Date)+r,this},n.clear=function(){for(var e=this.items.length;e--;)this.delete(this.items[e].key);return this},n.toJSON=function(){for(var e,t=new Array(this.items.length),r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}},d4ba:function(e,t,r){"use strict";const s=r("65a5");function n(e,t,r){return i(e,t,r)}async function i(e,t,r){const n=[];for await(const i of s(e,r.maxChildrenPerNode))n.push(await t(i));return n.length>1?i(n,t,r):n[0]}e.exports=n},d4c1:function(e,t,r){"use strict";const{Record:s}=r("7af3"),n=r("3e9a");class i{constructor(e,t,r){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=r}serialize(){return s.encode(this.prepareSerialize()).finish()}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:this.timeReceived&&n.toRFC3339(this.timeReceived)}}static deserialize(e){const t=s.decode(e);return i.fromDeserialized(s.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}))}static fromDeserialized(e){let t;e.timeReceived&&(t=n.parseRFC3339(e.timeReceived));const r=new i(e.key,e.value,t);return r}}e.exports=i},d507:function(e,t,r){"use strict";const s=r("c449"),n=r("b6aa"),i=r("54a6"),o=r("34eb"),a=r("9410"),c=r("41c5"),u=r("c81a"),l=r("675c"),d=r("5d98"),{Key:h}=r("1304");function p(e){const t=`Invalid type '${e}', must be one of {direct, indirect, recursive, all}`;return n(new Error(t),"ERR_INVALID_PIN_TYPE")}const f=l.encoding("base32upper");function y(e){return new h("/"+f.encode(e.multihash))}function g(e){return f.decode(e.toString().slice(1))}const b={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};class m{constructor({repo:e,ipld:t}){this.repo=e,this.ipld=t,this.log=o("ipfs:pin"),this.directPins=new Set,this.recursivePins=new Set}async*_walkDag(e,t){const r=await this.ipld.get(e,t);if("dag-pb"===e.codec)for(const s of r.Links)yield s.Hash,yield*this._walkDag(s.Hash,t);else if("dag-cbor"===e.codec)for(const[,s]of i(r))yield s,yield*this._walkDag(s,t)}async pinDirectly(e,t={}){await this.ipld.get(e,t);const r={depth:0};return 0!==e.version&&(r.version=e.version),"dag-pb"!==e.codec&&(r.codec=d.getNumber(e.codec)),t.metadata&&(r.metadata=t.metadata),this.repo.pins.put(y(e),u.encode(r))}async unpin(e,t){return this.repo.pins.delete(y(e))}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);const r={depth:1/0};0!==e.version&&(r.version=e.version),"dag-pb"!==e.codec&&(r.codec=d.getNumber(e.codec)),t.metadata&&(r.metadata=t.metadata),await this.repo.pins.put(y(e),u.encode(r))}async*directKeys(e){for await(const t of this.repo.pins.query({filters:[e=>{const t=u.decode(e.value);return 0===t.depth}]})){const e=u.decode(t.value),r=e.version||0,n=e.codec?d.getName(e.codec):"dag-pb",i=g(t.key);yield{cid:new s(r,n,i),metadata:e.metadata}}}async*recursiveKeys(e){for await(const t of this.repo.pins.query({filters:[e=>{const t=u.decode(e.value);return t.depth===1/0}]})){const e=u.decode(t.value),r=e.version||0,n=e.codec?d.getName(e.codec):"dag-pb",i=g(t.key);yield{cid:new s(r,n,i),metadata:e.metadata}}}async*indirectKeys(e){for await(const{cid:t}of this.recursiveKeys())for await(const r of this._walkDag(t,e)){const e=[b.recursive],t=await this.isPinnedWithType(r,e);t.pinned||(yield r)}}async isPinnedWithType(e,t,r){Array.isArray(t)||(t=[t]);const s=t.includes(b.all),n=t.includes(b.direct),i=t.includes(b.recursive),o=t.includes(b.indirect);if(i||n||s){const r=await a(this.repo.pins.query({prefix:y(e).toString(),filters:[e=>{if(s)return!0;const r=u.decode(e.value);return t.includes(0===r.depth?b.direct:b.recursive)}],limit:1}));if(r){const t=u.decode(r.value);return{cid:e,pinned:!0,reason:0===t.depth?b.direct:b.recursive,metadata:t.metadata}}}const c=this;async function*l(e,t){for await(const{cid:r}of t)for await(const t of c._walkDag(r))if(t.equals(e))return void(yield r)}if(s||o){const t=await a(l(e,this.recursiveKeys()));if(t)return{cid:e,pinned:!0,reason:b.indirect,parent:t}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t){await c(this._walkDag(e,t))}static checkPinType(e){if("string"!==typeof e||!Object.keys(b).includes(e))throw p(e);return!0}}m.PinTypes=b,e.exports=m},d5ac:function(e,t,r){"use strict";const s=r("b84f"),n=r("2621"),i=r("8156"),o=r("6cdb");class a{constructor({network:e}){this.wantlist=s({network:e}),this.wantlistForPeer=n({network:e}),this.unwant=i({network:e}),this.stat=o({network:e})}}e.exports=a},d63e:function(e,t,r){"use strict";const s=r("e680"),n=r("ea8c"),i=r("01de"),o=r("d9a8"),a=r("34eb")("ipfs:repo:migrator");function c(e){return e=e||s,Array.isArray(e)&&0!==e.length?e[e.length-1].version:0}async function u(e,t,r,{ignoreLock:u=!1,onProgress:l,isDryRun:h=!1,migrations:p}){if(p=p||s,!e)throw new o.RequiredParameterError("Path argument is required!");if(!t)throw new o.RequiredParameterError("repoOptions argument is required!");if(!r)throw new o.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(r)||r<=0)throw new o.InvalidValueError("Version has to be positive integer!");const f=await n.getVersion(e,t);if(f===r)return void a("Nothing to migrate.");if(f>r)throw new o.InvalidValueError(`Current repo's version (${f}) is higher then toVersion (${r}), you probably wanted to revert it?`);let y;d(p,f,r),h||u||(y=await i.lock(f,e,t));try{for(const s of p){if(void 0!==r&&s.version>r)break;if(!(s.version<=f)){a("Migrating version "+s.version);try{if(!h){let r=()=>{};l&&(r=(e,t)=>l(s.version,e.toFixed(2),t)),await s.migrate(e,t,r)}}catch(g){const r=s.version-1;throw a("An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: "+r),await n.setVersion(e,r,t),new Error(`During migration to version ${s.version} exception was raised: ${g.stack||g.message||g}`)}a(`Migrating to version ${s.version} finished`)}}h||await n.setVersion(e,r||c(p),t),a("Repo successfully migrated",void 0!==r?`to version ${r}!`:"to latest version!")}finally{h||u||!y||await y.close()}}async function l(e,t,r,{ignoreLock:c=!1,onProgress:u,isDryRun:l=!1,migrations:h}){if(h=h||s,!e)throw new o.RequiredParameterError("Path argument is required!");if(!t)throw new o.RequiredParameterError("repoOptions argument is required!");if(!r)throw new o.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(r)||r<=0)throw new o.InvalidValueError("Version has to be positive integer!");const p=await n.getVersion(e,t);if(p===r)return void a("Nothing to revert.");if(p<r)throw new o.InvalidValueError(`Current repo's version (${p}) is lower then toVersion (${r}), you probably wanted to migrate it?`);let f;d(h,r,p,!0),l||c||(f=await i.lock(p,e,t)),a(`Reverting from version ${p} to ${r}`);try{const s=h.slice().reverse();for(const i of s){if(i.version<=r)break;if(!(i.version>p)){a("Reverting migration version "+i.version);try{if(!l){let r=()=>{};u&&(r=(e,t)=>u(i.version,e.toFixed(2),t)),await i.revert(e,t,r)}}catch(y){const r=i.version;throw a("An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: "+r),await n.setVersion(e,r,t),y.message=`During reversion to version ${i.version} exception was raised: ${y.message}`,y}a(`Reverting to version ${i.version} finished`)}}l||await n.setVersion(e,r,t),a(`All migrations successfully reverted to version ${r}!`)}finally{l||c||!f||await f.close()}}function d(e,t,r,s=!1){let n=0;for(const i of e){if(i.version>r)break;if(i.version>t){if(s&&!i.revert)throw new o.NonReversibleMigrationError(`It is not possible to revert to version ${t} because migration version ${i.version} is not reversible. Cancelling reversion.`);n++}}if(n!==r-t)throw new o.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${t} to ${r}`)}t.getCurrentRepoVersion=n.getVersion,t.errors=o,t.getLatestMigrationVersion=c,t.migrate=u,t.revert=l},d64a:function(e,t,r){"use strict";const s=r("a29d"),n="rsa",i=2048;e.exports=({keychain:e})=>{const t=(t,r={type:n,size:i})=>e.createKey(t,r.type||n,r.size||i);return s(t)}},d6c0:function(e,t,r){"use strict";const{TieredDatastore:s}=r("b0ea"),n=r("36be"),i=r("dcd8"),o=r("6b85");e.exports=({libp2p:e,repo:t,peerId:r,options:a})=>{const c=[];let u;if(n(a,"EXPERIMENTAL.ipnsPubsub",!1)){const s=e.pubsub,n=t.datastore;u=new i(s,n,r),c.push(u)}if(n(a,"offline")||!n(a,"libp2p.config.dht.enabled",!1)){const e=new o(t);c.push(e)}else c.push(e._dht);return new s(c)}},d6d7:function(e,t,r){"use strict";const s=r("b6aa"),n=r("c449"),i=r("0c24"),o=r("9975"),a=(e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),c=e=>{if(e instanceof Uint8Array)return{cid:new n(e),toResolve:[]};if(n.isCID(e))return{cid:e,toResolve:[]};if("string"===typeof e){0===e.indexOf("/ipfs/")&&(e=e.substring(6));const t=a(e);return{cid:new n(t[0]),toResolve:t.slice(1)}}throw s(new Error("Unknown path type "+e),"ERR_BAD_PATH")};async function*u(e,t,r={}){let{cid:n,toResolve:o}=c(e),a=n.toString(),u=a;const l=o.length;while(1){const c=await i(n,a,u,o,l,t,r);if(!c.entry&&!c.next)throw s(new Error("Could not resolve "+e),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;o=c.next.toResolve,n=c.next.cid,a=c.next.name,u=c.next.path}}async function l(e,t,r={}){const n=await o(u(e,t,r));if(!n)throw s(new Error("Could not resolve "+e),"ERR_NOT_FOUND");return n}async function*d(e,t,r={}){const s=await l(e,t,r);if(s&&(yield s,"directory"===s.type))for await(const i of n(s,r))yield i;async function*n(e,t){for await(const r of e.content(t))yield r,r instanceof Uint8Array||"directory"===r.type&&(yield*n(r,t))}}e.exports={exporter:l,walkPath:u,recursive:d}},d6e3:function(e,t,r){"use strict";e.exports=r("620f")},d6fc:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("1755"),n=r("b92d"),i=r("ac23");function o(e,t,r,n){return new s.Token(s.Type.map,n,r)}function a(e,t,r,s){return o(e,t,1,r)}function c(e,t,r,s){return o(e,t,2,n.readUint8(e,t+1,s))}function u(e,t,r,s){return o(e,t,3,n.readUint16(e,t+1,s))}function l(e,t,r,s){return o(e,t,5,n.readUint32(e,t+1,s))}function d(e,t,r,s){const a=n.readUint64(e,t+1,s);if("bigint"===typeof a)throw new Error(i.decodeErrPrefix+" 64-bit integer map lengths not supported");return o(e,t,9,a)}function h(e,t,r,s){if(!1===s.allowIndefinite)throw new Error(i.decodeErrPrefix+" indefinite length items not allowed");return o(e,t,1,1/0)}function p(e,t){n.encodeUintValue(e,s.Type.map.majorEncoded,t.value)}p.compareTokens=n.encodeUint.compareTokens,t.decodeMap16=u,t.decodeMap32=l,t.decodeMap64=d,t.decodeMap8=c,t.decodeMapCompact=a,t.decodeMapIndefinite=h,t.encodeMap=p},d7b4:function(e,t,r){"use strict";var s=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n)return n;throw new Error("unable to locate global object")},n=s();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},d81a:function(e,t,r){"use strict";const s=r("42f1"),n=r("0662");function i(e){if(!e||!e.hashFn)throw new Error("please define an options.hashFn");const t={bits:e.bits||8,hash:n(e.hashFn)};return new s(t)}e.exports={createHAMT:i,Bucket:s}},d835:function(e,t,r){"use strict";const s=(e,...t)=>new Promise(r=>{r(e(...t))});e.exports=s,e.exports.default=s},d9a5:function(e,t,r){"use strict";var s=r("6d6b"),n=/[\/\?<>\\:\*\|"]/g,i=/[\x00-\x1f\x80-\x9f]/g,o=/^\.+$/,a=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,c=/[\. ]+$/;function u(e,t){if("string"!==typeof e)throw new Error("Input must be string");var r=e.replace(n,t).replace(i,t).replace(o,t).replace(a,t).replace(c,t);return s(r,255)}e.exports=function(e,t){var r=t&&t.replacement||"",s=u(e,r);return""===r?s:u(s,"")}},d9a75:function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:ping"),{error:s("libp2p:ping:err")}),i=r("b6aa"),o=r("ff5f"),{pipe:a}=r("66f2"),{toBuffer:c}=r("6bec"),{collect:u,take:l}=r("8b55"),d=r("5aab"),{PROTOCOL:h,PING_LENGTH:p}=r("3184");async function f(e,t){n("dialing %s to %s",h,t.toB58String?t.toB58String():t);const r=await e.dial(t),{stream:s}=await r.newStream(h),f=Date.now(),y=o.randomBytes(p),[g]=await a([y],s,e=>l(1,e),c,u),b=Date.now();if(!d(y,g))throw i(new Error("Received wrong ping ack"),"ERR_WRONG_PING_ACK");return b-f}function y(e){e.handle(h,({stream:e})=>a(e,e))}function g(e){e.unhandle(h)}t=e.exports=f,t.mount=y,t.unmount=g},d9a8:function(e,t,r){"use strict";class s extends Error{constructor(e){super(e),this.name="NonReversibleMigrationError",this.code="ERR_NON_REVERSIBLE_MIGRATION",this.message=e}}s.code="ERR_NON_REVERSIBLE_MIGRATION";class n extends Error{constructor(e){super(e),this.name="NotInitializedRepoError",this.code="ERR_NOT_INITIALIZED_REPO",this.message=e}}n.code="ERR_NOT_INITIALIZED_REPO";class i extends Error{constructor(e){super(e),this.name="RequiredParameterError",this.code="ERR_REQUIRED_PARAMETER",this.message=e}}i.code="ERR_REQUIRED_PARAMETER";class o extends Error{constructor(e){super(e),this.name="InvalidValueError",this.code="ERR_INVALID_VALUE",this.message=e}}o.code="ERR_INVALID_VALUE";class a extends Error{constructor(e){super(e),this.name="MissingRepoOptionsError",this.code="ERR_MISSING_REPO_OPTIONS",this.message=e}}a.code="ERR_MISSING_REPO_OPTIONS",e.exports={NonReversibleMigrationError:s,NotInitializedRepoError:n,RequiredParameterError:i,InvalidValueError:o,MissingRepoOptionsError:a}},da0b:function(e,t,r){"use strict";const s=r("c449"),{ipfs:{pin:{Set:n}}}=r("8786"),i=r("bf4e"),o=r("aefb"),a=r("8141"),c=r("0fc0"),u=r("0eff"),l=r("0e80").multihash,{cidToKey:d,DEFAULT_FANOUT:h,MAX_ITEMS:p,EMPTY_KEY:f}=r("7db2"),y=r("f3bf"),g=r("f9a3"),b=r("9b62"),m=r("d46b"),w=r("5aab");function _(e){return new s(e).toBaseEncodedString()}function E(e){const t=e.Data,r=o.decode(t),s=o.decode.bytes;if(s<=0)throw new Error("Invalid Set header length");if(s+r>t.length)throw new Error("Impossibly large set header length");const i=t.slice(s,r+s),a=n.toObject(n.decode(i),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(1!==a.version)throw new Error("Unsupported Set version: "+a.version);if(a.fanout>e.Links.length)throw new Error("Impossibly large fanout");return{header:a,data:t.slice(r+s)}}function v(e,t){const r=new Uint8Array(4),s=new DataView(r.buffer);s.setUint32(0,e,!0);const n=m(_(t)),o=y([r,n],r.byteLength+n.byteLength);return i(b(o))}async function*S(e,t){const r=E(t);let s=0;for(const n of t.Links){if(s<r.header.fanout){const t=n.Hash;if(!w(f,t.bytes)){const r=await e.get(d(t)),s=a.util.deserialize(r);yield*S(e,s)}}else yield n.Hash;s++}}async function*I(e,t,r){const s=t.Links.find(e=>e.Name===r);if(!s)throw new Error("No link found with name "+r);const n=await e.get(d(s.Hash)),i=a.util.deserialize(n);yield*S(e,i)}function A(e,t){return r(t,0);async function r(t,s){const i=n.encode({version:1,fanout:h,seed:s}).finish(),b=o.encode(i.length),m=y([b,i]),w=[];for(let e=0;e<h;e++)w.push(new u("",1,f));if(t.length<=p){const e=t.map(e=>({link:new u("",1,e.key),data:e.data||new Uint8Array})).sort((e,t)=>g(e.link.Hash.bytes,t.link.Hash.bytes)),r=w.concat(e.map(e=>e.link)),s=y([m,...e.map(e=>e.data)]);return new c(s,r)}{const e=t.reduce((e,t)=>{const r=v(s,t.key)%h;return e[r]=r in e?e[r].concat([t]):[t],e},[]);let n=0;for(const t of e){const e=await r(t,s+1);await _(e,n),n++}return new c(m,w)}async function _(t,r){const s=a.util.serialize(t),n=await a.util.cid(s,{cidVersion:0,hashAlg:l.names["sha2-256"]});await e.put(d(n),s),w[r]=new u("",t.size,n)}}}async function R(e,t,r){const s=await A(e,r.map(e=>({key:e}))),n=s.serialize(),i=await a.util.cid(n,{cidVersion:0,hashAlg:l.names["sha2-256"]});return await e.put(d(i),n),new u(t,s.size,i)}e.exports={loadSet:I,storeSet:R}},da12:function(e,t,r){"use strict";const s=r("bc82"),n=r("0ca7");async function i(e,t){const r=new s({root:e.root,dir:!0,parent:e.parent,parentKey:e.parentKey,path:e.path,dirty:e.dirty,flat:!1,mtime:e.mtime,mode:e.mode},t);for await(const{key:s,child:n}of e.eachChildSeries())await r.put(s,n);return r}e.exports=async function e(t,r,s,o){let a=r;r instanceof n&&r.directChildrenCount()>=s&&(a=await i(r,o));const c=a.parent;if(c){if(a!==r){if(t&&(t.parent=a),!a.parentKey)throw new Error("No parent key found");await c.put(a.parentKey,a)}return e(a,c,s,o)}return a}},da5a:function(e,t){e.exports=s;var r=null;try{r=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(k){}function s(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function n(e){return!0===(e&&e["__isLong__"])}s.prototype.__isLong__,Object.defineProperty(s.prototype,"__isLong__",{value:!0}),s.isLong=n;var i={},o={};function a(e,t){var r,s,n;return t?(e>>>=0,(n=0<=e&&e<256)&&(s=o[e],s)?s:(r=u(e,(0|e)<0?-1:0,!0),n&&(o[e]=r),r)):(e|=0,(n=-128<=e&&e<128)&&(s=i[e],s)?s:(r=u(e,e<0?-1:0,!1),n&&(i[e]=r),r))}function c(e,t){if(isNaN(e))return t?_:w;if(t){if(e<0)return _;if(e>=g)return A}else{if(e<=-b)return R;if(e+1>=b)return I}return e<0?c(-e,t).neg():u(e%y|0,e/y|0,t)}function u(e,t,r){return new s(e,t,r)}s.fromInt=a,s.fromNumber=c,s.fromBits=u;var l=Math.pow;function d(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return w;if("number"===typeof t?(r=t,t=!1):t=!!t,r=r||10,r<2||36<r)throw RangeError("radix");var s;if((s=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===s)return d(e.substring(1),t,r).neg();for(var n=c(l(r,8)),i=w,o=0;o<e.length;o+=8){var a=Math.min(8,e.length-o),u=parseInt(e.substring(o,o+a),r);if(a<8){var h=c(l(r,a));i=i.mul(h).add(c(u))}else i=i.mul(n),i=i.add(c(u))}return i.unsigned=t,i}function h(e,t){return"number"===typeof e?c(e,t):"string"===typeof e?d(e,t):u(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}s.fromString=d,s.fromValue=h;var p=65536,f=1<<24,y=p*p,g=y*y,b=g/2,m=a(f),w=a(0);s.ZERO=w;var _=a(0,!0);s.UZERO=_;var E=a(1);s.ONE=E;var v=a(1,!0);s.UONE=v;var S=a(-1);s.NEG_ONE=S;var I=u(-1,2147483647,!1);s.MAX_VALUE=I;var A=u(-1,-1,!0);s.MAX_UNSIGNED_VALUE=A;var R=u(0,-2147483648,!1);s.MIN_VALUE=R;var T=s.prototype;T.toInt=function(){return this.unsigned?this.low>>>0:this.low},T.toNumber=function(){return this.unsigned?(this.high>>>0)*y+(this.low>>>0):this.high*y+(this.low>>>0)},T.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(R)){var t=c(e),r=this.div(t),s=r.mul(t).sub(this);return r.toString(e)+s.toInt().toString(e)}return"-"+this.neg().toString(e)}var n=c(l(e,6),this.unsigned),i=this,o="";while(1){var a=i.div(n),u=i.sub(a.mul(n)).toInt()>>>0,d=u.toString(e);if(i=a,i.isZero())return d+o;while(d.length<6)d="0"+d;o=""+d+o}},T.getHighBits=function(){return this.high},T.getHighBitsUnsigned=function(){return this.high>>>0},T.getLowBits=function(){return this.low},T.getLowBitsUnsigned=function(){return this.low>>>0},T.getNumBitsAbs=function(){if(this.isNegative())return this.eq(R)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0;t--)if(0!=(e&1<<t))break;return 0!=this.high?t+33:t+1},T.isZero=function(){return 0===this.high&&0===this.low},T.eqz=T.isZero,T.isNegative=function(){return!this.unsigned&&this.high<0},T.isPositive=function(){return this.unsigned||this.high>=0},T.isOdd=function(){return 1===(1&this.low)},T.isEven=function(){return 0===(1&this.low)},T.equals=function(e){return n(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},T.eq=T.equals,T.notEquals=function(e){return!this.eq(e)},T.neq=T.notEquals,T.ne=T.notEquals,T.lessThan=function(e){return this.comp(e)<0},T.lt=T.lessThan,T.lessThanOrEqual=function(e){return this.comp(e)<=0},T.lte=T.lessThanOrEqual,T.le=T.lessThanOrEqual,T.greaterThan=function(e){return this.comp(e)>0},T.gt=T.greaterThan,T.greaterThanOrEqual=function(e){return this.comp(e)>=0},T.gte=T.greaterThanOrEqual,T.ge=T.greaterThanOrEqual,T.compare=function(e){if(n(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},T.comp=T.compare,T.negate=function(){return!this.unsigned&&this.eq(R)?R:this.not().add(E)},T.neg=T.negate,T.add=function(e){n(e)||(e=h(e));var t=this.high>>>16,r=65535&this.high,s=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,c=e.low>>>16,l=65535&e.low,d=0,p=0,f=0,y=0;return y+=i+l,f+=y>>>16,y&=65535,f+=s+c,p+=f>>>16,f&=65535,p+=r+a,d+=p>>>16,p&=65535,d+=t+o,d&=65535,u(f<<16|y,d<<16|p,this.unsigned)},T.subtract=function(e){return n(e)||(e=h(e)),this.add(e.neg())},T.sub=T.subtract,T.multiply=function(e){if(this.isZero())return w;if(n(e)||(e=h(e)),r){var t=r.mul(this.low,this.high,e.low,e.high);return u(t,r.get_high(),this.unsigned)}if(e.isZero())return w;if(this.eq(R))return e.isOdd()?R:w;if(e.eq(R))return this.isOdd()?R:w;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return c(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,i=65535&this.high,o=this.low>>>16,a=65535&this.low,l=e.high>>>16,d=65535&e.high,p=e.low>>>16,f=65535&e.low,y=0,g=0,b=0,_=0;return _+=a*f,b+=_>>>16,_&=65535,b+=o*f,g+=b>>>16,b&=65535,b+=a*p,g+=b>>>16,b&=65535,g+=i*f,y+=g>>>16,g&=65535,g+=o*p,y+=g>>>16,g&=65535,g+=a*d,y+=g>>>16,g&=65535,y+=s*f+i*p+o*d+a*l,y&=65535,u(b<<16|_,y<<16|g,this.unsigned)},T.mul=T.multiply,T.divide=function(e){if(n(e)||(e=h(e)),e.isZero())throw Error("division by zero");if(r){if(!this.unsigned&&-2147483648===this.high&&-1===e.low&&-1===e.high)return this;var t=(this.unsigned?r.div_u:r.div_s)(this.low,this.high,e.low,e.high);return u(t,r.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?_:w;var s,i,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return _;if(e.gt(this.shru(1)))return v;o=_}else{if(this.eq(R)){if(e.eq(E)||e.eq(S))return R;if(e.eq(R))return E;var a=this.shr(1);return s=a.div(e).shl(1),s.eq(w)?e.isNegative()?E:S:(i=this.sub(e.mul(s)),o=s.add(i.div(e)),o)}if(e.eq(R))return this.unsigned?_:w;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=w}i=this;while(i.gte(e)){s=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));var d=Math.ceil(Math.log(s)/Math.LN2),p=d<=48?1:l(2,d-48),f=c(s),y=f.mul(e);while(y.isNegative()||y.gt(i))s-=p,f=c(s,this.unsigned),y=f.mul(e);f.isZero()&&(f=E),o=o.add(f),i=i.sub(y)}return o},T.div=T.divide,T.modulo=function(e){if(n(e)||(e=h(e)),r){var t=(this.unsigned?r.rem_u:r.rem_s)(this.low,this.high,e.low,e.high);return u(t,r.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},T.mod=T.modulo,T.rem=T.modulo,T.not=function(){return u(~this.low,~this.high,this.unsigned)},T.and=function(e){return n(e)||(e=h(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},T.or=function(e){return n(e)||(e=h(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},T.xor=function(e){return n(e)||(e=h(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},T.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},T.shl=T.shiftLeft,T.shiftRight=function(e){return n(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},T.shr=T.shiftRight,T.shiftRightUnsigned=function(e){if(n(e)&&(e=e.toInt()),e&=63,0===e)return this;var t=this.high;if(e<32){var r=this.low;return u(r>>>e|t<<32-e,t>>>e,this.unsigned)}return u(32===e?t:t>>>e-32,0,this.unsigned)},T.shru=T.shiftRightUnsigned,T.shr_u=T.shiftRightUnsigned,T.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},T.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},T.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},T.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},T.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},s.fromBytes=function(e,t,r){return r?s.fromBytesLE(e,t):s.fromBytesBE(e,t)},s.fromBytesLE=function(e,t){return new s(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},s.fromBytesBE=function(e,t){return new s(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},db9e5:function(e,t,r){"use strict";const s=r("9975"),n=r("c449");e.exports=({addAll:e})=>(t,r={})=>{let i;return i=n.isCID(t)?e([{cid:t,...r}],r):e([{path:t.toString(),...r}],r),s(i)}},dbaa:function(e,t,r){"use strict";const s=r("b6aa"),n=r("91d3").default,{anySignal:i}=r("74fd"),o=r("4442a"),a=r("94df");class c{constructor({addrs:e,dialAction:t,dialer:r}){this.addrs=e,this.dialer=r,this.dialAction=t}async run(e={}){const t=this.dialer.getTokens(this.addrs.length);if(t.length<1)throw s(new Error("No dial tokens available"),"ERR_NO_DIAL_TOKENS");const r=new o;t.forEach(e=>r.push(e));const c=this.addrs.map(()=>new n);let u=0;try{return await a(this.addrs.map(async(s,n)=>{const o=await r.shift();let a;try{const l=c[n].signal;a=await this.dialAction(s,{...e,signal:e.signal?i([l,e.signal]):l}),c.splice(n,1)}finally{u++,this.addrs.length-u>=t.length?r.push(o):this.dialer.releaseToken(t.splice(t.indexOf(o),1)[0])}return a}))}finally{c.map(e=>e.abort()),t.forEach(e=>this.dialer.releaseToken(e))}}}e.exports=c},dbc6:function(e,t,r){"use strict";const s={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};t.SignaturePolicy=s},dc99:function(e,t,r){"use strict";const{URLWithLegacySupport:s,format:n}=r("9b7b");e.exports=(e,t={},r={},i)=>{let o,a=t.protocol?t.protocol.replace(":",""):"http";a=(r[a]||i||a)+":";try{o=new s(e)}catch(u){o={}}const c=Object.assign({},t,{protocol:a||o.protocol,host:t.host||o.host});return new s(e,n(c)).toString()}},dcc7:function(e,t,r){var s,n,i;(function(o,a){n=[r("543b")],s=a,i="function"===typeof s?s.apply(t,n):s,void 0===i||(e.exports=i)})(0,(function(e){"use strict";var t=e.Reader,r=e.Writer,s=e.util,n=e.roots["default"]||(e.roots["default"]={});return n.RPC=function(){function i(e){if(this.subscriptions=[],this.msgs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.subscriptions=s.emptyArray,i.prototype.msgs=s.emptyArray,i.prototype.control=null,Object.defineProperty(i.prototype,"_control",{get:s.oneOfGetter(o=["control"]),set:s.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=r.create()),null!=e.subscriptions&&e.subscriptions.length)for(var s=0;s<e.subscriptions.length;++s)n.RPC.SubOpts.encode(e.subscriptions[s],t.uint32(10).fork()).ldelim();if(null!=e.msgs&&e.msgs.length)for(s=0;s<e.msgs.length;++s)n.RPC.Message.encode(e.msgs[s],t.uint32(18).fork()).ldelim();return null!=e.control&&Object.hasOwnProperty.call(e,"control")&&n.RPC.ControlMessage.encode(e.control,t.uint32(26).fork()).ldelim(),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));var s=void 0===r?e.len:e.pos+r,i=new n.RPC;while(e.pos<s){var o=e.uint32();switch(o>>>3){case 1:i.subscriptions&&i.subscriptions.length||(i.subscriptions=[]),i.subscriptions.push(n.RPC.SubOpts.decode(e,e.uint32()));break;case 2:i.msgs&&i.msgs.length||(i.msgs=[]),i.msgs.push(n.RPC.Message.decode(e,e.uint32()));break;case 3:i.control=n.RPC.ControlMessage.decode(e,e.uint32());break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof n.RPC)return e;var t=new n.RPC;if(e.subscriptions){if(!Array.isArray(e.subscriptions))throw TypeError(".RPC.subscriptions: array expected");t.subscriptions=[];for(var r=0;r<e.subscriptions.length;++r){if("object"!==typeof e.subscriptions[r])throw TypeError(".RPC.subscriptions: object expected");t.subscriptions[r]=n.RPC.SubOpts.fromObject(e.subscriptions[r])}}if(e.msgs){if(!Array.isArray(e.msgs))throw TypeError(".RPC.msgs: array expected");t.msgs=[];for(r=0;r<e.msgs.length;++r){if("object"!==typeof e.msgs[r])throw TypeError(".RPC.msgs: object expected");t.msgs[r]=n.RPC.Message.fromObject(e.msgs[r])}}if(null!=e.control){if("object"!==typeof e.control)throw TypeError(".RPC.control: object expected");t.control=n.RPC.ControlMessage.fromObject(e.control)}return t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.subscriptions=[],r.msgs=[]),e.subscriptions&&e.subscriptions.length){r.subscriptions=[];for(var s=0;s<e.subscriptions.length;++s)r.subscriptions[s]=n.RPC.SubOpts.toObject(e.subscriptions[s],t)}if(e.msgs&&e.msgs.length){r.msgs=[];for(s=0;s<e.msgs.length;++s)r.msgs[s]=n.RPC.Message.toObject(e.msgs[s],t)}return null!=e.control&&e.hasOwnProperty("control")&&(r.control=n.RPC.ControlMessage.toObject(e.control,t),t.oneofs&&(r._control="control")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i.SubOpts=function(){function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.subscribe=null,i.prototype.topicID=null,Object.defineProperty(i.prototype,"_subscribe",{get:s.oneOfGetter(o=["subscribe"]),set:s.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_topicID",{get:s.oneOfGetter(o=["topicID"]),set:s.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=r.create()),null!=e.subscribe&&Object.hasOwnProperty.call(e,"subscribe")&&t.uint32(8).bool(e.subscribe),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(18).string(e.topicID),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));var s=void 0===r?e.len:e.pos+r,i=new n.RPC.SubOpts;while(e.pos<s){var o=e.uint32();switch(o>>>3){case 1:i.subscribe=e.bool();break;case 2:i.topicID=e.string();break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof n.RPC.SubOpts)return e;var t=new n.RPC.SubOpts;return null!=e.subscribe&&(t.subscribe=Boolean(e.subscribe)),null!=e.topicID&&(t.topicID=String(e.topicID)),t},i.toObject=function(e,t){t||(t={});var r={};return null!=e.subscribe&&e.hasOwnProperty("subscribe")&&(r.subscribe=e.subscribe,t.oneofs&&(r._subscribe="subscribe")),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.Message=function(){function i(e){if(this.topicIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.from=null,i.prototype.data=null,i.prototype.seqno=null,i.prototype.topicIDs=s.emptyArray,i.prototype.signature=null,i.prototype.key=null,Object.defineProperty(i.prototype,"_from",{get:s.oneOfGetter(o=["from"]),set:s.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_data",{get:s.oneOfGetter(o=["data"]),set:s.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_seqno",{get:s.oneOfGetter(o=["seqno"]),set:s.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_signature",{get:s.oneOfGetter(o=["signature"]),set:s.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_key",{get:s.oneOfGetter(o=["key"]),set:s.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=r.create()),null!=e.from&&Object.hasOwnProperty.call(e,"from")&&t.uint32(10).bytes(e.from),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),null!=e.seqno&&Object.hasOwnProperty.call(e,"seqno")&&t.uint32(26).bytes(e.seqno),null!=e.topicIDs&&e.topicIDs.length)for(var s=0;s<e.topicIDs.length;++s)t.uint32(34).string(e.topicIDs[s]);return null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(50).bytes(e.key),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));var s=void 0===r?e.len:e.pos+r,i=new n.RPC.Message;while(e.pos<s){var o=e.uint32();switch(o>>>3){case 1:i.from=e.bytes();break;case 2:i.data=e.bytes();break;case 3:i.seqno=e.bytes();break;case 4:i.topicIDs&&i.topicIDs.length||(i.topicIDs=[]),i.topicIDs.push(e.string());break;case 5:i.signature=e.bytes();break;case 6:i.key=e.bytes();break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof n.RPC.Message)return e;var t=new n.RPC.Message;if(null!=e.from&&("string"===typeof e.from?s.base64.decode(e.from,t.from=s.newBuffer(s.base64.length(e.from)),0):e.from.length&&(t.from=e.from)),null!=e.data&&("string"===typeof e.data?s.base64.decode(e.data,t.data=s.newBuffer(s.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.seqno&&("string"===typeof e.seqno?s.base64.decode(e.seqno,t.seqno=s.newBuffer(s.base64.length(e.seqno)),0):e.seqno.length&&(t.seqno=e.seqno)),e.topicIDs){if(!Array.isArray(e.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");t.topicIDs=[];for(var r=0;r<e.topicIDs.length;++r)t.topicIDs[r]=String(e.topicIDs[r])}return null!=e.signature&&("string"===typeof e.signature?s.base64.decode(e.signature,t.signature=s.newBuffer(s.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),null!=e.key&&("string"===typeof e.key?s.base64.decode(e.key,t.key=s.newBuffer(s.base64.length(e.key)),0):e.key.length&&(t.key=e.key)),t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.topicIDs=[]),null!=e.from&&e.hasOwnProperty("from")&&(r.from=t.bytes===String?s.base64.encode(e.from,0,e.from.length):t.bytes===Array?Array.prototype.slice.call(e.from):e.from,t.oneofs&&(r._from="from")),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?s.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data,t.oneofs&&(r._data="data")),null!=e.seqno&&e.hasOwnProperty("seqno")&&(r.seqno=t.bytes===String?s.base64.encode(e.seqno,0,e.seqno.length):t.bytes===Array?Array.prototype.slice.call(e.seqno):e.seqno,t.oneofs&&(r._seqno="seqno")),e.topicIDs&&e.topicIDs.length){r.topicIDs=[];for(var n=0;n<e.topicIDs.length;++n)r.topicIDs[n]=e.topicIDs[n]}return null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?s.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature,t.oneofs&&(r._signature="signature")),null!=e.key&&e.hasOwnProperty("key")&&(r.key=t.bytes===String?s.base64.encode(e.key,0,e.key.length):t.bytes===Array?Array.prototype.slice.call(e.key):e.key,t.oneofs&&(r._key="key")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlMessage=function(){function i(e){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return i.prototype.ihave=s.emptyArray,i.prototype.iwant=s.emptyArray,i.prototype.graft=s.emptyArray,i.prototype.prune=s.emptyArray,i.encode=function(e,t){if(t||(t=r.create()),null!=e.ihave&&e.ihave.length)for(var s=0;s<e.ihave.length;++s)n.RPC.ControlIHave.encode(e.ihave[s],t.uint32(10).fork()).ldelim();if(null!=e.iwant&&e.iwant.length)for(s=0;s<e.iwant.length;++s)n.RPC.ControlIWant.encode(e.iwant[s],t.uint32(18).fork()).ldelim();if(null!=e.graft&&e.graft.length)for(s=0;s<e.graft.length;++s)n.RPC.ControlGraft.encode(e.graft[s],t.uint32(26).fork()).ldelim();if(null!=e.prune&&e.prune.length)for(s=0;s<e.prune.length;++s)n.RPC.ControlPrune.encode(e.prune[s],t.uint32(34).fork()).ldelim();return t},i.decode=function(e,r){e instanceof t||(e=t.create(e));var s=void 0===r?e.len:e.pos+r,i=new n.RPC.ControlMessage;while(e.pos<s){var o=e.uint32();switch(o>>>3){case 1:i.ihave&&i.ihave.length||(i.ihave=[]),i.ihave.push(n.RPC.ControlIHave.decode(e,e.uint32()));break;case 2:i.iwant&&i.iwant.length||(i.iwant=[]),i.iwant.push(n.RPC.ControlIWant.decode(e,e.uint32()));break;case 3:i.graft&&i.graft.length||(i.graft=[]),i.graft.push(n.RPC.ControlGraft.decode(e,e.uint32()));break;case 4:i.prune&&i.prune.length||(i.prune=[]),i.prune.push(n.RPC.ControlPrune.decode(e,e.uint32()));break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof n.RPC.ControlMessage)return e;var t=new n.RPC.ControlMessage;if(e.ihave){if(!Array.isArray(e.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");t.ihave=[];for(var r=0;r<e.ihave.length;++r){if("object"!==typeof e.ihave[r])throw TypeError(".RPC.ControlMessage.ihave: object expected");t.ihave[r]=n.RPC.ControlIHave.fromObject(e.ihave[r])}}if(e.iwant){if(!Array.isArray(e.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");t.iwant=[];for(r=0;r<e.iwant.length;++r){if("object"!==typeof e.iwant[r])throw TypeError(".RPC.ControlMessage.iwant: object expected");t.iwant[r]=n.RPC.ControlIWant.fromObject(e.iwant[r])}}if(e.graft){if(!Array.isArray(e.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");t.graft=[];for(r=0;r<e.graft.length;++r){if("object"!==typeof e.graft[r])throw TypeError(".RPC.ControlMessage.graft: object expected");t.graft[r]=n.RPC.ControlGraft.fromObject(e.graft[r])}}if(e.prune){if(!Array.isArray(e.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");t.prune=[];for(r=0;r<e.prune.length;++r){if("object"!==typeof e.prune[r])throw TypeError(".RPC.ControlMessage.prune: object expected");t.prune[r]=n.RPC.ControlPrune.fromObject(e.prune[r])}}return t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.ihave=[],r.iwant=[],r.graft=[],r.prune=[]),e.ihave&&e.ihave.length){r.ihave=[];for(var s=0;s<e.ihave.length;++s)r.ihave[s]=n.RPC.ControlIHave.toObject(e.ihave[s],t)}if(e.iwant&&e.iwant.length){r.iwant=[];for(s=0;s<e.iwant.length;++s)r.iwant[s]=n.RPC.ControlIWant.toObject(e.iwant[s],t)}if(e.graft&&e.graft.length){r.graft=[];for(s=0;s<e.graft.length;++s)r.graft[s]=n.RPC.ControlGraft.toObject(e.graft[s],t)}if(e.prune&&e.prune.length){r.prune=[];for(s=0;s<e.prune.length;++s)r.prune[s]=n.RPC.ControlPrune.toObject(e.prune[s],t)}return r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlIHave=function(){function i(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.topicID=null,i.prototype.messageIDs=s.emptyArray,Object.defineProperty(i.prototype,"_topicID",{get:s.oneOfGetter(o=["topicID"]),set:s.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.messageIDs&&e.messageIDs.length)for(var s=0;s<e.messageIDs.length;++s)t.uint32(18).bytes(e.messageIDs[s]);return t},i.decode=function(e,r){e instanceof t||(e=t.create(e));var s=void 0===r?e.len:e.pos+r,i=new n.RPC.ControlIHave;while(e.pos<s){var o=e.uint32();switch(o>>>3){case 1:i.topicID=e.string();break;case 2:i.messageIDs&&i.messageIDs.length||(i.messageIDs=[]),i.messageIDs.push(e.bytes());break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof n.RPC.ControlIHave)return e;var t=new n.RPC.ControlIHave;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");t.messageIDs=[];for(var r=0;r<e.messageIDs.length;++r)"string"===typeof e.messageIDs[r]?s.base64.decode(e.messageIDs[r],t.messageIDs[r]=s.newBuffer(s.base64.length(e.messageIDs[r])),0):e.messageIDs[r].length&&(t.messageIDs[r]=e.messageIDs[r])}return t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messageIDs=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),e.messageIDs&&e.messageIDs.length){r.messageIDs=[];for(var n=0;n<e.messageIDs.length;++n)r.messageIDs[n]=t.bytes===String?s.base64.encode(e.messageIDs[n],0,e.messageIDs[n].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[n]):e.messageIDs[n]}return r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlIWant=function(){function i(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return i.prototype.messageIDs=s.emptyArray,i.encode=function(e,t){if(t||(t=r.create()),null!=e.messageIDs&&e.messageIDs.length)for(var s=0;s<e.messageIDs.length;++s)t.uint32(10).bytes(e.messageIDs[s]);return t},i.decode=function(e,r){e instanceof t||(e=t.create(e));var s=void 0===r?e.len:e.pos+r,i=new n.RPC.ControlIWant;while(e.pos<s){var o=e.uint32();switch(o>>>3){case 1:i.messageIDs&&i.messageIDs.length||(i.messageIDs=[]),i.messageIDs.push(e.bytes());break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof n.RPC.ControlIWant)return e;var t=new n.RPC.ControlIWant;if(e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");t.messageIDs=[];for(var r=0;r<e.messageIDs.length;++r)"string"===typeof e.messageIDs[r]?s.base64.decode(e.messageIDs[r],t.messageIDs[r]=s.newBuffer(s.base64.length(e.messageIDs[r])),0):e.messageIDs[r].length&&(t.messageIDs[r]=e.messageIDs[r])}return t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messageIDs=[]),e.messageIDs&&e.messageIDs.length){r.messageIDs=[];for(var n=0;n<e.messageIDs.length;++n)r.messageIDs[n]=t.bytes===String?s.base64.encode(e.messageIDs[n],0,e.messageIDs[n].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[n]):e.messageIDs[n]}return r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlGraft=function(){function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.topicID=null,Object.defineProperty(i.prototype,"_topicID",{get:s.oneOfGetter(o=["topicID"]),set:s.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));var s=void 0===r?e.len:e.pos+r,i=new n.RPC.ControlGraft;while(e.pos<s){var o=e.uint32();switch(o>>>3){case 1:i.topicID=e.string();break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof n.RPC.ControlGraft)return e;var t=new n.RPC.ControlGraft;return null!=e.topicID&&(t.topicID=String(e.topicID)),t},i.toObject=function(e,t){t||(t={});var r={};return null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlPrune=function(){function i(e){if(this.peers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.topicID=null,i.prototype.peers=s.emptyArray,i.prototype.backoff=null,Object.defineProperty(i.prototype,"_topicID",{get:s.oneOfGetter(o=["topicID"]),set:s.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_backoff",{get:s.oneOfGetter(o=["backoff"]),set:s.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.peers&&e.peers.length)for(var s=0;s<e.peers.length;++s)n.RPC.PeerInfo.encode(e.peers[s],t.uint32(18).fork()).ldelim();return null!=e.backoff&&Object.hasOwnProperty.call(e,"backoff")&&t.uint32(24).uint64(e.backoff),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));var s=void 0===r?e.len:e.pos+r,i=new n.RPC.ControlPrune;while(e.pos<s){var o=e.uint32();switch(o>>>3){case 1:i.topicID=e.string();break;case 2:i.peers&&i.peers.length||(i.peers=[]),i.peers.push(n.RPC.PeerInfo.decode(e,e.uint32()));break;case 3:i.backoff=e.uint64();break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof n.RPC.ControlPrune)return e;var t=new n.RPC.ControlPrune;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.peers){if(!Array.isArray(e.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");t.peers=[];for(var r=0;r<e.peers.length;++r){if("object"!==typeof e.peers[r])throw TypeError(".RPC.ControlPrune.peers: object expected");t.peers[r]=n.RPC.PeerInfo.fromObject(e.peers[r])}}return null!=e.backoff&&(s.Long?(t.backoff=s.Long.fromValue(e.backoff)).unsigned=!0:"string"===typeof e.backoff?t.backoff=parseInt(e.backoff,10):"number"===typeof e.backoff?t.backoff=e.backoff:"object"===typeof e.backoff&&(t.backoff=new s.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0))),t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.peers=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),e.peers&&e.peers.length){r.peers=[];for(var i=0;i<e.peers.length;++i)r.peers[i]=n.RPC.PeerInfo.toObject(e.peers[i],t)}return null!=e.backoff&&e.hasOwnProperty("backoff")&&("number"===typeof e.backoff?r.backoff=t.longs===String?String(e.backoff):e.backoff:r.backoff=t.longs===String?s.Long.prototype.toString.call(e.backoff):t.longs===Number?new s.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0):e.backoff,t.oneofs&&(r._backoff="backoff")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.PeerInfo=function(){function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.peerID=null,i.prototype.signedPeerRecord=null,Object.defineProperty(i.prototype,"_peerID",{get:s.oneOfGetter(o=["peerID"]),set:s.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_signedPeerRecord",{get:s.oneOfGetter(o=["signedPeerRecord"]),set:s.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=r.create()),null!=e.peerID&&Object.hasOwnProperty.call(e,"peerID")&&t.uint32(10).bytes(e.peerID),null!=e.signedPeerRecord&&Object.hasOwnProperty.call(e,"signedPeerRecord")&&t.uint32(18).bytes(e.signedPeerRecord),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));var s=void 0===r?e.len:e.pos+r,i=new n.RPC.PeerInfo;while(e.pos<s){var o=e.uint32();switch(o>>>3){case 1:i.peerID=e.bytes();break;case 2:i.signedPeerRecord=e.bytes();break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof n.RPC.PeerInfo)return e;var t=new n.RPC.PeerInfo;return null!=e.peerID&&("string"===typeof e.peerID?s.base64.decode(e.peerID,t.peerID=s.newBuffer(s.base64.length(e.peerID)),0):e.peerID.length&&(t.peerID=e.peerID)),null!=e.signedPeerRecord&&("string"===typeof e.signedPeerRecord?s.base64.decode(e.signedPeerRecord,t.signedPeerRecord=s.newBuffer(s.base64.length(e.signedPeerRecord)),0):e.signedPeerRecord.length&&(t.signedPeerRecord=e.signedPeerRecord)),t},i.toObject=function(e,t){t||(t={});var r={};return null!=e.peerID&&e.hasOwnProperty("peerID")&&(r.peerID=t.bytes===String?s.base64.encode(e.peerID,0,e.peerID.length):t.bytes===Array?Array.prototype.slice.call(e.peerID):e.peerID,t.oneofs&&(r._peerID="peerID")),null!=e.signedPeerRecord&&e.hasOwnProperty("signedPeerRecord")&&(r.signedPeerRecord=t.bytes===String?s.base64.encode(e.signedPeerRecord,0,e.signedPeerRecord.length):t.bytes===Array?Array.prototype.slice.call(e.signedPeerRecord):e.signedPeerRecord,t.oneofs&&(r._signedPeerRecord="signedPeerRecord")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i}(),n}))},dcd8:function(e,t,r){"use strict";const s=r("6ef9"),{toB58String:n}=r("0e80").multihash,i=r("76a02"),o=r("9b62"),a=r("d46b"),c=r("b6aa"),u=r("34eb"),l=Object.assign(u("ipfs:ipns:pubsub"),{error:u("ipfs:ipns:pubsub:error")});class d{constructor(e,t,r){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new i(e,t,r,s.validator,this._handleSubscriptionKey)}put(e,t){return this._pubsubDs.put(e,t)}async get(e){let t,r;try{t=await this._pubsubDs.get(e)}catch(a){r=a}const i=e.slice(0,s.namespaceLength);if(o(i)===s.namespace){const t=n(e),r=n(e.slice(s.namespaceLength));this._subscriptions[t]=r,l(`subscribed to pubsub topic ${t}, id ${r}`)}if(r)throw r;return t}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=o(e,"base58btc"));const t=this._subscriptions[e];if(!t)throw c(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");let r;try{r=s.getIdKeys(a(t,"base58btc"))}catch(n){throw l.error(n),n}return r.routingKey.uint8Array()}getSubscriptions(){const e=Object.values(this._subscriptions).filter(Boolean);return e.map(e=>`${s.namespace}${e}`)}async cancel(e){if("string"!==typeof e)throw c(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(s.namespace)&&(e=e.substring(s.namespaceLength));const t=Object.keys(this._subscriptions).find(t=>this._subscriptions[t]===e);if(!t)return{canceled:!1};const r=a(t);return this._pubsubDs.unsubscribe(r),delete this._subscriptions[t],l(`unsubscribed pubsub ${t}: ${e}`),{canceled:!0}}}e.exports=d},dcea:function(e,t,r){"use strict";const s=r("3d5a"),n=r("9b62"),i=r("d46b"),o=r("eddf"),a=r("354e"),c=()=>s(8),u=(e,t)=>{const r=o.createFromB58String(e).id,s=new Uint8Array(r.length+t.length);return s.set(r,0),s.set(t,r.length),s},l=e=>a.encode(e,"sha2-256"),d=(e,t)=>{let r;r=Array.isArray(t)?e=>t.indexOf(e)>-1:e=>t.has(e);for(const s of e)if(r(s))return!0;return!1},h=e=>Array.isArray(e)?e:[e],p=(e,t)=>{const r=Object.assign({},e);return e.from instanceof Uint8Array&&(r.from=n(e.from,"base58btc")),t&&(r.receivedFrom=t),r},f=e=>{const t=Object.assign({},e);return"string"===typeof e.from&&(t.from=i(e.from,"base58btc")),"string"===typeof e.data&&(t.data=i(e.data)),t};e.exports={randomSeqno:c,msgId:u,noSignMsgId:l,anyMatch:d,ensureArray:h,normalizeInRpcMessage:p,normalizeOutRpcMessage:f}},de6c:function(e,t,r){"use strict";const{nanoid:s}=r("e1bd"),n=(e=(e=>e))=>e(s());e.exports=n},df7a:function(e,t,r){"use strict";const s=r("5102").create,n=s("LevelUPError"),i=s("NotFoundError",n);i.prototype.notFound=!0,i.prototype.status=404,e.exports={LevelUPError:n,InitializationError:s("InitializationError",n),OpenError:s("OpenError",n),ReadError:s("ReadError",n),WriteError:s("WriteError",n),NotFoundError:i,EncodingError:s("EncodingError",n)}},df9f:function(e,t,r){"use strict";const{Record:s}=r("92b9"),n=r("b6aa"),i=r("73fb"),o=r("a9f4");e.exports=e=>{const t=o.logger(e.peerId,"rpc:get-value");async function r(r,a){const c=a.key;if(t("key: %b",c),!c||0===c.length)throw n(new Error("Invalid key"),"ERR_INVALID_KEY");const u=new i(i.TYPES.GET_VALUE,c,a.clusterLevel);if(o.isPublicKeyKey(c)){t("is public key");const r=o.fromPublicKeyKey(c);let n;if(e._isSelf(r))n=e.peerId;else{const t=e.peerStore.get(r);n=t&&t.id}if(n&&n.pubKey)return t("returning found public key"),u.record=new s(c,n.pubKey.bytes),u}const[l,d]=await Promise.all([e._checkLocalDatastore(c),e._betterPeersToQuery(a,r)]);return l&&(t("got record"),u.record=l),d.length>0&&(t("got closer %s",d.length),u.closerPeers=d),u}return r}},e06e:function(e,t,r){"use strict";const s=r("eddf"),{Multiaddr:n}=r("2054"),i=r("9457"),{EventEmitter:o}=r("faa1"),a=r("34eb"),c=Object.assign(a("libp2p:bootstrap"),{error:a("libp2p:bootstrap:error")});class u extends o{constructor(e={list:[]}){if(!e.list||!e.list.length)throw new Error("Bootstrap requires a list of peer addresses");super(),this._list=e.list,this._interval=e.interval||1e4,this._timer=null}start(){this._timer||(this._timer=setInterval(()=>this._discoverBootstrapPeers(),this._interval),c("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){this._timer&&this._list.forEach(e=>{if(!i.P2P.matches(e))return c.error("Invalid multiaddr");const t=new n(e),r=t.getPeerId();if(!r)return void c.error("Invalid bootstrap multiaddr without peer id");const o=s.createFromB58String(r);try{this.emit("peer",{id:o,multiaddrs:[t]})}catch(a){c.error("Invalid bootstrap peer id",a)}})}stop(){this._timer&&clearInterval(this._timer),this._timer=null}}t=e.exports=u,t.tag="bootstrap"},e1a0:function(e,t,r){"use strict";const s=r("3f1c"),n=r("2f67"),i=r("b726"),o=r("9b0c"),a=r("4d2c");class c{constructor({repo:e}){this.add=s({repo:e}),this.list=i({repo:e}),this.rm=a({repo:e}),this.clear=n({repo:e}),this.reset=o({repo:e})}}e.exports=c},e1bd:function(e,t,r){"use strict";r.r(t),r.d(t,"nanoid",(function(){return a})),r.d(t,"customAlphabet",(function(){return o})),r.d(t,"customRandom",(function(){return i})),r.d(t,"urlAlphabet",(function(){return s})),r.d(t,"random",(function(){return n}));let s="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW";let n=e=>crypto.getRandomValues(new Uint8Array(e)),i=(e,t,r)=>{let s=(2<<Math.log(e.length-1)/Math.LN2)-1,n=-~(1.6*s*t/e.length);return()=>{let i="";while(1){let o=r(n),a=n;while(a--)if(i+=e[o[a]&s]||"",i.length===t)return i}}},o=(e,t)=>i(e,t,n),a=(e=21)=>{let t="",r=crypto.getRandomValues(new Uint8Array(e));while(e--){let s=63&r[e];t+=s<36?s.toString(36):s<62?(s-26).toString(36).toUpperCase():s<63?"_":"-"}return t}},e37e1:function(e,t,r){"use strict";const{DAGLink:s}=r("8141"),n=r("c449"),i=r("a29d");function o(e,t=[]){for(const i in e){const a=e[i];if("/"===i&&1===Object.keys(e).length)try{t.push(new s("",0,new n(a)));continue}catch(r){}n.isCID(a)?t.push(new s("",0,a)):(Array.isArray(a)&&o(a,t),a&&"object"===typeof a&&o(a,t))}return t}e.exports=({ipld:e})=>{async function t(t,r={}){const s=new n(t),i=await e.get(s,r);if("raw"===s.codec)return[];if("dag-pb"===s.codec)return i.Links;if("dag-cbor"===s.codec)return o(i);throw new Error("Cannot resolve links from codec "+s.codec)}return i(t)}},e3dbc:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("3ef0");const n=256;class i{constructor(e=n){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.chunks=[],this.cursor=0,this.maxCursor=-1,null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];const r=this.cursor+e.length;if(r<=this.maxCursor+1){const r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=s.alloc(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=s.slice(r,0,this.cursor)}else t=s.concat(this.chunks,this.cursor);return e&&this.reset(),t}}t.Bl=i},e3f0:function(e,t,r){"use strict";const s=r("5d98"),n=r("0e80").multihash,i=e=>s.getCodeFromName(e),o=e=>n.names[e],a=r("a29d");e.exports=({ipld:e,pin:t,gcLock:r,preload:s})=>{async function n(n,i={}){const{cidVersion:o,format:a,hashAlg:u}=c(i),l=i.pin?await r.readLock():null;try{const r=await e.put(n,a,{hashAlg:u,cidVersion:o,signal:i.signal});return i.pin&&await t.add(r,{lock:!1}),!1!==i.preload&&s(r),r}finally{l&&l()}}return a(n)};const c=e=>{if(e.cid&&(e.format||e.hashAlg))throw new Error("Can't put dag node. Please provide either `cid` OR `format` and `hashAlg` options.");if(e.format&&!e.hashAlg||!e.format&&e.hashAlg)throw new Error("Can't put dag node. Please provide `format` AND `hashAlg` options.");const{hashAlg:t,format:r}=null!=e.cid?{format:e.cid.code,hashAlg:void 0}:u({...d,...e}),s=l({...e,format:r,hashAlg:t});return{cidVersion:s,format:r,hashAlg:t}},u=({format:e,hashAlg:t})=>({format:"string"===typeof e?i(e):e,hashAlg:"string"===typeof t?o(t):t}),l=({version:e,cid:t,format:r,hashAlg:n})=>"number"===typeof e?e:t?t.version:r===s.DAG_PB&&n===s.SHA2_256?0:1,d={format:s.getCodeFromName("dag-cbor"),hashAlg:n.names["sha2-256"]}},e4e2:function(e,t,r){"use strict";const s=r("65a5");async function*n(e,t=1){for await(const r of s(e,t)){const e=r.map(e=>e().then(e=>({ok:!0,value:e}),e=>({ok:!1,err:e})));for(let t=0;t<e.length;t++){const r=await e[t];if(!r.ok)throw r.err;yield r.value}}}e.exports=n},e4e3:function(e,t,r){"use strict";const s=r("a29d");e.exports=({keychain:e})=>{const t=async(t,r)=>{const s=await e.renameKey(t,r);return{was:t,now:s.name,id:s.id,overwrite:!1}};return s(t)}},e4e8:function(e,t,r){"use strict";const s=r("b6aa"),n=r("c449");function i(e){const t=e.cid||""+e.path;if(!t)throw s(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const r={path:t,recursive:!1!==e.recursive};return null!=e.metadata&&(r.metadata=e.metadata),r}e.exports=async function*(e){if(null===e||void 0===e)throw s(new Error("Unexpected input: "+e),"ERR_UNEXPECTED_INPUT");if(n.isCID(e))yield i({cid:e});else{if(!(e instanceof String||"string"===typeof e)){if(null!=e.cid||null!=e.path)return yield i(e);if(Symbol.iterator in e){const t=e[Symbol.iterator](),r=t.next();if(r.done)return t;if(n.isCID(r.value)||r.value instanceof String||"string"===typeof r.value){yield i({cid:r.value});for(const e of t)yield i({cid:e});return}if(null!=r.value.cid||null!=r.value.path){yield i(r.value);for(const e of t)yield i(e);return}throw s(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in e){const t=e[Symbol.asyncIterator](),r=await t.next();if(r.done)return t;if(n.isCID(r.value)||r.value instanceof String||"string"===typeof r.value){yield i({cid:r.value});for await(const e of t)yield i({cid:e});return}if(null!=r.value.cid||null!=r.value.path){yield i(r.value);for await(const e of t)yield i(e);return}throw s(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw s(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}yield i({path:e})}}},e53b:function(e,t,r){"use strict";const s=r("34eb")("ipfs:mfs:utils:update-tree"),n=r("5688"),i={shardSplitThreshold:1e3},o=async(e,t,r)=>{r=Object.assign({},i,r),s("Trail",t),t=t.slice().reverse();let o,a=0;for await(const s of e.ipld.getMany(t.map(e=>e.cid))){const i=t[a].cid,c=t[a].name;if(a++,!o){o={cid:i,name:c,size:s.size};continue}const u=await n(e,{parent:s,name:o.name,cid:o.cid,size:o.size,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold,hashAlg:r.hashAlg,cidVersion:r.cidVersion});o={cid:u.cid,name:c,size:u.size}}const{cid:c}=o;return s("Final CID "+c),c};e.exports=o},e66e:function(e,t,r){"use strict";class s extends Error{constructor(e){super(e),this.name="TimeoutError"}}const n=(e,t,r,n)=>{let i;const o=new Promise((o,a)=>{if("number"!==typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");t!==1/0?(n={customTimers:{setTimeout:setTimeout,clearTimeout:clearTimeout},...n},i=n.customTimers.setTimeout.call(void 0,()=>{if("function"===typeof r){try{o(r())}catch(c){a(c)}return}const n="string"===typeof r?r:`Promise timed out after ${t} milliseconds`,i=r instanceof Error?r:new s(n);"function"===typeof e.cancel&&e.cancel(),a(i)},t),(async()=>{try{o(await e)}catch(t){a(t)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()):o(e)});return o.clear=()=>{clearTimeout(i),i=void 0},o};e.exports=n,e.exports.default=n,e.exports.TimeoutError=s},e680:function(e,t,r){"use strict";const s={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0};e.exports=[Object.assign({version:1},s),Object.assign({version:2},s),Object.assign({version:3},s),Object.assign({version:4},s),Object.assign({version:5},s),Object.assign({version:6},s),Object.assign({version:7},s),r("6289"),r("3e53"),r("23c4")]},e68e:function(e,t,r){"use strict";const s=r("97da"),n=r("ce8a");e.exports=e=>n(e,s)},e6bd:function(e,t,r){"use strict";const{EventEmitter:s}=r("faa1"),{Multiaddr:n}=r("2054"),i=r("eddf");class o extends s{constructor(e,{listen:t=[],announce:r=[]}={}){super(),this.peerId=e,this.listen=new Set(t.map(e=>e.toString())),this.announce=new Set(r.map(e=>e.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new n(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new n(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new n(e))}addObservedAddr(e){let t=new n(e);const r=t.getPeerId();if(r){const e=i.createFromB58String(r);e.equals(this.peerId)&&(t=t.decapsulate(new n("/p2p/"+this.peerId)))}const s=t.toString();this.observed.has(s)||(this.observed.add(s),this.emit("change:addresses"))}}e.exports=o},e730:function(e,t,r){"use strict";const s=r("b6aa");function n(e){return e=e||new Error("Cannot open database"),s(e,"ERR_DB_OPEN_FAILED")}function i(e){return e=e||new Error("Delete failed"),s(e,"ERR_DB_DELETE_FAILED")}function o(e){return e=e||new Error("Write failed"),s(e,"ERR_DB_WRITE_FAILED")}function a(e){return e=e||new Error("Not Found"),s(e,"ERR_NOT_FOUND")}function c(e){return e=e||new Error("Aborted"),s(e,"ERR_ABORTED")}e.exports={dbOpenFailedError:n,dbDeleteFailedError:i,dbWriteFailedError:o,notFoundError:a,abortedError:c}},e760:function(e,t,r){e.exports={encode:r("977f"),decode:r("ab3e"),encodingLength:r("c5c7")}},e7aa:function(e,t,r){"use strict";const s=Object.freeze({});function n(e){if("object"!==typeof e||null===e)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=e,this._operations=[],this._written=!1}n.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},n.prototype.put=function(e,t,r){this._checkWritten();const n=this.db._checkKey(e)||this.db._checkValue(t);if(n)throw n;return e=this.db._serializeKey(e),t=this.db._serializeValue(t),this._put(e,t,null!=r?r:s),this},n.prototype._put=function(e,t,r){this._operations.push({...r,type:"put",key:e,value:t})},n.prototype.del=function(e,t){this._checkWritten();const r=this.db._checkKey(e);if(r)throw r;return e=this.db._serializeKey(e),this._del(e,null!=t?t:s),this},n.prototype._del=function(e,t){this._operations.push({...t,type:"del",key:e})},n.prototype.clear=function(){return this._checkWritten(),this._clear(),this},n.prototype._clear=function(){this._operations=[]},n.prototype.write=function(e,t){if(this._checkWritten(),"function"===typeof e&&(t=e),"function"!==typeof t)throw new Error("write() requires a callback argument");"object"===typeof e&&null!==e||(e={}),this._written=!0,this._write(e,t)},n.prototype._write=function(e,t){this.db._batch(this._operations,e,t)},n.prototype._nextTick=r("7e01"),e.exports=n},e80e:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("1755"),n=r("b92d"),i=r("ac23");function o(e,t,r,n){return new s.Token(s.Type.array,n,r)}function a(e,t,r,s){return o(e,t,1,r)}function c(e,t,r,s){return o(e,t,2,n.readUint8(e,t+1,s))}function u(e,t,r,s){return o(e,t,3,n.readUint16(e,t+1,s))}function l(e,t,r,s){return o(e,t,5,n.readUint32(e,t+1,s))}function d(e,t,r,s){const a=n.readUint64(e,t+1,s);if("bigint"===typeof a)throw new Error(i.decodeErrPrefix+" 64-bit integer array lengths not supported");return o(e,t,9,a)}function h(e,t,r,s){if(!1===s.allowIndefinite)throw new Error(i.decodeErrPrefix+" indefinite length items not allowed");return o(e,t,1,1/0)}function p(e,t){n.encodeUintValue(e,s.Type.array.majorEncoded,t.value)}p.compareTokens=n.encodeUint.compareTokens,t.decodeArray16=u,t.decodeArray32=l,t.decodeArray64=d,t.decodeArray8=c,t.decodeArrayCompact=a,t.decodeArrayIndefinite=h,t.encodeArray=p},e8ff:function(e,t,r){"use strict";const s=r("0ea3"),n=r("29b0"),i=r("01f1");class o{constructor({ipns:e,options:t}){this.cancel=s({ipns:e,options:t}),this.state=n({ipns:e,options:t}),this.subs=i({ipns:e,options:t})}}e.exports=o},ea55:function(e,t,r){"use strict";const s=r("b6aa"),n=r("b2a9"),i=r("b846"),o=e=>{async function*t(t={}){const{offset:r,length:s}=i(e.length,t.offset,t.length);yield n(e,0,r,r+s)}return t},a=async(e,t,r,n,i,a,c,u)=>{if(n.length)throw s(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");const l=await c.get(e,u);return{entry:{type:"raw",name:t,path:r,cid:e,content:o(l),depth:a,size:l.length,node:l}}};e.exports=a},ea84:function(e,t,r){"use strict";const s=r("b789");class n{constructor(e){this.lru=s(e)}get(e){const t=this.lru.get(e);if(t)return t.expire&&t.expire<Date.now()?void this.lru.remove(e):t.value}set(e,t,r){this.lru.set(e,{value:t,expire:Date.now()+r})}has(e){const t=this.get(e);return!!t}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}}e.exports=n},ea8c:function(e,t,r){"use strict";const s=r("8874"),{MissingRepoOptionsError:n,NotInitializedRepoError:i}=r("d9a8"),{VERSION_KEY:o,createStore:a}=r("d268"),c=r("d46b"),u=r("9b62");async function l(e,t){if(!await s.isRepoInitialized(e,t))throw new i(`Repo in path ${e} is not initialized!`);if(!t)throw new n("Please pass repo options when trying to open a repo");const r=a(e,"root",t);await r.open();try{return parseInt(u(await r.get(o)))}finally{await r.close()}}async function d(e,t,r){if(!r)throw new n("Please pass repo options when trying to open a repo");const s=a(e,"root",r);await s.open(),await s.put(o,c(String(t))),await s.close()}e.exports={getVersion:l,setVersion:d}},ea9a:function(e,t,r){const{instantiate:s}=r("31e1");function n(e={}){if(!n.supported)return null;var t=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return s(new Response(new Blob([t],{type:"application/wasm"})),e)}n.supported="undefined"!==typeof WebAssembly,e.exports=n},eaeb:function(e,t,r){"use strict";function s(e,t,r){const s=new e(t,r);function n(e,t){t&&s.on(e,t),s._subscribeAdapter(e)}function i(e,t){t?s.removeListener(e,t):s.removeAllListeners(e),0===s.listenerCount(e)&&s._unsubscribeAdapter(e)}return s._subscribeAdapter=s.subscribe,s._unsubscribeAdapter=s.unsubscribe,s.subscribe=n,s.unsubscribe=i,s}e.exports=s},eb8b:function(e,t,r){var s=r("222c");function n(e,t,r){t&&"string"!=typeof t&&(t=t.message||t.name),s(this,{type:e,name:e,cause:"string"!=typeof t?t:r,message:t},"ewr")}function i(e,t){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),n.call(this,"CustomError",e,t)}function o(e,t,r){var s=function(r,i){n.call(this,t,r,i),"FilesystemError"==t&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(e.errno[this.cause.errno]?e.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,s)};return s.prototype=r?new r:new i,s}i.prototype=new Error,e.exports=function(e){var t=function(t,r){return o(e,t,r)};return{CustomError:i,FilesystemError:t("FilesystemError"),createError:t}}},ec58:function(e,t,r){"use strict";const s=r("34eb"),n=s("dns-over-http-resolver");n.error=s("dns-over-http-resolver:error");const i=r("d496"),o=r("67f8");class a{constructor({maxCache:e=100}={}){this._cache=new i({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){const e=[].concat(this._servers);for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*t),s=e[t];e[t]=e[r],e[r]=s}return e}setServers(e){this._servers=e}resolve(e,t="A"){switch(t){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(t+" is not supported")}}async resolve4(e){const t="A",r=this._cache.get(o.getCacheKey(e,t));if(r)return r;for(const i of this._getShuffledServers())try{const r=await o.fetch(o.buildResource({serverResolver:i,hostname:e,recordType:t})),s=await r.json(),n=s.Answer.map(e=>e.data),a=Math.min(s.Answer.map(e=>e.TTL));return this._cache.set(o.getCacheKey(e,t),n,{ttl:a}),n}catch(s){n.error(`${i} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolve6(e){const t="AAAA",r=this._cache.get(o.getCacheKey(e,t));if(r)return r;for(const i of this._getShuffledServers())try{const r=await o.fetch(o.buildResource({serverResolver:i,hostname:e,recordType:t})),s=await r.json(),n=s.Answer.map(e=>e.data),a=Math.min(s.Answer.map(e=>e.TTL));return this._cache.set(o.getCacheKey(e,t),n,{ttl:a}),n}catch(s){n.error(`${i} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolveTxt(e){const t="TXT",r=this._cache.get(o.getCacheKey(e,t));if(r)return r;for(const i of this._getShuffledServers())try{const r=await o.fetch(o.buildResource({serverResolver:i,hostname:e,recordType:t})),s=await r.json(),n=s.Answer.map(e=>[e.data.replace(/['"]+/g,"")]),a=Math.min(s.Answer.map(e=>e.TTL));return this._cache.set(o.getCacheKey(e,t),n,{ttl:a}),n}catch(s){n.error(`${i} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}}a.Resolver=a,e.exports=a},eeba:function(e,t,r){"use strict";const s=r("c449"),n=r("7022");t.resolve=(e,t)=>{let r=n.deserialize(e);const i=t.split("/").filter(Boolean);while(i.length){const e=i.shift();if(void 0===r[e])throw new Error(`Object has no property '${e}'`);if(r=r[e],s.isCID(r))return{value:r,remainderPath:i.join("/")}}return{value:r,remainderPath:""}};const i=function*(e,t){if(!(e instanceof Uint8Array||s.isCID(e)||"string"===typeof e||null===e))for(const r of Object.keys(e)){const s=void 0===t?r:t+"/"+r;yield s,yield*i(e[r],s)}};t.tree=function*(e){const t=n.deserialize(e);yield*i(t)}},eeca:function(e,t,r){"use strict";const{EventEmitter:s}=r("faa1"),n=r("ac57"),i=r("34eb")("latency-monitor:LatencyMonitor");class o extends s{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:t,asyncTestFn:r,latencyRandomPercentage:s}={}){super();const n=this;n.latencyCheckIntervalMs=e||500,n.latencyRandomPercentage=s||10,n._latecyCheckMultiply=n.latencyRandomPercentage/100*2*n.latencyCheckIntervalMs,n._latecyCheckSubtract=n._latecyCheckMultiply/2,n.dataEmitIntervalMs=null===t||0===t?void 0:t||5e3,i("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",n.latencyCheckIntervalMs,n.dataEmitIntervalMs),n.dataEmitIntervalMs?i("Expecting ~%s events per summary",n.latencyCheckIntervalMs/n.dataEmitIntervalMs):i("Not emitting summaries"),n.asyncTestFn=r}start(){globalThis.process&&globalThis.process.hrtime?(i("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{const t=this.now(e);return 1e3*t[0]+t[1]/1e6}):"undefined"!==typeof window&&window.performance&&window.performance.now?(i("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(i("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),a()&&(this._visibilityChangeEmitter=new n,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),this._visibilityChangeEmitter&&!this._visibilityChangeEmitter.isVisible()||this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),"function"===typeof this._emitIntervalID.unref&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){const e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){const e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),i("Summary: %O",e),e}_checkLatency(){const e=this,t=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,r={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+t),startTime:e.now()},s=()=>{if(!this._checkLatencyID)return;const t=e.getDeltaMS(r.startTime)-r.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,t),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,t),e._latencyData.totalMs+=t,i("MS: %s Data: %O",t,e._latencyData)};i("localData: %O",r),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(r.deltaOffset=0,r.startTime=e.now(),e.asyncTestFn(s)):(r.deltaOffset-=1,s())},r.deltaOffset),"function"===typeof this._checkLatencyID.unref&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}}function a(){return"undefined"!==typeof window}e.exports=o},eef9:function(e,t){function r(e,t,r){if(!e)return r;var s,n;if(Array.isArray(t)&&(s=t.slice(0)),"string"==typeof t&&(s=t.split(".")),"symbol"==typeof t&&(s=[t]),!Array.isArray(s))throw new Error("props arg must be an array, a string or a symbol");while(s.length){if(n=s.shift(),!e)return r;if(e=e[n],void 0===e)return r}return e}e.exports=r},f0a5:function(e,t,r){"use strict";const s=r("901e").BigNumber;t.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},t.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36},t.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},t.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},t.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")},t.SHIFT32=Math.pow(2,32),t.SHIFT16=Math.pow(2,16),t.MAX_SAFE_HIGH=2097151,t.NEG_ONE=new s(-1),t.TEN=new s(10),t.TWO=new s(2),t.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5}},f0fd:function(e,t,r){"use strict";e.exports=e=>{if(!Array.isArray(e))throw new TypeError("Expected an array, got "+typeof e);e=[...e];for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}},f105:function(e,t,r){"use strict";(function(t){const{shard:s,ShardingDatastore:n}=r("b0ea"),i=r("aef6"),{cidToKey:o,keyToCid:a}=r("109b"),c=r("5d6d"),u=r("5268"),l=r("0ad6");function d(e,t){return t.sharding?new n(e,new s.NextToLast(2)):e}function h(e){return{open(){return e.open()},async*query(t,r){for await(const{key:s,value:n}of e.query(t,r))yield new i(n,a(s))},async*queryKeys(t,r){for await(const s of e.queryKeys(t,r))yield a(s)},async get(t,r){const s=o(t),n=await e.get(s,r);return new i(n,t)},async*getMany(e,t){for await(const r of e)yield this.get(r,t)},async put(t,r){if(!i.isBlock(t))throw new Error("invalid block");const s=o(t.cid),n=await e.has(s,r);return n||await e.put(s,t.data,r),t},async*putMany(r,s){const n=l(),i=t&&t.nextTick?t.nextTick:setImmediate;i(async()=>{try{await u(e.putMany(async function*(){for await(const t of r){const r=o(t.cid),i=await e.has(r,s);i||(yield{key:r,value:t.data}),n.push(t)}}())),n.end()}catch(t){n.end(t)}}),yield*n},has(t,r){return e.has(o(t),r)},delete(t,r){return e.delete(o(t),r)},deleteMany(t,r){return e.deleteMany(c(t,e=>o(e)),r)},close(){return e.close()}}}e.exports=(e,t)=>{const r=d(e,t);return h(r)}}).call(this,r("4362"))},f10b:function(e,t,r){"use strict";const s=r("c449"),n=r("b6aa"),i=r("73fb"),o=r("a9f4");e.exports=e=>{const t=o.logger(e.peerId,"rpc:get-providers");async function r(r,a){let c;try{c=new s(a.key)}catch(g){throw n(new Error("Invalid CID: "+g.message),"ERR_INVALID_CID")}t("%s",c.toBaseEncodedString());const u=o.bufferToKey(c.bytes),[l,d,h]=await Promise.all([e.datastore.has(u),e.providers.getProviders(c),e._betterPeersToQuery(a,r)]),p=d.map(e=>({id:e,multiaddrs:[]})),f=h.map(e=>({id:e.id,multiaddrs:[]}));l&&p.push({id:e.peerId,multiaddrs:[]});const y=new i(a.type,a.key,a.clusterLevel);return p.length>0&&(y.providerPeers=p),f.length>0&&(y.closerPeers=f),t("got %s providers %s closerPeers",p.length,f.length),y}return r}},f10d:function(e,t,r){"use strict";const s=r("1c35").Buffer;t.test=function(e){return function(t){try{return t.cmp(e,0),!0}catch(r){return!1}}},t.bufferKeys=t.test(s.alloc(0))},f139:function(e,t,r){"use strict";const s=r("b6aa"),n=r("9b62"),i=r("d46b"),o="/record/";function a(e){return n(e,"base32")}function c(e){("string"===typeof e||e instanceof String)&&(e=i(e.toString()));const t=n(e,"base64url");return`${o}${t}`}function u(e){if(e.substring(0,o.length)!==o)throw s(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");const t=e.substring(o.length);return i(t,"base64url")}e.exports={encodeBase32:a,keyToTopic:c,topicToKey:u}},f140:function(e,t,r){"use strict";const s=r("543b"),{PBLink:n}=r("892c"),{createDagLinkFromB58EncodedHash:i}=r("bf15"),o=e=>{const t={};return e.Data&&e.Data.byteLength>0?t.Data=e.Data:t.Data=null,e.Links&&e.Links.length>0?t.Links=e.Links.map(e=>({Hash:e.Hash.bytes,Name:e.Name,Tsize:e.Tsize})):t.Links=null,t},a=e=>u(o(e)),c=(e,t=[])=>{const r={Data:e,Links:t.map(e=>i(e))};return u(o(r))};function u(e){const t=s.Writer.create();if(null!=e.Links)for(let r=0;r<e.Links.length;r++)n.encode(e.Links[r],t.uint32(18).fork()).ldelim();return null!=e.Data&&t.uint32(10).bytes(e.Data),t.finish()}e.exports={serializeDAGNode:a,serializeDAGNodeLike:c}},f248:function(e,t,r){"use strict";
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */e.exports=a,e.exports.format=c,e.exports.parse=u;var s=/\B(?=(\d{3})+(?!\d))/g,n=/(?:\.0*|(\.[^0]+)0+)$/,i={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},o=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function a(e,t){return"string"===typeof e?u(e):"number"===typeof e?c(e,t):null}function c(e,t){if(!Number.isFinite(e))return null;var r=Math.abs(e),o=t&&t.thousandsSeparator||"",a=t&&t.unitSeparator||"",c=t&&void 0!==t.decimalPlaces?t.decimalPlaces:2,u=Boolean(t&&t.fixedDecimals),l=t&&t.unit||"";l&&i[l.toLowerCase()]||(l=r>=i.pb?"PB":r>=i.tb?"TB":r>=i.gb?"GB":r>=i.mb?"MB":r>=i.kb?"KB":"B");var d=e/i[l.toLowerCase()],h=d.toFixed(c);return u||(h=h.replace(n,"$1")),o&&(h=h.replace(s,o)),h+a+l}function u(e){if("number"===typeof e&&!isNaN(e))return e;if("string"!==typeof e)return null;var t,r=o.exec(e),s="b";return r?(t=parseFloat(r[1]),s=r[4].toLowerCase()):(t=parseInt(e,10),s="b"),Math.floor(i[s]*t)}},f24f:function(e,t,r){"use strict";const s=r("a29d");e.exports=({repo:e})=>{async function t(t={}){const r=await e.stat();return{numObjects:BigInt(r.numObjects.toString()),repoSize:BigInt(r.repoSize.toString()),repoPath:r.repoPath,version:""+r.version,storageMax:BigInt(r.storageMax.toString())}}return s(t)}},f27c:function(e,t,r){"use strict";const s=r("34eb"),n=Object.assign(s("libp2p:auto-relay"),{error:s("libp2p:auto-relay:err")}),i=r("d46b"),o=r("9b62"),{Multiaddr:a}=r("2054"),c=r("eddf"),{relay:u}=r("5e54"),{canHop:l}=r("0f57"),{namespaceToCid:d}=r("1a4e"),{CIRCUIT_PROTO_CODE:h,HOP_METADATA_KEY:p,HOP_METADATA_VALUE:f,RELAY_RENDEZVOUS_NS:y}=r("076b");class g{constructor({libp2p:e,maxListeners:t=1,onError:r}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=t,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(e,t)=>{n.error(t||e),r&&r(e,t)}}async _onProtocolChange({peerId:e,protocols:t}){const r=e.toB58String(),s=t.find(e=>e===u);if(s||!this._listenRelays.has(r)){if(s&&!this._listenRelays.has(r))try{const t=this._connectionManager.get(e);if(!t)return;if(t.remoteAddr.protoCodes().includes(h))return void n(`relayed connection to ${r} will not be used to hop on`);const s=await l({connection:t});s&&(this._peerStore.metadataBook.set(e,p,i(f)),await this._addListenRelay(t,r))}catch(o){this._onError(o)}}else this._removeListenRelay(r)}_onPeerDisconnected(e){const t=e.remotePeer,r=t.toB58String();this._listenRelays.has(r)&&this._removeListenRelay(r)}async _addListenRelay(e,t){if(this._listenRelays.size>=this.maxListeners)return;const r=this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);if(!r||!r.length)return;const s=r[0].toString()+"/p2p-circuit";this._listenRelays.add(t);try{await this._transportManager.listen([new a(s)])}catch(n){this._onError(n),this._listenRelays.delete(t)}}_removeListenRelay(e){this._listenRelays.delete(e)&&this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;const t=[];for(const[s,n]of this._peerStore.metadataBook.data.entries()){if(this._listenRelays.has(s)||e.includes(s))continue;const r=n.get(p);if(!r||o(r)!==f)continue;const i=c.createFromCID(s),a=this._connectionManager.get(i);if(a){if(await this._addListenRelay(a,s),this._listenRelays.size>=this.maxListeners)return}else t.push(i)}for(const s of t)if(await this._tryToListenOnRelay(s),this._listenRelays.size>=this.maxListeners)return;try{const e=await d(y);for await(const t of this._libp2p.contentRouting.findProviders(e)){if(!t.multiaddrs.length)continue;const e=t.id;if(this._peerStore.addressBook.add(e,t.multiaddrs),await this._tryToListenOnRelay(e),this._listenRelays.size>=this.maxListeners)return}}catch(r){this._onError(r)}}async _tryToListenOnRelay(e){try{const t=await this._libp2p.dial(e);await this._addListenRelay(t,e.toB58String())}catch(t){this._onError(t,"could not connect and listen on known hop relay "+e.toB58String())}}}e.exports=g},f3d7:function(e,t,r){"use strict";const s=r("1304").Key,n=r("6f2b");class i extends n{constructor(e,t){super(e,{convert(e){return t.child(e)},invert(e){if("/"===t.toString())return e;if(!t.isAncestorOf(e))throw new Error(`Expected prefix: (${t.toString()}) in key: ${e.toString()}`);return new s(e.toString().slice(t.toString().length),!1)}}),this.prefix=t}query(e,t){return e.prefix&&"/"!==this.prefix.toString()?super.query(Object.assign({},e,{prefix:this.prefix.child(new s(e.prefix)).toString()})):super.query(e,t)}queryKeys(e,t){return e.prefix&&"/"!==this.prefix.toString()?super.queryKeys(Object.assign({},e,{prefix:this.prefix.child(new s(e.prefix)).toString()})):super.queryKeys(e,t)}}e.exports=i},f410:function(e,t,r){"use strict";const s=r("c449"),n=r("b6aa"),i=r("a9f4");e.exports=e=>{const t=i.logger(e.peerId,"rpc:add-provider");async function r(r,i){if(t("start"),!i.key||0===i.key.length)throw n(new Error("Missing key"),"ERR_MISSING_KEY");let o;try{o=new s(i.key)}catch(a){const e="Invalid CID: "+a.message;throw n(new Error(e),"ERR_INVALID_CID")}return i.providerPeers.forEach(s=>{if(s.id.isEqual(r)){if(!(s.multiaddrs.length<1))return t("received provider %s for %s (addrs %s)",r.toB58String(),o.toBaseEncodedString(),s.multiaddrs.map(e=>e.toString())),e._isSelf(s.id)?void 0:(e.peerStore.addressBook.add(s.id,s.multiaddrs),e.providers.addProvider(o,s.id));t("no valid addresses for provider %s. Ignore",r.toB58String())}else t("invalid provider peer %s from %s",s.id.toB58String(),r.toB58String())}),e.providers.addProvider(o,r)}return r}},f48f:function(e,t,r){"use strict";const s=r("2fd4"),n=r("c597"),i=r("ce74").logger,{wantlistSendDebounceMs:o}=r("2a9c");e.exports=class{constructor(e,t,r){this.peerId=t,this.network=r,this.refcnt=1,this._entries=[],this._log=i(e,"msgqueue"),this.sendEntries=s(this._sendEntries.bind(this),o)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;const e=new n(!1);this._entries.forEach(t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)}),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(t){return void this._log.error("cant connect to peer %s: %s",this.peerId.toB58String(),t.message)}this._log("sending message to peer %s",this.peerId.toB58String()),this.network.sendMessage(this.peerId,e).catch(e=>{this._log.error("send error: %s",e.message)})}}},f4d3:function(e,t,r){"use strict";const s=r("5d6d"),n=r("b6aa");class i{constructor(e){this._repo=e,this._bitswap=null}setExchange(e){this._bitswap=e}unsetExchange(){this._bitswap=null}hasExchange(){return null!=this._bitswap}put(e,t){return this.hasExchange()?this._bitswap.put(e,t):this._repo.blocks.put(e,t)}putMany(e,t){return this.hasExchange()?this._bitswap.putMany(e,t):this._repo.blocks.putMany(e,t)}get(e,t){return this.hasExchange()?this._bitswap.get(e,t):this._repo.blocks.get(e,t)}getMany(e,t){if(!Array.isArray(e))throw new Error("first arg must be an array of cids");return this.hasExchange()?this._bitswap.getMany(e,t):s(e,e=>this._repo.blocks.get(e,t))}async delete(e,t){if(!await this._repo.blocks.has(e))throw n(new Error("blockstore: block not found"),"ERR_BLOCK_NOT_FOUND");return this._repo.blocks.delete(e,t)}deleteMany(e,t){const r=this._repo;return this._repo.blocks.deleteMany(async function*(){for await(const t of e){if(!await r.blocks.has(t))throw n(new Error("blockstore: block not found"),"ERR_BLOCK_NOT_FOUND");yield t}}(),t)}}e.exports=i},f6a4:function(e,t,r){var s=r("d327");r("8272"),r("b1d4");var n=s.asn1,i=e.exports=s.pkcs7asn1=s.pkcs7asn1||{};s.pkcs7=s.pkcs7||{},s.pkcs7.asn1=i;var o={name:"ContentInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};i.contentInfoValidator=o;var a={name:"EncryptedContentInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};i.envelopedDataValidator={name:"EnvelopedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(a)},i.encryptedDataValidator={name:"EncryptedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"}].concat(a)};var c={name:"SignerInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};i.signedDataValidator={name:"SignedData",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},o,{name:"SignedData.Certificates",tagClass:n.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:n.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:n.Class.UNIVERSAL,type:n.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},i.recipientInfoValidator={name:"RecipientInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:n.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},f7c6:function(e,t,r){"use strict";const{default:s}=r("3cb9"),n=r("b6aa"),i=r("a29d");function o(e,t){let r;if(r=e.metrics?t.peer?e.metrics.forPeer(t.peer):t.proto?e.metrics.forProtocol(t.proto):e.metrics.global:void 0,!r)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:BigInt(0),rateOut:BigInt(0)};const{movingAverages:s,snapshot:n}=r;return{totalIn:BigInt(n.dataReceived.toString()),totalOut:BigInt(n.dataSent.toString()),rateIn:BigInt(s.dataReceived[6e4].movingAverage()/60),rateOut:BigInt(s.dataSent[6e4].movingAverage()/60)}}e.exports=({network:e})=>{const t=async function*(t={}){const{libp2p:r}=await e.use(t);if(!t.poll)return void(yield o(r,t));const i=t.interval||1e3;let a,c=-1;try{if(c="string"===typeof i?s(i)||-1:i,!c||c<0)throw new Error("invalid duration")}catch(u){throw n(u,"ERR_INVALID_POLL_INTERVAL")}try{while(1)yield o(r,t),await new Promise(e=>{a=setTimeout(e,c)})}finally{clearTimeout(a)}};return i(t)}},f7ff:function(e,t,r){"use strict";const s=r("c449"),n=r("b6aa"),{parallelMap:i,filter:o}=r("8b55"),{pipe:a}=r("66f2"),{PinTypes:c}=r("d507"),{cleanCid:u}=r("7ae0"),l=r("a29d"),d=8;e.exports=({blockService:e,gcLock:t,pinManager:r})=>{async function*h(l,h={}){Array.isArray(l)||(l=[l]);const p=await t.writeLock();try{yield*a(l,i(d,async t=>{t=u(t);const i={cid:t};try{const i=await r.isPinnedWithType(t,c.all);if(i.pinned){if(s.isCID(i.reason))throw n(new Error("pinned via "+i.reason),"ERR_BLOCK_PINNED");throw n(new Error("pinned: "+i.reason),"ERR_BLOCK_PINNED")}const o=await e._repo.blocks.has(t);if(!o)throw n(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await e.delete(t)}catch(o){h.force||(o.message=`cannot remove ${t}: ${o.message}`,i.error=o)}return i}),o(()=>!h.quiet))}finally{p()}}return l(h)}},f9a3:function(e,t,r){"use strict";function s(e,t){for(let r=0;r<e.byteLength;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}e.exports=s},f9b9:function(e,t,r){"use strict";r("7f97"),r("44f3");const s=r("d327"),{certificateForKey:n,findAsync:i}=r("9dd0"),o=r("b6aa"),a=r("d46b"),c=r("9b62"),u=new WeakMap;class l{constructor(e,t){if(!e)throw o(new Error("keychain is required"),"ERR_KEYCHAIN_REQUIRED");this.keychain=e,u.set(this,{dek:t})}async encrypt(e,t){if(!(t instanceof Uint8Array))throw o(new Error("Plain data must be a Uint8Array"),"ERR_INVALID_PARAMS");const r=await this.keychain.findKeyByName(e),i=await this.keychain._getPrivateKey(e),c=u.get(this).dek,l=s.pki.decryptRsaPrivateKey(i,c),d=await n(r,l),h=s.pkcs7.createEnvelopedData();h.addRecipient(d),h.content=s.util.createBuffer(t),h.encrypt();const p=s.asn1.toDer(h.toAsn1()).getBytes();return a(p,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw o(new Error("CMS data is required"),"ERR_INVALID_PARAMS");let t;try{const r=s.util.createBuffer(c(e,"ascii")),n=s.asn1.fromDer(r);t=s.pkcs7.messageFromAsn1(n)}catch(f){throw o(new Error("Invalid CMS: "+f.message),"ERR_INVALID_CMS")}const r=t.recipients.filter(e=>e.issuer.find(e=>"O"===e.shortName&&"ipfs"===e.value)).filter(e=>e.issuer.find(e=>"CN"===e.shortName)).map(e=>({recipient:e,keyId:e.issuer.find(e=>"CN"===e.shortName).value})),n=await i(r,async e=>{try{const t=await this.keychain.findKeyById(e.keyId);if(t)return!0}catch(f){return!1}return!1});if(!n){const e=r.map(e=>e.keyId);throw o(new Error("Decryption needs one of the key(s): "+e.join(", ")),"ERR_MISSING_KEYS",{missingKeys:e})}const l=await this.keychain.findKeyById(n.keyId);if(!l)throw o(new Error("No key available to decrypto"),"ERR_NO_KEY");const d=await this.keychain._getPrivateKey(l.name),h=u.get(this).dek,p=s.pki.decryptRsaPrivateKey(d,h);return t.decrypt(n.recipient,p),a(t.content.getBytes(),"ascii")}}e.exports=l},f9f7:function(e,t,r){"use strict";const s=r("34eb")("mss:handle"),n=r("3301"),i=r("5b1e"),o=r("4e8e"),{PROTOCOL_ID:a}=r("c319");e.exports=async(e,t)=>{t=Array.isArray(t)?t:[t];const{writer:r,reader:c,rest:u,stream:l}=o(e);while(1){const e=(await i.read(c)).toString();if(s('read "%s"',e),e!==a){if(t.includes(e))return i.write(r,e),s('respond with "%s" for "%s"',e,e),u(),{stream:l,protocol:e};"ls"!==e?(i.write(r,"na"),s('respond with "na" for "%s"',e)):(i.write(r,new n(t.map(e=>i.encode(e)))),s('respond with "%s" for %s',t,e))}else s('respond with "%s" for "%s"',a,e),i.write(r,a)}}},fa2a:function(e,t,r){"use strict";t.Connection=r("4c43")},fa3a6:function(e,t,r){"use strict";e.exports={gossipsub:r("2f0b")}},fa4e:function(e,t,r){var s=r("05e5");function n(e){if(!(e instanceof Object))throw new TypeError('"obj" must be an object (or inherit from it)');return i(e)}function i(e,t){for(var r in t=new s(e,t),e){var n=e[r];if(n instanceof Object&&(t.contains(n)||i(n,t)))return!0}return!1}e.exports=n},faba:function(e,t,r){"use strict";const{UnixFS:s}=r("9fd0"),{DAGNode:n}=r("8141"),i=r("5d98"),o=r("0e80").multihash,a=async(e,t,r)=>{const a=o.names[r.hashAlg],c=new s({type:t,mode:r.mode,mtime:r.mtime}),u=new n(c.marshal()),l=await e.ipld.put(u,i.DAG_PB,{cidVersion:r.cidVersion,hashAlg:a,onlyHash:!r.flush});return{cid:l,node:u}};e.exports=a},fabb:function(e,t,r){"use strict";class s extends Error{constructor(e="not initialized"){super(e),this.name="NotInitializedError",this.code=s.code}}s.code="ERR_NOT_INITIALIZED",t.NotInitializedError=s;class n extends Error{constructor(e="cannot initialize an initializing node"){super(e),this.name="AlreadyInitializingError",this.code=i.code}}n.code="ERR_ALREADY_INITIALIZING",t.AlreadyInitializingError=n;class i extends Error{constructor(e="cannot re-initialize an initialized node"){super(e),this.name="AlreadyInitializedError",this.code=i.code}}i.code="ERR_ALREADY_INITIALIZED",t.AlreadyInitializedError=i;class o extends Error{constructor(e="not started"){super(e),this.name="NotStartedError",this.code=o.code}}o.code="ERR_NOT_STARTED",t.NotStartedError=o;class a extends Error{constructor(e="cannot start, already startin"){super(e),this.name="AlreadyStartingError",this.code=a.code}}a.code="ERR_ALREADY_STARTING",t.AlreadyStartingError=a;class c extends Error{constructor(e="cannot start, already started"){super(e),this.name="AlreadyStartedError",this.code=c.code}}c.code="ERR_ALREADY_STARTED",t.AlreadyStartedError=c;class u extends Error{constructor(e="not enabled"){super(e),this.name="NotEnabledError",this.code=u.code}}u.code="ERR_NOT_ENABLED",t.NotEnabledError=u},fd46:function(e,t,r){"use strict";const s=[255,254,252,248,240,224,192,128],n=[1,3,7,15,31,63,127,255];function i(e,t,r){const s=o(t,r);return(e&s)>>>t}function o(e,t){return s[e]&n[Math.min(t+e-1,7)]}e.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,r=0;while(t&&this._haveBits()){const e=this._value[this._currentBytePos],s=this._currentBitPos+1,n=Math.min(s,t),o=i(e,s-n,n);r=(r<<n)+o,t-=n,this._currentBitPos-=n,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return r}untake(e){this._currentBitPos+=e;while(this._currentBitPos>7)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}},fd90:function(e,t,r){"use strict";const s=r("c872"),n=r("ac70"),i=r("1b9b"),o=r("1060"),a=r("68c6");class c{constructor({network:e}){this.addrs=s({network:e}),this.connect=n({network:e}),this.disconnect=i({network:e}),this.localAddrs=o({network:e}),this.peers=a({network:e})}}e.exports=c},fee4:function(e,t,r){"use strict";const s=async e=>{let t=0;for await(const r of e)t++;return t};e.exports=s}}]);